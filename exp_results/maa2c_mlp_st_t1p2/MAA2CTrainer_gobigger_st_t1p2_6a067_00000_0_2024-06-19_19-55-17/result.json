{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3200, "timesteps_this_iter": 0, "agent_timesteps_total": 6400, "timers": {"sample_time_ms": 1950.204, "sample_throughput": 1640.854, "load_time_ms": 0.301, "load_throughput": 10618491.139, "learn_time_ms": 83.862, "learn_throughput": 38158.004, "update_time_ms": 1.363}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2688958.25, "policy_entropy": 18216.44921875, "policy_loss": 1230936.875, "vf_loss": 43675824.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3200, "num_agent_steps_sampled": 6400, "num_steps_trained": 3200, "num_agent_steps_trained": 6400}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-55-22", "timestamp": 1718794522, "time_this_iter_s": 2.0139400959014893, "time_total_s": 2.0139400959014893, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9aee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 2.0139400959014893, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 65.93333333333334, "ram_util_percent": 33.23333333333333}}
{"episode_reward_max": 13074.790014079525, "episode_reward_min": 6471.226332468021, "episode_reward_mean": 10046.363453538743, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 3235.6131662340104}, "policy_reward_max": {"shared_policy": 6537.395007039764}, "policy_reward_mean": {"shared_policy": 5023.1817267693705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10465.06056170198, 7984.701124505878, 9712.14542393776, 11761.733229430021, 10707.634756786083, 10398.727485979041, 12499.044088311013, 10525.483027891609, 10741.545495800321, 13074.790014079525, 7870.200856652145, 11768.301465944493, 9616.280737586228, 7528.22323329115, 9720.956863194802, 9751.478621801263, 6471.226332468021, 9949.934929904837, 8845.032383831902, 11534.768437676765], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5232.530280850977, 5232.530280850977, 3992.350562252939, 3992.350562252939, 4856.072711968895, 4856.072711968895, 5880.866614715022, 5880.866614715022, 5353.817378393036, 5353.817378393036, 5199.363742989515, 5199.363742989515, 6249.522044155508, 6249.522044155508, 5262.7415139457935, 5262.7415139457935, 5370.772747900157, 5370.772747900157, 6537.395007039764, 6537.395007039764, 3935.1004283260727, 3935.1004283260727, 5884.150732972242, 5884.150732972242, 4808.140368793112, 4808.140368793112, 3764.111616645575, 3764.111616645575, 4860.478431597416, 4860.478431597416, 4875.7393109006325, 4875.7393109006325, 3235.6131662340104, 3235.6131662340104, 4974.967464952409, 4974.967464952409, 4422.516191915949, 4422.516191915949, 5767.384218838375, 5767.384218838375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24638594074581208, "mean_inference_ms": 1.1969072060199892, "mean_action_processing_ms": 0.13385647803957262, "mean_env_wait_ms": 3.2119683632091034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 22400, "timesteps_this_iter": 0, "agent_timesteps_total": 44800, "timers": {"sample_time_ms": 1812.636, "sample_throughput": 1765.385, "load_time_ms": 0.159, "load_throughput": 20092474.251, "learn_time_ms": 68.253, "learn_throughput": 46884.124, "update_time_ms": 1.436}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3767448.25, "policy_entropy": 20417.91015625, "policy_loss": 1461714.0, "vf_loss": 50603776.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 22400, "num_agent_steps_sampled": 44800, "num_steps_trained": 22400, "num_agent_steps_trained": 44800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-55-32", "timestamp": 1718794532, "time_this_iter_s": 10.709015130996704, "time_total_s": 12.722955226898193, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9ac10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 12.722955226898193, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 59.5625, "ram_util_percent": 33.54375}}
{"episode_reward_max": 15074.695341751754, "episode_reward_min": 2600.0, "episode_reward_mean": 9705.224468209146, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 7537.347670875868}, "policy_reward_mean": {"shared_policy": 4852.612234104573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10465.06056170198, 7984.701124505878, 9712.14542393776, 11761.733229430021, 10707.634756786083, 10398.727485979041, 12499.044088311013, 10525.483027891609, 10741.545495800321, 13074.790014079525, 7870.200856652145, 11768.301465944493, 9616.280737586228, 7528.22323329115, 9720.956863194802, 9751.478621801263, 6471.226332468021, 9949.934929904837, 8845.032383831902, 11534.768437676765, 5422.53459015344, 9073.09041474123, 13607.026374274072, 9057.285935898832, 11664.400821548272, 12187.01812482817, 10930.217490234987, 7521.980383808881, 10670.082341514295, 11000.47997550829, 11145.936537167523, 9105.288955299944, 12896.778350803019, 8525.08673694935, 7464.379650162171, 11830.603922472877, 10694.818116228162, 7333.044499871563, 10380.26035550269, 6555.634658073495, 2600.0, 6717.119425455952, 8490.969812527645, 10693.056345417666, 10692.64176184171, 6651.790392975676, 8732.281327407254, 15074.695341751754, 11863.475460441055, 5751.976236822491], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5232.530280850977, 5232.530280850977, 3992.350562252939, 3992.350562252939, 4856.072711968895, 4856.072711968895, 5880.866614715022, 5880.866614715022, 5353.817378393036, 5353.817378393036, 5199.363742989515, 5199.363742989515, 6249.522044155508, 6249.522044155508, 5262.7415139457935, 5262.7415139457935, 5370.772747900157, 5370.772747900157, 6537.395007039764, 6537.395007039764, 3935.1004283260727, 3935.1004283260727, 5884.150732972242, 5884.150732972242, 4808.140368793112, 4808.140368793112, 3764.111616645575, 3764.111616645575, 4860.478431597416, 4860.478431597416, 4875.7393109006325, 4875.7393109006325, 3235.6131662340104, 3235.6131662340104, 4974.967464952409, 4974.967464952409, 4422.516191915949, 4422.516191915949, 5767.384218838375, 5767.384218838375, 2711.26729507672, 2711.26729507672, 4536.545207370609, 4536.545207370609, 6803.513187137043, 6803.513187137043, 4528.642967949414, 4528.642967949414, 5832.200410774131, 5832.200410774131, 6093.509062414081, 6093.509062414081, 5465.108745117493, 5465.108745117493, 3760.9901919044405, 3760.9901919044405, 5335.041170757144, 5335.041170757144, 5500.239987754159, 5500.239987754159, 5572.968268583763, 5572.968268583763, 4552.644477649968, 4552.644477649968, 6448.389175401509, 6448.389175401509, 4262.543368474672, 4262.543368474672, 3732.1898250810855, 3732.1898250810855, 5915.301961236428, 5915.301961236428, 5347.409058114081, 5347.409058114081, 3666.5222499357815, 3666.5222499357815, 5190.1301777513345, 5190.1301777513345, 3277.8173290367477, 3277.8173290367477, 1300.0, 1300.0, 3358.559712727976, 3358.559712727976, 4245.484906263824, 4245.484906263824, 5346.528172708831, 5346.528172708831, 5346.320880920869, 5346.320880920869, 3325.895196487838, 3325.895196487838, 4366.14066370362, 4366.14066370362, 7537.347670875868, 7537.347670875868, 5931.737730220525, 5931.737730220525, 2875.9881184112455, 2875.9881184112455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25148268121121925, "mean_inference_ms": 1.2111013607549048, "mean_action_processing_ms": 0.13537106544077493, "mean_env_wait_ms": 3.292375203757371, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 41600, "timesteps_this_iter": 0, "agent_timesteps_total": 83200, "timers": {"sample_time_ms": 1861.752, "sample_throughput": 1718.811, "load_time_ms": 0.136, "load_throughput": 23538710.628, "learn_time_ms": 65.133, "learn_throughput": 49130.242, "update_time_ms": 1.564}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3649260.0, "policy_entropy": 21647.1953125, "policy_loss": 1285440.5, "vf_loss": 41282236.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 41600, "num_agent_steps_sampled": 83200, "num_steps_trained": 41600, "num_agent_steps_trained": 83200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 3, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-55-44", "timestamp": 1718794544, "time_this_iter_s": 11.46819519996643, "time_total_s": 24.191150426864624, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 24.191150426864624, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 59.675, "ram_util_percent": 33.5625}}
{"episode_reward_max": 15753.687195842307, "episode_reward_min": 2600.0, "episode_reward_mean": 10078.532591854322, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 7876.843597921146}, "policy_reward_mean": {"shared_policy": 5039.266295927161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10465.06056170198, 7984.701124505878, 9712.14542393776, 11761.733229430021, 10707.634756786083, 10398.727485979041, 12499.044088311013, 10525.483027891609, 10741.545495800321, 13074.790014079525, 7870.200856652145, 11768.301465944493, 9616.280737586228, 7528.22323329115, 9720.956863194802, 9751.478621801263, 6471.226332468021, 9949.934929904837, 8845.032383831902, 11534.768437676765, 5422.53459015344, 9073.09041474123, 13607.026374274072, 9057.285935898832, 11664.400821548272, 12187.01812482817, 10930.217490234987, 7521.980383808881, 10670.082341514295, 11000.47997550829, 11145.936537167523, 9105.288955299944, 12896.778350803019, 8525.08673694935, 7464.379650162171, 11830.603922472877, 10694.818116228162, 7333.044499871563, 10380.26035550269, 6555.634658073495, 2600.0, 6717.119425455952, 8490.969812527645, 10693.056345417666, 10692.64176184171, 6651.790392975676, 8732.281327407254, 15074.695341751754, 11863.475460441055, 5751.976236822491, 14686.90459755608, 11534.531543149078, 7526.262844843626, 6733.814813047757, 11270.573541131613, 13301.847961219239, 10680.281382855916, 7415.140100812023, 15753.687195842307, 12944.613812754149, 8358.358523720672, 7576.7345142446175, 11982.74720618749, 14068.834619503039, 9470.058707900724, 12424.134932057575, 10050.512917092, 11126.19427529109, 11893.432723207847, 11437.391806928528], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5232.530280850977, 5232.530280850977, 3992.350562252939, 3992.350562252939, 4856.072711968895, 4856.072711968895, 5880.866614715022, 5880.866614715022, 5353.817378393036, 5353.817378393036, 5199.363742989515, 5199.363742989515, 6249.522044155508, 6249.522044155508, 5262.7415139457935, 5262.7415139457935, 5370.772747900157, 5370.772747900157, 6537.395007039764, 6537.395007039764, 3935.1004283260727, 3935.1004283260727, 5884.150732972242, 5884.150732972242, 4808.140368793112, 4808.140368793112, 3764.111616645575, 3764.111616645575, 4860.478431597416, 4860.478431597416, 4875.7393109006325, 4875.7393109006325, 3235.6131662340104, 3235.6131662340104, 4974.967464952409, 4974.967464952409, 4422.516191915949, 4422.516191915949, 5767.384218838375, 5767.384218838375, 2711.26729507672, 2711.26729507672, 4536.545207370609, 4536.545207370609, 6803.513187137043, 6803.513187137043, 4528.642967949414, 4528.642967949414, 5832.200410774131, 5832.200410774131, 6093.509062414081, 6093.509062414081, 5465.108745117493, 5465.108745117493, 3760.9901919044405, 3760.9901919044405, 5335.041170757144, 5335.041170757144, 5500.239987754159, 5500.239987754159, 5572.968268583763, 5572.968268583763, 4552.644477649968, 4552.644477649968, 6448.389175401509, 6448.389175401509, 4262.543368474672, 4262.543368474672, 3732.1898250810855, 3732.1898250810855, 5915.301961236428, 5915.301961236428, 5347.409058114081, 5347.409058114081, 3666.5222499357815, 3666.5222499357815, 5190.1301777513345, 5190.1301777513345, 3277.8173290367477, 3277.8173290367477, 1300.0, 1300.0, 3358.559712727976, 3358.559712727976, 4245.484906263824, 4245.484906263824, 5346.528172708831, 5346.528172708831, 5346.320880920869, 5346.320880920869, 3325.895196487838, 3325.895196487838, 4366.14066370362, 4366.14066370362, 7537.347670875868, 7537.347670875868, 5931.737730220525, 5931.737730220525, 2875.9881184112455, 2875.9881184112455, 7343.452298778042, 7343.452298778042, 5767.265771574534, 5767.265771574534, 3763.131422421813, 3763.131422421813, 3366.9074065238783, 3366.9074065238783, 5635.28677056579, 5635.28677056579, 6650.9239806096175, 6650.9239806096175, 5340.140691427967, 5340.140691427967, 3707.5700504060114, 3707.5700504060114, 7876.843597921146, 7876.843597921146, 6472.306906377089, 6472.306906377089, 4179.179261860334, 4179.179261860334, 3788.3672571223087, 3788.3672571223087, 5991.373603093743, 5991.373603093743, 7034.4173097515195, 7034.4173097515195, 4735.0293539503655, 4735.0293539503655, 6212.0674660287805, 6212.0674660287805, 5025.256458546001, 5025.256458546001, 5563.097137645549, 5563.097137645549, 5946.71636160392, 5946.71636160392, 5718.695903464261, 5718.695903464261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25267295406135576, "mean_inference_ms": 1.2160672780310615, "mean_action_processing_ms": 0.13597026372672483, "mean_env_wait_ms": 3.3173674063464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 60800, "timesteps_this_iter": 0, "agent_timesteps_total": 121600, "timers": {"sample_time_ms": 1915.474, "sample_throughput": 1670.604, "load_time_ms": 0.139, "load_throughput": 23053543.112, "learn_time_ms": 65.77, "learn_throughput": 48654.538, "update_time_ms": 1.578}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5661525.0, "policy_entropy": 23523.400390625, "policy_loss": 1735744.0, "vf_loss": 49262588.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60800, "num_agent_steps_sampled": 121600, "num_steps_trained": 60800, "num_agent_steps_trained": 121600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 70, "training_iteration": 4, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-55-55", "timestamp": 1718794555, "time_this_iter_s": 11.362913846969604, "time_total_s": 35.55406427383423, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 35.55406427383423, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 59.29375, "ram_util_percent": 33.55}}
{"episode_reward_max": 16080.39438769031, "episode_reward_min": 2600.0, "episode_reward_mean": 10482.93385267255, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 8040.19719384515}, "policy_reward_mean": {"shared_policy": 5241.466926336273}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10465.06056170198, 7984.701124505878, 9712.14542393776, 11761.733229430021, 10707.634756786083, 10398.727485979041, 12499.044088311013, 10525.483027891609, 10741.545495800321, 13074.790014079525, 7870.200856652145, 11768.301465944493, 9616.280737586228, 7528.22323329115, 9720.956863194802, 9751.478621801263, 6471.226332468021, 9949.934929904837, 8845.032383831902, 11534.768437676765, 5422.53459015344, 9073.09041474123, 13607.026374274072, 9057.285935898832, 11664.400821548272, 12187.01812482817, 10930.217490234987, 7521.980383808881, 10670.082341514295, 11000.47997550829, 11145.936537167523, 9105.288955299944, 12896.778350803019, 8525.08673694935, 7464.379650162171, 11830.603922472877, 10694.818116228162, 7333.044499871563, 10380.26035550269, 6555.634658073495, 2600.0, 6717.119425455952, 8490.969812527645, 10693.056345417666, 10692.64176184171, 6651.790392975676, 8732.281327407254, 15074.695341751754, 11863.475460441055, 5751.976236822491, 14686.90459755608, 11534.531543149078, 7526.262844843626, 6733.814813047757, 11270.573541131613, 13301.847961219239, 10680.281382855916, 7415.140100812023, 15753.687195842307, 12944.613812754149, 8358.358523720672, 7576.7345142446175, 11982.74720618749, 14068.834619503039, 9470.058707900724, 12424.134932057575, 10050.512917092, 11126.19427529109, 11893.432723207847, 11437.391806928528, 16078.866875635686, 8734.736751507258, 13793.972082130284, 11048.019661798611, 12719.803172873253, 9939.506130451307, 8825.507473665417, 13174.192916493757, 11431.793864737458, 8017.643730098251, 8719.269095264583, 11035.103423109682, 12309.367380153704, 11053.98932417163, 15942.367209635599, 13646.255433842169, 10186.22311552993, 7214.857718140385, 12917.700354266712, 10431.18632680675, 8259.481026503592, 12711.877436426705, 8843.710487859764, 3400.0, 10670.49498006576, 14770.171420391645, 16080.39438769031, 13701.941266186317, 11477.635426265417, 15660.035365750336], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5232.530280850977, 5232.530280850977, 3992.350562252939, 3992.350562252939, 4856.072711968895, 4856.072711968895, 5880.866614715022, 5880.866614715022, 5353.817378393036, 5353.817378393036, 5199.363742989515, 5199.363742989515, 6249.522044155508, 6249.522044155508, 5262.7415139457935, 5262.7415139457935, 5370.772747900157, 5370.772747900157, 6537.395007039764, 6537.395007039764, 3935.1004283260727, 3935.1004283260727, 5884.150732972242, 5884.150732972242, 4808.140368793112, 4808.140368793112, 3764.111616645575, 3764.111616645575, 4860.478431597416, 4860.478431597416, 4875.7393109006325, 4875.7393109006325, 3235.6131662340104, 3235.6131662340104, 4974.967464952409, 4974.967464952409, 4422.516191915949, 4422.516191915949, 5767.384218838375, 5767.384218838375, 2711.26729507672, 2711.26729507672, 4536.545207370609, 4536.545207370609, 6803.513187137043, 6803.513187137043, 4528.642967949414, 4528.642967949414, 5832.200410774131, 5832.200410774131, 6093.509062414081, 6093.509062414081, 5465.108745117493, 5465.108745117493, 3760.9901919044405, 3760.9901919044405, 5335.041170757144, 5335.041170757144, 5500.239987754159, 5500.239987754159, 5572.968268583763, 5572.968268583763, 4552.644477649968, 4552.644477649968, 6448.389175401509, 6448.389175401509, 4262.543368474672, 4262.543368474672, 3732.1898250810855, 3732.1898250810855, 5915.301961236428, 5915.301961236428, 5347.409058114081, 5347.409058114081, 3666.5222499357815, 3666.5222499357815, 5190.1301777513345, 5190.1301777513345, 3277.8173290367477, 3277.8173290367477, 1300.0, 1300.0, 3358.559712727976, 3358.559712727976, 4245.484906263824, 4245.484906263824, 5346.528172708831, 5346.528172708831, 5346.320880920869, 5346.320880920869, 3325.895196487838, 3325.895196487838, 4366.14066370362, 4366.14066370362, 7537.347670875868, 7537.347670875868, 5931.737730220525, 5931.737730220525, 2875.9881184112455, 2875.9881184112455, 7343.452298778042, 7343.452298778042, 5767.265771574534, 5767.265771574534, 3763.131422421813, 3763.131422421813, 3366.9074065238783, 3366.9074065238783, 5635.28677056579, 5635.28677056579, 6650.9239806096175, 6650.9239806096175, 5340.140691427967, 5340.140691427967, 3707.5700504060114, 3707.5700504060114, 7876.843597921146, 7876.843597921146, 6472.306906377089, 6472.306906377089, 4179.179261860334, 4179.179261860334, 3788.3672571223087, 3788.3672571223087, 5991.373603093743, 5991.373603093743, 7034.4173097515195, 7034.4173097515195, 4735.0293539503655, 4735.0293539503655, 6212.0674660287805, 6212.0674660287805, 5025.256458546001, 5025.256458546001, 5563.097137645549, 5563.097137645549, 5946.71636160392, 5946.71636160392, 5718.695903464261, 5718.695903464261, 8039.43343781785, 8039.43343781785, 4367.368375753624, 4367.368375753624, 6896.9860410651345, 6896.9860410651345, 5524.009830899312, 5524.009830899312, 6359.901586436619, 6359.901586436619, 4969.753065225664, 4969.753065225664, 4412.75373683271, 4412.75373683271, 6587.096458246884, 6587.096458246884, 5715.896932368718, 5715.896932368718, 4008.8218650491253, 4008.8218650491253, 4359.634547632295, 4359.634547632295, 5517.551711554838, 5517.551711554838, 6154.683690076841, 6154.683690076841, 5526.994662085801, 5526.994662085801, 7971.1836048177975, 7971.1836048177975, 6823.12771692107, 6823.12771692107, 5093.111557764962, 5093.111557764962, 3607.4288590701926, 3607.4288590701926, 6458.850177133367, 6458.850177133367, 5215.593163403366, 5215.593163403366, 4129.740513251798, 4129.740513251798, 6355.938718213361, 6355.938718213361, 4421.855243929878, 4421.855243929878, 1700.0, 1700.0, 5335.247490032855, 5335.247490032855, 7385.085710195821, 7385.085710195821, 8040.19719384515, 8040.19719384515, 6850.9706330931585, 6850.9706330931585, 5738.8177131327175, 5738.8177131327175, 7830.017682875163, 7830.017682875163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2527423266047094, "mean_inference_ms": 1.21465487596309, "mean_action_processing_ms": 0.13575496139006202, "mean_env_wait_ms": 3.327936792470623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 1809.116, "sample_throughput": 1768.819, "load_time_ms": 0.136, "load_throughput": 23551101.597, "learn_time_ms": 64.036, "learn_throughput": 49972.086, "update_time_ms": 1.412}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5392867.5, "policy_entropy": 24367.857421875, "policy_loss": 1507304.75, "vf_loss": 44324404.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 160000, "num_steps_trained": 80000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 5, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-56-06", "timestamp": 1718794566, "time_this_iter_s": 10.847342729568481, "time_total_s": 46.40140700340271, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9a9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 46.40140700340271, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 58.806250000000006, "ram_util_percent": 33.50625}}
{"episode_reward_max": 16080.39438769031, "episode_reward_min": 2600.0, "episode_reward_mean": 10795.153351260613, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 8040.19719384515}, "policy_reward_mean": {"shared_policy": 5397.576675630304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5422.53459015344, 9073.09041474123, 13607.026374274072, 9057.285935898832, 11664.400821548272, 12187.01812482817, 10930.217490234987, 7521.980383808881, 10670.082341514295, 11000.47997550829, 11145.936537167523, 9105.288955299944, 12896.778350803019, 8525.08673694935, 7464.379650162171, 11830.603922472877, 10694.818116228162, 7333.044499871563, 10380.26035550269, 6555.634658073495, 2600.0, 6717.119425455952, 8490.969812527645, 10693.056345417666, 10692.64176184171, 6651.790392975676, 8732.281327407254, 15074.695341751754, 11863.475460441055, 5751.976236822491, 14686.90459755608, 11534.531543149078, 7526.262844843626, 6733.814813047757, 11270.573541131613, 13301.847961219239, 10680.281382855916, 7415.140100812023, 15753.687195842307, 12944.613812754149, 8358.358523720672, 7576.7345142446175, 11982.74720618749, 14068.834619503039, 9470.058707900724, 12424.134932057575, 10050.512917092, 11126.19427529109, 11893.432723207847, 11437.391806928528, 16078.866875635686, 8734.736751507258, 13793.972082130284, 11048.019661798611, 12719.803172873253, 9939.506130451307, 8825.507473665417, 13174.192916493757, 11431.793864737458, 8017.643730098251, 8719.269095264583, 11035.103423109682, 12309.367380153704, 11053.98932417163, 15942.367209635599, 13646.255433842169, 10186.22311552993, 7214.857718140385, 12917.700354266712, 10431.18632680675, 8259.481026503592, 12711.877436426705, 8843.710487859764, 3400.0, 10670.49498006576, 14770.171420391645, 16080.39438769031, 13701.941266186317, 11477.635426265417, 15660.035365750336, 12732.324904273235, 14826.622333780982, 13714.849852610714, 9809.584446758006, 11967.948814310352, 12199.714856306342, 11962.133466241234, 9307.124740660653, 11040.59833928039, 13647.310530029787, 10512.763514408914, 13832.738395248809, 10869.315687133254, 11706.026980222461, 8987.393853007332, 8301.228400336855, 15310.945799604502, 9834.012099775617, 13918.846965902216, 7667.734949689309], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2711.26729507672, 2711.26729507672, 4536.545207370609, 4536.545207370609, 6803.513187137043, 6803.513187137043, 4528.642967949414, 4528.642967949414, 5832.200410774131, 5832.200410774131, 6093.509062414081, 6093.509062414081, 5465.108745117493, 5465.108745117493, 3760.9901919044405, 3760.9901919044405, 5335.041170757144, 5335.041170757144, 5500.239987754159, 5500.239987754159, 5572.968268583763, 5572.968268583763, 4552.644477649968, 4552.644477649968, 6448.389175401509, 6448.389175401509, 4262.543368474672, 4262.543368474672, 3732.1898250810855, 3732.1898250810855, 5915.301961236428, 5915.301961236428, 5347.409058114081, 5347.409058114081, 3666.5222499357815, 3666.5222499357815, 5190.1301777513345, 5190.1301777513345, 3277.8173290367477, 3277.8173290367477, 1300.0, 1300.0, 3358.559712727976, 3358.559712727976, 4245.484906263824, 4245.484906263824, 5346.528172708831, 5346.528172708831, 5346.320880920869, 5346.320880920869, 3325.895196487838, 3325.895196487838, 4366.14066370362, 4366.14066370362, 7537.347670875868, 7537.347670875868, 5931.737730220525, 5931.737730220525, 2875.9881184112455, 2875.9881184112455, 7343.452298778042, 7343.452298778042, 5767.265771574534, 5767.265771574534, 3763.131422421813, 3763.131422421813, 3366.9074065238783, 3366.9074065238783, 5635.28677056579, 5635.28677056579, 6650.9239806096175, 6650.9239806096175, 5340.140691427967, 5340.140691427967, 3707.5700504060114, 3707.5700504060114, 7876.843597921146, 7876.843597921146, 6472.306906377089, 6472.306906377089, 4179.179261860334, 4179.179261860334, 3788.3672571223087, 3788.3672571223087, 5991.373603093743, 5991.373603093743, 7034.4173097515195, 7034.4173097515195, 4735.0293539503655, 4735.0293539503655, 6212.0674660287805, 6212.0674660287805, 5025.256458546001, 5025.256458546001, 5563.097137645549, 5563.097137645549, 5946.71636160392, 5946.71636160392, 5718.695903464261, 5718.695903464261, 8039.43343781785, 8039.43343781785, 4367.368375753624, 4367.368375753624, 6896.9860410651345, 6896.9860410651345, 5524.009830899312, 5524.009830899312, 6359.901586436619, 6359.901586436619, 4969.753065225664, 4969.753065225664, 4412.75373683271, 4412.75373683271, 6587.096458246884, 6587.096458246884, 5715.896932368718, 5715.896932368718, 4008.8218650491253, 4008.8218650491253, 4359.634547632295, 4359.634547632295, 5517.551711554838, 5517.551711554838, 6154.683690076841, 6154.683690076841, 5526.994662085801, 5526.994662085801, 7971.1836048177975, 7971.1836048177975, 6823.12771692107, 6823.12771692107, 5093.111557764962, 5093.111557764962, 3607.4288590701926, 3607.4288590701926, 6458.850177133367, 6458.850177133367, 5215.593163403366, 5215.593163403366, 4129.740513251798, 4129.740513251798, 6355.938718213361, 6355.938718213361, 4421.855243929878, 4421.855243929878, 1700.0, 1700.0, 5335.247490032855, 5335.247490032855, 7385.085710195821, 7385.085710195821, 8040.19719384515, 8040.19719384515, 6850.9706330931585, 6850.9706330931585, 5738.8177131327175, 5738.8177131327175, 7830.017682875163, 7830.017682875163, 6366.162452136621, 6366.162452136621, 7413.31116689048, 7413.31116689048, 6857.424926305364, 6857.424926305364, 4904.792223379017, 4904.792223379017, 5983.974407155165, 5983.974407155165, 6099.857428153169, 6099.857428153169, 5981.066733120612, 5981.066733120612, 4653.562370330311, 4653.562370330311, 5520.299169640191, 5520.299169640191, 6823.655265014879, 6823.655265014879, 5256.38175720445, 5256.38175720445, 6916.3691976244045, 6916.3691976244045, 5434.657843566621, 5434.657843566621, 5853.013490111244, 5853.013490111244, 4493.696926503668, 4493.696926503668, 4150.614200168429, 4150.614200168429, 7655.472899802249, 7655.472899802249, 4917.006049887794, 4917.006049887794, 6959.423482951119, 6959.423482951119, 3833.8674748446547, 3833.8674748446547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537362272001843, "mean_inference_ms": 1.2165549175313735, "mean_action_processing_ms": 0.13592026029275225, "mean_env_wait_ms": 3.3551208767214735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 99200, "timesteps_this_iter": 0, "agent_timesteps_total": 198400, "timers": {"sample_time_ms": 1838.219, "sample_throughput": 1740.816, "load_time_ms": 0.131, "load_throughput": 24341263.692, "learn_time_ms": 65.712, "learn_throughput": 48697.241, "update_time_ms": 1.448}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6404456.0, "policy_entropy": 24635.806640625, "policy_loss": 1733424.125, "vf_loss": 43694580.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 99200, "num_agent_steps_sampled": 198400, "num_steps_trained": 99200, "num_agent_steps_trained": 198400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 6, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-56-17", "timestamp": 1718794577, "time_this_iter_s": 11.066915035247803, "time_total_s": 57.46832203865051, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce869d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 57.46832203865051, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.175, "ram_util_percent": 33.45}}
{"episode_reward_max": 16990.53952782545, "episode_reward_min": 2600.0, "episode_reward_mean": 10801.022394094249, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 8495.269763912722}, "policy_reward_mean": {"shared_policy": 5400.511197047122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2600.0, 6717.119425455952, 8490.969812527645, 10693.056345417666, 10692.64176184171, 6651.790392975676, 8732.281327407254, 15074.695341751754, 11863.475460441055, 5751.976236822491, 14686.90459755608, 11534.531543149078, 7526.262844843626, 6733.814813047757, 11270.573541131613, 13301.847961219239, 10680.281382855916, 7415.140100812023, 15753.687195842307, 12944.613812754149, 8358.358523720672, 7576.7345142446175, 11982.74720618749, 14068.834619503039, 9470.058707900724, 12424.134932057575, 10050.512917092, 11126.19427529109, 11893.432723207847, 11437.391806928528, 16078.866875635686, 8734.736751507258, 13793.972082130284, 11048.019661798611, 12719.803172873253, 9939.506130451307, 8825.507473665417, 13174.192916493757, 11431.793864737458, 8017.643730098251, 8719.269095264583, 11035.103423109682, 12309.367380153704, 11053.98932417163, 15942.367209635599, 13646.255433842169, 10186.22311552993, 7214.857718140385, 12917.700354266712, 10431.18632680675, 8259.481026503592, 12711.877436426705, 8843.710487859764, 3400.0, 10670.49498006576, 14770.171420391645, 16080.39438769031, 13701.941266186317, 11477.635426265417, 15660.035365750336, 12732.324904273235, 14826.622333780982, 13714.849852610714, 9809.584446758006, 11967.948814310352, 12199.714856306342, 11962.133466241234, 9307.124740660653, 11040.59833928039, 13647.310530029787, 10512.763514408914, 13832.738395248809, 10869.315687133254, 11706.026980222461, 8987.393853007332, 8301.228400336855, 15310.945799604502, 9834.012099775617, 13918.846965902216, 7667.734949689309, 9864.779230099051, 6000.0, 13949.609625295558, 10423.356436996237, 12183.684488836137, 16990.53952782545, 9261.214311864365, 5600.0, 5800.0, 6941.959742037561, 11722.576808693208, 12289.730982050325, 13575.898768453844, 16722.20540701328, 10564.526493593057, 10742.435713416176, 5200.0, 6497.087878295119, 3800.0, 9523.247103935373], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [1300.0, 1300.0, 3358.559712727976, 3358.559712727976, 4245.484906263824, 4245.484906263824, 5346.528172708831, 5346.528172708831, 5346.320880920869, 5346.320880920869, 3325.895196487838, 3325.895196487838, 4366.14066370362, 4366.14066370362, 7537.347670875868, 7537.347670875868, 5931.737730220525, 5931.737730220525, 2875.9881184112455, 2875.9881184112455, 7343.452298778042, 7343.452298778042, 5767.265771574534, 5767.265771574534, 3763.131422421813, 3763.131422421813, 3366.9074065238783, 3366.9074065238783, 5635.28677056579, 5635.28677056579, 6650.9239806096175, 6650.9239806096175, 5340.140691427967, 5340.140691427967, 3707.5700504060114, 3707.5700504060114, 7876.843597921146, 7876.843597921146, 6472.306906377089, 6472.306906377089, 4179.179261860334, 4179.179261860334, 3788.3672571223087, 3788.3672571223087, 5991.373603093743, 5991.373603093743, 7034.4173097515195, 7034.4173097515195, 4735.0293539503655, 4735.0293539503655, 6212.0674660287805, 6212.0674660287805, 5025.256458546001, 5025.256458546001, 5563.097137645549, 5563.097137645549, 5946.71636160392, 5946.71636160392, 5718.695903464261, 5718.695903464261, 8039.43343781785, 8039.43343781785, 4367.368375753624, 4367.368375753624, 6896.9860410651345, 6896.9860410651345, 5524.009830899312, 5524.009830899312, 6359.901586436619, 6359.901586436619, 4969.753065225664, 4969.753065225664, 4412.75373683271, 4412.75373683271, 6587.096458246884, 6587.096458246884, 5715.896932368718, 5715.896932368718, 4008.8218650491253, 4008.8218650491253, 4359.634547632295, 4359.634547632295, 5517.551711554838, 5517.551711554838, 6154.683690076841, 6154.683690076841, 5526.994662085801, 5526.994662085801, 7971.1836048177975, 7971.1836048177975, 6823.12771692107, 6823.12771692107, 5093.111557764962, 5093.111557764962, 3607.4288590701926, 3607.4288590701926, 6458.850177133367, 6458.850177133367, 5215.593163403366, 5215.593163403366, 4129.740513251798, 4129.740513251798, 6355.938718213361, 6355.938718213361, 4421.855243929878, 4421.855243929878, 1700.0, 1700.0, 5335.247490032855, 5335.247490032855, 7385.085710195821, 7385.085710195821, 8040.19719384515, 8040.19719384515, 6850.9706330931585, 6850.9706330931585, 5738.8177131327175, 5738.8177131327175, 7830.017682875163, 7830.017682875163, 6366.162452136621, 6366.162452136621, 7413.31116689048, 7413.31116689048, 6857.424926305364, 6857.424926305364, 4904.792223379017, 4904.792223379017, 5983.974407155165, 5983.974407155165, 6099.857428153169, 6099.857428153169, 5981.066733120612, 5981.066733120612, 4653.562370330311, 4653.562370330311, 5520.299169640191, 5520.299169640191, 6823.655265014879, 6823.655265014879, 5256.38175720445, 5256.38175720445, 6916.3691976244045, 6916.3691976244045, 5434.657843566621, 5434.657843566621, 5853.013490111244, 5853.013490111244, 4493.696926503668, 4493.696926503668, 4150.614200168429, 4150.614200168429, 7655.472899802249, 7655.472899802249, 4917.006049887794, 4917.006049887794, 6959.423482951119, 6959.423482951119, 3833.8674748446547, 3833.8674748446547, 4932.389615049522, 4932.389615049522, 3000.0, 3000.0, 6974.80481264779, 6974.80481264779, 5211.678218498109, 5211.678218498109, 6091.842244418071, 6091.842244418071, 8495.269763912722, 8495.269763912722, 4630.607155932182, 4630.607155932182, 2800.0, 2800.0, 2900.0, 2900.0, 3470.9798710187806, 3470.9798710187806, 5861.288404346602, 5861.288404346602, 6144.865491025164, 6144.865491025164, 6787.949384226915, 6787.949384226915, 8361.102703506636, 8361.102703506636, 5282.2632467965195, 5282.2632467965195, 5371.217856708081, 5371.217856708081, 2600.0, 2600.0, 3248.5439391475575, 3248.5439391475575, 1900.0, 1900.0, 4761.623551967683, 4761.623551967683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25287902791613337, "mean_inference_ms": 1.2135417522970178, "mean_action_processing_ms": 0.1355284755901793, "mean_env_wait_ms": 3.35878634183989, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 118400, "timesteps_this_iter": 0, "agent_timesteps_total": 236800, "timers": {"sample_time_ms": 1869.266, "sample_throughput": 1711.902, "load_time_ms": 0.134, "load_throughput": 23954618.597, "learn_time_ms": 66.803, "learn_throughput": 47902.227, "update_time_ms": 1.442}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7424516.0, "policy_entropy": 26633.6953125, "policy_loss": 2028569.625, "vf_loss": 52716228.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 118400, "num_agent_steps_sampled": 236800, "num_steps_trained": 118400, "num_agent_steps_trained": 236800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 7, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-56-28", "timestamp": 1718794588, "time_this_iter_s": 11.276864051818848, "time_total_s": 68.74518609046936, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 68.74518609046936, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 58.9875, "ram_util_percent": 33.4375}}
{"episode_reward_max": 16990.53952782545, "episode_reward_min": 3400.0, "episode_reward_mean": 11334.04491640604, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1700.0}, "policy_reward_max": {"shared_policy": 8495.269763912722}, "policy_reward_mean": {"shared_policy": 5667.022458203018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16078.866875635686, 8734.736751507258, 13793.972082130284, 11048.019661798611, 12719.803172873253, 9939.506130451307, 8825.507473665417, 13174.192916493757, 11431.793864737458, 8017.643730098251, 8719.269095264583, 11035.103423109682, 12309.367380153704, 11053.98932417163, 15942.367209635599, 13646.255433842169, 10186.22311552993, 7214.857718140385, 12917.700354266712, 10431.18632680675, 8259.481026503592, 12711.877436426705, 8843.710487859764, 3400.0, 10670.49498006576, 14770.171420391645, 16080.39438769031, 13701.941266186317, 11477.635426265417, 15660.035365750336, 12732.324904273235, 14826.622333780982, 13714.849852610714, 9809.584446758006, 11967.948814310352, 12199.714856306342, 11962.133466241234, 9307.124740660653, 11040.59833928039, 13647.310530029787, 10512.763514408914, 13832.738395248809, 10869.315687133254, 11706.026980222461, 8987.393853007332, 8301.228400336855, 15310.945799604502, 9834.012099775617, 13918.846965902216, 7667.734949689309, 9864.779230099051, 6000.0, 13949.609625295558, 10423.356436996237, 12183.684488836137, 16990.53952782545, 9261.214311864365, 5600.0, 5800.0, 6941.959742037561, 11722.576808693208, 12289.730982050325, 13575.898768453844, 16722.20540701328, 10564.526493593057, 10742.435713416176, 5200.0, 6497.087878295119, 3800.0, 9523.247103935373, 15540.099818900966, 10451.310059602332, 13443.735524557185, 14010.12242286398, 14901.090215952387, 10197.23452645012, 16101.155181522288, 9097.302511377988, 12875.027161816604, 10905.407532521385, 10930.936505147125, 10348.248564284084, 12001.022974222622, 12511.465981528287, 11736.02459686841, 7543.809487734239, 4400.0, 12351.058499390889, 11687.565933711783, 11684.34481827336, 10758.740893491082, 11839.33635383473, 10665.117070465669, 14175.590946402088, 11450.286517076976, 14117.573430960369, 12699.756730491787, 13941.52482499549, 15851.408192276747, 12590.019078444951], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [8039.43343781785, 8039.43343781785, 4367.368375753624, 4367.368375753624, 6896.9860410651345, 6896.9860410651345, 5524.009830899312, 5524.009830899312, 6359.901586436619, 6359.901586436619, 4969.753065225664, 4969.753065225664, 4412.75373683271, 4412.75373683271, 6587.096458246884, 6587.096458246884, 5715.896932368718, 5715.896932368718, 4008.8218650491253, 4008.8218650491253, 4359.634547632295, 4359.634547632295, 5517.551711554838, 5517.551711554838, 6154.683690076841, 6154.683690076841, 5526.994662085801, 5526.994662085801, 7971.1836048177975, 7971.1836048177975, 6823.12771692107, 6823.12771692107, 5093.111557764962, 5093.111557764962, 3607.4288590701926, 3607.4288590701926, 6458.850177133367, 6458.850177133367, 5215.593163403366, 5215.593163403366, 4129.740513251798, 4129.740513251798, 6355.938718213361, 6355.938718213361, 4421.855243929878, 4421.855243929878, 1700.0, 1700.0, 5335.247490032855, 5335.247490032855, 7385.085710195821, 7385.085710195821, 8040.19719384515, 8040.19719384515, 6850.9706330931585, 6850.9706330931585, 5738.8177131327175, 5738.8177131327175, 7830.017682875163, 7830.017682875163, 6366.162452136621, 6366.162452136621, 7413.31116689048, 7413.31116689048, 6857.424926305364, 6857.424926305364, 4904.792223379017, 4904.792223379017, 5983.974407155165, 5983.974407155165, 6099.857428153169, 6099.857428153169, 5981.066733120612, 5981.066733120612, 4653.562370330311, 4653.562370330311, 5520.299169640191, 5520.299169640191, 6823.655265014879, 6823.655265014879, 5256.38175720445, 5256.38175720445, 6916.3691976244045, 6916.3691976244045, 5434.657843566621, 5434.657843566621, 5853.013490111244, 5853.013490111244, 4493.696926503668, 4493.696926503668, 4150.614200168429, 4150.614200168429, 7655.472899802249, 7655.472899802249, 4917.006049887794, 4917.006049887794, 6959.423482951119, 6959.423482951119, 3833.8674748446547, 3833.8674748446547, 4932.389615049522, 4932.389615049522, 3000.0, 3000.0, 6974.80481264779, 6974.80481264779, 5211.678218498109, 5211.678218498109, 6091.842244418071, 6091.842244418071, 8495.269763912722, 8495.269763912722, 4630.607155932182, 4630.607155932182, 2800.0, 2800.0, 2900.0, 2900.0, 3470.9798710187806, 3470.9798710187806, 5861.288404346602, 5861.288404346602, 6144.865491025164, 6144.865491025164, 6787.949384226915, 6787.949384226915, 8361.102703506636, 8361.102703506636, 5282.2632467965195, 5282.2632467965195, 5371.217856708081, 5371.217856708081, 2600.0, 2600.0, 3248.5439391475575, 3248.5439391475575, 1900.0, 1900.0, 4761.623551967683, 4761.623551967683, 7770.049909450481, 7770.049909450481, 5225.655029801166, 5225.655029801166, 6721.867762278591, 6721.867762278591, 7005.061211431988, 7005.061211431988, 7450.545107976204, 7450.545107976204, 5098.617263225037, 5098.617263225037, 8050.577590761148, 8050.577590761148, 4548.651255688994, 4548.651255688994, 6437.513580908304, 6437.513580908304, 5452.703766260705, 5452.703766260705, 5465.468252573583, 5465.468252573583, 5174.124282142046, 5174.124282142046, 6000.511487111295, 6000.511487111295, 6255.732990764151, 6255.732990764151, 5868.0122984342215, 5868.0122984342215, 3771.9047438671196, 3771.9047438671196, 2200.0, 2200.0, 6175.529249695441, 6175.529249695441, 5843.782966855894, 5843.782966855894, 5842.172409136681, 5842.172409136681, 5379.370446745539, 5379.370446745539, 5919.66817691739, 5919.66817691739, 5332.558535232836, 5332.558535232836, 7087.795473201044, 7087.795473201044, 5725.143258538497, 5725.143258538497, 7058.786715480193, 7058.786715480193, 6349.8783652458915, 6349.8783652458915, 6970.762412497728, 6970.762412497728, 7925.70409613837, 7925.70409613837, 6295.009539222461, 6295.009539222461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2526842411710439, "mean_inference_ms": 1.2099178938202748, "mean_action_processing_ms": 0.13511824916621368, "mean_env_wait_ms": 3.361960976779198, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 137600, "timesteps_this_iter": 0, "agent_timesteps_total": 275200, "timers": {"sample_time_ms": 1908.291, "sample_throughput": 1676.893, "load_time_ms": 0.139, "load_throughput": 23097182.585, "learn_time_ms": 65.617, "learn_throughput": 48767.964, "update_time_ms": 1.459}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7338674.5, "policy_entropy": 27584.478515625, "policy_loss": 1972872.0, "vf_loss": 54580324.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 137600, "num_agent_steps_sampled": 275200, "num_steps_trained": 137600, "num_agent_steps_trained": 275200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 170, "training_iteration": 8, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-56-40", "timestamp": 1718794600, "time_this_iter_s": 11.523060321807861, "time_total_s": 80.26824641227722, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 80.26824641227722, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.825, "ram_util_percent": 33.40625}}
{"episode_reward_max": 16990.53952782545, "episode_reward_min": 3400.0, "episode_reward_mean": 11263.403240194077, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1700.0}, "policy_reward_max": {"shared_policy": 8495.269763912722}, "policy_reward_mean": {"shared_policy": 5631.701620097039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8259.481026503592, 12711.877436426705, 8843.710487859764, 3400.0, 10670.49498006576, 14770.171420391645, 16080.39438769031, 13701.941266186317, 11477.635426265417, 15660.035365750336, 12732.324904273235, 14826.622333780982, 13714.849852610714, 9809.584446758006, 11967.948814310352, 12199.714856306342, 11962.133466241234, 9307.124740660653, 11040.59833928039, 13647.310530029787, 10512.763514408914, 13832.738395248809, 10869.315687133254, 11706.026980222461, 8987.393853007332, 8301.228400336855, 15310.945799604502, 9834.012099775617, 13918.846965902216, 7667.734949689309, 9864.779230099051, 6000.0, 13949.609625295558, 10423.356436996237, 12183.684488836137, 16990.53952782545, 9261.214311864365, 5600.0, 5800.0, 6941.959742037561, 11722.576808693208, 12289.730982050325, 13575.898768453844, 16722.20540701328, 10564.526493593057, 10742.435713416176, 5200.0, 6497.087878295119, 3800.0, 9523.247103935373, 15540.099818900966, 10451.310059602332, 13443.735524557185, 14010.12242286398, 14901.090215952387, 10197.23452645012, 16101.155181522288, 9097.302511377988, 12875.027161816604, 10905.407532521385, 10930.936505147125, 10348.248564284084, 12001.022974222622, 12511.465981528287, 11736.02459686841, 7543.809487734239, 4400.0, 12351.058499390889, 11687.565933711783, 11684.34481827336, 10758.740893491082, 11839.33635383473, 10665.117070465669, 14175.590946402088, 11450.286517076976, 14117.573430960369, 12699.756730491787, 13941.52482499549, 15851.408192276747, 12590.019078444951, 13180.415969120088, 9872.436819924369, 16331.16129456235, 11647.390681237775, 9882.713775111319, 12496.199153875481, 11634.971156284715, 10923.902350512788, 9074.238366010246, 10636.630370305473, 8784.969668561902, 4800.0, 13346.819498484143, 7090.331036868272, 10772.09022777775, 11704.323257739587, 10426.102119397194, 11906.63235060671, 12862.637596007866, 12782.228726728448], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4129.740513251798, 4129.740513251798, 6355.938718213361, 6355.938718213361, 4421.855243929878, 4421.855243929878, 1700.0, 1700.0, 5335.247490032855, 5335.247490032855, 7385.085710195821, 7385.085710195821, 8040.19719384515, 8040.19719384515, 6850.9706330931585, 6850.9706330931585, 5738.8177131327175, 5738.8177131327175, 7830.017682875163, 7830.017682875163, 6366.162452136621, 6366.162452136621, 7413.31116689048, 7413.31116689048, 6857.424926305364, 6857.424926305364, 4904.792223379017, 4904.792223379017, 5983.974407155165, 5983.974407155165, 6099.857428153169, 6099.857428153169, 5981.066733120612, 5981.066733120612, 4653.562370330311, 4653.562370330311, 5520.299169640191, 5520.299169640191, 6823.655265014879, 6823.655265014879, 5256.38175720445, 5256.38175720445, 6916.3691976244045, 6916.3691976244045, 5434.657843566621, 5434.657843566621, 5853.013490111244, 5853.013490111244, 4493.696926503668, 4493.696926503668, 4150.614200168429, 4150.614200168429, 7655.472899802249, 7655.472899802249, 4917.006049887794, 4917.006049887794, 6959.423482951119, 6959.423482951119, 3833.8674748446547, 3833.8674748446547, 4932.389615049522, 4932.389615049522, 3000.0, 3000.0, 6974.80481264779, 6974.80481264779, 5211.678218498109, 5211.678218498109, 6091.842244418071, 6091.842244418071, 8495.269763912722, 8495.269763912722, 4630.607155932182, 4630.607155932182, 2800.0, 2800.0, 2900.0, 2900.0, 3470.9798710187806, 3470.9798710187806, 5861.288404346602, 5861.288404346602, 6144.865491025164, 6144.865491025164, 6787.949384226915, 6787.949384226915, 8361.102703506636, 8361.102703506636, 5282.2632467965195, 5282.2632467965195, 5371.217856708081, 5371.217856708081, 2600.0, 2600.0, 3248.5439391475575, 3248.5439391475575, 1900.0, 1900.0, 4761.623551967683, 4761.623551967683, 7770.049909450481, 7770.049909450481, 5225.655029801166, 5225.655029801166, 6721.867762278591, 6721.867762278591, 7005.061211431988, 7005.061211431988, 7450.545107976204, 7450.545107976204, 5098.617263225037, 5098.617263225037, 8050.577590761148, 8050.577590761148, 4548.651255688994, 4548.651255688994, 6437.513580908304, 6437.513580908304, 5452.703766260705, 5452.703766260705, 5465.468252573583, 5465.468252573583, 5174.124282142046, 5174.124282142046, 6000.511487111295, 6000.511487111295, 6255.732990764151, 6255.732990764151, 5868.0122984342215, 5868.0122984342215, 3771.9047438671196, 3771.9047438671196, 2200.0, 2200.0, 6175.529249695441, 6175.529249695441, 5843.782966855894, 5843.782966855894, 5842.172409136681, 5842.172409136681, 5379.370446745539, 5379.370446745539, 5919.66817691739, 5919.66817691739, 5332.558535232836, 5332.558535232836, 7087.795473201044, 7087.795473201044, 5725.143258538497, 5725.143258538497, 7058.786715480193, 7058.786715480193, 6349.8783652458915, 6349.8783652458915, 6970.762412497728, 6970.762412497728, 7925.70409613837, 7925.70409613837, 6295.009539222461, 6295.009539222461, 6590.207984560044, 6590.207984560044, 4936.218409962181, 4936.218409962181, 8165.580647281178, 8165.580647281178, 5823.695340618911, 5823.695340618911, 4941.356887555667, 4941.356887555667, 6248.099576937753, 6248.099576937753, 5817.485578142363, 5817.485578142363, 5461.951175256394, 5461.951175256394, 4537.119183005119, 4537.119183005119, 5318.315185152741, 5318.315185152741, 4392.484834280952, 4392.484834280952, 2400.0, 2400.0, 6673.409749242079, 6673.409749242079, 3545.165518434136, 3545.165518434136, 5386.045113888846, 5386.045113888846, 5852.161628869801, 5852.161628869801, 5213.051059698591, 5213.051059698591, 5953.316175303358, 5953.316175303358, 6431.318798003947, 6431.318798003947, 6391.114363364233, 6391.114363364233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25277951925745873, "mean_inference_ms": 1.2101608149355432, "mean_action_processing_ms": 0.13514221117005107, "mean_env_wait_ms": 3.37129728391252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 156800, "timesteps_this_iter": 0, "agent_timesteps_total": 313600, "timers": {"sample_time_ms": 1910.606, "sample_throughput": 1674.861, "load_time_ms": 0.132, "load_throughput": 24222654.395, "learn_time_ms": 65.926, "learn_throughput": 48539.567, "update_time_ms": 1.39}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7483393.5, "policy_entropy": 28193.62890625, "policy_loss": 2088642.75, "vf_loss": 46603484.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156800, "num_agent_steps_sampled": 313600, "num_steps_trained": 156800, "num_agent_steps_trained": 313600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 190, "training_iteration": 9, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-56-51", "timestamp": 1718794611, "time_this_iter_s": 11.453023195266724, "time_total_s": 91.72126960754395, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce869d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 91.72126960754395, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 58.83529411764705, "ram_util_percent": 33.364705882352936}}
{"episode_reward_max": 16990.53952782545, "episode_reward_min": 3800.0, "episode_reward_mean": 10990.286853350091, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 8495.269763912722}, "policy_reward_mean": {"shared_policy": 5495.143426675047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9864.779230099051, 6000.0, 13949.609625295558, 10423.356436996237, 12183.684488836137, 16990.53952782545, 9261.214311864365, 5600.0, 5800.0, 6941.959742037561, 11722.576808693208, 12289.730982050325, 13575.898768453844, 16722.20540701328, 10564.526493593057, 10742.435713416176, 5200.0, 6497.087878295119, 3800.0, 9523.247103935373, 15540.099818900966, 10451.310059602332, 13443.735524557185, 14010.12242286398, 14901.090215952387, 10197.23452645012, 16101.155181522288, 9097.302511377988, 12875.027161816604, 10905.407532521385, 10930.936505147125, 10348.248564284084, 12001.022974222622, 12511.465981528287, 11736.02459686841, 7543.809487734239, 4400.0, 12351.058499390889, 11687.565933711783, 11684.34481827336, 10758.740893491082, 11839.33635383473, 10665.117070465669, 14175.590946402088, 11450.286517076976, 14117.573430960369, 12699.756730491787, 13941.52482499549, 15851.408192276747, 12590.019078444951, 13180.415969120088, 9872.436819924369, 16331.16129456235, 11647.390681237775, 9882.713775111319, 12496.199153875481, 11634.971156284715, 10923.902350512788, 9074.238366010246, 10636.630370305473, 8784.969668561902, 4800.0, 13346.819498484143, 7090.331036868272, 10772.09022777775, 11704.323257739587, 10426.102119397194, 11906.63235060671, 12862.637596007866, 12782.228726728448, 7534.483724903304, 15284.337837972533, 13225.961418828861, 10209.984196448368, 12638.455217654671, 6848.392928294108, 10537.85454569969, 9198.775064171288, 10675.830976247682, 15150.660606352816, 12301.101121660777, 13537.150150606445, 14504.223293462954, 15940.841345161505, 7042.81262775313, 11563.970341043321, 15043.930472503034, 13542.860028486131, 11407.88211426606, 7809.36029660143, 6400.0, 7628.372818678265, 7536.8672888934525, 7532.225917892149, 10749.80617587765, 7588.284587260801, 6568.878952271074, 14279.508906338891, 6249.875321497009, 11880.633765494695], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4932.389615049522, 4932.389615049522, 3000.0, 3000.0, 6974.80481264779, 6974.80481264779, 5211.678218498109, 5211.678218498109, 6091.842244418071, 6091.842244418071, 8495.269763912722, 8495.269763912722, 4630.607155932182, 4630.607155932182, 2800.0, 2800.0, 2900.0, 2900.0, 3470.9798710187806, 3470.9798710187806, 5861.288404346602, 5861.288404346602, 6144.865491025164, 6144.865491025164, 6787.949384226915, 6787.949384226915, 8361.102703506636, 8361.102703506636, 5282.2632467965195, 5282.2632467965195, 5371.217856708081, 5371.217856708081, 2600.0, 2600.0, 3248.5439391475575, 3248.5439391475575, 1900.0, 1900.0, 4761.623551967683, 4761.623551967683, 7770.049909450481, 7770.049909450481, 5225.655029801166, 5225.655029801166, 6721.867762278591, 6721.867762278591, 7005.061211431988, 7005.061211431988, 7450.545107976204, 7450.545107976204, 5098.617263225037, 5098.617263225037, 8050.577590761148, 8050.577590761148, 4548.651255688994, 4548.651255688994, 6437.513580908304, 6437.513580908304, 5452.703766260705, 5452.703766260705, 5465.468252573583, 5465.468252573583, 5174.124282142046, 5174.124282142046, 6000.511487111295, 6000.511487111295, 6255.732990764151, 6255.732990764151, 5868.0122984342215, 5868.0122984342215, 3771.9047438671196, 3771.9047438671196, 2200.0, 2200.0, 6175.529249695441, 6175.529249695441, 5843.782966855894, 5843.782966855894, 5842.172409136681, 5842.172409136681, 5379.370446745539, 5379.370446745539, 5919.66817691739, 5919.66817691739, 5332.558535232836, 5332.558535232836, 7087.795473201044, 7087.795473201044, 5725.143258538497, 5725.143258538497, 7058.786715480193, 7058.786715480193, 6349.8783652458915, 6349.8783652458915, 6970.762412497728, 6970.762412497728, 7925.70409613837, 7925.70409613837, 6295.009539222461, 6295.009539222461, 6590.207984560044, 6590.207984560044, 4936.218409962181, 4936.218409962181, 8165.580647281178, 8165.580647281178, 5823.695340618911, 5823.695340618911, 4941.356887555667, 4941.356887555667, 6248.099576937753, 6248.099576937753, 5817.485578142363, 5817.485578142363, 5461.951175256394, 5461.951175256394, 4537.119183005119, 4537.119183005119, 5318.315185152741, 5318.315185152741, 4392.484834280952, 4392.484834280952, 2400.0, 2400.0, 6673.409749242079, 6673.409749242079, 3545.165518434136, 3545.165518434136, 5386.045113888846, 5386.045113888846, 5852.161628869801, 5852.161628869801, 5213.051059698591, 5213.051059698591, 5953.316175303358, 5953.316175303358, 6431.318798003947, 6431.318798003947, 6391.114363364233, 6391.114363364233, 3767.241862451652, 3767.241862451652, 7642.168918986266, 7642.168918986266, 6612.980709414442, 6612.980709414442, 5104.992098224167, 5104.992098224167, 6319.227608827327, 6319.227608827327, 3424.196464147053, 3424.196464147053, 5268.927272849847, 5268.927272849847, 4599.38753208564, 4599.38753208564, 5337.915488123841, 5337.915488123841, 7575.330303176406, 7575.330303176406, 6150.550560830376, 6150.550560830376, 6768.5750753032335, 6768.5750753032335, 7252.111646731479, 7252.111646731479, 7970.420672580751, 7970.420672580751, 3521.406313876565, 3521.406313876565, 5781.985170521671, 5781.985170521671, 7521.96523625153, 7521.96523625153, 6771.430014243066, 6771.430014243066, 5703.941057133034, 5703.941057133034, 3904.680148300715, 3904.680148300715, 3200.0, 3200.0, 3814.1864093391323, 3814.1864093391323, 3768.4336444467262, 3768.4336444467262, 3766.1129589460743, 3766.1129589460743, 5374.903087938832, 5374.903087938832, 3794.1422936304007, 3794.1422936304007, 3284.439476135537, 3284.439476135537, 7139.7544531694475, 7139.7544531694475, 3124.9376607485046, 3124.9376607485046, 5940.316882747359, 5940.316882747359]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2542531892324773, "mean_inference_ms": 1.2144415234445103, "mean_action_processing_ms": 0.13568592025980586, "mean_env_wait_ms": 3.3895214752769154, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 176000, "timesteps_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"sample_time_ms": 1924.958, "sample_throughput": 1662.374, "load_time_ms": 0.136, "load_throughput": 23580064.652, "learn_time_ms": 66.386, "learn_throughput": 48203.292, "update_time_ms": 1.442}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4744876.0, "policy_entropy": 29394.4453125, "policy_loss": 1375303.5, "vf_loss": 32575044.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176000, "num_agent_steps_sampled": 352000, "num_steps_trained": 176000, "num_agent_steps_trained": 352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 10, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-57-03", "timestamp": 1718794623, "time_this_iter_s": 11.659276723861694, "time_total_s": 103.38054633140564, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce863a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 103.38054633140564, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 59.462500000000006, "ram_util_percent": 33.412499999999994}}
{"episode_reward_max": 18199.33403105878, "episode_reward_min": 4400.0, "episode_reward_mean": 11254.2677663907, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2200.0}, "policy_reward_max": {"shared_policy": 9099.66701552942}, "policy_reward_mean": {"shared_policy": 5627.133883195351}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15540.099818900966, 10451.310059602332, 13443.735524557185, 14010.12242286398, 14901.090215952387, 10197.23452645012, 16101.155181522288, 9097.302511377988, 12875.027161816604, 10905.407532521385, 10930.936505147125, 10348.248564284084, 12001.022974222622, 12511.465981528287, 11736.02459686841, 7543.809487734239, 4400.0, 12351.058499390889, 11687.565933711783, 11684.34481827336, 10758.740893491082, 11839.33635383473, 10665.117070465669, 14175.590946402088, 11450.286517076976, 14117.573430960369, 12699.756730491787, 13941.52482499549, 15851.408192276747, 12590.019078444951, 13180.415969120088, 9872.436819924369, 16331.16129456235, 11647.390681237775, 9882.713775111319, 12496.199153875481, 11634.971156284715, 10923.902350512788, 9074.238366010246, 10636.630370305473, 8784.969668561902, 4800.0, 13346.819498484143, 7090.331036868272, 10772.09022777775, 11704.323257739587, 10426.102119397194, 11906.63235060671, 12862.637596007866, 12782.228726728448, 7534.483724903304, 15284.337837972533, 13225.961418828861, 10209.984196448368, 12638.455217654671, 6848.392928294108, 10537.85454569969, 9198.775064171288, 10675.830976247682, 15150.660606352816, 12301.101121660777, 13537.150150606445, 14504.223293462954, 15940.841345161505, 7042.81262775313, 11563.970341043321, 15043.930472503034, 13542.860028486131, 11407.88211426606, 7809.36029660143, 6400.0, 7628.372818678265, 7536.8672888934525, 7532.225917892149, 10749.80617587765, 7588.284587260801, 6568.878952271074, 14279.508906338891, 6249.875321497009, 11880.633765494695, 10897.181448757481, 9995.658538382198, 12555.331947071696, 15874.284899405673, 9399.259849635811, 10414.09465261206, 7556.42711701372, 9131.56513660499, 11933.586001323201, 6602.8134446845925, 12987.001249837711, 5866.486319218573, 16253.291986225362, 12715.147851359201, 12173.55236449706, 6768.7584891341685, 13842.380620390344, 10007.056689030069, 10877.731186222674, 18199.33403105878], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7770.049909450481, 7770.049909450481, 5225.655029801166, 5225.655029801166, 6721.867762278591, 6721.867762278591, 7005.061211431988, 7005.061211431988, 7450.545107976204, 7450.545107976204, 5098.617263225037, 5098.617263225037, 8050.577590761148, 8050.577590761148, 4548.651255688994, 4548.651255688994, 6437.513580908304, 6437.513580908304, 5452.703766260705, 5452.703766260705, 5465.468252573583, 5465.468252573583, 5174.124282142046, 5174.124282142046, 6000.511487111295, 6000.511487111295, 6255.732990764151, 6255.732990764151, 5868.0122984342215, 5868.0122984342215, 3771.9047438671196, 3771.9047438671196, 2200.0, 2200.0, 6175.529249695441, 6175.529249695441, 5843.782966855894, 5843.782966855894, 5842.172409136681, 5842.172409136681, 5379.370446745539, 5379.370446745539, 5919.66817691739, 5919.66817691739, 5332.558535232836, 5332.558535232836, 7087.795473201044, 7087.795473201044, 5725.143258538497, 5725.143258538497, 7058.786715480193, 7058.786715480193, 6349.8783652458915, 6349.8783652458915, 6970.762412497728, 6970.762412497728, 7925.70409613837, 7925.70409613837, 6295.009539222461, 6295.009539222461, 6590.207984560044, 6590.207984560044, 4936.218409962181, 4936.218409962181, 8165.580647281178, 8165.580647281178, 5823.695340618911, 5823.695340618911, 4941.356887555667, 4941.356887555667, 6248.099576937753, 6248.099576937753, 5817.485578142363, 5817.485578142363, 5461.951175256394, 5461.951175256394, 4537.119183005119, 4537.119183005119, 5318.315185152741, 5318.315185152741, 4392.484834280952, 4392.484834280952, 2400.0, 2400.0, 6673.409749242079, 6673.409749242079, 3545.165518434136, 3545.165518434136, 5386.045113888846, 5386.045113888846, 5852.161628869801, 5852.161628869801, 5213.051059698591, 5213.051059698591, 5953.316175303358, 5953.316175303358, 6431.318798003947, 6431.318798003947, 6391.114363364233, 6391.114363364233, 3767.241862451652, 3767.241862451652, 7642.168918986266, 7642.168918986266, 6612.980709414442, 6612.980709414442, 5104.992098224167, 5104.992098224167, 6319.227608827327, 6319.227608827327, 3424.196464147053, 3424.196464147053, 5268.927272849847, 5268.927272849847, 4599.38753208564, 4599.38753208564, 5337.915488123841, 5337.915488123841, 7575.330303176406, 7575.330303176406, 6150.550560830376, 6150.550560830376, 6768.5750753032335, 6768.5750753032335, 7252.111646731479, 7252.111646731479, 7970.420672580751, 7970.420672580751, 3521.406313876565, 3521.406313876565, 5781.985170521671, 5781.985170521671, 7521.96523625153, 7521.96523625153, 6771.430014243066, 6771.430014243066, 5703.941057133034, 5703.941057133034, 3904.680148300715, 3904.680148300715, 3200.0, 3200.0, 3814.1864093391323, 3814.1864093391323, 3768.4336444467262, 3768.4336444467262, 3766.1129589460743, 3766.1129589460743, 5374.903087938832, 5374.903087938832, 3794.1422936304007, 3794.1422936304007, 3284.439476135537, 3284.439476135537, 7139.7544531694475, 7139.7544531694475, 3124.9376607485046, 3124.9376607485046, 5940.316882747359, 5940.316882747359, 5448.5907243787315, 5448.5907243787315, 4997.829269191093, 4997.829269191093, 6277.665973535837, 6277.665973535837, 7937.142449702827, 7937.142449702827, 4699.629924817897, 4699.629924817897, 5207.047326306045, 5207.047326306045, 3778.21355850686, 3778.21355850686, 4565.7825683024985, 4565.7825683024985, 5966.793000661593, 5966.793000661593, 3301.4067223422962, 3301.4067223422962, 6493.500624918859, 6493.500624918859, 2933.2431596092865, 2933.2431596092865, 8126.6459931126865, 8126.6459931126865, 6357.573925679608, 6357.573925679608, 6086.776182248523, 6086.776182248523, 3384.3792445670842, 3384.3792445670842, 6921.190310195181, 6921.190310195181, 5003.528344515027, 5003.528344515027, 5438.865593111333, 5438.865593111333, 9099.66701552942, 9099.66701552942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.254991078679011, "mean_inference_ms": 1.2166350290509562, "mean_action_processing_ms": 0.1359445200585768, "mean_env_wait_ms": 3.3992636863304426, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 195200, "timesteps_this_iter": 0, "agent_timesteps_total": 390400, "timers": {"sample_time_ms": 1895.294, "sample_throughput": 1688.393, "load_time_ms": 0.137, "load_throughput": 23435957.395, "learn_time_ms": 65.038, "learn_throughput": 49202.265, "update_time_ms": 1.397}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6833262.0, "policy_entropy": 29265.8359375, "policy_loss": 1975410.5, "vf_loss": 41270048.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 195200, "num_agent_steps_sampled": 390400, "num_steps_trained": 195200, "num_agent_steps_trained": 390400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 11, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-57-14", "timestamp": 1718794634, "time_this_iter_s": 11.119084358215332, "time_total_s": 114.49963068962097, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9a9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 114.49963068962097, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 58.0625, "ram_util_percent": 33.412499999999994}}
{"episode_reward_max": 18199.33403105878, "episode_reward_min": 3000.0, "episode_reward_mean": 10848.11133404295, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9099.66701552942}, "policy_reward_mean": {"shared_policy": 5424.055667021475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10758.740893491082, 11839.33635383473, 10665.117070465669, 14175.590946402088, 11450.286517076976, 14117.573430960369, 12699.756730491787, 13941.52482499549, 15851.408192276747, 12590.019078444951, 13180.415969120088, 9872.436819924369, 16331.16129456235, 11647.390681237775, 9882.713775111319, 12496.199153875481, 11634.971156284715, 10923.902350512788, 9074.238366010246, 10636.630370305473, 8784.969668561902, 4800.0, 13346.819498484143, 7090.331036868272, 10772.09022777775, 11704.323257739587, 10426.102119397194, 11906.63235060671, 12862.637596007866, 12782.228726728448, 7534.483724903304, 15284.337837972533, 13225.961418828861, 10209.984196448368, 12638.455217654671, 6848.392928294108, 10537.85454569969, 9198.775064171288, 10675.830976247682, 15150.660606352816, 12301.101121660777, 13537.150150606445, 14504.223293462954, 15940.841345161505, 7042.81262775313, 11563.970341043321, 15043.930472503034, 13542.860028486131, 11407.88211426606, 7809.36029660143, 6400.0, 7628.372818678265, 7536.8672888934525, 7532.225917892149, 10749.80617587765, 7588.284587260801, 6568.878952271074, 14279.508906338891, 6249.875321497009, 11880.633765494695, 10897.181448757481, 9995.658538382198, 12555.331947071696, 15874.284899405673, 9399.259849635811, 10414.09465261206, 7556.42711701372, 9131.56513660499, 11933.586001323201, 6602.8134446845925, 12987.001249837711, 5866.486319218573, 16253.291986225362, 12715.147851359201, 12173.55236449706, 6768.7584891341685, 13842.380620390344, 10007.056689030069, 10877.731186222674, 18199.33403105878, 9346.17355575343, 15358.68899563327, 9174.048234495465, 4800.0, 8976.320873801644, 8099.9806976695545, 8513.013960995497, 10278.681403830808, 5200.0, 13193.166240776744, 7496.50604720611, 3000.0, 11502.286975383104, 12985.369474612133, 15588.733366133802, 14373.397090948067, 9451.488122463987, 8139.084056595556, 6733.805176362754, 9890.574809289108], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5379.370446745539, 5379.370446745539, 5919.66817691739, 5919.66817691739, 5332.558535232836, 5332.558535232836, 7087.795473201044, 7087.795473201044, 5725.143258538497, 5725.143258538497, 7058.786715480193, 7058.786715480193, 6349.8783652458915, 6349.8783652458915, 6970.762412497728, 6970.762412497728, 7925.70409613837, 7925.70409613837, 6295.009539222461, 6295.009539222461, 6590.207984560044, 6590.207984560044, 4936.218409962181, 4936.218409962181, 8165.580647281178, 8165.580647281178, 5823.695340618911, 5823.695340618911, 4941.356887555667, 4941.356887555667, 6248.099576937753, 6248.099576937753, 5817.485578142363, 5817.485578142363, 5461.951175256394, 5461.951175256394, 4537.119183005119, 4537.119183005119, 5318.315185152741, 5318.315185152741, 4392.484834280952, 4392.484834280952, 2400.0, 2400.0, 6673.409749242079, 6673.409749242079, 3545.165518434136, 3545.165518434136, 5386.045113888846, 5386.045113888846, 5852.161628869801, 5852.161628869801, 5213.051059698591, 5213.051059698591, 5953.316175303358, 5953.316175303358, 6431.318798003947, 6431.318798003947, 6391.114363364233, 6391.114363364233, 3767.241862451652, 3767.241862451652, 7642.168918986266, 7642.168918986266, 6612.980709414442, 6612.980709414442, 5104.992098224167, 5104.992098224167, 6319.227608827327, 6319.227608827327, 3424.196464147053, 3424.196464147053, 5268.927272849847, 5268.927272849847, 4599.38753208564, 4599.38753208564, 5337.915488123841, 5337.915488123841, 7575.330303176406, 7575.330303176406, 6150.550560830376, 6150.550560830376, 6768.5750753032335, 6768.5750753032335, 7252.111646731479, 7252.111646731479, 7970.420672580751, 7970.420672580751, 3521.406313876565, 3521.406313876565, 5781.985170521671, 5781.985170521671, 7521.96523625153, 7521.96523625153, 6771.430014243066, 6771.430014243066, 5703.941057133034, 5703.941057133034, 3904.680148300715, 3904.680148300715, 3200.0, 3200.0, 3814.1864093391323, 3814.1864093391323, 3768.4336444467262, 3768.4336444467262, 3766.1129589460743, 3766.1129589460743, 5374.903087938832, 5374.903087938832, 3794.1422936304007, 3794.1422936304007, 3284.439476135537, 3284.439476135537, 7139.7544531694475, 7139.7544531694475, 3124.9376607485046, 3124.9376607485046, 5940.316882747359, 5940.316882747359, 5448.5907243787315, 5448.5907243787315, 4997.829269191093, 4997.829269191093, 6277.665973535837, 6277.665973535837, 7937.142449702827, 7937.142449702827, 4699.629924817897, 4699.629924817897, 5207.047326306045, 5207.047326306045, 3778.21355850686, 3778.21355850686, 4565.7825683024985, 4565.7825683024985, 5966.793000661593, 5966.793000661593, 3301.4067223422962, 3301.4067223422962, 6493.500624918859, 6493.500624918859, 2933.2431596092865, 2933.2431596092865, 8126.6459931126865, 8126.6459931126865, 6357.573925679608, 6357.573925679608, 6086.776182248523, 6086.776182248523, 3384.3792445670842, 3384.3792445670842, 6921.190310195181, 6921.190310195181, 5003.528344515027, 5003.528344515027, 5438.865593111333, 5438.865593111333, 9099.66701552942, 9099.66701552942, 4673.086777876721, 4673.086777876721, 7679.344497816641, 7679.344497816641, 4587.024117247731, 4587.024117247731, 2400.0, 2400.0, 4488.160436900824, 4488.160436900824, 4049.9903488347773, 4049.9903488347773, 4256.506980497746, 4256.506980497746, 5139.340701915412, 5139.340701915412, 2600.0, 2600.0, 6596.583120388361, 6596.583120388361, 3748.253023603055, 3748.253023603055, 1500.0, 1500.0, 5751.143487691563, 5751.143487691563, 6492.684737306052, 6492.684737306052, 7794.366683066892, 7794.366683066892, 7186.698545474028, 7186.698545474028, 4725.744061231992, 4725.744061231992, 4069.5420282977784, 4069.5420282977784, 3366.902588181377, 3366.902588181377, 4945.287404644554, 4945.287404644554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2549537296778125, "mean_inference_ms": 1.2170204700412355, "mean_action_processing_ms": 0.13592812553398173, "mean_env_wait_ms": 3.405841367018304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 214400, "timesteps_this_iter": 0, "agent_timesteps_total": 428800, "timers": {"sample_time_ms": 1867.405, "sample_throughput": 1713.608, "load_time_ms": 0.131, "load_throughput": 24443221.271, "learn_time_ms": 65.946, "learn_throughput": 48524.616, "update_time_ms": 1.418}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5185165.5, "policy_entropy": 30442.04296875, "policy_loss": 1530076.875, "vf_loss": 34511756.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 214400, "num_agent_steps_sampled": 428800, "num_steps_trained": 214400, "num_agent_steps_trained": 428800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 12, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-57-26", "timestamp": 1718794646, "time_this_iter_s": 11.28629183769226, "time_total_s": 125.78592252731323, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9a940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 125.78592252731323, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 57.543749999999996, "ram_util_percent": 33.30624999999999}}
{"episode_reward_max": 18199.33403105878, "episode_reward_min": 3000.0, "episode_reward_mean": 10255.426322141244, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9099.66701552942}, "policy_reward_mean": {"shared_policy": 5127.713161070622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7534.483724903304, 15284.337837972533, 13225.961418828861, 10209.984196448368, 12638.455217654671, 6848.392928294108, 10537.85454569969, 9198.775064171288, 10675.830976247682, 15150.660606352816, 12301.101121660777, 13537.150150606445, 14504.223293462954, 15940.841345161505, 7042.81262775313, 11563.970341043321, 15043.930472503034, 13542.860028486131, 11407.88211426606, 7809.36029660143, 6400.0, 7628.372818678265, 7536.8672888934525, 7532.225917892149, 10749.80617587765, 7588.284587260801, 6568.878952271074, 14279.508906338891, 6249.875321497009, 11880.633765494695, 10897.181448757481, 9995.658538382198, 12555.331947071696, 15874.284899405673, 9399.259849635811, 10414.09465261206, 7556.42711701372, 9131.56513660499, 11933.586001323201, 6602.8134446845925, 12987.001249837711, 5866.486319218573, 16253.291986225362, 12715.147851359201, 12173.55236449706, 6768.7584891341685, 13842.380620390344, 10007.056689030069, 10877.731186222674, 18199.33403105878, 9346.17355575343, 15358.68899563327, 9174.048234495465, 4800.0, 8976.320873801644, 8099.9806976695545, 8513.013960995497, 10278.681403830808, 5200.0, 13193.166240776744, 7496.50604720611, 3000.0, 11502.286975383104, 12985.369474612133, 15588.733366133802, 14373.397090948067, 9451.488122463987, 8139.084056595556, 6733.805176362754, 9890.574809289108, 7812.7630301457575, 15311.087519273427, 11827.496368657849, 10015.886315109838, 11164.056778650287, 8964.117241104312, 11006.32150984379, 9035.453201429496, 9143.253285577797, 10157.783769430793, 7330.332805707698, 8985.623071754588, 9448.0578677597, 11868.495582142172, 13300.480764902903, 12156.355703271929, 9515.041260361962, 10089.495837404473, 6521.506099897295, 4800.0, 10873.865036850315, 8147.300298606331, 5000.0, 10982.04693056038, 10728.492833236025, 11810.991415528399, 9622.50989834248, 7255.62626202799, 6132.92867895024, 9969.677900857598], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3767.241862451652, 3767.241862451652, 7642.168918986266, 7642.168918986266, 6612.980709414442, 6612.980709414442, 5104.992098224167, 5104.992098224167, 6319.227608827327, 6319.227608827327, 3424.196464147053, 3424.196464147053, 5268.927272849847, 5268.927272849847, 4599.38753208564, 4599.38753208564, 5337.915488123841, 5337.915488123841, 7575.330303176406, 7575.330303176406, 6150.550560830376, 6150.550560830376, 6768.5750753032335, 6768.5750753032335, 7252.111646731479, 7252.111646731479, 7970.420672580751, 7970.420672580751, 3521.406313876565, 3521.406313876565, 5781.985170521671, 5781.985170521671, 7521.96523625153, 7521.96523625153, 6771.430014243066, 6771.430014243066, 5703.941057133034, 5703.941057133034, 3904.680148300715, 3904.680148300715, 3200.0, 3200.0, 3814.1864093391323, 3814.1864093391323, 3768.4336444467262, 3768.4336444467262, 3766.1129589460743, 3766.1129589460743, 5374.903087938832, 5374.903087938832, 3794.1422936304007, 3794.1422936304007, 3284.439476135537, 3284.439476135537, 7139.7544531694475, 7139.7544531694475, 3124.9376607485046, 3124.9376607485046, 5940.316882747359, 5940.316882747359, 5448.5907243787315, 5448.5907243787315, 4997.829269191093, 4997.829269191093, 6277.665973535837, 6277.665973535837, 7937.142449702827, 7937.142449702827, 4699.629924817897, 4699.629924817897, 5207.047326306045, 5207.047326306045, 3778.21355850686, 3778.21355850686, 4565.7825683024985, 4565.7825683024985, 5966.793000661593, 5966.793000661593, 3301.4067223422962, 3301.4067223422962, 6493.500624918859, 6493.500624918859, 2933.2431596092865, 2933.2431596092865, 8126.6459931126865, 8126.6459931126865, 6357.573925679608, 6357.573925679608, 6086.776182248523, 6086.776182248523, 3384.3792445670842, 3384.3792445670842, 6921.190310195181, 6921.190310195181, 5003.528344515027, 5003.528344515027, 5438.865593111333, 5438.865593111333, 9099.66701552942, 9099.66701552942, 4673.086777876721, 4673.086777876721, 7679.344497816641, 7679.344497816641, 4587.024117247731, 4587.024117247731, 2400.0, 2400.0, 4488.160436900824, 4488.160436900824, 4049.9903488347773, 4049.9903488347773, 4256.506980497746, 4256.506980497746, 5139.340701915412, 5139.340701915412, 2600.0, 2600.0, 6596.583120388361, 6596.583120388361, 3748.253023603055, 3748.253023603055, 1500.0, 1500.0, 5751.143487691563, 5751.143487691563, 6492.684737306052, 6492.684737306052, 7794.366683066892, 7794.366683066892, 7186.698545474028, 7186.698545474028, 4725.744061231992, 4725.744061231992, 4069.5420282977784, 4069.5420282977784, 3366.902588181377, 3366.902588181377, 4945.287404644554, 4945.287404644554, 3906.3815150728788, 3906.3815150728788, 7655.543759636723, 7655.543759636723, 5913.74818432892, 5913.74818432892, 5007.943157554929, 5007.943157554929, 5582.028389325131, 5582.028389325131, 4482.058620552152, 4482.058620552152, 5503.160754921899, 5503.160754921899, 4517.726600714743, 4517.726600714743, 4571.626642788902, 4571.626642788902, 5078.8918847153855, 5078.8918847153855, 3665.166402853849, 3665.166402853849, 4492.811535877302, 4492.811535877302, 4724.028933879848, 4724.028933879848, 5934.24779107108, 5934.24779107108, 6650.240382451439, 6650.240382451439, 6078.1778516359755, 6078.1778516359755, 4757.520630180967, 4757.520630180967, 5044.747918702239, 5044.747918702239, 3260.7530499486475, 3260.7530499486475, 2400.0, 2400.0, 5436.932518425148, 5436.932518425148, 4073.650149303169, 4073.650149303169, 2500.0, 2500.0, 5491.023465280185, 5491.023465280185, 5364.246416617995, 5364.246416617995, 5905.495707764194, 5905.495707764194, 4811.254949171238, 4811.254949171238, 3627.813131013995, 3627.813131013995, 3066.46433947512, 3066.46433947512, 4984.838950428797, 4984.838950428797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2551373102978416, "mean_inference_ms": 1.218033681621361, "mean_action_processing_ms": 0.13607394378743107, "mean_env_wait_ms": 3.4089793396986714, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 233600, "timesteps_this_iter": 0, "agent_timesteps_total": 467200, "timers": {"sample_time_ms": 1868.199, "sample_throughput": 1712.879, "load_time_ms": 0.133, "load_throughput": 24144221.623, "learn_time_ms": 64.709, "learn_throughput": 49452.057, "update_time_ms": 1.404}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6153897.0, "policy_entropy": 30066.00390625, "policy_loss": 1805139.75, "vf_loss": 41214880.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 233600, "num_agent_steps_sampled": 467200, "num_steps_trained": 233600, "num_agent_steps_trained": 467200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 290, "training_iteration": 13, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-57-37", "timestamp": 1718794657, "time_this_iter_s": 11.135618686676025, "time_total_s": 136.92154121398926, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 136.92154121398926, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 57.7375, "ram_util_percent": 33.349999999999994}}
{"episode_reward_max": 18199.33403105878, "episode_reward_min": 3000.0, "episode_reward_mean": 10319.601255262476, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9099.66701552942}, "policy_reward_mean": {"shared_policy": 5159.800627631238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6400.0, 7628.372818678265, 7536.8672888934525, 7532.225917892149, 10749.80617587765, 7588.284587260801, 6568.878952271074, 14279.508906338891, 6249.875321497009, 11880.633765494695, 10897.181448757481, 9995.658538382198, 12555.331947071696, 15874.284899405673, 9399.259849635811, 10414.09465261206, 7556.42711701372, 9131.56513660499, 11933.586001323201, 6602.8134446845925, 12987.001249837711, 5866.486319218573, 16253.291986225362, 12715.147851359201, 12173.55236449706, 6768.7584891341685, 13842.380620390344, 10007.056689030069, 10877.731186222674, 18199.33403105878, 9346.17355575343, 15358.68899563327, 9174.048234495465, 4800.0, 8976.320873801644, 8099.9806976695545, 8513.013960995497, 10278.681403830808, 5200.0, 13193.166240776744, 7496.50604720611, 3000.0, 11502.286975383104, 12985.369474612133, 15588.733366133802, 14373.397090948067, 9451.488122463987, 8139.084056595556, 6733.805176362754, 9890.574809289108, 7812.7630301457575, 15311.087519273427, 11827.496368657849, 10015.886315109838, 11164.056778650287, 8964.117241104312, 11006.32150984379, 9035.453201429496, 9143.253285577797, 10157.783769430793, 7330.332805707698, 8985.623071754588, 9448.0578677597, 11868.495582142172, 13300.480764902903, 12156.355703271929, 9515.041260361962, 10089.495837404473, 6521.506099897295, 4800.0, 10873.865036850315, 8147.300298606331, 5000.0, 10982.04693056038, 10728.492833236025, 11810.991415528399, 9622.50989834248, 7255.62626202799, 6132.92867895024, 9969.677900857598, 10686.615514996298, 13337.977894774765, 9991.442257133862, 12819.781433262462, 14432.961985720052, 7862.575882676421, 7144.283498608482, 8494.487020344277, 11959.21967621901, 13396.759972278836, 14142.027770351408, 9116.270807102941, 8396.757014466064, 11477.001694060069, 15467.559267073368, 15029.898884240582, 12492.463112002482, 13596.500536488802, 14848.298321507998, 15723.479076933061], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3200.0, 3200.0, 3814.1864093391323, 3814.1864093391323, 3768.4336444467262, 3768.4336444467262, 3766.1129589460743, 3766.1129589460743, 5374.903087938832, 5374.903087938832, 3794.1422936304007, 3794.1422936304007, 3284.439476135537, 3284.439476135537, 7139.7544531694475, 7139.7544531694475, 3124.9376607485046, 3124.9376607485046, 5940.316882747359, 5940.316882747359, 5448.5907243787315, 5448.5907243787315, 4997.829269191093, 4997.829269191093, 6277.665973535837, 6277.665973535837, 7937.142449702827, 7937.142449702827, 4699.629924817897, 4699.629924817897, 5207.047326306045, 5207.047326306045, 3778.21355850686, 3778.21355850686, 4565.7825683024985, 4565.7825683024985, 5966.793000661593, 5966.793000661593, 3301.4067223422962, 3301.4067223422962, 6493.500624918859, 6493.500624918859, 2933.2431596092865, 2933.2431596092865, 8126.6459931126865, 8126.6459931126865, 6357.573925679608, 6357.573925679608, 6086.776182248523, 6086.776182248523, 3384.3792445670842, 3384.3792445670842, 6921.190310195181, 6921.190310195181, 5003.528344515027, 5003.528344515027, 5438.865593111333, 5438.865593111333, 9099.66701552942, 9099.66701552942, 4673.086777876721, 4673.086777876721, 7679.344497816641, 7679.344497816641, 4587.024117247731, 4587.024117247731, 2400.0, 2400.0, 4488.160436900824, 4488.160436900824, 4049.9903488347773, 4049.9903488347773, 4256.506980497746, 4256.506980497746, 5139.340701915412, 5139.340701915412, 2600.0, 2600.0, 6596.583120388361, 6596.583120388361, 3748.253023603055, 3748.253023603055, 1500.0, 1500.0, 5751.143487691563, 5751.143487691563, 6492.684737306052, 6492.684737306052, 7794.366683066892, 7794.366683066892, 7186.698545474028, 7186.698545474028, 4725.744061231992, 4725.744061231992, 4069.5420282977784, 4069.5420282977784, 3366.902588181377, 3366.902588181377, 4945.287404644554, 4945.287404644554, 3906.3815150728788, 3906.3815150728788, 7655.543759636723, 7655.543759636723, 5913.74818432892, 5913.74818432892, 5007.943157554929, 5007.943157554929, 5582.028389325131, 5582.028389325131, 4482.058620552152, 4482.058620552152, 5503.160754921899, 5503.160754921899, 4517.726600714743, 4517.726600714743, 4571.626642788902, 4571.626642788902, 5078.8918847153855, 5078.8918847153855, 3665.166402853849, 3665.166402853849, 4492.811535877302, 4492.811535877302, 4724.028933879848, 4724.028933879848, 5934.24779107108, 5934.24779107108, 6650.240382451439, 6650.240382451439, 6078.1778516359755, 6078.1778516359755, 4757.520630180967, 4757.520630180967, 5044.747918702239, 5044.747918702239, 3260.7530499486475, 3260.7530499486475, 2400.0, 2400.0, 5436.932518425148, 5436.932518425148, 4073.650149303169, 4073.650149303169, 2500.0, 2500.0, 5491.023465280185, 5491.023465280185, 5364.246416617995, 5364.246416617995, 5905.495707764194, 5905.495707764194, 4811.254949171238, 4811.254949171238, 3627.813131013995, 3627.813131013995, 3066.46433947512, 3066.46433947512, 4984.838950428797, 4984.838950428797, 5343.307757498153, 5343.307757498153, 6668.988947387381, 6668.988947387381, 4995.721128566916, 4995.721128566916, 6409.890716631227, 6409.890716631227, 7216.480992860035, 7216.480992860035, 3931.2879413382107, 3931.2879413382107, 3572.141749304241, 3572.141749304241, 4247.243510172135, 4247.243510172135, 5979.609838109518, 5979.609838109518, 6698.379986139422, 6698.379986139422, 7071.013885175706, 7071.013885175706, 4558.135403551485, 4558.135403551485, 4198.378507233025, 4198.378507233025, 5738.500847030048, 5738.500847030048, 7733.779633536693, 7733.779633536693, 7514.949442120294, 7514.949442120294, 6246.23155600125, 6246.23155600125, 6798.25026824441, 6798.25026824441, 7424.149160754005, 7424.149160754005, 7861.73953846654, 7861.73953846654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2545769933464832, "mean_inference_ms": 1.2160769281541028, "mean_action_processing_ms": 0.1357787440835864, "mean_env_wait_ms": 3.406672062961509, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 252800, "timesteps_this_iter": 0, "agent_timesteps_total": 505600, "timers": {"sample_time_ms": 1850.002, "sample_throughput": 1729.728, "load_time_ms": 0.134, "load_throughput": 23848210.377, "learn_time_ms": 63.963, "learn_throughput": 50028.693, "update_time_ms": 1.424}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8134527.5, "policy_entropy": 30471.142578125, "policy_loss": 2419080.75, "vf_loss": 55119900.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 252800, "num_agent_steps_sampled": 505600, "num_steps_trained": 252800, "num_agent_steps_trained": 505600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 310, "training_iteration": 14, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-57-48", "timestamp": 1718794668, "time_this_iter_s": 11.094294786453247, "time_total_s": 148.0158360004425, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 148.0158360004425, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 57.80625, "ram_util_percent": 33.4}}
{"episode_reward_max": 15723.479076933061, "episode_reward_min": 3000.0, "episode_reward_mean": 10494.454648307357, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 7861.73953846654}, "policy_reward_mean": {"shared_policy": 5247.227324153678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9346.17355575343, 15358.68899563327, 9174.048234495465, 4800.0, 8976.320873801644, 8099.9806976695545, 8513.013960995497, 10278.681403830808, 5200.0, 13193.166240776744, 7496.50604720611, 3000.0, 11502.286975383104, 12985.369474612133, 15588.733366133802, 14373.397090948067, 9451.488122463987, 8139.084056595556, 6733.805176362754, 9890.574809289108, 7812.7630301457575, 15311.087519273427, 11827.496368657849, 10015.886315109838, 11164.056778650287, 8964.117241104312, 11006.32150984379, 9035.453201429496, 9143.253285577797, 10157.783769430793, 7330.332805707698, 8985.623071754588, 9448.0578677597, 11868.495582142172, 13300.480764902903, 12156.355703271929, 9515.041260361962, 10089.495837404473, 6521.506099897295, 4800.0, 10873.865036850315, 8147.300298606331, 5000.0, 10982.04693056038, 10728.492833236025, 11810.991415528399, 9622.50989834248, 7255.62626202799, 6132.92867895024, 9969.677900857598, 10686.615514996298, 13337.977894774765, 9991.442257133862, 12819.781433262462, 14432.961985720052, 7862.575882676421, 7144.283498608482, 8494.487020344277, 11959.21967621901, 13396.759972278836, 14142.027770351408, 9116.270807102941, 8396.757014466064, 11477.001694060069, 15467.559267073368, 15029.898884240582, 12492.463112002482, 13596.500536488802, 14848.298321507998, 15723.479076933061, 14125.111151651694, 13868.648236888235, 10690.133712955223, 4600.0, 10448.797014842665, 13492.858729793043, 11396.010555979414, 10107.4979768854, 11415.489989211299, 11558.82044770255, 11523.935494693087, 11217.337358588251, 11762.261474854346, 13199.598475722672, 14287.890935242525, 12974.790858077828, 10760.650656881586, 10768.166724727711, 11337.400701317201, 12113.857392897728, 6379.765249830605, 13416.668923508223, 10246.471961890158, 8037.910240236399, 7252.579103403506, 12583.301039644746, 12749.449455718583, 10847.329155742773, 11388.003842269958, 3400.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4673.086777876721, 4673.086777876721, 7679.344497816641, 7679.344497816641, 4587.024117247731, 4587.024117247731, 2400.0, 2400.0, 4488.160436900824, 4488.160436900824, 4049.9903488347773, 4049.9903488347773, 4256.506980497746, 4256.506980497746, 5139.340701915412, 5139.340701915412, 2600.0, 2600.0, 6596.583120388361, 6596.583120388361, 3748.253023603055, 3748.253023603055, 1500.0, 1500.0, 5751.143487691563, 5751.143487691563, 6492.684737306052, 6492.684737306052, 7794.366683066892, 7794.366683066892, 7186.698545474028, 7186.698545474028, 4725.744061231992, 4725.744061231992, 4069.5420282977784, 4069.5420282977784, 3366.902588181377, 3366.902588181377, 4945.287404644554, 4945.287404644554, 3906.3815150728788, 3906.3815150728788, 7655.543759636723, 7655.543759636723, 5913.74818432892, 5913.74818432892, 5007.943157554929, 5007.943157554929, 5582.028389325131, 5582.028389325131, 4482.058620552152, 4482.058620552152, 5503.160754921899, 5503.160754921899, 4517.726600714743, 4517.726600714743, 4571.626642788902, 4571.626642788902, 5078.8918847153855, 5078.8918847153855, 3665.166402853849, 3665.166402853849, 4492.811535877302, 4492.811535877302, 4724.028933879848, 4724.028933879848, 5934.24779107108, 5934.24779107108, 6650.240382451439, 6650.240382451439, 6078.1778516359755, 6078.1778516359755, 4757.520630180967, 4757.520630180967, 5044.747918702239, 5044.747918702239, 3260.7530499486475, 3260.7530499486475, 2400.0, 2400.0, 5436.932518425148, 5436.932518425148, 4073.650149303169, 4073.650149303169, 2500.0, 2500.0, 5491.023465280185, 5491.023465280185, 5364.246416617995, 5364.246416617995, 5905.495707764194, 5905.495707764194, 4811.254949171238, 4811.254949171238, 3627.813131013995, 3627.813131013995, 3066.46433947512, 3066.46433947512, 4984.838950428797, 4984.838950428797, 5343.307757498153, 5343.307757498153, 6668.988947387381, 6668.988947387381, 4995.721128566916, 4995.721128566916, 6409.890716631227, 6409.890716631227, 7216.480992860035, 7216.480992860035, 3931.2879413382107, 3931.2879413382107, 3572.141749304241, 3572.141749304241, 4247.243510172135, 4247.243510172135, 5979.609838109518, 5979.609838109518, 6698.379986139422, 6698.379986139422, 7071.013885175706, 7071.013885175706, 4558.135403551485, 4558.135403551485, 4198.378507233025, 4198.378507233025, 5738.500847030048, 5738.500847030048, 7733.779633536693, 7733.779633536693, 7514.949442120294, 7514.949442120294, 6246.23155600125, 6246.23155600125, 6798.25026824441, 6798.25026824441, 7424.149160754005, 7424.149160754005, 7861.73953846654, 7861.73953846654, 7062.5555758258415, 7062.5555758258415, 6934.32411844413, 6934.32411844413, 5345.066856477613, 5345.066856477613, 2300.0, 2300.0, 5224.398507421336, 5224.398507421336, 6746.429364896518, 6746.429364896518, 5698.005277989707, 5698.005277989707, 5053.748988442694, 5053.748988442694, 5707.744994605648, 5707.744994605648, 5779.410223851265, 5779.410223851265, 5761.967747346542, 5761.967747346542, 5608.66867929412, 5608.66867929412, 5881.130737427171, 5881.130737427171, 6599.799237861336, 6599.799237861336, 7143.945467621266, 7143.945467621266, 6487.395429038917, 6487.395429038917, 5380.325328440797, 5380.325328440797, 5384.0833623638555, 5384.0833623638555, 5668.700350658599, 5668.700350658599, 6056.92869644887, 6056.92869644887, 3189.8826249153026, 3189.8826249153026, 6708.33446175411, 6708.33446175411, 5123.235980945068, 5123.235980945068, 4018.9551201181994, 4018.9551201181994, 3626.289551701753, 3626.289551701753, 6291.650519822371, 6291.650519822371, 6374.724727859299, 6374.724727859299, 5423.664577871377, 5423.664577871377, 5694.001921134987, 5694.001921134987, 1700.0, 1700.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2542886792847168, "mean_inference_ms": 1.2148557784121485, "mean_action_processing_ms": 0.13566064555045984, "mean_env_wait_ms": 3.401544963211172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 272000, "timesteps_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"sample_time_ms": 1862.616, "sample_throughput": 1718.014, "load_time_ms": 0.132, "load_throughput": 24231400.614, "learn_time_ms": 65.44, "learn_throughput": 48899.961, "update_time_ms": 1.542}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4431144.0, "policy_entropy": 31812.875, "policy_loss": 1383980.125, "vf_loss": 28614674.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 272000, "num_agent_steps_sampled": 544000, "num_steps_trained": 272000, "num_agent_steps_trained": 544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 15, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-57-59", "timestamp": 1718794679, "time_this_iter_s": 11.20563006401062, "time_total_s": 159.22146606445312, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf430d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 159.22146606445312, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 57.787499999999994, "ram_util_percent": 33.30624999999999}}
{"episode_reward_max": 20579.12321634862, "episode_reward_min": 3400.0, "episode_reward_mean": 11023.396429846112, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1700.0}, "policy_reward_max": {"shared_policy": 10289.561608174332}, "policy_reward_mean": {"shared_policy": 5511.698214923057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7812.7630301457575, 15311.087519273427, 11827.496368657849, 10015.886315109838, 11164.056778650287, 8964.117241104312, 11006.32150984379, 9035.453201429496, 9143.253285577797, 10157.783769430793, 7330.332805707698, 8985.623071754588, 9448.0578677597, 11868.495582142172, 13300.480764902903, 12156.355703271929, 9515.041260361962, 10089.495837404473, 6521.506099897295, 4800.0, 10873.865036850315, 8147.300298606331, 5000.0, 10982.04693056038, 10728.492833236025, 11810.991415528399, 9622.50989834248, 7255.62626202799, 6132.92867895024, 9969.677900857598, 10686.615514996298, 13337.977894774765, 9991.442257133862, 12819.781433262462, 14432.961985720052, 7862.575882676421, 7144.283498608482, 8494.487020344277, 11959.21967621901, 13396.759972278836, 14142.027770351408, 9116.270807102941, 8396.757014466064, 11477.001694060069, 15467.559267073368, 15029.898884240582, 12492.463112002482, 13596.500536488802, 14848.298321507998, 15723.479076933061, 14125.111151651694, 13868.648236888235, 10690.133712955223, 4600.0, 10448.797014842665, 13492.858729793043, 11396.010555979414, 10107.4979768854, 11415.489989211299, 11558.82044770255, 11523.935494693087, 11217.337358588251, 11762.261474854346, 13199.598475722672, 14287.890935242525, 12974.790858077828, 10760.650656881586, 10768.166724727711, 11337.400701317201, 12113.857392897728, 6379.765249830605, 13416.668923508223, 10246.471961890158, 8037.910240236399, 7252.579103403506, 12583.301039644746, 12749.449455718583, 10847.329155742773, 11388.003842269958, 3400.0, 8658.838750235758, 20579.12321634862, 12982.482188907627, 8779.45225090166, 11847.38554373696, 9456.419451984646, 13002.169374890327, 9032.84853517923, 11428.817403632129, 9883.009990476698, 12551.841927170724, 11642.03022102937, 13274.92306241463, 15851.178688488482, 16816.000884504152, 14577.65465578852, 13584.970823179508, 15941.093371656592, 3400.0, 11705.256895301365], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3906.3815150728788, 3906.3815150728788, 7655.543759636723, 7655.543759636723, 5913.74818432892, 5913.74818432892, 5007.943157554929, 5007.943157554929, 5582.028389325131, 5582.028389325131, 4482.058620552152, 4482.058620552152, 5503.160754921899, 5503.160754921899, 4517.726600714743, 4517.726600714743, 4571.626642788902, 4571.626642788902, 5078.8918847153855, 5078.8918847153855, 3665.166402853849, 3665.166402853849, 4492.811535877302, 4492.811535877302, 4724.028933879848, 4724.028933879848, 5934.24779107108, 5934.24779107108, 6650.240382451439, 6650.240382451439, 6078.1778516359755, 6078.1778516359755, 4757.520630180967, 4757.520630180967, 5044.747918702239, 5044.747918702239, 3260.7530499486475, 3260.7530499486475, 2400.0, 2400.0, 5436.932518425148, 5436.932518425148, 4073.650149303169, 4073.650149303169, 2500.0, 2500.0, 5491.023465280185, 5491.023465280185, 5364.246416617995, 5364.246416617995, 5905.495707764194, 5905.495707764194, 4811.254949171238, 4811.254949171238, 3627.813131013995, 3627.813131013995, 3066.46433947512, 3066.46433947512, 4984.838950428797, 4984.838950428797, 5343.307757498153, 5343.307757498153, 6668.988947387381, 6668.988947387381, 4995.721128566916, 4995.721128566916, 6409.890716631227, 6409.890716631227, 7216.480992860035, 7216.480992860035, 3931.2879413382107, 3931.2879413382107, 3572.141749304241, 3572.141749304241, 4247.243510172135, 4247.243510172135, 5979.609838109518, 5979.609838109518, 6698.379986139422, 6698.379986139422, 7071.013885175706, 7071.013885175706, 4558.135403551485, 4558.135403551485, 4198.378507233025, 4198.378507233025, 5738.500847030048, 5738.500847030048, 7733.779633536693, 7733.779633536693, 7514.949442120294, 7514.949442120294, 6246.23155600125, 6246.23155600125, 6798.25026824441, 6798.25026824441, 7424.149160754005, 7424.149160754005, 7861.73953846654, 7861.73953846654, 7062.5555758258415, 7062.5555758258415, 6934.32411844413, 6934.32411844413, 5345.066856477613, 5345.066856477613, 2300.0, 2300.0, 5224.398507421336, 5224.398507421336, 6746.429364896518, 6746.429364896518, 5698.005277989707, 5698.005277989707, 5053.748988442694, 5053.748988442694, 5707.744994605648, 5707.744994605648, 5779.410223851265, 5779.410223851265, 5761.967747346542, 5761.967747346542, 5608.66867929412, 5608.66867929412, 5881.130737427171, 5881.130737427171, 6599.799237861336, 6599.799237861336, 7143.945467621266, 7143.945467621266, 6487.395429038917, 6487.395429038917, 5380.325328440797, 5380.325328440797, 5384.0833623638555, 5384.0833623638555, 5668.700350658599, 5668.700350658599, 6056.92869644887, 6056.92869644887, 3189.8826249153026, 3189.8826249153026, 6708.33446175411, 6708.33446175411, 5123.235980945068, 5123.235980945068, 4018.9551201181994, 4018.9551201181994, 3626.289551701753, 3626.289551701753, 6291.650519822371, 6291.650519822371, 6374.724727859299, 6374.724727859299, 5423.664577871377, 5423.664577871377, 5694.001921134987, 5694.001921134987, 1700.0, 1700.0, 4329.419375117876, 4329.419375117876, 10289.561608174332, 10289.561608174332, 6491.241094453799, 6491.241094453799, 4389.726125450833, 4389.726125450833, 5923.692771868486, 5923.692771868486, 4728.209725992338, 4728.209725992338, 6501.08468744516, 6501.08468744516, 4516.424267589615, 4516.424267589615, 5714.408701816055, 5714.408701816055, 4941.504995238339, 4941.504995238339, 6275.920963585364, 6275.920963585364, 5821.015110514687, 5821.015110514687, 6637.461531207309, 6637.461531207309, 7925.589344244239, 7925.589344244239, 8408.000442252072, 8408.000442252072, 7288.82732789426, 7288.82732789426, 6792.485411589745, 6792.485411589745, 7970.546685828296, 7970.546685828296, 1700.0, 1700.0, 5852.628447650691, 5852.628447650691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25408370478088704, "mean_inference_ms": 1.2136700696481235, "mean_action_processing_ms": 0.13552191734196595, "mean_env_wait_ms": 3.3986734363887696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 291200, "timesteps_this_iter": 0, "agent_timesteps_total": 582400, "timers": {"sample_time_ms": 1866.338, "sample_throughput": 1714.587, "load_time_ms": 0.131, "load_throughput": 24514653.516, "learn_time_ms": 65.149, "learn_throughput": 49117.926, "update_time_ms": 1.52}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7881964.0, "policy_entropy": 31240.333984375, "policy_loss": 2418804.5, "vf_loss": 46664340.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 291200, "num_agent_steps_sampled": 582400, "num_steps_trained": 291200, "num_agent_steps_trained": 582400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 16, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-58-10", "timestamp": 1718794690, "time_this_iter_s": 11.14834451675415, "time_total_s": 170.36981058120728, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9aca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 170.36981058120728, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.3875, "ram_util_percent": 33.2625}}
{"episode_reward_max": 20579.12321634862, "episode_reward_min": 3400.0, "episode_reward_mean": 11390.427120154225, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1700.0}, "policy_reward_max": {"shared_policy": 10289.561608174332}, "policy_reward_mean": {"shared_policy": 5695.213560077113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10873.865036850315, 8147.300298606331, 5000.0, 10982.04693056038, 10728.492833236025, 11810.991415528399, 9622.50989834248, 7255.62626202799, 6132.92867895024, 9969.677900857598, 10686.615514996298, 13337.977894774765, 9991.442257133862, 12819.781433262462, 14432.961985720052, 7862.575882676421, 7144.283498608482, 8494.487020344277, 11959.21967621901, 13396.759972278836, 14142.027770351408, 9116.270807102941, 8396.757014466064, 11477.001694060069, 15467.559267073368, 15029.898884240582, 12492.463112002482, 13596.500536488802, 14848.298321507998, 15723.479076933061, 14125.111151651694, 13868.648236888235, 10690.133712955223, 4600.0, 10448.797014842665, 13492.858729793043, 11396.010555979414, 10107.4979768854, 11415.489989211299, 11558.82044770255, 11523.935494693087, 11217.337358588251, 11762.261474854346, 13199.598475722672, 14287.890935242525, 12974.790858077828, 10760.650656881586, 10768.166724727711, 11337.400701317201, 12113.857392897728, 6379.765249830605, 13416.668923508223, 10246.471961890158, 8037.910240236399, 7252.579103403506, 12583.301039644746, 12749.449455718583, 10847.329155742773, 11388.003842269958, 3400.0, 8658.838750235758, 20579.12321634862, 12982.482188907627, 8779.45225090166, 11847.38554373696, 9456.419451984646, 13002.169374890327, 9032.84853517923, 11428.817403632129, 9883.009990476698, 12551.841927170724, 11642.03022102937, 13274.92306241463, 15851.178688488482, 16816.000884504152, 14577.65465578852, 13584.970823179508, 15941.093371656592, 3400.0, 11705.256895301365, 11167.293477801268, 8002.725085387185, 14721.922622022634, 14681.984432888225, 13020.30015254164, 10524.070977085044, 6956.63375356184, 16322.259610500052, 15347.038677916506, 11990.862311898669, 5400.0, 12033.888591030336, 9633.630889426331, 9182.284616803161, 11690.35144197669, 13258.062967783677, 10717.030780703983, 12484.102884268235, 12419.936437870132, 15602.297331771577], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5436.932518425148, 5436.932518425148, 4073.650149303169, 4073.650149303169, 2500.0, 2500.0, 5491.023465280185, 5491.023465280185, 5364.246416617995, 5364.246416617995, 5905.495707764194, 5905.495707764194, 4811.254949171238, 4811.254949171238, 3627.813131013995, 3627.813131013995, 3066.46433947512, 3066.46433947512, 4984.838950428797, 4984.838950428797, 5343.307757498153, 5343.307757498153, 6668.988947387381, 6668.988947387381, 4995.721128566916, 4995.721128566916, 6409.890716631227, 6409.890716631227, 7216.480992860035, 7216.480992860035, 3931.2879413382107, 3931.2879413382107, 3572.141749304241, 3572.141749304241, 4247.243510172135, 4247.243510172135, 5979.609838109518, 5979.609838109518, 6698.379986139422, 6698.379986139422, 7071.013885175706, 7071.013885175706, 4558.135403551485, 4558.135403551485, 4198.378507233025, 4198.378507233025, 5738.500847030048, 5738.500847030048, 7733.779633536693, 7733.779633536693, 7514.949442120294, 7514.949442120294, 6246.23155600125, 6246.23155600125, 6798.25026824441, 6798.25026824441, 7424.149160754005, 7424.149160754005, 7861.73953846654, 7861.73953846654, 7062.5555758258415, 7062.5555758258415, 6934.32411844413, 6934.32411844413, 5345.066856477613, 5345.066856477613, 2300.0, 2300.0, 5224.398507421336, 5224.398507421336, 6746.429364896518, 6746.429364896518, 5698.005277989707, 5698.005277989707, 5053.748988442694, 5053.748988442694, 5707.744994605648, 5707.744994605648, 5779.410223851265, 5779.410223851265, 5761.967747346542, 5761.967747346542, 5608.66867929412, 5608.66867929412, 5881.130737427171, 5881.130737427171, 6599.799237861336, 6599.799237861336, 7143.945467621266, 7143.945467621266, 6487.395429038917, 6487.395429038917, 5380.325328440797, 5380.325328440797, 5384.0833623638555, 5384.0833623638555, 5668.700350658599, 5668.700350658599, 6056.92869644887, 6056.92869644887, 3189.8826249153026, 3189.8826249153026, 6708.33446175411, 6708.33446175411, 5123.235980945068, 5123.235980945068, 4018.9551201181994, 4018.9551201181994, 3626.289551701753, 3626.289551701753, 6291.650519822371, 6291.650519822371, 6374.724727859299, 6374.724727859299, 5423.664577871377, 5423.664577871377, 5694.001921134987, 5694.001921134987, 1700.0, 1700.0, 4329.419375117876, 4329.419375117876, 10289.561608174332, 10289.561608174332, 6491.241094453799, 6491.241094453799, 4389.726125450833, 4389.726125450833, 5923.692771868486, 5923.692771868486, 4728.209725992338, 4728.209725992338, 6501.08468744516, 6501.08468744516, 4516.424267589615, 4516.424267589615, 5714.408701816055, 5714.408701816055, 4941.504995238339, 4941.504995238339, 6275.920963585364, 6275.920963585364, 5821.015110514687, 5821.015110514687, 6637.461531207309, 6637.461531207309, 7925.589344244239, 7925.589344244239, 8408.000442252072, 8408.000442252072, 7288.82732789426, 7288.82732789426, 6792.485411589745, 6792.485411589745, 7970.546685828296, 7970.546685828296, 1700.0, 1700.0, 5852.628447650691, 5852.628447650691, 5583.646738900621, 5583.646738900621, 4001.3625426935923, 4001.3625426935923, 7360.961311011295, 7360.961311011295, 7340.992216444094, 7340.992216444094, 6510.150076270809, 6510.150076270809, 5262.035488542518, 5262.035488542518, 3478.31687678092, 3478.31687678092, 8161.129805250017, 8161.129805250017, 7673.519338958249, 7673.519338958249, 5995.431155949333, 5995.431155949333, 2700.0, 2700.0, 6016.944295515184, 6016.944295515184, 4816.815444713174, 4816.815444713174, 4591.142308401601, 4591.142308401601, 5845.175720988346, 5845.175720988346, 6629.031483891826, 6629.031483891826, 5358.515390351996, 5358.515390351996, 6242.051442134123, 6242.051442134123, 6209.968218935068, 6209.968218935068, 7801.148665885796, 7801.148665885796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537897654815058, "mean_inference_ms": 1.2121513122746927, "mean_action_processing_ms": 0.13530123784867074, "mean_env_wait_ms": 3.397180229429929, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 310400, "timesteps_this_iter": 0, "agent_timesteps_total": 620800, "timers": {"sample_time_ms": 1869.425, "sample_throughput": 1711.756, "load_time_ms": 0.135, "load_throughput": 23725955.1, "learn_time_ms": 65.354, "learn_throughput": 48964.254, "update_time_ms": 1.526}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8759469.0, "policy_entropy": 33234.078125, "policy_loss": 2879910.25, "vf_loss": 61396284.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 310400, "num_agent_steps_sampled": 620800, "num_steps_trained": 310400, "num_agent_steps_trained": 620800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 17, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-58-22", "timestamp": 1718794702, "time_this_iter_s": 11.372691869735718, "time_total_s": 181.742502450943, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 181.742502450943, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 57.33125, "ram_util_percent": 33.21875}}
{"episode_reward_max": 20579.12321634862, "episode_reward_min": 3400.0, "episode_reward_mean": 12041.953939842679, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1700.0}, "policy_reward_max": {"shared_policy": 10289.561608174332}, "policy_reward_mean": {"shared_policy": 6020.9769699213375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14125.111151651694, 13868.648236888235, 10690.133712955223, 4600.0, 10448.797014842665, 13492.858729793043, 11396.010555979414, 10107.4979768854, 11415.489989211299, 11558.82044770255, 11523.935494693087, 11217.337358588251, 11762.261474854346, 13199.598475722672, 14287.890935242525, 12974.790858077828, 10760.650656881586, 10768.166724727711, 11337.400701317201, 12113.857392897728, 6379.765249830605, 13416.668923508223, 10246.471961890158, 8037.910240236399, 7252.579103403506, 12583.301039644746, 12749.449455718583, 10847.329155742773, 11388.003842269958, 3400.0, 8658.838750235758, 20579.12321634862, 12982.482188907627, 8779.45225090166, 11847.38554373696, 9456.419451984646, 13002.169374890327, 9032.84853517923, 11428.817403632129, 9883.009990476698, 12551.841927170724, 11642.03022102937, 13274.92306241463, 15851.178688488482, 16816.000884504152, 14577.65465578852, 13584.970823179508, 15941.093371656592, 3400.0, 11705.256895301365, 11167.293477801268, 8002.725085387185, 14721.922622022634, 14681.984432888225, 13020.30015254164, 10524.070977085044, 6956.63375356184, 16322.259610500052, 15347.038677916506, 11990.862311898669, 5400.0, 12033.888591030336, 9633.630889426331, 9182.284616803161, 11690.35144197669, 13258.062967783677, 10717.030780703983, 12484.102884268235, 12419.936437870132, 15602.297331771577, 19667.651360044292, 5600.0, 15286.560783525827, 13242.236967187095, 11692.275223065179, 8320.673020447772, 8000.700634615874, 15530.69567818661, 12207.85697400471, 14158.92943740786, 10302.643788337879, 14163.615601931466, 10513.890050885595, 14390.956413329259, 10360.725080186829, 14646.606930636903, 8215.912720499768, 15012.548532067522, 13719.650247471425, 15998.8317798024, 15879.161424362825, 7440.395595702745, 13886.77111335472, 17137.729943536935, 15404.676003749482, 15129.800678268104, 17094.23865018157, 14214.96819190244, 12238.21185383691, 16633.568165516226], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7062.5555758258415, 7062.5555758258415, 6934.32411844413, 6934.32411844413, 5345.066856477613, 5345.066856477613, 2300.0, 2300.0, 5224.398507421336, 5224.398507421336, 6746.429364896518, 6746.429364896518, 5698.005277989707, 5698.005277989707, 5053.748988442694, 5053.748988442694, 5707.744994605648, 5707.744994605648, 5779.410223851265, 5779.410223851265, 5761.967747346542, 5761.967747346542, 5608.66867929412, 5608.66867929412, 5881.130737427171, 5881.130737427171, 6599.799237861336, 6599.799237861336, 7143.945467621266, 7143.945467621266, 6487.395429038917, 6487.395429038917, 5380.325328440797, 5380.325328440797, 5384.0833623638555, 5384.0833623638555, 5668.700350658599, 5668.700350658599, 6056.92869644887, 6056.92869644887, 3189.8826249153026, 3189.8826249153026, 6708.33446175411, 6708.33446175411, 5123.235980945068, 5123.235980945068, 4018.9551201181994, 4018.9551201181994, 3626.289551701753, 3626.289551701753, 6291.650519822371, 6291.650519822371, 6374.724727859299, 6374.724727859299, 5423.664577871377, 5423.664577871377, 5694.001921134987, 5694.001921134987, 1700.0, 1700.0, 4329.419375117876, 4329.419375117876, 10289.561608174332, 10289.561608174332, 6491.241094453799, 6491.241094453799, 4389.726125450833, 4389.726125450833, 5923.692771868486, 5923.692771868486, 4728.209725992338, 4728.209725992338, 6501.08468744516, 6501.08468744516, 4516.424267589615, 4516.424267589615, 5714.408701816055, 5714.408701816055, 4941.504995238339, 4941.504995238339, 6275.920963585364, 6275.920963585364, 5821.015110514687, 5821.015110514687, 6637.461531207309, 6637.461531207309, 7925.589344244239, 7925.589344244239, 8408.000442252072, 8408.000442252072, 7288.82732789426, 7288.82732789426, 6792.485411589745, 6792.485411589745, 7970.546685828296, 7970.546685828296, 1700.0, 1700.0, 5852.628447650691, 5852.628447650691, 5583.646738900621, 5583.646738900621, 4001.3625426935923, 4001.3625426935923, 7360.961311011295, 7360.961311011295, 7340.992216444094, 7340.992216444094, 6510.150076270809, 6510.150076270809, 5262.035488542518, 5262.035488542518, 3478.31687678092, 3478.31687678092, 8161.129805250017, 8161.129805250017, 7673.519338958249, 7673.519338958249, 5995.431155949333, 5995.431155949333, 2700.0, 2700.0, 6016.944295515184, 6016.944295515184, 4816.815444713174, 4816.815444713174, 4591.142308401601, 4591.142308401601, 5845.175720988346, 5845.175720988346, 6629.031483891826, 6629.031483891826, 5358.515390351996, 5358.515390351996, 6242.051442134123, 6242.051442134123, 6209.968218935068, 6209.968218935068, 7801.148665885796, 7801.148665885796, 9833.82568002216, 9833.82568002216, 2800.0, 2800.0, 7643.280391762895, 7643.280391762895, 6621.118483593536, 6621.118483593536, 5846.137611532578, 5846.137611532578, 4160.336510223887, 4160.336510223887, 4000.350317307937, 4000.350317307937, 7765.347839093296, 7765.347839093296, 6103.92848700236, 6103.92848700236, 7079.464718703923, 7079.464718703923, 5151.321894168941, 5151.321894168941, 7081.80780096574, 7081.80780096574, 5256.945025442785, 5256.945025442785, 7195.478206664617, 7195.478206664617, 5180.362540093418, 5180.362540093418, 7323.303465318448, 7323.303465318448, 4107.956360249886, 4107.956360249886, 7506.27426603375, 7506.27426603375, 6859.825123735722, 6859.825123735722, 7999.415889901189, 7999.415889901189, 7939.580712181405, 7939.580712181405, 3720.1977978513723, 3720.1977978513723, 6943.385556677349, 6943.385556677349, 8568.864971768442, 8568.864971768442, 7702.338001874743, 7702.338001874743, 7564.900339134041, 7564.900339134041, 8547.119325090795, 8547.119325090795, 7107.484095951222, 7107.484095951222, 6119.105926918439, 6119.105926918439, 8316.784082758117, 8316.784082758117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2537552933261045, "mean_inference_ms": 1.2119486228288854, "mean_action_processing_ms": 0.13534827525479792, "mean_env_wait_ms": 3.3958097602945645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 329600, "timesteps_this_iter": 0, "agent_timesteps_total": 659200, "timers": {"sample_time_ms": 1899.43, "sample_throughput": 1684.716, "load_time_ms": 0.135, "load_throughput": 23675732.581, "learn_time_ms": 66.2, "learn_throughput": 48338.181, "update_time_ms": 1.524}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7566831.5, "policy_entropy": 32880.375, "policy_loss": 2451950.0, "vf_loss": 49791008.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 329600, "num_agent_steps_sampled": 659200, "num_steps_trained": 329600, "num_agent_steps_trained": 659200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 410, "training_iteration": 18, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-58-33", "timestamp": 1718794713, "time_this_iter_s": 11.345388412475586, "time_total_s": 193.08789086341858, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf08ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 193.08789086341858, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.85625, "ram_util_percent": 33.206250000000004}}
{"episode_reward_max": 20579.12321634862, "episode_reward_min": 3400.0, "episode_reward_mean": 12185.425348360446, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1700.0}, "policy_reward_max": {"shared_policy": 10289.561608174332}, "policy_reward_mean": {"shared_policy": 6092.71267418022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6379.765249830605, 13416.668923508223, 10246.471961890158, 8037.910240236399, 7252.579103403506, 12583.301039644746, 12749.449455718583, 10847.329155742773, 11388.003842269958, 3400.0, 8658.838750235758, 20579.12321634862, 12982.482188907627, 8779.45225090166, 11847.38554373696, 9456.419451984646, 13002.169374890327, 9032.84853517923, 11428.817403632129, 9883.009990476698, 12551.841927170724, 11642.03022102937, 13274.92306241463, 15851.178688488482, 16816.000884504152, 14577.65465578852, 13584.970823179508, 15941.093371656592, 3400.0, 11705.256895301365, 11167.293477801268, 8002.725085387185, 14721.922622022634, 14681.984432888225, 13020.30015254164, 10524.070977085044, 6956.63375356184, 16322.259610500052, 15347.038677916506, 11990.862311898669, 5400.0, 12033.888591030336, 9633.630889426331, 9182.284616803161, 11690.35144197669, 13258.062967783677, 10717.030780703983, 12484.102884268235, 12419.936437870132, 15602.297331771577, 19667.651360044292, 5600.0, 15286.560783525827, 13242.236967187095, 11692.275223065179, 8320.673020447772, 8000.700634615874, 15530.69567818661, 12207.85697400471, 14158.92943740786, 10302.643788337879, 14163.615601931466, 10513.890050885595, 14390.956413329259, 10360.725080186829, 14646.606930636903, 8215.912720499768, 15012.548532067522, 13719.650247471425, 15998.8317798024, 15879.161424362825, 7440.395595702745, 13886.77111335472, 17137.729943536935, 15404.676003749482, 15129.800678268104, 17094.23865018157, 14214.96819190244, 12238.21185383691, 16633.568165516226, 13416.979258077183, 9944.807231958479, 17274.476442536215, 11779.204703313277, 13294.927310304676, 11799.059065552745, 8325.539659792128, 15169.752724818678, 13564.657526856005, 15055.639964828235, 14806.194048062782, 17468.721356052374, 11141.443621282979, 7139.019341514862, 9097.610909907533, 15846.919848166483, 15010.521640291205, 7110.666578441445, 10359.10685531786, 8391.15065361407], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3189.8826249153026, 3189.8826249153026, 6708.33446175411, 6708.33446175411, 5123.235980945068, 5123.235980945068, 4018.9551201181994, 4018.9551201181994, 3626.289551701753, 3626.289551701753, 6291.650519822371, 6291.650519822371, 6374.724727859299, 6374.724727859299, 5423.664577871377, 5423.664577871377, 5694.001921134987, 5694.001921134987, 1700.0, 1700.0, 4329.419375117876, 4329.419375117876, 10289.561608174332, 10289.561608174332, 6491.241094453799, 6491.241094453799, 4389.726125450833, 4389.726125450833, 5923.692771868486, 5923.692771868486, 4728.209725992338, 4728.209725992338, 6501.08468744516, 6501.08468744516, 4516.424267589615, 4516.424267589615, 5714.408701816055, 5714.408701816055, 4941.504995238339, 4941.504995238339, 6275.920963585364, 6275.920963585364, 5821.015110514687, 5821.015110514687, 6637.461531207309, 6637.461531207309, 7925.589344244239, 7925.589344244239, 8408.000442252072, 8408.000442252072, 7288.82732789426, 7288.82732789426, 6792.485411589745, 6792.485411589745, 7970.546685828296, 7970.546685828296, 1700.0, 1700.0, 5852.628447650691, 5852.628447650691, 5583.646738900621, 5583.646738900621, 4001.3625426935923, 4001.3625426935923, 7360.961311011295, 7360.961311011295, 7340.992216444094, 7340.992216444094, 6510.150076270809, 6510.150076270809, 5262.035488542518, 5262.035488542518, 3478.31687678092, 3478.31687678092, 8161.129805250017, 8161.129805250017, 7673.519338958249, 7673.519338958249, 5995.431155949333, 5995.431155949333, 2700.0, 2700.0, 6016.944295515184, 6016.944295515184, 4816.815444713174, 4816.815444713174, 4591.142308401601, 4591.142308401601, 5845.175720988346, 5845.175720988346, 6629.031483891826, 6629.031483891826, 5358.515390351996, 5358.515390351996, 6242.051442134123, 6242.051442134123, 6209.968218935068, 6209.968218935068, 7801.148665885796, 7801.148665885796, 9833.82568002216, 9833.82568002216, 2800.0, 2800.0, 7643.280391762895, 7643.280391762895, 6621.118483593536, 6621.118483593536, 5846.137611532578, 5846.137611532578, 4160.336510223887, 4160.336510223887, 4000.350317307937, 4000.350317307937, 7765.347839093296, 7765.347839093296, 6103.92848700236, 6103.92848700236, 7079.464718703923, 7079.464718703923, 5151.321894168941, 5151.321894168941, 7081.80780096574, 7081.80780096574, 5256.945025442785, 5256.945025442785, 7195.478206664617, 7195.478206664617, 5180.362540093418, 5180.362540093418, 7323.303465318448, 7323.303465318448, 4107.956360249886, 4107.956360249886, 7506.27426603375, 7506.27426603375, 6859.825123735722, 6859.825123735722, 7999.415889901189, 7999.415889901189, 7939.580712181405, 7939.580712181405, 3720.1977978513723, 3720.1977978513723, 6943.385556677349, 6943.385556677349, 8568.864971768442, 8568.864971768442, 7702.338001874743, 7702.338001874743, 7564.900339134041, 7564.900339134041, 8547.119325090795, 8547.119325090795, 7107.484095951222, 7107.484095951222, 6119.105926918439, 6119.105926918439, 8316.784082758117, 8316.784082758117, 6708.489629038606, 6708.489629038606, 4972.403615979223, 4972.403615979223, 8637.238221268088, 8637.238221268088, 5889.60235165664, 5889.60235165664, 6647.463655152333, 6647.463655152333, 5899.529532776373, 5899.529532776373, 4162.769829896064, 4162.769829896064, 7584.87636240935, 7584.87636240935, 6782.328763427991, 6782.328763427991, 7527.819982414103, 7527.819982414103, 7403.097024031384, 7403.097024031384, 8734.360678026183, 8734.360678026183, 5570.721810641484, 5570.721810641484, 3569.509670757431, 3569.509670757431, 4548.80545495377, 4548.80545495377, 7923.459924083232, 7923.459924083232, 7505.260820145599, 7505.260820145599, 3555.3332892207227, 3555.3332892207227, 5179.553427658939, 5179.553427658939, 4195.575326807021, 4195.575326807021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2534040099297803, "mean_inference_ms": 1.2105945366368944, "mean_action_processing_ms": 0.13514134757975046, "mean_env_wait_ms": 3.3948886155511953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 348800, "timesteps_this_iter": 0, "agent_timesteps_total": 697600, "timers": {"sample_time_ms": 1861.397, "sample_throughput": 1719.139, "load_time_ms": 0.14, "load_throughput": 22935360.219, "learn_time_ms": 65.994, "learn_throughput": 48488.941, "update_time_ms": 1.464}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8390657.0, "policy_entropy": 33461.59765625, "policy_loss": 2792116.0, "vf_loss": 61999040.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 348800, "num_agent_steps_sampled": 697600, "num_steps_trained": 348800, "num_agent_steps_trained": 697600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 430, "training_iteration": 19, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-58-44", "timestamp": 1718794724, "time_this_iter_s": 10.967784404754639, "time_total_s": 204.05567526817322, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf085e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 204.05567526817322, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 57.587500000000006, "ram_util_percent": 33.2}}
{"episode_reward_max": 19667.651360044292, "episode_reward_min": 3800.0, "episode_reward_mean": 12304.01385684801, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 9833.82568002216}, "policy_reward_mean": {"shared_policy": 6152.006928424002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11167.293477801268, 8002.725085387185, 14721.922622022634, 14681.984432888225, 13020.30015254164, 10524.070977085044, 6956.63375356184, 16322.259610500052, 15347.038677916506, 11990.862311898669, 5400.0, 12033.888591030336, 9633.630889426331, 9182.284616803161, 11690.35144197669, 13258.062967783677, 10717.030780703983, 12484.102884268235, 12419.936437870132, 15602.297331771577, 19667.651360044292, 5600.0, 15286.560783525827, 13242.236967187095, 11692.275223065179, 8320.673020447772, 8000.700634615874, 15530.69567818661, 12207.85697400471, 14158.92943740786, 10302.643788337879, 14163.615601931466, 10513.890050885595, 14390.956413329259, 10360.725080186829, 14646.606930636903, 8215.912720499768, 15012.548532067522, 13719.650247471425, 15998.8317798024, 15879.161424362825, 7440.395595702745, 13886.77111335472, 17137.729943536935, 15404.676003749482, 15129.800678268104, 17094.23865018157, 14214.96819190244, 12238.21185383691, 16633.568165516226, 13416.979258077183, 9944.807231958479, 17274.476442536215, 11779.204703313277, 13294.927310304676, 11799.059065552745, 8325.539659792128, 15169.752724818678, 13564.657526856005, 15055.639964828235, 14806.194048062782, 17468.721356052374, 11141.443621282979, 7139.019341514862, 9097.610909907533, 15846.919848166483, 15010.521640291205, 7110.666578441445, 10359.10685531786, 8391.15065361407, 14527.885523830559, 12463.604135671045, 15960.069469207177, 12059.358107340722, 17416.665803898024, 13164.534648434146, 5371.350997539894, 13071.661374759697, 9429.87150961635, 15001.508528158993, 3800.0, 12002.238381997515, 10438.11824827387, 11396.366621511468, 8788.904150962808, 10486.58019610712, 5000.0, 12677.548368897598, 11282.361073738964, 15218.7685947063, 10321.225776525233, 8038.816405015999, 14650.282042885625, 12172.916743578298, 14474.25941257547, 13825.331504252124, 11442.986318336789, 15641.525692637573, 15573.573973163147, 7457.513453205813], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5583.646738900621, 5583.646738900621, 4001.3625426935923, 4001.3625426935923, 7360.961311011295, 7360.961311011295, 7340.992216444094, 7340.992216444094, 6510.150076270809, 6510.150076270809, 5262.035488542518, 5262.035488542518, 3478.31687678092, 3478.31687678092, 8161.129805250017, 8161.129805250017, 7673.519338958249, 7673.519338958249, 5995.431155949333, 5995.431155949333, 2700.0, 2700.0, 6016.944295515184, 6016.944295515184, 4816.815444713174, 4816.815444713174, 4591.142308401601, 4591.142308401601, 5845.175720988346, 5845.175720988346, 6629.031483891826, 6629.031483891826, 5358.515390351996, 5358.515390351996, 6242.051442134123, 6242.051442134123, 6209.968218935068, 6209.968218935068, 7801.148665885796, 7801.148665885796, 9833.82568002216, 9833.82568002216, 2800.0, 2800.0, 7643.280391762895, 7643.280391762895, 6621.118483593536, 6621.118483593536, 5846.137611532578, 5846.137611532578, 4160.336510223887, 4160.336510223887, 4000.350317307937, 4000.350317307937, 7765.347839093296, 7765.347839093296, 6103.92848700236, 6103.92848700236, 7079.464718703923, 7079.464718703923, 5151.321894168941, 5151.321894168941, 7081.80780096574, 7081.80780096574, 5256.945025442785, 5256.945025442785, 7195.478206664617, 7195.478206664617, 5180.362540093418, 5180.362540093418, 7323.303465318448, 7323.303465318448, 4107.956360249886, 4107.956360249886, 7506.27426603375, 7506.27426603375, 6859.825123735722, 6859.825123735722, 7999.415889901189, 7999.415889901189, 7939.580712181405, 7939.580712181405, 3720.1977978513723, 3720.1977978513723, 6943.385556677349, 6943.385556677349, 8568.864971768442, 8568.864971768442, 7702.338001874743, 7702.338001874743, 7564.900339134041, 7564.900339134041, 8547.119325090795, 8547.119325090795, 7107.484095951222, 7107.484095951222, 6119.105926918439, 6119.105926918439, 8316.784082758117, 8316.784082758117, 6708.489629038606, 6708.489629038606, 4972.403615979223, 4972.403615979223, 8637.238221268088, 8637.238221268088, 5889.60235165664, 5889.60235165664, 6647.463655152333, 6647.463655152333, 5899.529532776373, 5899.529532776373, 4162.769829896064, 4162.769829896064, 7584.87636240935, 7584.87636240935, 6782.328763427991, 6782.328763427991, 7527.819982414103, 7527.819982414103, 7403.097024031384, 7403.097024031384, 8734.360678026183, 8734.360678026183, 5570.721810641484, 5570.721810641484, 3569.509670757431, 3569.509670757431, 4548.80545495377, 4548.80545495377, 7923.459924083232, 7923.459924083232, 7505.260820145599, 7505.260820145599, 3555.3332892207227, 3555.3332892207227, 5179.553427658939, 5179.553427658939, 4195.575326807021, 4195.575326807021, 7263.942761915267, 7263.942761915267, 6231.802067835521, 6231.802067835521, 7980.034734603592, 7980.034734603592, 6029.679053670373, 6029.679053670373, 8708.332901949005, 8708.332901949005, 6582.267324217059, 6582.267324217059, 2685.675498769947, 2685.675498769947, 6535.830687379861, 6535.830687379861, 4714.935754808178, 4714.935754808178, 7500.754264079493, 7500.754264079493, 1900.0, 1900.0, 6001.119190998745, 6001.119190998745, 5219.059124136926, 5219.059124136926, 5698.183310755749, 5698.183310755749, 4394.452075481402, 4394.452075481402, 5243.290098053568, 5243.290098053568, 2500.0, 2500.0, 6338.774184448801, 6338.774184448801, 5641.180536869475, 5641.180536869475, 7609.384297353148, 7609.384297353148, 5160.61288826262, 5160.61288826262, 4019.4082025079997, 4019.4082025079997, 7325.141021442803, 7325.141021442803, 6086.458371789151, 6086.458371789151, 7237.129706287737, 7237.129706287737, 6912.66575212606, 6912.66575212606, 5721.4931591684, 5721.4931591684, 7820.762846318787, 7820.762846318787, 7786.786986581563, 7786.786986581563, 3728.7567266029064, 3728.7567266029064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25324553791663046, "mean_inference_ms": 1.2100922285775975, "mean_action_processing_ms": 0.13512695693228952, "mean_env_wait_ms": 3.3918196541554577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 368000, "timesteps_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"sample_time_ms": 1827.718, "sample_throughput": 1750.817, "load_time_ms": 0.137, "load_throughput": 23358462.931, "learn_time_ms": 64.052, "learn_throughput": 49959.382, "update_time_ms": 1.409}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6122700.0, "policy_entropy": 36102.203125, "policy_loss": 2132902.25, "vf_loss": 41456440.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 368000, "num_agent_steps_sampled": 736000, "num_steps_trained": 368000, "num_agent_steps_trained": 736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 20, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-58-55", "timestamp": 1718794735, "time_this_iter_s": 11.01699686050415, "time_total_s": 215.07267212867737, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf08a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 215.07267212867737, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.725, "ram_util_percent": 33.23125}}
{"episode_reward_max": 19667.651360044292, "episode_reward_min": 3800.0, "episode_reward_mean": 12323.98462023976, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 9833.82568002216}, "policy_reward_mean": {"shared_policy": 6161.992310119879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19667.651360044292, 5600.0, 15286.560783525827, 13242.236967187095, 11692.275223065179, 8320.673020447772, 8000.700634615874, 15530.69567818661, 12207.85697400471, 14158.92943740786, 10302.643788337879, 14163.615601931466, 10513.890050885595, 14390.956413329259, 10360.725080186829, 14646.606930636903, 8215.912720499768, 15012.548532067522, 13719.650247471425, 15998.8317798024, 15879.161424362825, 7440.395595702745, 13886.77111335472, 17137.729943536935, 15404.676003749482, 15129.800678268104, 17094.23865018157, 14214.96819190244, 12238.21185383691, 16633.568165516226, 13416.979258077183, 9944.807231958479, 17274.476442536215, 11779.204703313277, 13294.927310304676, 11799.059065552745, 8325.539659792128, 15169.752724818678, 13564.657526856005, 15055.639964828235, 14806.194048062782, 17468.721356052374, 11141.443621282979, 7139.019341514862, 9097.610909907533, 15846.919848166483, 15010.521640291205, 7110.666578441445, 10359.10685531786, 8391.15065361407, 14527.885523830559, 12463.604135671045, 15960.069469207177, 12059.358107340722, 17416.665803898024, 13164.534648434146, 5371.350997539894, 13071.661374759697, 9429.87150961635, 15001.508528158993, 3800.0, 12002.238381997515, 10438.11824827387, 11396.366621511468, 8788.904150962808, 10486.58019610712, 5000.0, 12677.548368897598, 11282.361073738964, 15218.7685947063, 10321.225776525233, 8038.816405015999, 14650.282042885625, 12172.916743578298, 14474.25941257547, 13825.331504252124, 11442.986318336789, 15641.525692637573, 15573.573973163147, 7457.513453205813, 11610.137136554262, 13616.243600394188, 15812.685653584962, 13292.133901289351, 12041.132226215592, 10827.063477892247, 16650.935687054676, 11144.555058787657, 6292.152188030168, 17939.415994542316, 13453.063632286998, 8622.40903802371, 13913.404727436158, 5009.91640010805, 10325.257062394769, 9058.18779048439, 10168.467093470888, 14874.313561597832, 9619.4802853672, 12882.798866897], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [9833.82568002216, 9833.82568002216, 2800.0, 2800.0, 7643.280391762895, 7643.280391762895, 6621.118483593536, 6621.118483593536, 5846.137611532578, 5846.137611532578, 4160.336510223887, 4160.336510223887, 4000.350317307937, 4000.350317307937, 7765.347839093296, 7765.347839093296, 6103.92848700236, 6103.92848700236, 7079.464718703923, 7079.464718703923, 5151.321894168941, 5151.321894168941, 7081.80780096574, 7081.80780096574, 5256.945025442785, 5256.945025442785, 7195.478206664617, 7195.478206664617, 5180.362540093418, 5180.362540093418, 7323.303465318448, 7323.303465318448, 4107.956360249886, 4107.956360249886, 7506.27426603375, 7506.27426603375, 6859.825123735722, 6859.825123735722, 7999.415889901189, 7999.415889901189, 7939.580712181405, 7939.580712181405, 3720.1977978513723, 3720.1977978513723, 6943.385556677349, 6943.385556677349, 8568.864971768442, 8568.864971768442, 7702.338001874743, 7702.338001874743, 7564.900339134041, 7564.900339134041, 8547.119325090795, 8547.119325090795, 7107.484095951222, 7107.484095951222, 6119.105926918439, 6119.105926918439, 8316.784082758117, 8316.784082758117, 6708.489629038606, 6708.489629038606, 4972.403615979223, 4972.403615979223, 8637.238221268088, 8637.238221268088, 5889.60235165664, 5889.60235165664, 6647.463655152333, 6647.463655152333, 5899.529532776373, 5899.529532776373, 4162.769829896064, 4162.769829896064, 7584.87636240935, 7584.87636240935, 6782.328763427991, 6782.328763427991, 7527.819982414103, 7527.819982414103, 7403.097024031384, 7403.097024031384, 8734.360678026183, 8734.360678026183, 5570.721810641484, 5570.721810641484, 3569.509670757431, 3569.509670757431, 4548.80545495377, 4548.80545495377, 7923.459924083232, 7923.459924083232, 7505.260820145599, 7505.260820145599, 3555.3332892207227, 3555.3332892207227, 5179.553427658939, 5179.553427658939, 4195.575326807021, 4195.575326807021, 7263.942761915267, 7263.942761915267, 6231.802067835521, 6231.802067835521, 7980.034734603592, 7980.034734603592, 6029.679053670373, 6029.679053670373, 8708.332901949005, 8708.332901949005, 6582.267324217059, 6582.267324217059, 2685.675498769947, 2685.675498769947, 6535.830687379861, 6535.830687379861, 4714.935754808178, 4714.935754808178, 7500.754264079493, 7500.754264079493, 1900.0, 1900.0, 6001.119190998745, 6001.119190998745, 5219.059124136926, 5219.059124136926, 5698.183310755749, 5698.183310755749, 4394.452075481402, 4394.452075481402, 5243.290098053568, 5243.290098053568, 2500.0, 2500.0, 6338.774184448801, 6338.774184448801, 5641.180536869475, 5641.180536869475, 7609.384297353148, 7609.384297353148, 5160.61288826262, 5160.61288826262, 4019.4082025079997, 4019.4082025079997, 7325.141021442803, 7325.141021442803, 6086.458371789151, 6086.458371789151, 7237.129706287737, 7237.129706287737, 6912.66575212606, 6912.66575212606, 5721.4931591684, 5721.4931591684, 7820.762846318787, 7820.762846318787, 7786.786986581563, 7786.786986581563, 3728.7567266029064, 3728.7567266029064, 5805.068568277142, 5805.068568277142, 6808.121800197088, 6808.121800197088, 7906.342826792481, 7906.342826792481, 6646.066950644681, 6646.066950644681, 6020.566113107802, 6020.566113107802, 5413.531738946143, 5413.531738946143, 8325.46784352733, 8325.46784352733, 5572.277529393823, 5572.277529393823, 3146.076094015084, 3146.076094015084, 8969.707997271153, 8969.707997271153, 6726.5318161435025, 6726.5318161435025, 4311.204519011856, 4311.204519011856, 6956.702363718066, 6956.702363718066, 2504.9582000540267, 2504.9582000540267, 5162.628531197381, 5162.628531197381, 4529.093895242202, 4529.093895242202, 5084.23354673544, 5084.23354673544, 7437.15678079891, 7437.15678079891, 4809.7401426836, 4809.7401426836, 6441.399433448496, 6441.399433448496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2530811998139412, "mean_inference_ms": 1.2092962125419202, "mean_action_processing_ms": 0.13501216800885957, "mean_env_wait_ms": 3.3899091750656942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 387200, "timesteps_this_iter": 0, "agent_timesteps_total": 774400, "timers": {"sample_time_ms": 1848.308, "sample_throughput": 1731.314, "load_time_ms": 0.14, "load_throughput": 22849459.993, "learn_time_ms": 64.95, "learn_throughput": 49268.495, "update_time_ms": 1.453}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8936154.0, "policy_entropy": 35727.71875, "policy_loss": 3100995.0, "vf_loss": 60889320.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 387200, "num_agent_steps_sampled": 774400, "num_steps_trained": 387200, "num_agent_steps_trained": 774400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 21, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-59-06", "timestamp": 1718794746, "time_this_iter_s": 11.17925238609314, "time_total_s": 226.2519245147705, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 226.2519245147705, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.6875, "ram_util_percent": 33.2}}
{"episode_reward_max": 17939.415994542316, "episode_reward_min": 3800.0, "episode_reward_mean": 12041.529170289816, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 8969.707997271153}, "policy_reward_mean": {"shared_policy": 6020.764585144906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15879.161424362825, 7440.395595702745, 13886.77111335472, 17137.729943536935, 15404.676003749482, 15129.800678268104, 17094.23865018157, 14214.96819190244, 12238.21185383691, 16633.568165516226, 13416.979258077183, 9944.807231958479, 17274.476442536215, 11779.204703313277, 13294.927310304676, 11799.059065552745, 8325.539659792128, 15169.752724818678, 13564.657526856005, 15055.639964828235, 14806.194048062782, 17468.721356052374, 11141.443621282979, 7139.019341514862, 9097.610909907533, 15846.919848166483, 15010.521640291205, 7110.666578441445, 10359.10685531786, 8391.15065361407, 14527.885523830559, 12463.604135671045, 15960.069469207177, 12059.358107340722, 17416.665803898024, 13164.534648434146, 5371.350997539894, 13071.661374759697, 9429.87150961635, 15001.508528158993, 3800.0, 12002.238381997515, 10438.11824827387, 11396.366621511468, 8788.904150962808, 10486.58019610712, 5000.0, 12677.548368897598, 11282.361073738964, 15218.7685947063, 10321.225776525233, 8038.816405015999, 14650.282042885625, 12172.916743578298, 14474.25941257547, 13825.331504252124, 11442.986318336789, 15641.525692637573, 15573.573973163147, 7457.513453205813, 11610.137136554262, 13616.243600394188, 15812.685653584962, 13292.133901289351, 12041.132226215592, 10827.063477892247, 16650.935687054676, 11144.555058787657, 6292.152188030168, 17939.415994542316, 13453.063632286998, 8622.40903802371, 13913.404727436158, 5009.91640010805, 10325.257062394769, 9058.18779048439, 10168.467093470888, 14874.313561597832, 9619.4802853672, 12882.798866897, 11751.70419362442, 13987.522490907108, 5869.332088051973, 15416.719500856329, 15905.455039496974, 9729.915379118469, 9795.185213723089, 10376.048647567073, 10374.288998531774, 7540.801120988041, 11195.027692621967, 7889.493417096646, 15249.262546134301, 11316.551455543293, 12079.557230064049, 7954.157960894936, 16027.701688834615, 7432.93725098695, 15242.947511617815, 7652.806801979603], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7939.580712181405, 7939.580712181405, 3720.1977978513723, 3720.1977978513723, 6943.385556677349, 6943.385556677349, 8568.864971768442, 8568.864971768442, 7702.338001874743, 7702.338001874743, 7564.900339134041, 7564.900339134041, 8547.119325090795, 8547.119325090795, 7107.484095951222, 7107.484095951222, 6119.105926918439, 6119.105926918439, 8316.784082758117, 8316.784082758117, 6708.489629038606, 6708.489629038606, 4972.403615979223, 4972.403615979223, 8637.238221268088, 8637.238221268088, 5889.60235165664, 5889.60235165664, 6647.463655152333, 6647.463655152333, 5899.529532776373, 5899.529532776373, 4162.769829896064, 4162.769829896064, 7584.87636240935, 7584.87636240935, 6782.328763427991, 6782.328763427991, 7527.819982414103, 7527.819982414103, 7403.097024031384, 7403.097024031384, 8734.360678026183, 8734.360678026183, 5570.721810641484, 5570.721810641484, 3569.509670757431, 3569.509670757431, 4548.80545495377, 4548.80545495377, 7923.459924083232, 7923.459924083232, 7505.260820145599, 7505.260820145599, 3555.3332892207227, 3555.3332892207227, 5179.553427658939, 5179.553427658939, 4195.575326807021, 4195.575326807021, 7263.942761915267, 7263.942761915267, 6231.802067835521, 6231.802067835521, 7980.034734603592, 7980.034734603592, 6029.679053670373, 6029.679053670373, 8708.332901949005, 8708.332901949005, 6582.267324217059, 6582.267324217059, 2685.675498769947, 2685.675498769947, 6535.830687379861, 6535.830687379861, 4714.935754808178, 4714.935754808178, 7500.754264079493, 7500.754264079493, 1900.0, 1900.0, 6001.119190998745, 6001.119190998745, 5219.059124136926, 5219.059124136926, 5698.183310755749, 5698.183310755749, 4394.452075481402, 4394.452075481402, 5243.290098053568, 5243.290098053568, 2500.0, 2500.0, 6338.774184448801, 6338.774184448801, 5641.180536869475, 5641.180536869475, 7609.384297353148, 7609.384297353148, 5160.61288826262, 5160.61288826262, 4019.4082025079997, 4019.4082025079997, 7325.141021442803, 7325.141021442803, 6086.458371789151, 6086.458371789151, 7237.129706287737, 7237.129706287737, 6912.66575212606, 6912.66575212606, 5721.4931591684, 5721.4931591684, 7820.762846318787, 7820.762846318787, 7786.786986581563, 7786.786986581563, 3728.7567266029064, 3728.7567266029064, 5805.068568277142, 5805.068568277142, 6808.121800197088, 6808.121800197088, 7906.342826792481, 7906.342826792481, 6646.066950644681, 6646.066950644681, 6020.566113107802, 6020.566113107802, 5413.531738946143, 5413.531738946143, 8325.46784352733, 8325.46784352733, 5572.277529393823, 5572.277529393823, 3146.076094015084, 3146.076094015084, 8969.707997271153, 8969.707997271153, 6726.5318161435025, 6726.5318161435025, 4311.204519011856, 4311.204519011856, 6956.702363718066, 6956.702363718066, 2504.9582000540267, 2504.9582000540267, 5162.628531197381, 5162.628531197381, 4529.093895242202, 4529.093895242202, 5084.23354673544, 5084.23354673544, 7437.15678079891, 7437.15678079891, 4809.7401426836, 4809.7401426836, 6441.399433448496, 6441.399433448496, 5875.852096812228, 5875.852096812228, 6993.761245453545, 6993.761245453545, 2934.6660440259866, 2934.6660440259866, 7708.3597504281715, 7708.3597504281715, 7952.727519748485, 7952.727519748485, 4864.957689559233, 4864.957689559233, 4897.592606861542, 4897.592606861542, 5188.024323783555, 5188.024323783555, 5187.1444992659, 5187.1444992659, 3770.4005604940203, 3770.4005604940203, 5597.513846310986, 5597.513846310986, 3944.746708548323, 3944.746708548323, 7624.631273067129, 7624.631273067129, 5658.275727771642, 5658.275727771642, 6039.778615032031, 6039.778615032031, 3977.078980447468, 3977.078980447468, 8013.850844417311, 8013.850844417311, 3716.468625493475, 3716.468625493475, 7621.473755808924, 7621.473755808924, 3826.4034009898005, 3826.4034009898005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25271039575149135, "mean_inference_ms": 1.207585698841919, "mean_action_processing_ms": 0.1347384092161132, "mean_env_wait_ms": 3.3872143339011735, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 406400, "timesteps_this_iter": 0, "agent_timesteps_total": 812800, "timers": {"sample_time_ms": 1850.68, "sample_throughput": 1729.095, "load_time_ms": 0.138, "load_throughput": 23133010.686, "learn_time_ms": 64.901, "learn_throughput": 49305.526, "update_time_ms": 1.439}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6840577.5, "policy_entropy": 35674.87890625, "policy_loss": 2383379.25, "vf_loss": 44758584.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 406400, "num_agent_steps_sampled": 812800, "num_steps_trained": 406400, "num_agent_steps_trained": 812800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 500, "training_iteration": 22, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-59-17", "timestamp": 1718794757, "time_this_iter_s": 11.094545364379883, "time_total_s": 237.3464698791504, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cfe9940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 237.3464698791504, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 57.24000000000001, "ram_util_percent": 33.24666666666668}}
{"episode_reward_max": 17939.415994542316, "episode_reward_min": 3600.0, "episode_reward_mean": 11695.787680519694, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1800.0}, "policy_reward_max": {"shared_policy": 8969.707997271153}, "policy_reward_mean": {"shared_policy": 5847.893840259849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14527.885523830559, 12463.604135671045, 15960.069469207177, 12059.358107340722, 17416.665803898024, 13164.534648434146, 5371.350997539894, 13071.661374759697, 9429.87150961635, 15001.508528158993, 3800.0, 12002.238381997515, 10438.11824827387, 11396.366621511468, 8788.904150962808, 10486.58019610712, 5000.0, 12677.548368897598, 11282.361073738964, 15218.7685947063, 10321.225776525233, 8038.816405015999, 14650.282042885625, 12172.916743578298, 14474.25941257547, 13825.331504252124, 11442.986318336789, 15641.525692637573, 15573.573973163147, 7457.513453205813, 11610.137136554262, 13616.243600394188, 15812.685653584962, 13292.133901289351, 12041.132226215592, 10827.063477892247, 16650.935687054676, 11144.555058787657, 6292.152188030168, 17939.415994542316, 13453.063632286998, 8622.40903802371, 13913.404727436158, 5009.91640010805, 10325.257062394769, 9058.18779048439, 10168.467093470888, 14874.313561597832, 9619.4802853672, 12882.798866897, 11751.70419362442, 13987.522490907108, 5869.332088051973, 15416.719500856329, 15905.455039496974, 9729.915379118469, 9795.185213723089, 10376.048647567073, 10374.288998531774, 7540.801120988041, 11195.027692621967, 7889.493417096646, 15249.262546134301, 11316.551455543293, 12079.557230064049, 7954.157960894936, 16027.701688834615, 7432.93725098695, 15242.947511617815, 7652.806801979603, 13858.3549889118, 12257.034350513022, 6789.573586820799, 12345.083633715822, 10987.99553818355, 16196.184828711921, 9695.972018178072, 12046.832878135017, 6716.961895621989, 3600.0, 12591.738755788654, 12969.977560152049, 10373.768518339512, 12146.632137082706, 13729.047217750787, 8128.841206552566, 10200.190206810123, 14198.420625124552, 12009.651012033231, 11434.306257666609, 15188.998584928147, 12823.756150911006, 9235.965814738327, 11581.269468638868, 12465.470017174346, 12421.94341751609, 13908.783349937701, 11531.092985975607, 17484.440870850864, 17563.48350732537], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7263.942761915267, 7263.942761915267, 6231.802067835521, 6231.802067835521, 7980.034734603592, 7980.034734603592, 6029.679053670373, 6029.679053670373, 8708.332901949005, 8708.332901949005, 6582.267324217059, 6582.267324217059, 2685.675498769947, 2685.675498769947, 6535.830687379861, 6535.830687379861, 4714.935754808178, 4714.935754808178, 7500.754264079493, 7500.754264079493, 1900.0, 1900.0, 6001.119190998745, 6001.119190998745, 5219.059124136926, 5219.059124136926, 5698.183310755749, 5698.183310755749, 4394.452075481402, 4394.452075481402, 5243.290098053568, 5243.290098053568, 2500.0, 2500.0, 6338.774184448801, 6338.774184448801, 5641.180536869475, 5641.180536869475, 7609.384297353148, 7609.384297353148, 5160.61288826262, 5160.61288826262, 4019.4082025079997, 4019.4082025079997, 7325.141021442803, 7325.141021442803, 6086.458371789151, 6086.458371789151, 7237.129706287737, 7237.129706287737, 6912.66575212606, 6912.66575212606, 5721.4931591684, 5721.4931591684, 7820.762846318787, 7820.762846318787, 7786.786986581563, 7786.786986581563, 3728.7567266029064, 3728.7567266029064, 5805.068568277142, 5805.068568277142, 6808.121800197088, 6808.121800197088, 7906.342826792481, 7906.342826792481, 6646.066950644681, 6646.066950644681, 6020.566113107802, 6020.566113107802, 5413.531738946143, 5413.531738946143, 8325.46784352733, 8325.46784352733, 5572.277529393823, 5572.277529393823, 3146.076094015084, 3146.076094015084, 8969.707997271153, 8969.707997271153, 6726.5318161435025, 6726.5318161435025, 4311.204519011856, 4311.204519011856, 6956.702363718066, 6956.702363718066, 2504.9582000540267, 2504.9582000540267, 5162.628531197381, 5162.628531197381, 4529.093895242202, 4529.093895242202, 5084.23354673544, 5084.23354673544, 7437.15678079891, 7437.15678079891, 4809.7401426836, 4809.7401426836, 6441.399433448496, 6441.399433448496, 5875.852096812228, 5875.852096812228, 6993.761245453545, 6993.761245453545, 2934.6660440259866, 2934.6660440259866, 7708.3597504281715, 7708.3597504281715, 7952.727519748485, 7952.727519748485, 4864.957689559233, 4864.957689559233, 4897.592606861542, 4897.592606861542, 5188.024323783555, 5188.024323783555, 5187.1444992659, 5187.1444992659, 3770.4005604940203, 3770.4005604940203, 5597.513846310986, 5597.513846310986, 3944.746708548323, 3944.746708548323, 7624.631273067129, 7624.631273067129, 5658.275727771642, 5658.275727771642, 6039.778615032031, 6039.778615032031, 3977.078980447468, 3977.078980447468, 8013.850844417311, 8013.850844417311, 3716.468625493475, 3716.468625493475, 7621.473755808924, 7621.473755808924, 3826.4034009898005, 3826.4034009898005, 6929.1774944558965, 6929.1774944558965, 6128.517175256522, 6128.517175256522, 3394.7867934103997, 3394.7867934103997, 6172.541816857907, 6172.541816857907, 5493.997769091795, 5493.997769091795, 8098.0924143559805, 8098.0924143559805, 4847.9860090890415, 4847.9860090890415, 6023.416439067527, 6023.416439067527, 3358.4809478109946, 3358.4809478109946, 1800.0, 1800.0, 6295.869377894322, 6295.869377894322, 6484.988780076033, 6484.988780076033, 5186.884259169753, 5186.884259169753, 6073.316068541344, 6073.316068541344, 6864.523608875388, 6864.523608875388, 4064.420603276283, 4064.420603276283, 5100.095103405066, 5100.095103405066, 7099.210312562289, 7099.210312562289, 6004.825506016628, 6004.825506016628, 5717.153128833311, 5717.153128833311, 7594.499292464077, 7594.499292464077, 6411.878075455483, 6411.878075455483, 4617.982907369163, 4617.982907369163, 5790.63473431944, 5790.63473431944, 6232.735008587169, 6232.735008587169, 6210.971708758054, 6210.971708758054, 6954.391674968872, 6954.391674968872, 5765.546492987806, 5765.546492987806, 8742.220435425443, 8742.220435425443, 8781.741753662685, 8781.741753662685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2524927201436349, "mean_inference_ms": 1.206815838852915, "mean_action_processing_ms": 0.13466367367868687, "mean_env_wait_ms": 3.382660541032353, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 425600, "timesteps_this_iter": 0, "agent_timesteps_total": 851200, "timers": {"sample_time_ms": 1848.662, "sample_throughput": 1730.981, "load_time_ms": 0.131, "load_throughput": 24465499.089, "learn_time_ms": 64.928, "learn_throughput": 49285.393, "update_time_ms": 1.516}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8118471.0, "policy_entropy": 36206.46875, "policy_loss": 2898583.5, "vf_loss": 57110248.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 425600, "num_agent_steps_sampled": 851200, "num_steps_trained": 425600, "num_agent_steps_trained": 851200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 530, "training_iteration": 23, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-59-28", "timestamp": 1718794768, "time_this_iter_s": 11.177953481674194, "time_total_s": 248.52442336082458, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9aaf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 248.52442336082458, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 57.824999999999996, "ram_util_percent": 33.28125}}
{"episode_reward_max": 19036.42530690923, "episode_reward_min": 3600.0, "episode_reward_mean": 11526.990605048966, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1800.0}, "policy_reward_max": {"shared_policy": 9518.212653454597}, "policy_reward_mean": {"shared_policy": 5763.495302524483}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10321.225776525233, 8038.816405015999, 14650.282042885625, 12172.916743578298, 14474.25941257547, 13825.331504252124, 11442.986318336789, 15641.525692637573, 15573.573973163147, 7457.513453205813, 11610.137136554262, 13616.243600394188, 15812.685653584962, 13292.133901289351, 12041.132226215592, 10827.063477892247, 16650.935687054676, 11144.555058787657, 6292.152188030168, 17939.415994542316, 13453.063632286998, 8622.40903802371, 13913.404727436158, 5009.91640010805, 10325.257062394769, 9058.18779048439, 10168.467093470888, 14874.313561597832, 9619.4802853672, 12882.798866897, 11751.70419362442, 13987.522490907108, 5869.332088051973, 15416.719500856329, 15905.455039496974, 9729.915379118469, 9795.185213723089, 10376.048647567073, 10374.288998531774, 7540.801120988041, 11195.027692621967, 7889.493417096646, 15249.262546134301, 11316.551455543293, 12079.557230064049, 7954.157960894936, 16027.701688834615, 7432.93725098695, 15242.947511617815, 7652.806801979603, 13858.3549889118, 12257.034350513022, 6789.573586820799, 12345.083633715822, 10987.99553818355, 16196.184828711921, 9695.972018178072, 12046.832878135017, 6716.961895621989, 3600.0, 12591.738755788654, 12969.977560152049, 10373.768518339512, 12146.632137082706, 13729.047217750787, 8128.841206552566, 10200.190206810123, 14198.420625124552, 12009.651012033231, 11434.306257666609, 15188.998584928147, 12823.756150911006, 9235.965814738327, 11581.269468638868, 12465.470017174346, 12421.94341751609, 13908.783349937701, 11531.092985975607, 17484.440870850864, 17563.48350732537, 10353.582058580469, 12034.334517716816, 10335.972004138268, 7765.894690729212, 11632.068164106833, 10718.094493236342, 9072.051411703625, 8625.26449076613, 10184.776127233104, 10927.260081980192, 4600.0, 10675.143894194422, 13791.338229299636, 12843.894864165362, 12678.273919555424, 9168.171495340328, 19036.42530690923, 10860.359938056601, 4944.159223007438, 12430.623276860097], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5160.61288826262, 5160.61288826262, 4019.4082025079997, 4019.4082025079997, 7325.141021442803, 7325.141021442803, 6086.458371789151, 6086.458371789151, 7237.129706287737, 7237.129706287737, 6912.66575212606, 6912.66575212606, 5721.4931591684, 5721.4931591684, 7820.762846318787, 7820.762846318787, 7786.786986581563, 7786.786986581563, 3728.7567266029064, 3728.7567266029064, 5805.068568277142, 5805.068568277142, 6808.121800197088, 6808.121800197088, 7906.342826792481, 7906.342826792481, 6646.066950644681, 6646.066950644681, 6020.566113107802, 6020.566113107802, 5413.531738946143, 5413.531738946143, 8325.46784352733, 8325.46784352733, 5572.277529393823, 5572.277529393823, 3146.076094015084, 3146.076094015084, 8969.707997271153, 8969.707997271153, 6726.5318161435025, 6726.5318161435025, 4311.204519011856, 4311.204519011856, 6956.702363718066, 6956.702363718066, 2504.9582000540267, 2504.9582000540267, 5162.628531197381, 5162.628531197381, 4529.093895242202, 4529.093895242202, 5084.23354673544, 5084.23354673544, 7437.15678079891, 7437.15678079891, 4809.7401426836, 4809.7401426836, 6441.399433448496, 6441.399433448496, 5875.852096812228, 5875.852096812228, 6993.761245453545, 6993.761245453545, 2934.6660440259866, 2934.6660440259866, 7708.3597504281715, 7708.3597504281715, 7952.727519748485, 7952.727519748485, 4864.957689559233, 4864.957689559233, 4897.592606861542, 4897.592606861542, 5188.024323783555, 5188.024323783555, 5187.1444992659, 5187.1444992659, 3770.4005604940203, 3770.4005604940203, 5597.513846310986, 5597.513846310986, 3944.746708548323, 3944.746708548323, 7624.631273067129, 7624.631273067129, 5658.275727771642, 5658.275727771642, 6039.778615032031, 6039.778615032031, 3977.078980447468, 3977.078980447468, 8013.850844417311, 8013.850844417311, 3716.468625493475, 3716.468625493475, 7621.473755808924, 7621.473755808924, 3826.4034009898005, 3826.4034009898005, 6929.1774944558965, 6929.1774944558965, 6128.517175256522, 6128.517175256522, 3394.7867934103997, 3394.7867934103997, 6172.541816857907, 6172.541816857907, 5493.997769091795, 5493.997769091795, 8098.0924143559805, 8098.0924143559805, 4847.9860090890415, 4847.9860090890415, 6023.416439067527, 6023.416439067527, 3358.4809478109946, 3358.4809478109946, 1800.0, 1800.0, 6295.869377894322, 6295.869377894322, 6484.988780076033, 6484.988780076033, 5186.884259169753, 5186.884259169753, 6073.316068541344, 6073.316068541344, 6864.523608875388, 6864.523608875388, 4064.420603276283, 4064.420603276283, 5100.095103405066, 5100.095103405066, 7099.210312562289, 7099.210312562289, 6004.825506016628, 6004.825506016628, 5717.153128833311, 5717.153128833311, 7594.499292464077, 7594.499292464077, 6411.878075455483, 6411.878075455483, 4617.982907369163, 4617.982907369163, 5790.63473431944, 5790.63473431944, 6232.735008587169, 6232.735008587169, 6210.971708758054, 6210.971708758054, 6954.391674968872, 6954.391674968872, 5765.546492987806, 5765.546492987806, 8742.220435425443, 8742.220435425443, 8781.741753662685, 8781.741753662685, 5176.791029290234, 5176.791029290234, 6017.167258858416, 6017.167258858416, 5167.986002069129, 5167.986002069129, 3882.947345364606, 3882.947345364606, 5816.034082053414, 5816.034082053414, 5359.047246618156, 5359.047246618156, 4536.025705851818, 4536.025705851818, 4312.632245383054, 4312.632245383054, 5092.3880636165395, 5092.3880636165395, 5463.630040990094, 5463.630040990094, 2300.0, 2300.0, 5337.571947097207, 5337.571947097207, 6895.6691146498215, 6895.6691146498215, 6421.947432082692, 6421.947432082692, 6339.136959777687, 6339.136959777687, 4584.0857476701685, 4584.0857476701685, 9518.212653454597, 9518.212653454597, 5430.179969028293, 5430.179969028293, 2472.0796115037137, 2472.0796115037137, 6215.311638430045, 6215.311638430045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2522276177633998, "mean_inference_ms": 1.2057151987370018, "mean_action_processing_ms": 0.13446852941922735, "mean_env_wait_ms": 3.3821146377485207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 444800, "timesteps_this_iter": 0, "agent_timesteps_total": 889600, "timers": {"sample_time_ms": 1872.448, "sample_throughput": 1708.993, "load_time_ms": 0.135, "load_throughput": 23772179.95, "learn_time_ms": 66.388, "learn_throughput": 48201.405, "update_time_ms": 1.497}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6837598.0, "policy_entropy": 35459.18359375, "policy_loss": 2404281.5, "vf_loss": 44798780.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 444800, "num_agent_steps_sampled": 889600, "num_steps_trained": 444800, "num_agent_steps_trained": 889600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 550, "training_iteration": 24, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-59-40", "timestamp": 1718794780, "time_this_iter_s": 11.285117864608765, "time_total_s": 259.80954122543335, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9af70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 259.80954122543335, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 58.54705882352942, "ram_util_percent": 33.27058823529411}}
{"episode_reward_max": 19036.42530690923, "episode_reward_min": 3600.0, "episode_reward_mean": 11500.435216483767, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 1800.0}, "policy_reward_max": {"shared_policy": 9518.212653454597}, "policy_reward_mean": {"shared_policy": 5750.217608241884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11751.70419362442, 13987.522490907108, 5869.332088051973, 15416.719500856329, 15905.455039496974, 9729.915379118469, 9795.185213723089, 10376.048647567073, 10374.288998531774, 7540.801120988041, 11195.027692621967, 7889.493417096646, 15249.262546134301, 11316.551455543293, 12079.557230064049, 7954.157960894936, 16027.701688834615, 7432.93725098695, 15242.947511617815, 7652.806801979603, 13858.3549889118, 12257.034350513022, 6789.573586820799, 12345.083633715822, 10987.99553818355, 16196.184828711921, 9695.972018178072, 12046.832878135017, 6716.961895621989, 3600.0, 12591.738755788654, 12969.977560152049, 10373.768518339512, 12146.632137082706, 13729.047217750787, 8128.841206552566, 10200.190206810123, 14198.420625124552, 12009.651012033231, 11434.306257666609, 15188.998584928147, 12823.756150911006, 9235.965814738327, 11581.269468638868, 12465.470017174346, 12421.94341751609, 13908.783349937701, 11531.092985975607, 17484.440870850864, 17563.48350732537, 10353.582058580469, 12034.334517716816, 10335.972004138268, 7765.894690729212, 11632.068164106833, 10718.094493236342, 9072.051411703625, 8625.26449076613, 10184.776127233104, 10927.260081980192, 4600.0, 10675.143894194422, 13791.338229299636, 12843.894864165362, 12678.273919555424, 9168.171495340328, 19036.42530690923, 10860.359938056601, 4944.159223007438, 12430.623276860097, 11596.399823583757, 12514.074578289605, 10028.192117306658, 12405.581204259808, 15984.114446863558, 12203.576460776454, 9837.30271920175, 9271.01664301473, 7126.626231596467, 8183.627399306566, 15005.11591267896, 11711.05989193438, 8807.794858336118, 11035.512503341248, 10580.879272582682, 16530.09547527448, 7720.987991255577, 13063.879271216607, 16019.071963211234, 15176.744243243913, 15910.233730325803, 8895.281107820323, 11377.640313041473, 15596.553114971928, 7218.450828275891, 18152.067105942908, 11470.775044742633, 15172.489637496154, 8158.110899861887, 11343.391058315083], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5875.852096812228, 5875.852096812228, 6993.761245453545, 6993.761245453545, 2934.6660440259866, 2934.6660440259866, 7708.3597504281715, 7708.3597504281715, 7952.727519748485, 7952.727519748485, 4864.957689559233, 4864.957689559233, 4897.592606861542, 4897.592606861542, 5188.024323783555, 5188.024323783555, 5187.1444992659, 5187.1444992659, 3770.4005604940203, 3770.4005604940203, 5597.513846310986, 5597.513846310986, 3944.746708548323, 3944.746708548323, 7624.631273067129, 7624.631273067129, 5658.275727771642, 5658.275727771642, 6039.778615032031, 6039.778615032031, 3977.078980447468, 3977.078980447468, 8013.850844417311, 8013.850844417311, 3716.468625493475, 3716.468625493475, 7621.473755808924, 7621.473755808924, 3826.4034009898005, 3826.4034009898005, 6929.1774944558965, 6929.1774944558965, 6128.517175256522, 6128.517175256522, 3394.7867934103997, 3394.7867934103997, 6172.541816857907, 6172.541816857907, 5493.997769091795, 5493.997769091795, 8098.0924143559805, 8098.0924143559805, 4847.9860090890415, 4847.9860090890415, 6023.416439067527, 6023.416439067527, 3358.4809478109946, 3358.4809478109946, 1800.0, 1800.0, 6295.869377894322, 6295.869377894322, 6484.988780076033, 6484.988780076033, 5186.884259169753, 5186.884259169753, 6073.316068541344, 6073.316068541344, 6864.523608875388, 6864.523608875388, 4064.420603276283, 4064.420603276283, 5100.095103405066, 5100.095103405066, 7099.210312562289, 7099.210312562289, 6004.825506016628, 6004.825506016628, 5717.153128833311, 5717.153128833311, 7594.499292464077, 7594.499292464077, 6411.878075455483, 6411.878075455483, 4617.982907369163, 4617.982907369163, 5790.63473431944, 5790.63473431944, 6232.735008587169, 6232.735008587169, 6210.971708758054, 6210.971708758054, 6954.391674968872, 6954.391674968872, 5765.546492987806, 5765.546492987806, 8742.220435425443, 8742.220435425443, 8781.741753662685, 8781.741753662685, 5176.791029290234, 5176.791029290234, 6017.167258858416, 6017.167258858416, 5167.986002069129, 5167.986002069129, 3882.947345364606, 3882.947345364606, 5816.034082053414, 5816.034082053414, 5359.047246618156, 5359.047246618156, 4536.025705851818, 4536.025705851818, 4312.632245383054, 4312.632245383054, 5092.3880636165395, 5092.3880636165395, 5463.630040990094, 5463.630040990094, 2300.0, 2300.0, 5337.571947097207, 5337.571947097207, 6895.6691146498215, 6895.6691146498215, 6421.947432082692, 6421.947432082692, 6339.136959777687, 6339.136959777687, 4584.0857476701685, 4584.0857476701685, 9518.212653454597, 9518.212653454597, 5430.179969028293, 5430.179969028293, 2472.0796115037137, 2472.0796115037137, 6215.311638430045, 6215.311638430045, 5798.19991179188, 5798.19991179188, 6257.037289144813, 6257.037289144813, 5014.096058653328, 5014.096058653328, 6202.790602129913, 6202.790602129913, 7992.057223431781, 7992.057223431781, 6101.788230388223, 6101.788230388223, 4918.6513596008745, 4918.6513596008745, 4635.508321507353, 4635.508321507353, 3563.3131157982352, 3563.3131157982352, 4091.8136996532776, 4091.8136996532776, 7502.557956339471, 7502.557956339471, 5855.529945967193, 5855.529945967193, 4403.897429168059, 4403.897429168059, 5517.7562516706275, 5517.7562516706275, 5290.439636291345, 5290.439636291345, 8265.04773763724, 8265.04773763724, 3860.4939956277885, 3860.4939956277885, 6531.939635608291, 6531.939635608291, 8009.535981605601, 8009.535981605601, 7588.372121621947, 7588.372121621947, 7955.116865162898, 7955.116865162898, 4447.64055391016, 4447.64055391016, 5688.820156520751, 5688.820156520751, 7798.276557485964, 7798.276557485964, 3609.2254141379453, 3609.2254141379453, 9076.033552971447, 9076.033552971447, 5735.3875223713185, 5735.3875223713185, 7586.244818748077, 7586.244818748077, 4079.0554499309437, 4079.0554499309437, 5671.695529157523, 5671.695529157523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25225273177446206, "mean_inference_ms": 1.2057848798012183, "mean_action_processing_ms": 0.13450943304652405, "mean_env_wait_ms": 3.380446485464548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 464000, "timesteps_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"sample_time_ms": 1884.655, "sample_throughput": 1697.923, "load_time_ms": 0.135, "load_throughput": 23763762.04, "learn_time_ms": 65.746, "learn_throughput": 48672.288, "update_time_ms": 1.453}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5910934.5, "policy_entropy": 34144.4921875, "policy_loss": 1938624.0, "vf_loss": 41640808.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 464000, "num_agent_steps_sampled": 928000, "num_steps_trained": 464000, "num_agent_steps_trained": 928000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 580, "training_iteration": 25, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_19-59-51", "timestamp": 1718794791, "time_this_iter_s": 11.349745273590088, "time_total_s": 271.15928649902344, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf08dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 271.15928649902344, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 58.262499999999996, "ram_util_percent": 33.2375}}
{"episode_reward_max": 19036.42530690923, "episode_reward_min": 3600.0, "episode_reward_mean": 11868.962178896367, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 1800.0}, "policy_reward_max": {"shared_policy": 9518.212653454597}, "policy_reward_mean": {"shared_policy": 5934.481089448183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13858.3549889118, 12257.034350513022, 6789.573586820799, 12345.083633715822, 10987.99553818355, 16196.184828711921, 9695.972018178072, 12046.832878135017, 6716.961895621989, 3600.0, 12591.738755788654, 12969.977560152049, 10373.768518339512, 12146.632137082706, 13729.047217750787, 8128.841206552566, 10200.190206810123, 14198.420625124552, 12009.651012033231, 11434.306257666609, 15188.998584928147, 12823.756150911006, 9235.965814738327, 11581.269468638868, 12465.470017174346, 12421.94341751609, 13908.783349937701, 11531.092985975607, 17484.440870850864, 17563.48350732537, 10353.582058580469, 12034.334517716816, 10335.972004138268, 7765.894690729212, 11632.068164106833, 10718.094493236342, 9072.051411703625, 8625.26449076613, 10184.776127233104, 10927.260081980192, 4600.0, 10675.143894194422, 13791.338229299636, 12843.894864165362, 12678.273919555424, 9168.171495340328, 19036.42530690923, 10860.359938056601, 4944.159223007438, 12430.623276860097, 11596.399823583757, 12514.074578289605, 10028.192117306658, 12405.581204259808, 15984.114446863558, 12203.576460776454, 9837.30271920175, 9271.01664301473, 7126.626231596467, 8183.627399306566, 15005.11591267896, 11711.05989193438, 8807.794858336118, 11035.512503341248, 10580.879272582682, 16530.09547527448, 7720.987991255577, 13063.879271216607, 16019.071963211234, 15176.744243243913, 15910.233730325803, 8895.281107820323, 11377.640313041473, 15596.553114971928, 7218.450828275891, 18152.067105942908, 11470.775044742633, 15172.489637496154, 8158.110899861887, 11343.391058315083, 11501.300617706285, 11117.703876633375, 14633.195775205651, 12335.983234184085, 10462.515481118502, 13629.265431122436, 16011.49655149419, 18127.337471683037, 10923.11201456037, 15230.474306767002, 11815.595114796874, 13266.540658136419, 8017.579479660219, 13585.180625102657, 12237.64280075672, 14288.928891141415, 11830.894807835099, 12364.825111096878, 15990.816501507885, 12269.72371939048], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6929.1774944558965, 6929.1774944558965, 6128.517175256522, 6128.517175256522, 3394.7867934103997, 3394.7867934103997, 6172.541816857907, 6172.541816857907, 5493.997769091795, 5493.997769091795, 8098.0924143559805, 8098.0924143559805, 4847.9860090890415, 4847.9860090890415, 6023.416439067527, 6023.416439067527, 3358.4809478109946, 3358.4809478109946, 1800.0, 1800.0, 6295.869377894322, 6295.869377894322, 6484.988780076033, 6484.988780076033, 5186.884259169753, 5186.884259169753, 6073.316068541344, 6073.316068541344, 6864.523608875388, 6864.523608875388, 4064.420603276283, 4064.420603276283, 5100.095103405066, 5100.095103405066, 7099.210312562289, 7099.210312562289, 6004.825506016628, 6004.825506016628, 5717.153128833311, 5717.153128833311, 7594.499292464077, 7594.499292464077, 6411.878075455483, 6411.878075455483, 4617.982907369163, 4617.982907369163, 5790.63473431944, 5790.63473431944, 6232.735008587169, 6232.735008587169, 6210.971708758054, 6210.971708758054, 6954.391674968872, 6954.391674968872, 5765.546492987806, 5765.546492987806, 8742.220435425443, 8742.220435425443, 8781.741753662685, 8781.741753662685, 5176.791029290234, 5176.791029290234, 6017.167258858416, 6017.167258858416, 5167.986002069129, 5167.986002069129, 3882.947345364606, 3882.947345364606, 5816.034082053414, 5816.034082053414, 5359.047246618156, 5359.047246618156, 4536.025705851818, 4536.025705851818, 4312.632245383054, 4312.632245383054, 5092.3880636165395, 5092.3880636165395, 5463.630040990094, 5463.630040990094, 2300.0, 2300.0, 5337.571947097207, 5337.571947097207, 6895.6691146498215, 6895.6691146498215, 6421.947432082692, 6421.947432082692, 6339.136959777687, 6339.136959777687, 4584.0857476701685, 4584.0857476701685, 9518.212653454597, 9518.212653454597, 5430.179969028293, 5430.179969028293, 2472.0796115037137, 2472.0796115037137, 6215.311638430045, 6215.311638430045, 5798.19991179188, 5798.19991179188, 6257.037289144813, 6257.037289144813, 5014.096058653328, 5014.096058653328, 6202.790602129913, 6202.790602129913, 7992.057223431781, 7992.057223431781, 6101.788230388223, 6101.788230388223, 4918.6513596008745, 4918.6513596008745, 4635.508321507353, 4635.508321507353, 3563.3131157982352, 3563.3131157982352, 4091.8136996532776, 4091.8136996532776, 7502.557956339471, 7502.557956339471, 5855.529945967193, 5855.529945967193, 4403.897429168059, 4403.897429168059, 5517.7562516706275, 5517.7562516706275, 5290.439636291345, 5290.439636291345, 8265.04773763724, 8265.04773763724, 3860.4939956277885, 3860.4939956277885, 6531.939635608291, 6531.939635608291, 8009.535981605601, 8009.535981605601, 7588.372121621947, 7588.372121621947, 7955.116865162898, 7955.116865162898, 4447.64055391016, 4447.64055391016, 5688.820156520751, 5688.820156520751, 7798.276557485964, 7798.276557485964, 3609.2254141379453, 3609.2254141379453, 9076.033552971447, 9076.033552971447, 5735.3875223713185, 5735.3875223713185, 7586.244818748077, 7586.244818748077, 4079.0554499309437, 4079.0554499309437, 5671.695529157523, 5671.695529157523, 5750.650308853141, 5750.650308853141, 5558.851938316695, 5558.851938316695, 7316.597887602826, 7316.597887602826, 6167.991617092042, 6167.991617092042, 5231.257740559246, 5231.257740559246, 6814.6327155612125, 6814.6327155612125, 8005.748275747086, 8005.748275747086, 9063.668735841506, 9063.668735841506, 5461.556007280189, 5461.556007280189, 7615.237153383518, 7615.237153383518, 5907.7975573984495, 5907.7975573984495, 6633.270329068206, 6633.270329068206, 4008.7897398301093, 4008.7897398301093, 6792.590312551336, 6792.590312551336, 6118.821400378356, 6118.821400378356, 7144.464445570709, 7144.464445570709, 5915.447403917549, 5915.447403917549, 6182.412555548438, 6182.412555548438, 7995.408250753933, 7995.408250753933, 6134.861859695226, 6134.861859695226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25228519595448706, "mean_inference_ms": 1.2057988670402289, "mean_action_processing_ms": 0.1345104538047487, "mean_env_wait_ms": 3.381002657204718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 483200, "timesteps_this_iter": 0, "agent_timesteps_total": 966400, "timers": {"sample_time_ms": 1900.289, "sample_throughput": 1683.954, "load_time_ms": 0.133, "load_throughput": 23993158.384, "learn_time_ms": 65.024, "learn_throughput": 49212.747, "update_time_ms": 1.381}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9281428.0, "policy_entropy": 33591.39453125, "policy_loss": 3065484.75, "vf_loss": 63797924.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 483200, "num_agent_steps_sampled": 966400, "num_steps_trained": 483200, "num_agent_steps_trained": 966400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 26, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-00-02", "timestamp": 1718794802, "time_this_iter_s": 11.31521487236023, "time_total_s": 282.47450137138367, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 282.47450137138367, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 58.74375, "ram_util_percent": 33.28125}}
{"episode_reward_max": 19036.42530690923, "episode_reward_min": 4600.0, "episode_reward_mean": 12054.107897169428, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2300.0}, "policy_reward_max": {"shared_policy": 9518.212653454597}, "policy_reward_mean": {"shared_policy": 6027.053948584711}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15188.998584928147, 12823.756150911006, 9235.965814738327, 11581.269468638868, 12465.470017174346, 12421.94341751609, 13908.783349937701, 11531.092985975607, 17484.440870850864, 17563.48350732537, 10353.582058580469, 12034.334517716816, 10335.972004138268, 7765.894690729212, 11632.068164106833, 10718.094493236342, 9072.051411703625, 8625.26449076613, 10184.776127233104, 10927.260081980192, 4600.0, 10675.143894194422, 13791.338229299636, 12843.894864165362, 12678.273919555424, 9168.171495340328, 19036.42530690923, 10860.359938056601, 4944.159223007438, 12430.623276860097, 11596.399823583757, 12514.074578289605, 10028.192117306658, 12405.581204259808, 15984.114446863558, 12203.576460776454, 9837.30271920175, 9271.01664301473, 7126.626231596467, 8183.627399306566, 15005.11591267896, 11711.05989193438, 8807.794858336118, 11035.512503341248, 10580.879272582682, 16530.09547527448, 7720.987991255577, 13063.879271216607, 16019.071963211234, 15176.744243243913, 15910.233730325803, 8895.281107820323, 11377.640313041473, 15596.553114971928, 7218.450828275891, 18152.067105942908, 11470.775044742633, 15172.489637496154, 8158.110899861887, 11343.391058315083, 11501.300617706285, 11117.703876633375, 14633.195775205651, 12335.983234184085, 10462.515481118502, 13629.265431122436, 16011.49655149419, 18127.337471683037, 10923.11201456037, 15230.474306767002, 11815.595114796874, 13266.540658136419, 8017.579479660219, 13585.180625102657, 12237.64280075672, 14288.928891141415, 11830.894807835099, 12364.825111096878, 15990.816501507885, 12269.72371939048, 10707.651606856707, 4800.0, 14826.51620656209, 16054.751945059477, 16950.77622842222, 10780.417144080686, 14387.446711643479, 14349.52194182948, 14100.291724855804, 10251.532307257039, 5200.0, 11742.743084340647, 7606.861456784674, 11322.230676885913, 15766.279617944216, 13018.42369291151, 13033.537133081187, 17069.516543722508, 5580.078024606986, 13242.562996553967], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7594.499292464077, 7594.499292464077, 6411.878075455483, 6411.878075455483, 4617.982907369163, 4617.982907369163, 5790.63473431944, 5790.63473431944, 6232.735008587169, 6232.735008587169, 6210.971708758054, 6210.971708758054, 6954.391674968872, 6954.391674968872, 5765.546492987806, 5765.546492987806, 8742.220435425443, 8742.220435425443, 8781.741753662685, 8781.741753662685, 5176.791029290234, 5176.791029290234, 6017.167258858416, 6017.167258858416, 5167.986002069129, 5167.986002069129, 3882.947345364606, 3882.947345364606, 5816.034082053414, 5816.034082053414, 5359.047246618156, 5359.047246618156, 4536.025705851818, 4536.025705851818, 4312.632245383054, 4312.632245383054, 5092.3880636165395, 5092.3880636165395, 5463.630040990094, 5463.630040990094, 2300.0, 2300.0, 5337.571947097207, 5337.571947097207, 6895.6691146498215, 6895.6691146498215, 6421.947432082692, 6421.947432082692, 6339.136959777687, 6339.136959777687, 4584.0857476701685, 4584.0857476701685, 9518.212653454597, 9518.212653454597, 5430.179969028293, 5430.179969028293, 2472.0796115037137, 2472.0796115037137, 6215.311638430045, 6215.311638430045, 5798.19991179188, 5798.19991179188, 6257.037289144813, 6257.037289144813, 5014.096058653328, 5014.096058653328, 6202.790602129913, 6202.790602129913, 7992.057223431781, 7992.057223431781, 6101.788230388223, 6101.788230388223, 4918.6513596008745, 4918.6513596008745, 4635.508321507353, 4635.508321507353, 3563.3131157982352, 3563.3131157982352, 4091.8136996532776, 4091.8136996532776, 7502.557956339471, 7502.557956339471, 5855.529945967193, 5855.529945967193, 4403.897429168059, 4403.897429168059, 5517.7562516706275, 5517.7562516706275, 5290.439636291345, 5290.439636291345, 8265.04773763724, 8265.04773763724, 3860.4939956277885, 3860.4939956277885, 6531.939635608291, 6531.939635608291, 8009.535981605601, 8009.535981605601, 7588.372121621947, 7588.372121621947, 7955.116865162898, 7955.116865162898, 4447.64055391016, 4447.64055391016, 5688.820156520751, 5688.820156520751, 7798.276557485964, 7798.276557485964, 3609.2254141379453, 3609.2254141379453, 9076.033552971447, 9076.033552971447, 5735.3875223713185, 5735.3875223713185, 7586.244818748077, 7586.244818748077, 4079.0554499309437, 4079.0554499309437, 5671.695529157523, 5671.695529157523, 5750.650308853141, 5750.650308853141, 5558.851938316695, 5558.851938316695, 7316.597887602826, 7316.597887602826, 6167.991617092042, 6167.991617092042, 5231.257740559246, 5231.257740559246, 6814.6327155612125, 6814.6327155612125, 8005.748275747086, 8005.748275747086, 9063.668735841506, 9063.668735841506, 5461.556007280189, 5461.556007280189, 7615.237153383518, 7615.237153383518, 5907.7975573984495, 5907.7975573984495, 6633.270329068206, 6633.270329068206, 4008.7897398301093, 4008.7897398301093, 6792.590312551336, 6792.590312551336, 6118.821400378356, 6118.821400378356, 7144.464445570709, 7144.464445570709, 5915.447403917549, 5915.447403917549, 6182.412555548438, 6182.412555548438, 7995.408250753933, 7995.408250753933, 6134.861859695226, 6134.861859695226, 5353.82580342835, 5353.82580342835, 2400.0, 2400.0, 7413.258103281041, 7413.258103281041, 8027.375972529735, 8027.375972529735, 8475.38811421111, 8475.38811421111, 5390.208572040345, 5390.208572040345, 7193.7233558217395, 7193.7233558217395, 7174.760970914729, 7174.760970914729, 7050.145862427882, 7050.145862427882, 5125.766153628509, 5125.766153628509, 2600.0, 2600.0, 5871.371542170304, 5871.371542170304, 3803.430728392337, 3803.430728392337, 5661.115338442965, 5661.115338442965, 7883.1398089721115, 7883.1398089721115, 6509.211846455753, 6509.211846455753, 6516.768566540606, 6516.768566540606, 8534.758271861258, 8534.758271861258, 2790.039012303494, 2790.039012303494, 6621.281498276992, 6621.281498276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25214445821817405, "mean_inference_ms": 1.2051844124567395, "mean_action_processing_ms": 0.13439012807916734, "mean_env_wait_ms": 3.382415142491956, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 502400, "timesteps_this_iter": 0, "agent_timesteps_total": 1004800, "timers": {"sample_time_ms": 1876.039, "sample_throughput": 1705.722, "load_time_ms": 0.138, "load_throughput": 23241165.022, "learn_time_ms": 63.548, "learn_throughput": 50355.284, "update_time_ms": 1.422}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5768307.5, "policy_entropy": 33166.94921875, "policy_loss": 1907541.75, "vf_loss": 36004596.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 502400, "num_agent_steps_sampled": 1004800, "num_steps_trained": 502400, "num_agent_steps_trained": 1004800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 620, "training_iteration": 27, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-00-14", "timestamp": 1718794814, "time_this_iter_s": 11.115485668182373, "time_total_s": 293.58998703956604, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce868b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 293.58998703956604, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 57.84375, "ram_util_percent": 33.3}}
{"episode_reward_max": 18152.067105942908, "episode_reward_min": 4800.0, "episode_reward_mean": 11739.340158184863, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2400.0}, "policy_reward_max": {"shared_policy": 9076.033552971447}, "policy_reward_mean": {"shared_policy": 5869.670079092429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11596.399823583757, 12514.074578289605, 10028.192117306658, 12405.581204259808, 15984.114446863558, 12203.576460776454, 9837.30271920175, 9271.01664301473, 7126.626231596467, 8183.627399306566, 15005.11591267896, 11711.05989193438, 8807.794858336118, 11035.512503341248, 10580.879272582682, 16530.09547527448, 7720.987991255577, 13063.879271216607, 16019.071963211234, 15176.744243243913, 15910.233730325803, 8895.281107820323, 11377.640313041473, 15596.553114971928, 7218.450828275891, 18152.067105942908, 11470.775044742633, 15172.489637496154, 8158.110899861887, 11343.391058315083, 11501.300617706285, 11117.703876633375, 14633.195775205651, 12335.983234184085, 10462.515481118502, 13629.265431122436, 16011.49655149419, 18127.337471683037, 10923.11201456037, 15230.474306767002, 11815.595114796874, 13266.540658136419, 8017.579479660219, 13585.180625102657, 12237.64280075672, 14288.928891141415, 11830.894807835099, 12364.825111096878, 15990.816501507885, 12269.72371939048, 10707.651606856707, 4800.0, 14826.51620656209, 16054.751945059477, 16950.77622842222, 10780.417144080686, 14387.446711643479, 14349.52194182948, 14100.291724855804, 10251.532307257039, 5200.0, 11742.743084340647, 7606.861456784674, 11322.230676885913, 15766.279617944216, 13018.42369291151, 13033.537133081187, 17069.516543722508, 5580.078024606986, 13242.562996553967, 7512.986245672209, 8650.608133863607, 12938.942402442386, 8256.230103380261, 10892.267733662378, 6084.309062344382, 12290.539369090071, 13457.052827152951, 11951.572673635808, 10316.569730239473, 5000.0, 10086.769370895909, 13123.346660426007, 6000.0, 13403.903634097354, 9640.468376556819, 12074.228397343653, 13519.141716961614, 16546.34286814506, 5400.0, 13343.088470552837, 12010.686307057924, 12664.35370790544, 9860.709920322959, 10770.1750487986, 5400.0, 9713.29568719948, 11523.49271913834, 11323.41854918488, 11651.618741048693], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5798.19991179188, 5798.19991179188, 6257.037289144813, 6257.037289144813, 5014.096058653328, 5014.096058653328, 6202.790602129913, 6202.790602129913, 7992.057223431781, 7992.057223431781, 6101.788230388223, 6101.788230388223, 4918.6513596008745, 4918.6513596008745, 4635.508321507353, 4635.508321507353, 3563.3131157982352, 3563.3131157982352, 4091.8136996532776, 4091.8136996532776, 7502.557956339471, 7502.557956339471, 5855.529945967193, 5855.529945967193, 4403.897429168059, 4403.897429168059, 5517.7562516706275, 5517.7562516706275, 5290.439636291345, 5290.439636291345, 8265.04773763724, 8265.04773763724, 3860.4939956277885, 3860.4939956277885, 6531.939635608291, 6531.939635608291, 8009.535981605601, 8009.535981605601, 7588.372121621947, 7588.372121621947, 7955.116865162898, 7955.116865162898, 4447.64055391016, 4447.64055391016, 5688.820156520751, 5688.820156520751, 7798.276557485964, 7798.276557485964, 3609.2254141379453, 3609.2254141379453, 9076.033552971447, 9076.033552971447, 5735.3875223713185, 5735.3875223713185, 7586.244818748077, 7586.244818748077, 4079.0554499309437, 4079.0554499309437, 5671.695529157523, 5671.695529157523, 5750.650308853141, 5750.650308853141, 5558.851938316695, 5558.851938316695, 7316.597887602826, 7316.597887602826, 6167.991617092042, 6167.991617092042, 5231.257740559246, 5231.257740559246, 6814.6327155612125, 6814.6327155612125, 8005.748275747086, 8005.748275747086, 9063.668735841506, 9063.668735841506, 5461.556007280189, 5461.556007280189, 7615.237153383518, 7615.237153383518, 5907.7975573984495, 5907.7975573984495, 6633.270329068206, 6633.270329068206, 4008.7897398301093, 4008.7897398301093, 6792.590312551336, 6792.590312551336, 6118.821400378356, 6118.821400378356, 7144.464445570709, 7144.464445570709, 5915.447403917549, 5915.447403917549, 6182.412555548438, 6182.412555548438, 7995.408250753933, 7995.408250753933, 6134.861859695226, 6134.861859695226, 5353.82580342835, 5353.82580342835, 2400.0, 2400.0, 7413.258103281041, 7413.258103281041, 8027.375972529735, 8027.375972529735, 8475.38811421111, 8475.38811421111, 5390.208572040345, 5390.208572040345, 7193.7233558217395, 7193.7233558217395, 7174.760970914729, 7174.760970914729, 7050.145862427882, 7050.145862427882, 5125.766153628509, 5125.766153628509, 2600.0, 2600.0, 5871.371542170304, 5871.371542170304, 3803.430728392337, 3803.430728392337, 5661.115338442965, 5661.115338442965, 7883.1398089721115, 7883.1398089721115, 6509.211846455753, 6509.211846455753, 6516.768566540606, 6516.768566540606, 8534.758271861258, 8534.758271861258, 2790.039012303494, 2790.039012303494, 6621.281498276992, 6621.281498276992, 3756.4931228361056, 3756.4931228361056, 4325.304066931796, 4325.304066931796, 6469.471201221195, 6469.471201221195, 4128.115051690131, 4128.115051690131, 5446.133866831192, 5446.133866831192, 3042.154531172191, 3042.154531172191, 6145.269684545044, 6145.269684545044, 6728.526413576481, 6728.526413576481, 5975.786336817892, 5975.786336817892, 5158.284865119736, 5158.284865119736, 2500.0, 2500.0, 5043.384685447956, 5043.384685447956, 6561.673330213003, 6561.673330213003, 3000.0, 3000.0, 6701.951817048672, 6701.951817048672, 4820.23418827841, 4820.23418827841, 6037.114198671816, 6037.114198671816, 6759.570858480816, 6759.570858480816, 8273.171434072527, 8273.171434072527, 2700.0, 2700.0, 6671.544235276422, 6671.544235276422, 6005.343153528963, 6005.343153528963, 6332.176853952717, 6332.176853952717, 4930.354960161468, 4930.354960161468, 5385.087524399305, 5385.087524399305, 2700.0, 2700.0, 4856.647843599766, 4856.647843599766, 5761.746359569172, 5761.746359569172, 5661.709274592445, 5661.709274592445, 5825.809370524337, 5825.809370524337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25221400784151243, "mean_inference_ms": 1.2053849110835992, "mean_action_processing_ms": 0.13445980101082136, "mean_env_wait_ms": 3.381295084427228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 521600, "timesteps_this_iter": 0, "agent_timesteps_total": 1043200, "timers": {"sample_time_ms": 1845.696, "sample_throughput": 1733.763, "load_time_ms": 0.134, "load_throughput": 23963172.291, "learn_time_ms": 63.205, "learn_throughput": 50628.559, "update_time_ms": 1.455}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7457381.0, "policy_entropy": 33729.51171875, "policy_loss": 2442336.75, "vf_loss": 49658856.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 521600, "num_agent_steps_sampled": 1043200, "num_steps_trained": 521600, "num_agent_steps_trained": 1043200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 650, "training_iteration": 28, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-00-25", "timestamp": 1718794825, "time_this_iter_s": 11.081018209457397, "time_total_s": 304.67100524902344, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce864c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 304.67100524902344, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.6125, "ram_util_percent": 33.3}}
{"episode_reward_max": 18152.067105942908, "episode_reward_min": 4800.0, "episode_reward_mean": 11611.834890375649, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2400.0}, "policy_reward_max": {"shared_policy": 9076.033552971447}, "policy_reward_mean": {"shared_policy": 5805.917445187823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15910.233730325803, 8895.281107820323, 11377.640313041473, 15596.553114971928, 7218.450828275891, 18152.067105942908, 11470.775044742633, 15172.489637496154, 8158.110899861887, 11343.391058315083, 11501.300617706285, 11117.703876633375, 14633.195775205651, 12335.983234184085, 10462.515481118502, 13629.265431122436, 16011.49655149419, 18127.337471683037, 10923.11201456037, 15230.474306767002, 11815.595114796874, 13266.540658136419, 8017.579479660219, 13585.180625102657, 12237.64280075672, 14288.928891141415, 11830.894807835099, 12364.825111096878, 15990.816501507885, 12269.72371939048, 10707.651606856707, 4800.0, 14826.51620656209, 16054.751945059477, 16950.77622842222, 10780.417144080686, 14387.446711643479, 14349.52194182948, 14100.291724855804, 10251.532307257039, 5200.0, 11742.743084340647, 7606.861456784674, 11322.230676885913, 15766.279617944216, 13018.42369291151, 13033.537133081187, 17069.516543722508, 5580.078024606986, 13242.562996553967, 7512.986245672209, 8650.608133863607, 12938.942402442386, 8256.230103380261, 10892.267733662378, 6084.309062344382, 12290.539369090071, 13457.052827152951, 11951.572673635808, 10316.569730239473, 5000.0, 10086.769370895909, 13123.346660426007, 6000.0, 13403.903634097354, 9640.468376556819, 12074.228397343653, 13519.141716961614, 16546.34286814506, 5400.0, 13343.088470552837, 12010.686307057924, 12664.35370790544, 9860.709920322959, 10770.1750487986, 5400.0, 9713.29568719948, 11523.49271913834, 11323.41854918488, 11651.618741048693, 13176.85398793155, 12217.418424610485, 13978.242169637142, 12928.94337922809, 9616.17087536995, 8573.989828606725, 10247.902786767954, 13375.90969398283, 13369.032963103953, 6697.623531122144, 9930.23238508002, 11716.709578049842, 14449.407109773194, 8398.952412479968, 9815.317303971344, 14771.38380819028, 9067.955262801617, 13239.856378073193, 8342.066433263491, 8137.1579143099025], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7955.116865162898, 7955.116865162898, 4447.64055391016, 4447.64055391016, 5688.820156520751, 5688.820156520751, 7798.276557485964, 7798.276557485964, 3609.2254141379453, 3609.2254141379453, 9076.033552971447, 9076.033552971447, 5735.3875223713185, 5735.3875223713185, 7586.244818748077, 7586.244818748077, 4079.0554499309437, 4079.0554499309437, 5671.695529157523, 5671.695529157523, 5750.650308853141, 5750.650308853141, 5558.851938316695, 5558.851938316695, 7316.597887602826, 7316.597887602826, 6167.991617092042, 6167.991617092042, 5231.257740559246, 5231.257740559246, 6814.6327155612125, 6814.6327155612125, 8005.748275747086, 8005.748275747086, 9063.668735841506, 9063.668735841506, 5461.556007280189, 5461.556007280189, 7615.237153383518, 7615.237153383518, 5907.7975573984495, 5907.7975573984495, 6633.270329068206, 6633.270329068206, 4008.7897398301093, 4008.7897398301093, 6792.590312551336, 6792.590312551336, 6118.821400378356, 6118.821400378356, 7144.464445570709, 7144.464445570709, 5915.447403917549, 5915.447403917549, 6182.412555548438, 6182.412555548438, 7995.408250753933, 7995.408250753933, 6134.861859695226, 6134.861859695226, 5353.82580342835, 5353.82580342835, 2400.0, 2400.0, 7413.258103281041, 7413.258103281041, 8027.375972529735, 8027.375972529735, 8475.38811421111, 8475.38811421111, 5390.208572040345, 5390.208572040345, 7193.7233558217395, 7193.7233558217395, 7174.760970914729, 7174.760970914729, 7050.145862427882, 7050.145862427882, 5125.766153628509, 5125.766153628509, 2600.0, 2600.0, 5871.371542170304, 5871.371542170304, 3803.430728392337, 3803.430728392337, 5661.115338442965, 5661.115338442965, 7883.1398089721115, 7883.1398089721115, 6509.211846455753, 6509.211846455753, 6516.768566540606, 6516.768566540606, 8534.758271861258, 8534.758271861258, 2790.039012303494, 2790.039012303494, 6621.281498276992, 6621.281498276992, 3756.4931228361056, 3756.4931228361056, 4325.304066931796, 4325.304066931796, 6469.471201221195, 6469.471201221195, 4128.115051690131, 4128.115051690131, 5446.133866831192, 5446.133866831192, 3042.154531172191, 3042.154531172191, 6145.269684545044, 6145.269684545044, 6728.526413576481, 6728.526413576481, 5975.786336817892, 5975.786336817892, 5158.284865119736, 5158.284865119736, 2500.0, 2500.0, 5043.384685447956, 5043.384685447956, 6561.673330213003, 6561.673330213003, 3000.0, 3000.0, 6701.951817048672, 6701.951817048672, 4820.23418827841, 4820.23418827841, 6037.114198671816, 6037.114198671816, 6759.570858480816, 6759.570858480816, 8273.171434072527, 8273.171434072527, 2700.0, 2700.0, 6671.544235276422, 6671.544235276422, 6005.343153528963, 6005.343153528963, 6332.176853952717, 6332.176853952717, 4930.354960161468, 4930.354960161468, 5385.087524399305, 5385.087524399305, 2700.0, 2700.0, 4856.647843599766, 4856.647843599766, 5761.746359569172, 5761.746359569172, 5661.709274592445, 5661.709274592445, 5825.809370524337, 5825.809370524337, 6588.426993965757, 6588.426993965757, 6108.709212305241, 6108.709212305241, 6989.1210848185765, 6989.1210848185765, 6464.471689614047, 6464.471689614047, 4808.085437684971, 4808.085437684971, 4286.994914303357, 4286.994914303357, 5123.951393383995, 5123.951393383995, 6687.9548469914025, 6687.9548469914025, 6684.516481551975, 6684.516481551975, 3348.811765561072, 3348.811765561072, 4965.116192539999, 4965.116192539999, 5858.354789024896, 5858.354789024896, 7224.703554886593, 7224.703554886593, 4199.476206239982, 4199.476206239982, 4907.658651985663, 4907.658651985663, 7385.691904095147, 7385.691904095147, 4533.977631400818, 4533.977631400818, 6619.928189036607, 6619.928189036607, 4171.033216631745, 4171.033216631745, 4068.5789571549476, 4068.5789571549476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25196970595584206, "mean_inference_ms": 1.2043113013677291, "mean_action_processing_ms": 0.13428717959768613, "mean_env_wait_ms": 3.3813366638534204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 540800, "timesteps_this_iter": 0, "agent_timesteps_total": 1081600, "timers": {"sample_time_ms": 1843.567, "sample_throughput": 1735.766, "load_time_ms": 0.129, "load_throughput": 24827548.65, "learn_time_ms": 63.165, "learn_throughput": 50661.352, "update_time_ms": 1.515}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8221106.0, "policy_entropy": 34323.140625, "policy_loss": 2770576.25, "vf_loss": 57621904.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540800, "num_agent_steps_sampled": 1081600, "num_steps_trained": 540800, "num_agent_steps_trained": 1081600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 670, "training_iteration": 29, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-00-36", "timestamp": 1718794836, "time_this_iter_s": 11.049946069717407, "time_total_s": 315.72095131874084, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9aee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 315.72095131874084, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.40666666666667, "ram_util_percent": 33.300000000000004}}
{"episode_reward_max": 17069.516543722508, "episode_reward_min": 4800.0, "episode_reward_mean": 11368.037656470948, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2400.0}, "policy_reward_max": {"shared_policy": 8534.758271861258}, "policy_reward_mean": {"shared_policy": 5684.018828235474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10707.651606856707, 4800.0, 14826.51620656209, 16054.751945059477, 16950.77622842222, 10780.417144080686, 14387.446711643479, 14349.52194182948, 14100.291724855804, 10251.532307257039, 5200.0, 11742.743084340647, 7606.861456784674, 11322.230676885913, 15766.279617944216, 13018.42369291151, 13033.537133081187, 17069.516543722508, 5580.078024606986, 13242.562996553967, 7512.986245672209, 8650.608133863607, 12938.942402442386, 8256.230103380261, 10892.267733662378, 6084.309062344382, 12290.539369090071, 13457.052827152951, 11951.572673635808, 10316.569730239473, 5000.0, 10086.769370895909, 13123.346660426007, 6000.0, 13403.903634097354, 9640.468376556819, 12074.228397343653, 13519.141716961614, 16546.34286814506, 5400.0, 13343.088470552837, 12010.686307057924, 12664.35370790544, 9860.709920322959, 10770.1750487986, 5400.0, 9713.29568719948, 11523.49271913834, 11323.41854918488, 11651.618741048693, 13176.85398793155, 12217.418424610485, 13978.242169637142, 12928.94337922809, 9616.17087536995, 8573.989828606725, 10247.902786767954, 13375.90969398283, 13369.032963103953, 6697.623531122144, 9930.23238508002, 11716.709578049842, 14449.407109773194, 8398.952412479968, 9815.317303971344, 14771.38380819028, 9067.955262801617, 13239.856378073193, 8342.066433263491, 8137.1579143099025, 15270.842405493451, 15502.308683461422, 11098.823080138769, 12547.241940131422, 7105.446319370678, 14247.660053030526, 11486.867745952728, 8623.360338971408, 9785.419651470223, 15040.340453330617, 12068.656603023406, 15892.254419242323, 9705.972571742186, 9803.248389564655, 11083.271831200196, 15004.906243804475, 12804.72316842563, 12322.407347950972, 5200.0, 11286.782383150501, 14624.071035835866, 16415.09624471722, 14087.053195551987, 9029.604327281279, 14175.703986545734, 13954.168050050572, 9767.935799698545, 12284.274148196495, 9883.855003230052, 8453.08649965996], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5353.82580342835, 5353.82580342835, 2400.0, 2400.0, 7413.258103281041, 7413.258103281041, 8027.375972529735, 8027.375972529735, 8475.38811421111, 8475.38811421111, 5390.208572040345, 5390.208572040345, 7193.7233558217395, 7193.7233558217395, 7174.760970914729, 7174.760970914729, 7050.145862427882, 7050.145862427882, 5125.766153628509, 5125.766153628509, 2600.0, 2600.0, 5871.371542170304, 5871.371542170304, 3803.430728392337, 3803.430728392337, 5661.115338442965, 5661.115338442965, 7883.1398089721115, 7883.1398089721115, 6509.211846455753, 6509.211846455753, 6516.768566540606, 6516.768566540606, 8534.758271861258, 8534.758271861258, 2790.039012303494, 2790.039012303494, 6621.281498276992, 6621.281498276992, 3756.4931228361056, 3756.4931228361056, 4325.304066931796, 4325.304066931796, 6469.471201221195, 6469.471201221195, 4128.115051690131, 4128.115051690131, 5446.133866831192, 5446.133866831192, 3042.154531172191, 3042.154531172191, 6145.269684545044, 6145.269684545044, 6728.526413576481, 6728.526413576481, 5975.786336817892, 5975.786336817892, 5158.284865119736, 5158.284865119736, 2500.0, 2500.0, 5043.384685447956, 5043.384685447956, 6561.673330213003, 6561.673330213003, 3000.0, 3000.0, 6701.951817048672, 6701.951817048672, 4820.23418827841, 4820.23418827841, 6037.114198671816, 6037.114198671816, 6759.570858480816, 6759.570858480816, 8273.171434072527, 8273.171434072527, 2700.0, 2700.0, 6671.544235276422, 6671.544235276422, 6005.343153528963, 6005.343153528963, 6332.176853952717, 6332.176853952717, 4930.354960161468, 4930.354960161468, 5385.087524399305, 5385.087524399305, 2700.0, 2700.0, 4856.647843599766, 4856.647843599766, 5761.746359569172, 5761.746359569172, 5661.709274592445, 5661.709274592445, 5825.809370524337, 5825.809370524337, 6588.426993965757, 6588.426993965757, 6108.709212305241, 6108.709212305241, 6989.1210848185765, 6989.1210848185765, 6464.471689614047, 6464.471689614047, 4808.085437684971, 4808.085437684971, 4286.994914303357, 4286.994914303357, 5123.951393383995, 5123.951393383995, 6687.9548469914025, 6687.9548469914025, 6684.516481551975, 6684.516481551975, 3348.811765561072, 3348.811765561072, 4965.116192539999, 4965.116192539999, 5858.354789024896, 5858.354789024896, 7224.703554886593, 7224.703554886593, 4199.476206239982, 4199.476206239982, 4907.658651985663, 4907.658651985663, 7385.691904095147, 7385.691904095147, 4533.977631400818, 4533.977631400818, 6619.928189036607, 6619.928189036607, 4171.033216631745, 4171.033216631745, 4068.5789571549476, 4068.5789571549476, 7635.42120274672, 7635.42120274672, 7751.154341730733, 7751.154341730733, 5549.411540069377, 5549.411540069377, 6273.620970065711, 6273.620970065711, 3552.723159685339, 3552.723159685339, 7123.830026515268, 7123.830026515268, 5743.433872976362, 5743.433872976362, 4311.6801694857, 4311.6801694857, 4892.7098257351045, 4892.7098257351045, 7520.170226665319, 7520.170226665319, 6034.328301511701, 6034.328301511701, 7946.127209621165, 7946.127209621165, 4852.986285871091, 4852.986285871091, 4901.624194782327, 4901.624194782327, 5541.63591560012, 5541.63591560012, 7502.453121902225, 7502.453121902225, 6402.361584212818, 6402.361584212818, 6161.203673975475, 6161.203673975475, 2600.0, 2600.0, 5643.391191575249, 5643.391191575249, 7312.035517917926, 7312.035517917926, 8207.548122358596, 8207.548122358596, 7043.526597775985, 7043.526597775985, 4514.802163640645, 4514.802163640645, 7087.851993272858, 7087.851993272858, 6977.08402502528, 6977.08402502528, 4883.967899849283, 4883.967899849283, 6142.137074098251, 6142.137074098251, 4941.927501615025, 4941.927501615025, 4226.543249829984, 4226.543249829984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25190370642302734, "mean_inference_ms": 1.2039883334084633, "mean_action_processing_ms": 0.1342889851736815, "mean_env_wait_ms": 3.378223603279905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1120000, "timers": {"sample_time_ms": 1831.868, "sample_throughput": 1746.851, "load_time_ms": 0.132, "load_throughput": 24183374.414, "learn_time_ms": 65.113, "learn_throughput": 49145.299, "update_time_ms": 1.394}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4745818.0, "policy_entropy": 34241.44921875, "policy_loss": 1543658.625, "vf_loss": 33362796.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 1120000, "num_steps_trained": 560000, "num_agent_steps_trained": 1120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 700, "training_iteration": 30, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-00-47", "timestamp": 1718794847, "time_this_iter_s": 11.030726432800293, "time_total_s": 326.75167775154114, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9a9d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 326.75167775154114, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 57.587500000000006, "ram_util_percent": 33.275}}
{"episode_reward_max": 16546.34286814506, "episode_reward_min": 5000.0, "episode_reward_mean": 11120.117517059902, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 8273.171434072527}, "policy_reward_mean": {"shared_policy": 5560.058758529951}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7512.986245672209, 8650.608133863607, 12938.942402442386, 8256.230103380261, 10892.267733662378, 6084.309062344382, 12290.539369090071, 13457.052827152951, 11951.572673635808, 10316.569730239473, 5000.0, 10086.769370895909, 13123.346660426007, 6000.0, 13403.903634097354, 9640.468376556819, 12074.228397343653, 13519.141716961614, 16546.34286814506, 5400.0, 13343.088470552837, 12010.686307057924, 12664.35370790544, 9860.709920322959, 10770.1750487986, 5400.0, 9713.29568719948, 11523.49271913834, 11323.41854918488, 11651.618741048693, 13176.85398793155, 12217.418424610485, 13978.242169637142, 12928.94337922809, 9616.17087536995, 8573.989828606725, 10247.902786767954, 13375.90969398283, 13369.032963103953, 6697.623531122144, 9930.23238508002, 11716.709578049842, 14449.407109773194, 8398.952412479968, 9815.317303971344, 14771.38380819028, 9067.955262801617, 13239.856378073193, 8342.066433263491, 8137.1579143099025, 15270.842405493451, 15502.308683461422, 11098.823080138769, 12547.241940131422, 7105.446319370678, 14247.660053030526, 11486.867745952728, 8623.360338971408, 9785.419651470223, 15040.340453330617, 12068.656603023406, 15892.254419242323, 9705.972571742186, 9803.248389564655, 11083.271831200196, 15004.906243804475, 12804.72316842563, 12322.407347950972, 5200.0, 11286.782383150501, 14624.071035835866, 16415.09624471722, 14087.053195551987, 9029.604327281279, 14175.703986545734, 13954.168050050572, 9767.935799698545, 12284.274148196495, 9883.855003230052, 8453.08649965996, 8194.327266627673, 14193.750642659437, 6200.0, 10491.710907049568, 7574.293730488043, 11738.2606618932, 13263.570073431496, 14857.145513569874, 7258.745476235115, 9141.642258164771, 15858.320676805477, 10608.532791716581, 7983.487223671353, 12689.711776579057, 13407.600380320633, 6579.9852748451995, 13103.216687371714, 11560.130049306797, 13452.836051356735, 7841.8576602014655], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3756.4931228361056, 3756.4931228361056, 4325.304066931796, 4325.304066931796, 6469.471201221195, 6469.471201221195, 4128.115051690131, 4128.115051690131, 5446.133866831192, 5446.133866831192, 3042.154531172191, 3042.154531172191, 6145.269684545044, 6145.269684545044, 6728.526413576481, 6728.526413576481, 5975.786336817892, 5975.786336817892, 5158.284865119736, 5158.284865119736, 2500.0, 2500.0, 5043.384685447956, 5043.384685447956, 6561.673330213003, 6561.673330213003, 3000.0, 3000.0, 6701.951817048672, 6701.951817048672, 4820.23418827841, 4820.23418827841, 6037.114198671816, 6037.114198671816, 6759.570858480816, 6759.570858480816, 8273.171434072527, 8273.171434072527, 2700.0, 2700.0, 6671.544235276422, 6671.544235276422, 6005.343153528963, 6005.343153528963, 6332.176853952717, 6332.176853952717, 4930.354960161468, 4930.354960161468, 5385.087524399305, 5385.087524399305, 2700.0, 2700.0, 4856.647843599766, 4856.647843599766, 5761.746359569172, 5761.746359569172, 5661.709274592445, 5661.709274592445, 5825.809370524337, 5825.809370524337, 6588.426993965757, 6588.426993965757, 6108.709212305241, 6108.709212305241, 6989.1210848185765, 6989.1210848185765, 6464.471689614047, 6464.471689614047, 4808.085437684971, 4808.085437684971, 4286.994914303357, 4286.994914303357, 5123.951393383995, 5123.951393383995, 6687.9548469914025, 6687.9548469914025, 6684.516481551975, 6684.516481551975, 3348.811765561072, 3348.811765561072, 4965.116192539999, 4965.116192539999, 5858.354789024896, 5858.354789024896, 7224.703554886593, 7224.703554886593, 4199.476206239982, 4199.476206239982, 4907.658651985663, 4907.658651985663, 7385.691904095147, 7385.691904095147, 4533.977631400818, 4533.977631400818, 6619.928189036607, 6619.928189036607, 4171.033216631745, 4171.033216631745, 4068.5789571549476, 4068.5789571549476, 7635.42120274672, 7635.42120274672, 7751.154341730733, 7751.154341730733, 5549.411540069377, 5549.411540069377, 6273.620970065711, 6273.620970065711, 3552.723159685339, 3552.723159685339, 7123.830026515268, 7123.830026515268, 5743.433872976362, 5743.433872976362, 4311.6801694857, 4311.6801694857, 4892.7098257351045, 4892.7098257351045, 7520.170226665319, 7520.170226665319, 6034.328301511701, 6034.328301511701, 7946.127209621165, 7946.127209621165, 4852.986285871091, 4852.986285871091, 4901.624194782327, 4901.624194782327, 5541.63591560012, 5541.63591560012, 7502.453121902225, 7502.453121902225, 6402.361584212818, 6402.361584212818, 6161.203673975475, 6161.203673975475, 2600.0, 2600.0, 5643.391191575249, 5643.391191575249, 7312.035517917926, 7312.035517917926, 8207.548122358596, 8207.548122358596, 7043.526597775985, 7043.526597775985, 4514.802163640645, 4514.802163640645, 7087.851993272858, 7087.851993272858, 6977.08402502528, 6977.08402502528, 4883.967899849283, 4883.967899849283, 6142.137074098251, 6142.137074098251, 4941.927501615025, 4941.927501615025, 4226.543249829984, 4226.543249829984, 4097.163633313837, 4097.163633313837, 7096.875321329717, 7096.875321329717, 3100.0, 3100.0, 5245.855453524779, 5245.855453524779, 3787.1468652440217, 3787.1468652440217, 5869.130330946591, 5869.130330946591, 6631.785036715753, 6631.785036715753, 7428.572756784935, 7428.572756784935, 3629.3727381175577, 3629.3727381175577, 4570.8211290824065, 4570.8211290824065, 7929.160338402744, 7929.160338402744, 5304.266395858299, 5304.266395858299, 3991.7436118356763, 3991.7436118356763, 6344.855888289523, 6344.855888289523, 6703.800190160322, 6703.800190160322, 3289.9926374225997, 3289.9926374225997, 6551.608343685846, 6551.608343685846, 5780.065024653403, 5780.065024653403, 6726.418025678358, 6726.418025678358, 3920.9288301007327, 3920.9288301007327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2518029727138373, "mean_inference_ms": 1.2034076896556396, "mean_action_processing_ms": 0.13421582762493098, "mean_env_wait_ms": 3.3765300113957766, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 579200, "timesteps_this_iter": 0, "agent_timesteps_total": 1158400, "timers": {"sample_time_ms": 1847.605, "sample_throughput": 1731.972, "load_time_ms": 0.133, "load_throughput": 24139879.137, "learn_time_ms": 66.925, "learn_throughput": 47814.717, "update_time_ms": 1.568}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7839989.5, "policy_entropy": 34600.16015625, "policy_loss": 2614273.25, "vf_loss": 54167208.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 579200, "num_agent_steps_sampled": 1158400, "num_steps_trained": 579200, "num_agent_steps_trained": 1158400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 31, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-00-58", "timestamp": 1718794858, "time_this_iter_s": 10.987149715423584, "time_total_s": 337.7388274669647, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 337.7388274669647, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 57.99375, "ram_util_percent": 33.28125}}
{"episode_reward_max": 16415.09624471722, "episode_reward_min": 4400.0, "episode_reward_mean": 11143.359325502137, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2200.0}, "policy_reward_max": {"shared_policy": 8207.548122358596}, "policy_reward_mean": {"shared_policy": 5571.6796627510685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13343.088470552837, 12010.686307057924, 12664.35370790544, 9860.709920322959, 10770.1750487986, 5400.0, 9713.29568719948, 11523.49271913834, 11323.41854918488, 11651.618741048693, 13176.85398793155, 12217.418424610485, 13978.242169637142, 12928.94337922809, 9616.17087536995, 8573.989828606725, 10247.902786767954, 13375.90969398283, 13369.032963103953, 6697.623531122144, 9930.23238508002, 11716.709578049842, 14449.407109773194, 8398.952412479968, 9815.317303971344, 14771.38380819028, 9067.955262801617, 13239.856378073193, 8342.066433263491, 8137.1579143099025, 15270.842405493451, 15502.308683461422, 11098.823080138769, 12547.241940131422, 7105.446319370678, 14247.660053030526, 11486.867745952728, 8623.360338971408, 9785.419651470223, 15040.340453330617, 12068.656603023406, 15892.254419242323, 9705.972571742186, 9803.248389564655, 11083.271831200196, 15004.906243804475, 12804.72316842563, 12322.407347950972, 5200.0, 11286.782383150501, 14624.071035835866, 16415.09624471722, 14087.053195551987, 9029.604327281279, 14175.703986545734, 13954.168050050572, 9767.935799698545, 12284.274148196495, 9883.855003230052, 8453.08649965996, 8194.327266627673, 14193.750642659437, 6200.0, 10491.710907049568, 7574.293730488043, 11738.2606618932, 13263.570073431496, 14857.145513569874, 7258.745476235115, 9141.642258164771, 15858.320676805477, 10608.532791716581, 7983.487223671353, 12689.711776579057, 13407.600380320633, 6579.9852748451995, 13103.216687371714, 11560.130049306797, 13452.836051356735, 7841.8576602014655, 14995.909538176205, 11105.776422373398, 10393.777409740553, 9938.18540070824, 9194.089794394724, 4400.0, 8006.562293631905, 15427.478231100624, 11427.82964904661, 12770.01990057106, 5961.996305292796, 6653.049249112624, 15581.021570875397, 8684.802169104732, 7916.752498958886, 11106.000443710225, 5800.0, 14873.46572573849, 14413.289696754062, 10819.453850842896], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6671.544235276422, 6671.544235276422, 6005.343153528963, 6005.343153528963, 6332.176853952717, 6332.176853952717, 4930.354960161468, 4930.354960161468, 5385.087524399305, 5385.087524399305, 2700.0, 2700.0, 4856.647843599766, 4856.647843599766, 5761.746359569172, 5761.746359569172, 5661.709274592445, 5661.709274592445, 5825.809370524337, 5825.809370524337, 6588.426993965757, 6588.426993965757, 6108.709212305241, 6108.709212305241, 6989.1210848185765, 6989.1210848185765, 6464.471689614047, 6464.471689614047, 4808.085437684971, 4808.085437684971, 4286.994914303357, 4286.994914303357, 5123.951393383995, 5123.951393383995, 6687.9548469914025, 6687.9548469914025, 6684.516481551975, 6684.516481551975, 3348.811765561072, 3348.811765561072, 4965.116192539999, 4965.116192539999, 5858.354789024896, 5858.354789024896, 7224.703554886593, 7224.703554886593, 4199.476206239982, 4199.476206239982, 4907.658651985663, 4907.658651985663, 7385.691904095147, 7385.691904095147, 4533.977631400818, 4533.977631400818, 6619.928189036607, 6619.928189036607, 4171.033216631745, 4171.033216631745, 4068.5789571549476, 4068.5789571549476, 7635.42120274672, 7635.42120274672, 7751.154341730733, 7751.154341730733, 5549.411540069377, 5549.411540069377, 6273.620970065711, 6273.620970065711, 3552.723159685339, 3552.723159685339, 7123.830026515268, 7123.830026515268, 5743.433872976362, 5743.433872976362, 4311.6801694857, 4311.6801694857, 4892.7098257351045, 4892.7098257351045, 7520.170226665319, 7520.170226665319, 6034.328301511701, 6034.328301511701, 7946.127209621165, 7946.127209621165, 4852.986285871091, 4852.986285871091, 4901.624194782327, 4901.624194782327, 5541.63591560012, 5541.63591560012, 7502.453121902225, 7502.453121902225, 6402.361584212818, 6402.361584212818, 6161.203673975475, 6161.203673975475, 2600.0, 2600.0, 5643.391191575249, 5643.391191575249, 7312.035517917926, 7312.035517917926, 8207.548122358596, 8207.548122358596, 7043.526597775985, 7043.526597775985, 4514.802163640645, 4514.802163640645, 7087.851993272858, 7087.851993272858, 6977.08402502528, 6977.08402502528, 4883.967899849283, 4883.967899849283, 6142.137074098251, 6142.137074098251, 4941.927501615025, 4941.927501615025, 4226.543249829984, 4226.543249829984, 4097.163633313837, 4097.163633313837, 7096.875321329717, 7096.875321329717, 3100.0, 3100.0, 5245.855453524779, 5245.855453524779, 3787.1468652440217, 3787.1468652440217, 5869.130330946591, 5869.130330946591, 6631.785036715753, 6631.785036715753, 7428.572756784935, 7428.572756784935, 3629.3727381175577, 3629.3727381175577, 4570.8211290824065, 4570.8211290824065, 7929.160338402744, 7929.160338402744, 5304.266395858299, 5304.266395858299, 3991.7436118356763, 3991.7436118356763, 6344.855888289523, 6344.855888289523, 6703.800190160322, 6703.800190160322, 3289.9926374225997, 3289.9926374225997, 6551.608343685846, 6551.608343685846, 5780.065024653403, 5780.065024653403, 6726.418025678358, 6726.418025678358, 3920.9288301007327, 3920.9288301007327, 7497.954769088101, 7497.954769088101, 5552.888211186697, 5552.888211186697, 5196.888704870284, 5196.888704870284, 4969.092700354115, 4969.092700354115, 4597.04489719737, 4597.04489719737, 2200.0, 2200.0, 4003.2811468159525, 4003.2811468159525, 7713.739115550325, 7713.739115550325, 5713.914824523305, 5713.914824523305, 6385.009950285528, 6385.009950285528, 2980.998152646398, 2980.998152646398, 3326.524624556312, 3326.524624556312, 7790.510785437691, 7790.510785437691, 4342.401084552364, 4342.401084552364, 3958.376249479443, 3958.376249479443, 5553.000221855111, 5553.000221855111, 2900.0, 2900.0, 7436.732862869243, 7436.732862869243, 7206.644848377027, 7206.644848377027, 5409.726925421451, 5409.726925421451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2516038688985912, "mean_inference_ms": 1.2024320990702382, "mean_action_processing_ms": 0.13405168317267196, "mean_env_wait_ms": 3.3763305394538747, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 598400, "timesteps_this_iter": 0, "agent_timesteps_total": 1196800, "timers": {"sample_time_ms": 1862.205, "sample_throughput": 1718.393, "load_time_ms": 0.131, "load_throughput": 24358934.301, "learn_time_ms": 67.549, "learn_throughput": 47373.343, "update_time_ms": 1.764}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4599955.0, "policy_entropy": 35198.87890625, "policy_loss": 1581817.0, "vf_loss": 26274516.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 598400, "num_agent_steps_sampled": 1196800, "num_steps_trained": 598400, "num_agent_steps_trained": 1196800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 740, "training_iteration": 32, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-01-09", "timestamp": 1718794869, "time_this_iter_s": 11.298194646835327, "time_total_s": 349.03702211380005, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 349.03702211380005, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 57.75625, "ram_util_percent": 33.3}}
{"episode_reward_max": 16415.09624471722, "episode_reward_min": 4400.0, "episode_reward_mean": 10740.018324657683, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2200.0}, "policy_reward_max": {"shared_policy": 8207.548122358596}, "policy_reward_mean": {"shared_policy": 5370.009162328844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15270.842405493451, 15502.308683461422, 11098.823080138769, 12547.241940131422, 7105.446319370678, 14247.660053030526, 11486.867745952728, 8623.360338971408, 9785.419651470223, 15040.340453330617, 12068.656603023406, 15892.254419242323, 9705.972571742186, 9803.248389564655, 11083.271831200196, 15004.906243804475, 12804.72316842563, 12322.407347950972, 5200.0, 11286.782383150501, 14624.071035835866, 16415.09624471722, 14087.053195551987, 9029.604327281279, 14175.703986545734, 13954.168050050572, 9767.935799698545, 12284.274148196495, 9883.855003230052, 8453.08649965996, 8194.327266627673, 14193.750642659437, 6200.0, 10491.710907049568, 7574.293730488043, 11738.2606618932, 13263.570073431496, 14857.145513569874, 7258.745476235115, 9141.642258164771, 15858.320676805477, 10608.532791716581, 7983.487223671353, 12689.711776579057, 13407.600380320633, 6579.9852748451995, 13103.216687371714, 11560.130049306797, 13452.836051356735, 7841.8576602014655, 14995.909538176205, 11105.776422373398, 10393.777409740553, 9938.18540070824, 9194.089794394724, 4400.0, 8006.562293631905, 15427.478231100624, 11427.82964904661, 12770.01990057106, 5961.996305292796, 6653.049249112624, 15581.021570875397, 8684.802169104732, 7916.752498958886, 11106.000443710225, 5800.0, 14873.46572573849, 14413.289696754062, 10819.453850842896, 8668.903984819786, 9476.209067484371, 10324.28197093118, 9189.269913254404, 12053.430774541357, 6840.968842076709, 5651.175341604654, 9471.801529479326, 6823.4193578295435, 10661.021290155295, 10943.132060226304, 11073.208426386864, 10693.564939904954, 14434.357652641636, 6672.587333428473, 9724.377806474975, 12509.590909519076, 8707.644822426744, 10066.306506559824, 10708.230426496746, 8073.4646812799765, 11254.360642612897, 8900.905154441232, 8578.616181666082, 9903.362164003192, 8825.164741270357, 8371.137754827327, 6200.0, 9751.32197188244, 15426.049044891915], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7635.42120274672, 7635.42120274672, 7751.154341730733, 7751.154341730733, 5549.411540069377, 5549.411540069377, 6273.620970065711, 6273.620970065711, 3552.723159685339, 3552.723159685339, 7123.830026515268, 7123.830026515268, 5743.433872976362, 5743.433872976362, 4311.6801694857, 4311.6801694857, 4892.7098257351045, 4892.7098257351045, 7520.170226665319, 7520.170226665319, 6034.328301511701, 6034.328301511701, 7946.127209621165, 7946.127209621165, 4852.986285871091, 4852.986285871091, 4901.624194782327, 4901.624194782327, 5541.63591560012, 5541.63591560012, 7502.453121902225, 7502.453121902225, 6402.361584212818, 6402.361584212818, 6161.203673975475, 6161.203673975475, 2600.0, 2600.0, 5643.391191575249, 5643.391191575249, 7312.035517917926, 7312.035517917926, 8207.548122358596, 8207.548122358596, 7043.526597775985, 7043.526597775985, 4514.802163640645, 4514.802163640645, 7087.851993272858, 7087.851993272858, 6977.08402502528, 6977.08402502528, 4883.967899849283, 4883.967899849283, 6142.137074098251, 6142.137074098251, 4941.927501615025, 4941.927501615025, 4226.543249829984, 4226.543249829984, 4097.163633313837, 4097.163633313837, 7096.875321329717, 7096.875321329717, 3100.0, 3100.0, 5245.855453524779, 5245.855453524779, 3787.1468652440217, 3787.1468652440217, 5869.130330946591, 5869.130330946591, 6631.785036715753, 6631.785036715753, 7428.572756784935, 7428.572756784935, 3629.3727381175577, 3629.3727381175577, 4570.8211290824065, 4570.8211290824065, 7929.160338402744, 7929.160338402744, 5304.266395858299, 5304.266395858299, 3991.7436118356763, 3991.7436118356763, 6344.855888289523, 6344.855888289523, 6703.800190160322, 6703.800190160322, 3289.9926374225997, 3289.9926374225997, 6551.608343685846, 6551.608343685846, 5780.065024653403, 5780.065024653403, 6726.418025678358, 6726.418025678358, 3920.9288301007327, 3920.9288301007327, 7497.954769088101, 7497.954769088101, 5552.888211186697, 5552.888211186697, 5196.888704870284, 5196.888704870284, 4969.092700354115, 4969.092700354115, 4597.04489719737, 4597.04489719737, 2200.0, 2200.0, 4003.2811468159525, 4003.2811468159525, 7713.739115550325, 7713.739115550325, 5713.914824523305, 5713.914824523305, 6385.009950285528, 6385.009950285528, 2980.998152646398, 2980.998152646398, 3326.524624556312, 3326.524624556312, 7790.510785437691, 7790.510785437691, 4342.401084552364, 4342.401084552364, 3958.376249479443, 3958.376249479443, 5553.000221855111, 5553.000221855111, 2900.0, 2900.0, 7436.732862869243, 7436.732862869243, 7206.644848377027, 7206.644848377027, 5409.726925421451, 5409.726925421451, 4334.451992409903, 4334.451992409903, 4738.104533742182, 4738.104533742182, 5162.1409854655885, 5162.1409854655885, 4594.634956627197, 4594.634956627197, 6026.715387270689, 6026.715387270689, 3420.4844210383544, 3420.4844210383544, 2825.587670802327, 2825.587670802327, 4735.900764739676, 4735.900764739676, 3411.7096789147718, 3411.7096789147718, 5330.51064507766, 5330.51064507766, 5471.566030113159, 5471.566030113159, 5536.604213193441, 5536.604213193441, 5346.782469952497, 5346.782469952497, 7217.17882632082, 7217.17882632082, 3336.2936667142367, 3336.2936667142367, 4862.188903237471, 4862.188903237471, 6254.795454759522, 6254.795454759522, 4353.822411213372, 4353.822411213372, 5033.153253279916, 5033.153253279916, 5354.1152132483785, 5354.1152132483785, 4036.7323406399883, 4036.7323406399883, 5627.180321306443, 5627.180321306443, 4450.452577220616, 4450.452577220616, 4289.308090833039, 4289.308090833039, 4951.681082001594, 4951.681082001594, 4412.582370635178, 4412.582370635178, 4185.568877413666, 4185.568877413666, 3100.0, 3100.0, 4875.660985941227, 4875.660985941227, 7713.024522445947, 7713.024522445947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25167345168193067, "mean_inference_ms": 1.2028589815391606, "mean_action_processing_ms": 0.1341380429183002, "mean_env_wait_ms": 3.3746364696521773, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 617600, "timesteps_this_iter": 0, "agent_timesteps_total": 1235200, "timers": {"sample_time_ms": 1898.995, "sample_throughput": 1685.102, "load_time_ms": 0.138, "load_throughput": 23133010.686, "learn_time_ms": 65.859, "learn_throughput": 48588.927, "update_time_ms": 1.443}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5798006.0, "policy_entropy": 36172.828125, "policy_loss": 2056864.125, "vf_loss": 40437620.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 617600, "num_agent_steps_sampled": 1235200, "num_steps_trained": 617600, "num_agent_steps_trained": 1235200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 770, "training_iteration": 33, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-01-20", "timestamp": 1718794880, "time_this_iter_s": 11.327033042907715, "time_total_s": 360.36405515670776, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43b80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 360.36405515670776, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 57.8625, "ram_util_percent": 33.3}}
{"episode_reward_max": 17370.583654834845, "episode_reward_min": 4400.0, "episode_reward_mean": 10764.84201619075, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2200.0}, "policy_reward_max": {"shared_policy": 8685.29182741743}, "policy_reward_mean": {"shared_policy": 5382.421008095375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14624.071035835866, 16415.09624471722, 14087.053195551987, 9029.604327281279, 14175.703986545734, 13954.168050050572, 9767.935799698545, 12284.274148196495, 9883.855003230052, 8453.08649965996, 8194.327266627673, 14193.750642659437, 6200.0, 10491.710907049568, 7574.293730488043, 11738.2606618932, 13263.570073431496, 14857.145513569874, 7258.745476235115, 9141.642258164771, 15858.320676805477, 10608.532791716581, 7983.487223671353, 12689.711776579057, 13407.600380320633, 6579.9852748451995, 13103.216687371714, 11560.130049306797, 13452.836051356735, 7841.8576602014655, 14995.909538176205, 11105.776422373398, 10393.777409740553, 9938.18540070824, 9194.089794394724, 4400.0, 8006.562293631905, 15427.478231100624, 11427.82964904661, 12770.01990057106, 5961.996305292796, 6653.049249112624, 15581.021570875397, 8684.802169104732, 7916.752498958886, 11106.000443710225, 5800.0, 14873.46572573849, 14413.289696754062, 10819.453850842896, 8668.903984819786, 9476.209067484371, 10324.28197093118, 9189.269913254404, 12053.430774541357, 6840.968842076709, 5651.175341604654, 9471.801529479326, 6823.4193578295435, 10661.021290155295, 10943.132060226304, 11073.208426386864, 10693.564939904954, 14434.357652641636, 6672.587333428473, 9724.377806474975, 12509.590909519076, 8707.644822426744, 10066.306506559824, 10708.230426496746, 8073.4646812799765, 11254.360642612897, 8900.905154441232, 8578.616181666082, 9903.362164003192, 8825.164741270357, 8371.137754827327, 6200.0, 9751.32197188244, 15426.049044891915, 11288.637983768935, 11493.164699870085, 11970.536689012006, 12610.674130179163, 14919.790827948458, 13270.168808475439, 12012.652765577219, 13925.918739579596, 8537.780245111418, 13904.566152180341, 14749.585614980791, 11425.25611436379, 10192.767377822918, 7947.792842530394, 11844.852423988705, 9536.332120760573, 12663.049480315662, 10273.981719809493, 8424.810391652369, 17370.583654834845], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7312.035517917926, 7312.035517917926, 8207.548122358596, 8207.548122358596, 7043.526597775985, 7043.526597775985, 4514.802163640645, 4514.802163640645, 7087.851993272858, 7087.851993272858, 6977.08402502528, 6977.08402502528, 4883.967899849283, 4883.967899849283, 6142.137074098251, 6142.137074098251, 4941.927501615025, 4941.927501615025, 4226.543249829984, 4226.543249829984, 4097.163633313837, 4097.163633313837, 7096.875321329717, 7096.875321329717, 3100.0, 3100.0, 5245.855453524779, 5245.855453524779, 3787.1468652440217, 3787.1468652440217, 5869.130330946591, 5869.130330946591, 6631.785036715753, 6631.785036715753, 7428.572756784935, 7428.572756784935, 3629.3727381175577, 3629.3727381175577, 4570.8211290824065, 4570.8211290824065, 7929.160338402744, 7929.160338402744, 5304.266395858299, 5304.266395858299, 3991.7436118356763, 3991.7436118356763, 6344.855888289523, 6344.855888289523, 6703.800190160322, 6703.800190160322, 3289.9926374225997, 3289.9926374225997, 6551.608343685846, 6551.608343685846, 5780.065024653403, 5780.065024653403, 6726.418025678358, 6726.418025678358, 3920.9288301007327, 3920.9288301007327, 7497.954769088101, 7497.954769088101, 5552.888211186697, 5552.888211186697, 5196.888704870284, 5196.888704870284, 4969.092700354115, 4969.092700354115, 4597.04489719737, 4597.04489719737, 2200.0, 2200.0, 4003.2811468159525, 4003.2811468159525, 7713.739115550325, 7713.739115550325, 5713.914824523305, 5713.914824523305, 6385.009950285528, 6385.009950285528, 2980.998152646398, 2980.998152646398, 3326.524624556312, 3326.524624556312, 7790.510785437691, 7790.510785437691, 4342.401084552364, 4342.401084552364, 3958.376249479443, 3958.376249479443, 5553.000221855111, 5553.000221855111, 2900.0, 2900.0, 7436.732862869243, 7436.732862869243, 7206.644848377027, 7206.644848377027, 5409.726925421451, 5409.726925421451, 4334.451992409903, 4334.451992409903, 4738.104533742182, 4738.104533742182, 5162.1409854655885, 5162.1409854655885, 4594.634956627197, 4594.634956627197, 6026.715387270689, 6026.715387270689, 3420.4844210383544, 3420.4844210383544, 2825.587670802327, 2825.587670802327, 4735.900764739676, 4735.900764739676, 3411.7096789147718, 3411.7096789147718, 5330.51064507766, 5330.51064507766, 5471.566030113159, 5471.566030113159, 5536.604213193441, 5536.604213193441, 5346.782469952497, 5346.782469952497, 7217.17882632082, 7217.17882632082, 3336.2936667142367, 3336.2936667142367, 4862.188903237471, 4862.188903237471, 6254.795454759522, 6254.795454759522, 4353.822411213372, 4353.822411213372, 5033.153253279916, 5033.153253279916, 5354.1152132483785, 5354.1152132483785, 4036.7323406399883, 4036.7323406399883, 5627.180321306443, 5627.180321306443, 4450.452577220616, 4450.452577220616, 4289.308090833039, 4289.308090833039, 4951.681082001594, 4951.681082001594, 4412.582370635178, 4412.582370635178, 4185.568877413666, 4185.568877413666, 3100.0, 3100.0, 4875.660985941227, 4875.660985941227, 7713.024522445947, 7713.024522445947, 5644.318991884456, 5644.318991884456, 5746.582349935033, 5746.582349935033, 5985.26834450603, 5985.26834450603, 6305.33706508959, 6305.33706508959, 7459.89541397422, 7459.89541397422, 6635.084404237714, 6635.084404237714, 6006.326382788603, 6006.326382788603, 6962.959369789798, 6962.959369789798, 4268.8901225557065, 4268.8901225557065, 6952.283076090163, 6952.283076090163, 7374.792807490396, 7374.792807490396, 5712.628057181899, 5712.628057181899, 5096.383688911454, 5096.383688911454, 3973.896421265197, 3973.896421265197, 5922.426211994352, 5922.426211994352, 4768.166060380295, 4768.166060380295, 6331.524740157838, 6331.524740157838, 5136.990859904747, 5136.990859904747, 4212.405195826186, 4212.405195826186, 8685.29182741743, 8685.29182741743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25149691639857935, "mean_inference_ms": 1.2020908636791976, "mean_action_processing_ms": 0.1339989823422315, "mean_env_wait_ms": 3.374983427412301, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 636800, "timesteps_this_iter": 0, "agent_timesteps_total": 1273600, "timers": {"sample_time_ms": 1855.84, "sample_throughput": 1724.287, "load_time_ms": 0.138, "load_throughput": 23192971.833, "learn_time_ms": 65.129, "learn_throughput": 49132.903, "update_time_ms": 1.464}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7166304.5, "policy_entropy": 36033.77734375, "policy_loss": 2515883.75, "vf_loss": 50524188.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 636800, "num_agent_steps_sampled": 1273600, "num_steps_trained": 636800, "num_agent_steps_trained": 1273600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 790, "training_iteration": 34, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-01-31", "timestamp": 1718794891, "time_this_iter_s": 10.941700458526611, "time_total_s": 371.3057556152344, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 371.3057556152344, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 57.89375, "ram_util_percent": 33.25}}
{"episode_reward_max": 17579.258322574824, "episode_reward_min": 4400.0, "episode_reward_mean": 10771.89901541803, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2200.0}, "policy_reward_max": {"shared_policy": 8789.629161287417}, "policy_reward_mean": {"shared_policy": 5385.949507709015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14995.909538176205, 11105.776422373398, 10393.777409740553, 9938.18540070824, 9194.089794394724, 4400.0, 8006.562293631905, 15427.478231100624, 11427.82964904661, 12770.01990057106, 5961.996305292796, 6653.049249112624, 15581.021570875397, 8684.802169104732, 7916.752498958886, 11106.000443710225, 5800.0, 14873.46572573849, 14413.289696754062, 10819.453850842896, 8668.903984819786, 9476.209067484371, 10324.28197093118, 9189.269913254404, 12053.430774541357, 6840.968842076709, 5651.175341604654, 9471.801529479326, 6823.4193578295435, 10661.021290155295, 10943.132060226304, 11073.208426386864, 10693.564939904954, 14434.357652641636, 6672.587333428473, 9724.377806474975, 12509.590909519076, 8707.644822426744, 10066.306506559824, 10708.230426496746, 8073.4646812799765, 11254.360642612897, 8900.905154441232, 8578.616181666082, 9903.362164003192, 8825.164741270357, 8371.137754827327, 6200.0, 9751.32197188244, 15426.049044891915, 11288.637983768935, 11493.164699870085, 11970.536689012006, 12610.674130179163, 14919.790827948458, 13270.168808475439, 12012.652765577219, 13925.918739579596, 8537.780245111418, 13904.566152180341, 14749.585614980791, 11425.25611436379, 10192.767377822918, 7947.792842530394, 11844.852423988705, 9536.332120760573, 12663.049480315662, 10273.981719809493, 8424.810391652369, 17370.583654834845, 5876.141738975239, 10897.588135341448, 10921.888388213381, 12003.505415465519, 12673.624217837994, 8574.969739209486, 6762.447756170182, 13934.482571283923, 9061.376440213957, 14675.170686766065, 9869.5848094978, 10126.475689917715, 14348.97295626032, 11741.847762867008, 8211.177823690494, 5369.722148562034, 16789.819904080185, 7990.604747118516, 12022.799475376065, 8149.515620889504, 14257.730866737595, 8124.905847178983, 13244.886681322561, 14773.938361883258, 9580.681193485063, 15148.7636558441, 15012.102925832125, 17579.258322574824, 13237.607475061937, 8418.081958132443], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7497.954769088101, 7497.954769088101, 5552.888211186697, 5552.888211186697, 5196.888704870284, 5196.888704870284, 4969.092700354115, 4969.092700354115, 4597.04489719737, 4597.04489719737, 2200.0, 2200.0, 4003.2811468159525, 4003.2811468159525, 7713.739115550325, 7713.739115550325, 5713.914824523305, 5713.914824523305, 6385.009950285528, 6385.009950285528, 2980.998152646398, 2980.998152646398, 3326.524624556312, 3326.524624556312, 7790.510785437691, 7790.510785437691, 4342.401084552364, 4342.401084552364, 3958.376249479443, 3958.376249479443, 5553.000221855111, 5553.000221855111, 2900.0, 2900.0, 7436.732862869243, 7436.732862869243, 7206.644848377027, 7206.644848377027, 5409.726925421451, 5409.726925421451, 4334.451992409903, 4334.451992409903, 4738.104533742182, 4738.104533742182, 5162.1409854655885, 5162.1409854655885, 4594.634956627197, 4594.634956627197, 6026.715387270689, 6026.715387270689, 3420.4844210383544, 3420.4844210383544, 2825.587670802327, 2825.587670802327, 4735.900764739676, 4735.900764739676, 3411.7096789147718, 3411.7096789147718, 5330.51064507766, 5330.51064507766, 5471.566030113159, 5471.566030113159, 5536.604213193441, 5536.604213193441, 5346.782469952497, 5346.782469952497, 7217.17882632082, 7217.17882632082, 3336.2936667142367, 3336.2936667142367, 4862.188903237471, 4862.188903237471, 6254.795454759522, 6254.795454759522, 4353.822411213372, 4353.822411213372, 5033.153253279916, 5033.153253279916, 5354.1152132483785, 5354.1152132483785, 4036.7323406399883, 4036.7323406399883, 5627.180321306443, 5627.180321306443, 4450.452577220616, 4450.452577220616, 4289.308090833039, 4289.308090833039, 4951.681082001594, 4951.681082001594, 4412.582370635178, 4412.582370635178, 4185.568877413666, 4185.568877413666, 3100.0, 3100.0, 4875.660985941227, 4875.660985941227, 7713.024522445947, 7713.024522445947, 5644.318991884456, 5644.318991884456, 5746.582349935033, 5746.582349935033, 5985.26834450603, 5985.26834450603, 6305.33706508959, 6305.33706508959, 7459.89541397422, 7459.89541397422, 6635.084404237714, 6635.084404237714, 6006.326382788603, 6006.326382788603, 6962.959369789798, 6962.959369789798, 4268.8901225557065, 4268.8901225557065, 6952.283076090163, 6952.283076090163, 7374.792807490396, 7374.792807490396, 5712.628057181899, 5712.628057181899, 5096.383688911454, 5096.383688911454, 3973.896421265197, 3973.896421265197, 5922.426211994352, 5922.426211994352, 4768.166060380295, 4768.166060380295, 6331.524740157838, 6331.524740157838, 5136.990859904747, 5136.990859904747, 4212.405195826186, 4212.405195826186, 8685.29182741743, 8685.29182741743, 2938.0708694876193, 2938.0708694876193, 5448.794067670725, 5448.794067670725, 5460.944194106671, 5460.944194106671, 6001.752707732752, 6001.752707732752, 6336.812108918992, 6336.812108918992, 4287.484869604745, 4287.484869604745, 3381.223878085091, 3381.223878085091, 6967.241285641961, 6967.241285641961, 4530.688220106984, 4530.688220106984, 7337.585343383034, 7337.585343383034, 4934.792404748894, 4934.792404748894, 5063.237844958856, 5063.237844958856, 7174.486478130155, 7174.486478130155, 5870.923881433507, 5870.923881433507, 4105.588911845256, 4105.588911845256, 2684.861074281017, 2684.861074281017, 8394.909952040078, 8394.909952040078, 3995.302373559258, 3995.302373559258, 6011.39973768804, 6011.39973768804, 4074.757810444752, 4074.757810444752, 7128.865433368803, 7128.865433368803, 4062.4529235894915, 4062.4529235894915, 6622.443340661293, 6622.443340661293, 7386.969180941622, 7386.969180941622, 4790.340596742522, 4790.340596742522, 7574.381827922056, 7574.381827922056, 7506.051462916061, 7506.051462916061, 8789.629161287417, 8789.629161287417, 6618.803737530976, 6618.803737530976, 4209.040979066231, 4209.040979066231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25159421235660184, "mean_inference_ms": 1.2026564036980045, "mean_action_processing_ms": 0.1341091543853036, "mean_env_wait_ms": 3.373960349721512, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 656000, "timesteps_this_iter": 0, "agent_timesteps_total": 1312000, "timers": {"sample_time_ms": 1830.987, "sample_throughput": 1747.692, "load_time_ms": 0.134, "load_throughput": 23814359.12, "learn_time_ms": 64.608, "learn_throughput": 49529.341, "update_time_ms": 1.418}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4281918.0, "policy_entropy": 34370.32421875, "policy_loss": 1463335.375, "vf_loss": 31669576.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 656000, "num_agent_steps_sampled": 1312000, "num_steps_trained": 656000, "num_agent_steps_trained": 1312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 820, "training_iteration": 35, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-01-43", "timestamp": 1718794903, "time_this_iter_s": 11.110571146011353, "time_total_s": 382.4163267612457, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf15a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 382.4163267612457, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.15, "ram_util_percent": 33.3}}
{"episode_reward_max": 17579.258322574824, "episode_reward_min": 4600.0, "episode_reward_mean": 10656.102821783488, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2300.0}, "policy_reward_max": {"shared_policy": 8789.629161287417}, "policy_reward_mean": {"shared_policy": 5328.051410891747}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8668.903984819786, 9476.209067484371, 10324.28197093118, 9189.269913254404, 12053.430774541357, 6840.968842076709, 5651.175341604654, 9471.801529479326, 6823.4193578295435, 10661.021290155295, 10943.132060226304, 11073.208426386864, 10693.564939904954, 14434.357652641636, 6672.587333428473, 9724.377806474975, 12509.590909519076, 8707.644822426744, 10066.306506559824, 10708.230426496746, 8073.4646812799765, 11254.360642612897, 8900.905154441232, 8578.616181666082, 9903.362164003192, 8825.164741270357, 8371.137754827327, 6200.0, 9751.32197188244, 15426.049044891915, 11288.637983768935, 11493.164699870085, 11970.536689012006, 12610.674130179163, 14919.790827948458, 13270.168808475439, 12012.652765577219, 13925.918739579596, 8537.780245111418, 13904.566152180341, 14749.585614980791, 11425.25611436379, 10192.767377822918, 7947.792842530394, 11844.852423988705, 9536.332120760573, 12663.049480315662, 10273.981719809493, 8424.810391652369, 17370.583654834845, 5876.141738975239, 10897.588135341448, 10921.888388213381, 12003.505415465519, 12673.624217837994, 8574.969739209486, 6762.447756170182, 13934.482571283923, 9061.376440213957, 14675.170686766065, 9869.5848094978, 10126.475689917715, 14348.97295626032, 11741.847762867008, 8211.177823690494, 5369.722148562034, 16789.819904080185, 7990.604747118516, 12022.799475376065, 8149.515620889504, 14257.730866737595, 8124.905847178983, 13244.886681322561, 14773.938361883258, 9580.681193485063, 15148.7636558441, 15012.102925832125, 17579.258322574824, 13237.607475061937, 8418.081958132443, 11771.165420075537, 5539.326031275408, 6533.817835789963, 5938.087314602573, 9222.175323602783, 16162.720488871611, 9395.012202504175, 5685.265929160598, 12874.545889767487, 11253.79210906642, 11186.43199930228, 14559.631038165742, 14766.734643542975, 8156.916290786714, 4600.0, 12752.60960278624, 4800.0, 9021.742992481497, 11013.196715886123, 12656.668959011356], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4334.451992409903, 4334.451992409903, 4738.104533742182, 4738.104533742182, 5162.1409854655885, 5162.1409854655885, 4594.634956627197, 4594.634956627197, 6026.715387270689, 6026.715387270689, 3420.4844210383544, 3420.4844210383544, 2825.587670802327, 2825.587670802327, 4735.900764739676, 4735.900764739676, 3411.7096789147718, 3411.7096789147718, 5330.51064507766, 5330.51064507766, 5471.566030113159, 5471.566030113159, 5536.604213193441, 5536.604213193441, 5346.782469952497, 5346.782469952497, 7217.17882632082, 7217.17882632082, 3336.2936667142367, 3336.2936667142367, 4862.188903237471, 4862.188903237471, 6254.795454759522, 6254.795454759522, 4353.822411213372, 4353.822411213372, 5033.153253279916, 5033.153253279916, 5354.1152132483785, 5354.1152132483785, 4036.7323406399883, 4036.7323406399883, 5627.180321306443, 5627.180321306443, 4450.452577220616, 4450.452577220616, 4289.308090833039, 4289.308090833039, 4951.681082001594, 4951.681082001594, 4412.582370635178, 4412.582370635178, 4185.568877413666, 4185.568877413666, 3100.0, 3100.0, 4875.660985941227, 4875.660985941227, 7713.024522445947, 7713.024522445947, 5644.318991884456, 5644.318991884456, 5746.582349935033, 5746.582349935033, 5985.26834450603, 5985.26834450603, 6305.33706508959, 6305.33706508959, 7459.89541397422, 7459.89541397422, 6635.084404237714, 6635.084404237714, 6006.326382788603, 6006.326382788603, 6962.959369789798, 6962.959369789798, 4268.8901225557065, 4268.8901225557065, 6952.283076090163, 6952.283076090163, 7374.792807490396, 7374.792807490396, 5712.628057181899, 5712.628057181899, 5096.383688911454, 5096.383688911454, 3973.896421265197, 3973.896421265197, 5922.426211994352, 5922.426211994352, 4768.166060380295, 4768.166060380295, 6331.524740157838, 6331.524740157838, 5136.990859904747, 5136.990859904747, 4212.405195826186, 4212.405195826186, 8685.29182741743, 8685.29182741743, 2938.0708694876193, 2938.0708694876193, 5448.794067670725, 5448.794067670725, 5460.944194106671, 5460.944194106671, 6001.752707732752, 6001.752707732752, 6336.812108918992, 6336.812108918992, 4287.484869604745, 4287.484869604745, 3381.223878085091, 3381.223878085091, 6967.241285641961, 6967.241285641961, 4530.688220106984, 4530.688220106984, 7337.585343383034, 7337.585343383034, 4934.792404748894, 4934.792404748894, 5063.237844958856, 5063.237844958856, 7174.486478130155, 7174.486478130155, 5870.923881433507, 5870.923881433507, 4105.588911845256, 4105.588911845256, 2684.861074281017, 2684.861074281017, 8394.909952040078, 8394.909952040078, 3995.302373559258, 3995.302373559258, 6011.39973768804, 6011.39973768804, 4074.757810444752, 4074.757810444752, 7128.865433368803, 7128.865433368803, 4062.4529235894915, 4062.4529235894915, 6622.443340661293, 6622.443340661293, 7386.969180941622, 7386.969180941622, 4790.340596742522, 4790.340596742522, 7574.381827922056, 7574.381827922056, 7506.051462916061, 7506.051462916061, 8789.629161287417, 8789.629161287417, 6618.803737530976, 6618.803737530976, 4209.040979066231, 4209.040979066231, 5885.582710037767, 5885.582710037767, 2769.663015637704, 2769.663015637704, 3266.9089178949816, 3266.9089178949816, 2969.0436573012867, 2969.0436573012867, 4611.087661801392, 4611.087661801392, 8081.3602444358075, 8081.3602444358075, 4697.506101252088, 4697.506101252088, 2842.632964580299, 2842.632964580299, 6437.272944883727, 6437.272944883727, 5626.896054533214, 5626.896054533214, 5593.2159996511455, 5593.2159996511455, 7279.815519082886, 7279.815519082886, 7383.367321771486, 7383.367321771486, 4078.458145393359, 4078.458145393359, 2300.0, 2300.0, 6376.30480139314, 6376.30480139314, 2400.0, 2400.0, 4510.8714962407375, 4510.8714962407375, 5506.59835794305, 5506.59835794305, 6328.334479505691, 6328.334479505691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515585250571138, "mean_inference_ms": 1.2024414184318386, "mean_action_processing_ms": 0.13407897876593597, "mean_env_wait_ms": 3.3731813281984118, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 675200, "timesteps_this_iter": 0, "agent_timesteps_total": 1350400, "timers": {"sample_time_ms": 1841.803, "sample_throughput": 1737.428, "load_time_ms": 0.127, "load_throughput": 25101501.403, "learn_time_ms": 63.927, "learn_throughput": 50057.11, "update_time_ms": 1.435}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7899236.0, "policy_entropy": 33936.96484375, "policy_loss": 2622632.5, "vf_loss": 51975336.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 675200, "num_agent_steps_sampled": 1350400, "num_steps_trained": 675200, "num_agent_steps_trained": 1350400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 840, "training_iteration": 36, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-01-53", "timestamp": 1718794913, "time_this_iter_s": 10.91464638710022, "time_total_s": 393.33097314834595, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf15ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 393.33097314834595, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.57333333333333, "ram_util_percent": 33.26666666666667}}
{"episode_reward_max": 17579.258322574824, "episode_reward_min": 4000.0, "episode_reward_mean": 10824.051651952715, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2000.0}, "policy_reward_max": {"shared_policy": 8789.629161287417}, "policy_reward_mean": {"shared_policy": 5412.02582597636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8073.4646812799765, 11254.360642612897, 8900.905154441232, 8578.616181666082, 9903.362164003192, 8825.164741270357, 8371.137754827327, 6200.0, 9751.32197188244, 15426.049044891915, 11288.637983768935, 11493.164699870085, 11970.536689012006, 12610.674130179163, 14919.790827948458, 13270.168808475439, 12012.652765577219, 13925.918739579596, 8537.780245111418, 13904.566152180341, 14749.585614980791, 11425.25611436379, 10192.767377822918, 7947.792842530394, 11844.852423988705, 9536.332120760573, 12663.049480315662, 10273.981719809493, 8424.810391652369, 17370.583654834845, 5876.141738975239, 10897.588135341448, 10921.888388213381, 12003.505415465519, 12673.624217837994, 8574.969739209486, 6762.447756170182, 13934.482571283923, 9061.376440213957, 14675.170686766065, 9869.5848094978, 10126.475689917715, 14348.97295626032, 11741.847762867008, 8211.177823690494, 5369.722148562034, 16789.819904080185, 7990.604747118516, 12022.799475376065, 8149.515620889504, 14257.730866737595, 8124.905847178983, 13244.886681322561, 14773.938361883258, 9580.681193485063, 15148.7636558441, 15012.102925832125, 17579.258322574824, 13237.607475061937, 8418.081958132443, 11771.165420075537, 5539.326031275408, 6533.817835789963, 5938.087314602573, 9222.175323602783, 16162.720488871611, 9395.012202504175, 5685.265929160598, 12874.545889767487, 11253.79210906642, 11186.43199930228, 14559.631038165742, 14766.734643542975, 8156.916290786714, 4600.0, 12752.60960278624, 4800.0, 9021.742992481497, 11013.196715886123, 12656.668959011356, 12296.764397411353, 10264.112709746874, 9668.87812758092, 12150.517652191826, 12874.696320570365, 11438.153866924262, 9426.058598467833, 8312.279073099064, 8288.139628663099, 12873.983209726834, 4000.0, 10390.91531291461, 13945.58727131096, 13620.601067439602, 13066.75951359154, 11476.81635573935, 12221.895968453427, 7025.703924484187, 10491.87424970277, 7654.628725145987], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4036.7323406399883, 4036.7323406399883, 5627.180321306443, 5627.180321306443, 4450.452577220616, 4450.452577220616, 4289.308090833039, 4289.308090833039, 4951.681082001594, 4951.681082001594, 4412.582370635178, 4412.582370635178, 4185.568877413666, 4185.568877413666, 3100.0, 3100.0, 4875.660985941227, 4875.660985941227, 7713.024522445947, 7713.024522445947, 5644.318991884456, 5644.318991884456, 5746.582349935033, 5746.582349935033, 5985.26834450603, 5985.26834450603, 6305.33706508959, 6305.33706508959, 7459.89541397422, 7459.89541397422, 6635.084404237714, 6635.084404237714, 6006.326382788603, 6006.326382788603, 6962.959369789798, 6962.959369789798, 4268.8901225557065, 4268.8901225557065, 6952.283076090163, 6952.283076090163, 7374.792807490396, 7374.792807490396, 5712.628057181899, 5712.628057181899, 5096.383688911454, 5096.383688911454, 3973.896421265197, 3973.896421265197, 5922.426211994352, 5922.426211994352, 4768.166060380295, 4768.166060380295, 6331.524740157838, 6331.524740157838, 5136.990859904747, 5136.990859904747, 4212.405195826186, 4212.405195826186, 8685.29182741743, 8685.29182741743, 2938.0708694876193, 2938.0708694876193, 5448.794067670725, 5448.794067670725, 5460.944194106671, 5460.944194106671, 6001.752707732752, 6001.752707732752, 6336.812108918992, 6336.812108918992, 4287.484869604745, 4287.484869604745, 3381.223878085091, 3381.223878085091, 6967.241285641961, 6967.241285641961, 4530.688220106984, 4530.688220106984, 7337.585343383034, 7337.585343383034, 4934.792404748894, 4934.792404748894, 5063.237844958856, 5063.237844958856, 7174.486478130155, 7174.486478130155, 5870.923881433507, 5870.923881433507, 4105.588911845256, 4105.588911845256, 2684.861074281017, 2684.861074281017, 8394.909952040078, 8394.909952040078, 3995.302373559258, 3995.302373559258, 6011.39973768804, 6011.39973768804, 4074.757810444752, 4074.757810444752, 7128.865433368803, 7128.865433368803, 4062.4529235894915, 4062.4529235894915, 6622.443340661293, 6622.443340661293, 7386.969180941622, 7386.969180941622, 4790.340596742522, 4790.340596742522, 7574.381827922056, 7574.381827922056, 7506.051462916061, 7506.051462916061, 8789.629161287417, 8789.629161287417, 6618.803737530976, 6618.803737530976, 4209.040979066231, 4209.040979066231, 5885.582710037767, 5885.582710037767, 2769.663015637704, 2769.663015637704, 3266.9089178949816, 3266.9089178949816, 2969.0436573012867, 2969.0436573012867, 4611.087661801392, 4611.087661801392, 8081.3602444358075, 8081.3602444358075, 4697.506101252088, 4697.506101252088, 2842.632964580299, 2842.632964580299, 6437.272944883727, 6437.272944883727, 5626.896054533214, 5626.896054533214, 5593.2159996511455, 5593.2159996511455, 7279.815519082886, 7279.815519082886, 7383.367321771486, 7383.367321771486, 4078.458145393359, 4078.458145393359, 2300.0, 2300.0, 6376.30480139314, 6376.30480139314, 2400.0, 2400.0, 4510.8714962407375, 4510.8714962407375, 5506.59835794305, 5506.59835794305, 6328.334479505691, 6328.334479505691, 6148.382198705699, 6148.382198705699, 5132.056354873435, 5132.056354873435, 4834.439063790454, 4834.439063790454, 6075.25882609591, 6075.25882609591, 6437.348160285188, 6437.348160285188, 5719.076933462132, 5719.076933462132, 4713.029299233918, 4713.029299233918, 4156.139536549532, 4156.139536549532, 4144.069814331544, 4144.069814331544, 6436.991604863411, 6436.991604863411, 2000.0, 2000.0, 5195.457656457312, 5195.457656457312, 6972.793635655482, 6972.793635655482, 6810.300533719814, 6810.300533719814, 6533.379756795788, 6533.379756795788, 5738.408177869661, 5738.408177869661, 6110.947984226723, 6110.947984226723, 3512.8519622420936, 3512.8519622420936, 5245.9371248513835, 5245.9371248513835, 3827.3143625729936, 3827.3143625729936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25134750555772406, "mean_inference_ms": 1.2014304815006385, "mean_action_processing_ms": 0.1339131040644523, "mean_env_wait_ms": 3.372709082924645, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 694400, "timesteps_this_iter": 0, "agent_timesteps_total": 1388800, "timers": {"sample_time_ms": 1843.872, "sample_throughput": 1735.479, "load_time_ms": 0.136, "load_throughput": 23530457.223, "learn_time_ms": 64.956, "learn_throughput": 49263.848, "update_time_ms": 1.432}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7454886.5, "policy_entropy": 35998.828125, "policy_loss": 2556025.25, "vf_loss": 52550548.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 694400, "num_agent_steps_sampled": 1388800, "num_steps_trained": 694400, "num_agent_steps_trained": 1388800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 860, "training_iteration": 37, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-02-05", "timestamp": 1718794925, "time_this_iter_s": 11.111583709716797, "time_total_s": 404.44255685806274, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf159d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 404.44255685806274, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 57.53125, "ram_util_percent": 33.2}}
{"episode_reward_max": 18809.01507394464, "episode_reward_min": 4000.0, "episode_reward_mean": 10639.47978722982, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2000.0}, "policy_reward_max": {"shared_policy": 9404.50753697233}, "policy_reward_mean": {"shared_policy": 5319.739893614912}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5876.141738975239, 10897.588135341448, 10921.888388213381, 12003.505415465519, 12673.624217837994, 8574.969739209486, 6762.447756170182, 13934.482571283923, 9061.376440213957, 14675.170686766065, 9869.5848094978, 10126.475689917715, 14348.97295626032, 11741.847762867008, 8211.177823690494, 5369.722148562034, 16789.819904080185, 7990.604747118516, 12022.799475376065, 8149.515620889504, 14257.730866737595, 8124.905847178983, 13244.886681322561, 14773.938361883258, 9580.681193485063, 15148.7636558441, 15012.102925832125, 17579.258322574824, 13237.607475061937, 8418.081958132443, 11771.165420075537, 5539.326031275408, 6533.817835789963, 5938.087314602573, 9222.175323602783, 16162.720488871611, 9395.012202504175, 5685.265929160598, 12874.545889767487, 11253.79210906642, 11186.43199930228, 14559.631038165742, 14766.734643542975, 8156.916290786714, 4600.0, 12752.60960278624, 4800.0, 9021.742992481497, 11013.196715886123, 12656.668959011356, 12296.764397411353, 10264.112709746874, 9668.87812758092, 12150.517652191826, 12874.696320570365, 11438.153866924262, 9426.058598467833, 8312.279073099064, 8288.139628663099, 12873.983209726834, 4000.0, 10390.91531291461, 13945.58727131096, 13620.601067439602, 13066.75951359154, 11476.81635573935, 12221.895968453427, 7025.703924484187, 10491.87424970277, 7654.628725145987, 16519.77103279547, 8333.609080441754, 7939.948193790484, 11252.439340676312, 9948.297173165302, 9607.945931952007, 18809.01507394464, 10090.87598857009, 14206.261344225011, 11637.991386104673, 9279.616016217922, 6432.792979060887, 11865.112748549152, 10192.875065994722, 6317.403749132525, 10509.869770793852, 5976.372804620689, 13731.368246872946, 13154.242260417705, 8063.130850314534, 11754.349621444573, 10039.068899054873, 13925.956180011515, 8130.686056479895, 6664.219971253751, 9673.548492574762, 7966.166080272775, 11384.978820550248, 9922.411437598817, 11859.774050466127], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2938.0708694876193, 2938.0708694876193, 5448.794067670725, 5448.794067670725, 5460.944194106671, 5460.944194106671, 6001.752707732752, 6001.752707732752, 6336.812108918992, 6336.812108918992, 4287.484869604745, 4287.484869604745, 3381.223878085091, 3381.223878085091, 6967.241285641961, 6967.241285641961, 4530.688220106984, 4530.688220106984, 7337.585343383034, 7337.585343383034, 4934.792404748894, 4934.792404748894, 5063.237844958856, 5063.237844958856, 7174.486478130155, 7174.486478130155, 5870.923881433507, 5870.923881433507, 4105.588911845256, 4105.588911845256, 2684.861074281017, 2684.861074281017, 8394.909952040078, 8394.909952040078, 3995.302373559258, 3995.302373559258, 6011.39973768804, 6011.39973768804, 4074.757810444752, 4074.757810444752, 7128.865433368803, 7128.865433368803, 4062.4529235894915, 4062.4529235894915, 6622.443340661293, 6622.443340661293, 7386.969180941622, 7386.969180941622, 4790.340596742522, 4790.340596742522, 7574.381827922056, 7574.381827922056, 7506.051462916061, 7506.051462916061, 8789.629161287417, 8789.629161287417, 6618.803737530976, 6618.803737530976, 4209.040979066231, 4209.040979066231, 5885.582710037767, 5885.582710037767, 2769.663015637704, 2769.663015637704, 3266.9089178949816, 3266.9089178949816, 2969.0436573012867, 2969.0436573012867, 4611.087661801392, 4611.087661801392, 8081.3602444358075, 8081.3602444358075, 4697.506101252088, 4697.506101252088, 2842.632964580299, 2842.632964580299, 6437.272944883727, 6437.272944883727, 5626.896054533214, 5626.896054533214, 5593.2159996511455, 5593.2159996511455, 7279.815519082886, 7279.815519082886, 7383.367321771486, 7383.367321771486, 4078.458145393359, 4078.458145393359, 2300.0, 2300.0, 6376.30480139314, 6376.30480139314, 2400.0, 2400.0, 4510.8714962407375, 4510.8714962407375, 5506.59835794305, 5506.59835794305, 6328.334479505691, 6328.334479505691, 6148.382198705699, 6148.382198705699, 5132.056354873435, 5132.056354873435, 4834.439063790454, 4834.439063790454, 6075.25882609591, 6075.25882609591, 6437.348160285188, 6437.348160285188, 5719.076933462132, 5719.076933462132, 4713.029299233918, 4713.029299233918, 4156.139536549532, 4156.139536549532, 4144.069814331544, 4144.069814331544, 6436.991604863411, 6436.991604863411, 2000.0, 2000.0, 5195.457656457312, 5195.457656457312, 6972.793635655482, 6972.793635655482, 6810.300533719814, 6810.300533719814, 6533.379756795788, 6533.379756795788, 5738.408177869661, 5738.408177869661, 6110.947984226723, 6110.947984226723, 3512.8519622420936, 3512.8519622420936, 5245.9371248513835, 5245.9371248513835, 3827.3143625729936, 3827.3143625729936, 8259.885516397739, 8259.885516397739, 4166.804540220879, 4166.804540220879, 3969.974096895242, 3969.974096895242, 5626.219670338156, 5626.219670338156, 4974.148586582653, 4974.148586582653, 4803.972965976025, 4803.972965976025, 9404.50753697233, 9404.50753697233, 5045.437994285045, 5045.437994285045, 7103.130672112518, 7103.130672112518, 5818.99569305234, 5818.99569305234, 4639.808008108968, 4639.808008108968, 3216.3964895304434, 3216.3964895304434, 5932.556374274574, 5932.556374274574, 5096.437532997363, 5096.437532997363, 3158.7018745662626, 3158.7018745662626, 5254.934885396928, 5254.934885396928, 2988.1864023103444, 2988.1864023103444, 6865.68412343648, 6865.68412343648, 6577.121130208858, 6577.121130208858, 4031.565425157267, 4031.565425157267, 5877.174810722285, 5877.174810722285, 5019.534449527442, 5019.534449527442, 6962.978090005756, 6962.978090005756, 4065.3430282399477, 4065.3430282399477, 3332.1099856268756, 3332.1099856268756, 4836.774246287384, 4836.774246287384, 3983.0830401363874, 3983.0830401363874, 5692.48941027513, 5692.48941027513, 4961.205718799405, 4961.205718799405, 5929.887025233056, 5929.887025233056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2513826889754746, "mean_inference_ms": 1.2016279165006853, "mean_action_processing_ms": 0.13398100186633974, "mean_env_wait_ms": 3.3706382984085828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 713600, "timesteps_this_iter": 0, "agent_timesteps_total": 1427200, "timers": {"sample_time_ms": 1862.728, "sample_throughput": 1717.91, "load_time_ms": 0.135, "load_throughput": 23654869.228, "learn_time_ms": 64.961, "learn_throughput": 49260.539, "update_time_ms": 1.409}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5344901.5, "policy_entropy": 34008.78515625, "policy_loss": 1764060.875, "vf_loss": 38064152.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 713600, "num_agent_steps_sampled": 1427200, "num_steps_trained": 713600, "num_agent_steps_trained": 1427200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 890, "training_iteration": 38, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-02-16", "timestamp": 1718794936, "time_this_iter_s": 11.208816528320312, "time_total_s": 415.65137338638306, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 415.65137338638306, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 57.70625, "ram_util_percent": 33.25}}
{"episode_reward_max": 18809.01507394464, "episode_reward_min": 4000.0, "episode_reward_mean": 10438.219699435898, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2000.0}, "policy_reward_max": {"shared_policy": 9404.50753697233}, "policy_reward_mean": {"shared_policy": 5219.109849717949}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14257.730866737595, 8124.905847178983, 13244.886681322561, 14773.938361883258, 9580.681193485063, 15148.7636558441, 15012.102925832125, 17579.258322574824, 13237.607475061937, 8418.081958132443, 11771.165420075537, 5539.326031275408, 6533.817835789963, 5938.087314602573, 9222.175323602783, 16162.720488871611, 9395.012202504175, 5685.265929160598, 12874.545889767487, 11253.79210906642, 11186.43199930228, 14559.631038165742, 14766.734643542975, 8156.916290786714, 4600.0, 12752.60960278624, 4800.0, 9021.742992481497, 11013.196715886123, 12656.668959011356, 12296.764397411353, 10264.112709746874, 9668.87812758092, 12150.517652191826, 12874.696320570365, 11438.153866924262, 9426.058598467833, 8312.279073099064, 8288.139628663099, 12873.983209726834, 4000.0, 10390.91531291461, 13945.58727131096, 13620.601067439602, 13066.75951359154, 11476.81635573935, 12221.895968453427, 7025.703924484187, 10491.87424970277, 7654.628725145987, 16519.77103279547, 8333.609080441754, 7939.948193790484, 11252.439340676312, 9948.297173165302, 9607.945931952007, 18809.01507394464, 10090.87598857009, 14206.261344225011, 11637.991386104673, 9279.616016217922, 6432.792979060887, 11865.112748549152, 10192.875065994722, 6317.403749132525, 10509.869770793852, 5976.372804620689, 13731.368246872946, 13154.242260417705, 8063.130850314534, 11754.349621444573, 10039.068899054873, 13925.956180011515, 8130.686056479895, 6664.219971253751, 9673.548492574762, 7966.166080272775, 11384.978820550248, 9922.411437598817, 11859.774050466127, 9565.299215028961, 10521.444894433367, 7142.511967335347, 6114.697105197927, 12987.415478856776, 8542.497984525562, 12063.373183739419, 6747.038455711736, 9967.265135764526, 11237.382032010282, 10098.869994928464, 13287.052043509233, 15095.11886821879, 7379.476808204507, 9210.36551199033, 6884.728482075649, 7078.351261930817, 6587.630790888939, 9016.975151087488, 10348.2128829063], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7128.865433368803, 7128.865433368803, 4062.4529235894915, 4062.4529235894915, 6622.443340661293, 6622.443340661293, 7386.969180941622, 7386.969180941622, 4790.340596742522, 4790.340596742522, 7574.381827922056, 7574.381827922056, 7506.051462916061, 7506.051462916061, 8789.629161287417, 8789.629161287417, 6618.803737530976, 6618.803737530976, 4209.040979066231, 4209.040979066231, 5885.582710037767, 5885.582710037767, 2769.663015637704, 2769.663015637704, 3266.9089178949816, 3266.9089178949816, 2969.0436573012867, 2969.0436573012867, 4611.087661801392, 4611.087661801392, 8081.3602444358075, 8081.3602444358075, 4697.506101252088, 4697.506101252088, 2842.632964580299, 2842.632964580299, 6437.272944883727, 6437.272944883727, 5626.896054533214, 5626.896054533214, 5593.2159996511455, 5593.2159996511455, 7279.815519082886, 7279.815519082886, 7383.367321771486, 7383.367321771486, 4078.458145393359, 4078.458145393359, 2300.0, 2300.0, 6376.30480139314, 6376.30480139314, 2400.0, 2400.0, 4510.8714962407375, 4510.8714962407375, 5506.59835794305, 5506.59835794305, 6328.334479505691, 6328.334479505691, 6148.382198705699, 6148.382198705699, 5132.056354873435, 5132.056354873435, 4834.439063790454, 4834.439063790454, 6075.25882609591, 6075.25882609591, 6437.348160285188, 6437.348160285188, 5719.076933462132, 5719.076933462132, 4713.029299233918, 4713.029299233918, 4156.139536549532, 4156.139536549532, 4144.069814331544, 4144.069814331544, 6436.991604863411, 6436.991604863411, 2000.0, 2000.0, 5195.457656457312, 5195.457656457312, 6972.793635655482, 6972.793635655482, 6810.300533719814, 6810.300533719814, 6533.379756795788, 6533.379756795788, 5738.408177869661, 5738.408177869661, 6110.947984226723, 6110.947984226723, 3512.8519622420936, 3512.8519622420936, 5245.9371248513835, 5245.9371248513835, 3827.3143625729936, 3827.3143625729936, 8259.885516397739, 8259.885516397739, 4166.804540220879, 4166.804540220879, 3969.974096895242, 3969.974096895242, 5626.219670338156, 5626.219670338156, 4974.148586582653, 4974.148586582653, 4803.972965976025, 4803.972965976025, 9404.50753697233, 9404.50753697233, 5045.437994285045, 5045.437994285045, 7103.130672112518, 7103.130672112518, 5818.99569305234, 5818.99569305234, 4639.808008108968, 4639.808008108968, 3216.3964895304434, 3216.3964895304434, 5932.556374274574, 5932.556374274574, 5096.437532997363, 5096.437532997363, 3158.7018745662626, 3158.7018745662626, 5254.934885396928, 5254.934885396928, 2988.1864023103444, 2988.1864023103444, 6865.68412343648, 6865.68412343648, 6577.121130208858, 6577.121130208858, 4031.565425157267, 4031.565425157267, 5877.174810722285, 5877.174810722285, 5019.534449527442, 5019.534449527442, 6962.978090005756, 6962.978090005756, 4065.3430282399477, 4065.3430282399477, 3332.1099856268756, 3332.1099856268756, 4836.774246287384, 4836.774246287384, 3983.0830401363874, 3983.0830401363874, 5692.48941027513, 5692.48941027513, 4961.205718799405, 4961.205718799405, 5929.887025233056, 5929.887025233056, 4782.649607514468, 4782.649607514468, 5260.722447216685, 5260.722447216685, 3571.2559836676737, 3571.2559836676737, 3057.3485525989636, 3057.3485525989636, 6493.707739428388, 6493.707739428388, 4271.248992262773, 4271.248992262773, 6031.686591869695, 6031.686591869695, 3373.519227855868, 3373.519227855868, 4983.632567882277, 4983.632567882277, 5618.69101600515, 5618.69101600515, 5049.434997464223, 5049.434997464223, 6643.526021754604, 6643.526021754604, 7547.559434109386, 7547.559434109386, 3689.738404102254, 3689.738404102254, 4605.182755995158, 4605.182755995158, 3442.3642410378243, 3442.3642410378243, 3539.1756309654083, 3539.1756309654083, 3293.8153954444697, 3293.8153954444697, 4508.4875755437515, 4508.4875755437515, 5174.106441453134, 5174.106441453134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2511746516490555, "mean_inference_ms": 1.2006127781193427, "mean_action_processing_ms": 0.13381248990428252, "mean_env_wait_ms": 3.3702662273681825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 732800, "timesteps_this_iter": 0, "agent_timesteps_total": 1465600, "timers": {"sample_time_ms": 1842.674, "sample_throughput": 1736.606, "load_time_ms": 0.134, "load_throughput": 23916202.423, "learn_time_ms": 64.365, "learn_throughput": 49716.383, "update_time_ms": 1.489}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6207862.0, "policy_entropy": 34691.078125, "policy_loss": 2110836.0, "vf_loss": 38780596.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 732800, "num_agent_steps_sampled": 1465600, "num_steps_trained": 732800, "num_agent_steps_trained": 1465600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 910, "training_iteration": 39, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-02-27", "timestamp": 1718794947, "time_this_iter_s": 10.888824701309204, "time_total_s": 426.54019808769226, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf154c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 426.54019808769226, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 33.3}}
{"episode_reward_max": 18809.01507394464, "episode_reward_min": 4000.0, "episode_reward_mean": 10335.259142361401, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2000.0}, "policy_reward_max": {"shared_policy": 9404.50753697233}, "policy_reward_mean": {"shared_policy": 5167.629571180701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12296.764397411353, 10264.112709746874, 9668.87812758092, 12150.517652191826, 12874.696320570365, 11438.153866924262, 9426.058598467833, 8312.279073099064, 8288.139628663099, 12873.983209726834, 4000.0, 10390.91531291461, 13945.58727131096, 13620.601067439602, 13066.75951359154, 11476.81635573935, 12221.895968453427, 7025.703924484187, 10491.87424970277, 7654.628725145987, 16519.77103279547, 8333.609080441754, 7939.948193790484, 11252.439340676312, 9948.297173165302, 9607.945931952007, 18809.01507394464, 10090.87598857009, 14206.261344225011, 11637.991386104673, 9279.616016217922, 6432.792979060887, 11865.112748549152, 10192.875065994722, 6317.403749132525, 10509.869770793852, 5976.372804620689, 13731.368246872946, 13154.242260417705, 8063.130850314534, 11754.349621444573, 10039.068899054873, 13925.956180011515, 8130.686056479895, 6664.219971253751, 9673.548492574762, 7966.166080272775, 11384.978820550248, 9922.411437598817, 11859.774050466127, 9565.299215028961, 10521.444894433367, 7142.511967335347, 6114.697105197927, 12987.415478856776, 8542.497984525562, 12063.373183739419, 6747.038455711736, 9967.265135764526, 11237.382032010282, 10098.869994928464, 13287.052043509233, 15095.11886821879, 7379.476808204507, 9210.36551199033, 6884.728482075649, 7078.351261930817, 6587.630790888939, 9016.975151087488, 10348.2128829063, 11821.469665568638, 12781.115505119815, 8820.568640507754, 9538.773472549146, 10422.07572648206, 10508.674479665107, 6080.168507146378, 5400.0, 9473.472750557914, 8684.932753573008, 10685.168446944768, 13821.798583643224, 9771.451472728855, 10640.368472781673, 12421.347085743364, 7941.979596248308, 8535.6465502112, 13556.700929419752, 9174.502870636443, 14480.544984552082, 7977.733418675463, 7659.127499112072, 13095.998626826826, 8275.799087373132, 11348.6819543352, 16299.088023485838, 12303.603530937402, 10355.647928863273, 11091.173965243343, 14004.127838350829], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6148.382198705699, 6148.382198705699, 5132.056354873435, 5132.056354873435, 4834.439063790454, 4834.439063790454, 6075.25882609591, 6075.25882609591, 6437.348160285188, 6437.348160285188, 5719.076933462132, 5719.076933462132, 4713.029299233918, 4713.029299233918, 4156.139536549532, 4156.139536549532, 4144.069814331544, 4144.069814331544, 6436.991604863411, 6436.991604863411, 2000.0, 2000.0, 5195.457656457312, 5195.457656457312, 6972.793635655482, 6972.793635655482, 6810.300533719814, 6810.300533719814, 6533.379756795788, 6533.379756795788, 5738.408177869661, 5738.408177869661, 6110.947984226723, 6110.947984226723, 3512.8519622420936, 3512.8519622420936, 5245.9371248513835, 5245.9371248513835, 3827.3143625729936, 3827.3143625729936, 8259.885516397739, 8259.885516397739, 4166.804540220879, 4166.804540220879, 3969.974096895242, 3969.974096895242, 5626.219670338156, 5626.219670338156, 4974.148586582653, 4974.148586582653, 4803.972965976025, 4803.972965976025, 9404.50753697233, 9404.50753697233, 5045.437994285045, 5045.437994285045, 7103.130672112518, 7103.130672112518, 5818.99569305234, 5818.99569305234, 4639.808008108968, 4639.808008108968, 3216.3964895304434, 3216.3964895304434, 5932.556374274574, 5932.556374274574, 5096.437532997363, 5096.437532997363, 3158.7018745662626, 3158.7018745662626, 5254.934885396928, 5254.934885396928, 2988.1864023103444, 2988.1864023103444, 6865.68412343648, 6865.68412343648, 6577.121130208858, 6577.121130208858, 4031.565425157267, 4031.565425157267, 5877.174810722285, 5877.174810722285, 5019.534449527442, 5019.534449527442, 6962.978090005756, 6962.978090005756, 4065.3430282399477, 4065.3430282399477, 3332.1099856268756, 3332.1099856268756, 4836.774246287384, 4836.774246287384, 3983.0830401363874, 3983.0830401363874, 5692.48941027513, 5692.48941027513, 4961.205718799405, 4961.205718799405, 5929.887025233056, 5929.887025233056, 4782.649607514468, 4782.649607514468, 5260.722447216685, 5260.722447216685, 3571.2559836676737, 3571.2559836676737, 3057.3485525989636, 3057.3485525989636, 6493.707739428388, 6493.707739428388, 4271.248992262773, 4271.248992262773, 6031.686591869695, 6031.686591869695, 3373.519227855868, 3373.519227855868, 4983.632567882277, 4983.632567882277, 5618.69101600515, 5618.69101600515, 5049.434997464223, 5049.434997464223, 6643.526021754604, 6643.526021754604, 7547.559434109386, 7547.559434109386, 3689.738404102254, 3689.738404102254, 4605.182755995158, 4605.182755995158, 3442.3642410378243, 3442.3642410378243, 3539.1756309654083, 3539.1756309654083, 3293.8153954444697, 3293.8153954444697, 4508.4875755437515, 4508.4875755437515, 5174.106441453134, 5174.106441453134, 5910.7348327843065, 5910.7348327843065, 6390.5577525598965, 6390.5577525598965, 4410.284320253877, 4410.284320253877, 4769.386736274566, 4769.386736274566, 5211.037863241037, 5211.037863241037, 5254.337239832557, 5254.337239832557, 3040.084253573189, 3040.084253573189, 2700.0, 2700.0, 4736.7363752789515, 4736.7363752789515, 4342.4663767865, 4342.4663767865, 5342.584223472361, 5342.584223472361, 6910.899291821606, 6910.899291821606, 4885.725736364437, 4885.725736364437, 5320.184236390836, 5320.184236390836, 6210.673542871675, 6210.673542871675, 3970.989798124154, 3970.989798124154, 4267.823275105598, 4267.823275105598, 6778.350464709878, 6778.350464709878, 4587.25143531821, 4587.25143531821, 7240.27249227605, 7240.27249227605, 3988.8667093377317, 3988.8667093377317, 3829.563749556036, 3829.563749556036, 6547.999313413424, 6547.999313413424, 4137.899543686568, 4137.899543686568, 5674.340977167614, 5674.340977167614, 8149.5440117429225, 8149.5440117429225, 6151.801765468707, 6151.801765468707, 5177.823964431648, 5177.823964431648, 5545.586982621668, 5545.586982621668, 7002.063919175416, 7002.063919175416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512000057157981, "mean_inference_ms": 1.2007611501230284, "mean_action_processing_ms": 0.13387430440620374, "mean_env_wait_ms": 3.3682556723349757, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 752000, "timesteps_this_iter": 0, "agent_timesteps_total": 1504000, "timers": {"sample_time_ms": 1822.506, "sample_throughput": 1755.824, "load_time_ms": 0.137, "load_throughput": 23391029.627, "learn_time_ms": 64.861, "learn_throughput": 49336.573, "update_time_ms": 1.444}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5114379.5, "policy_entropy": 36677.8359375, "policy_loss": 1815497.75, "vf_loss": 33546064.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 752000, "num_agent_steps_sampled": 1504000, "num_steps_trained": 752000, "num_agent_steps_trained": 1504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 940, "training_iteration": 40, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-02-38", "timestamp": 1718794958, "time_this_iter_s": 11.031490564346313, "time_total_s": 437.5716886520386, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 437.5716886520386, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 57.686666666666675, "ram_util_percent": 33.25333333333334}}
{"episode_reward_max": 18809.01507394464, "episode_reward_min": 5400.0, "episode_reward_mean": 10428.973909101645, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2700.0}, "policy_reward_max": {"shared_policy": 9404.50753697233}, "policy_reward_mean": {"shared_policy": 5214.486954550823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16519.77103279547, 8333.609080441754, 7939.948193790484, 11252.439340676312, 9948.297173165302, 9607.945931952007, 18809.01507394464, 10090.87598857009, 14206.261344225011, 11637.991386104673, 9279.616016217922, 6432.792979060887, 11865.112748549152, 10192.875065994722, 6317.403749132525, 10509.869770793852, 5976.372804620689, 13731.368246872946, 13154.242260417705, 8063.130850314534, 11754.349621444573, 10039.068899054873, 13925.956180011515, 8130.686056479895, 6664.219971253751, 9673.548492574762, 7966.166080272775, 11384.978820550248, 9922.411437598817, 11859.774050466127, 9565.299215028961, 10521.444894433367, 7142.511967335347, 6114.697105197927, 12987.415478856776, 8542.497984525562, 12063.373183739419, 6747.038455711736, 9967.265135764526, 11237.382032010282, 10098.869994928464, 13287.052043509233, 15095.11886821879, 7379.476808204507, 9210.36551199033, 6884.728482075649, 7078.351261930817, 6587.630790888939, 9016.975151087488, 10348.2128829063, 11821.469665568638, 12781.115505119815, 8820.568640507754, 9538.773472549146, 10422.07572648206, 10508.674479665107, 6080.168507146378, 5400.0, 9473.472750557914, 8684.932753573008, 10685.168446944768, 13821.798583643224, 9771.451472728855, 10640.368472781673, 12421.347085743364, 7941.979596248308, 8535.6465502112, 13556.700929419752, 9174.502870636443, 14480.544984552082, 7977.733418675463, 7659.127499112072, 13095.998626826826, 8275.799087373132, 11348.6819543352, 16299.088023485838, 12303.603530937402, 10355.647928863273, 11091.173965243343, 14004.127838350829, 12597.020964499188, 10561.768436546408, 8248.258115867833, 10164.271149324726, 18464.66616218703, 13009.947794323209, 14794.936360701555, 10929.82868591262, 9048.645684789855, 8081.970845008878, 9594.312787188635, 10389.285448199767, 11404.093886506216, 10483.329495524013, 8628.871452322255, 10247.292431690646, 10280.89616085637, 7809.624973220842, 10823.739499569103, 15297.082312950075], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [8259.885516397739, 8259.885516397739, 4166.804540220879, 4166.804540220879, 3969.974096895242, 3969.974096895242, 5626.219670338156, 5626.219670338156, 4974.148586582653, 4974.148586582653, 4803.972965976025, 4803.972965976025, 9404.50753697233, 9404.50753697233, 5045.437994285045, 5045.437994285045, 7103.130672112518, 7103.130672112518, 5818.99569305234, 5818.99569305234, 4639.808008108968, 4639.808008108968, 3216.3964895304434, 3216.3964895304434, 5932.556374274574, 5932.556374274574, 5096.437532997363, 5096.437532997363, 3158.7018745662626, 3158.7018745662626, 5254.934885396928, 5254.934885396928, 2988.1864023103444, 2988.1864023103444, 6865.68412343648, 6865.68412343648, 6577.121130208858, 6577.121130208858, 4031.565425157267, 4031.565425157267, 5877.174810722285, 5877.174810722285, 5019.534449527442, 5019.534449527442, 6962.978090005756, 6962.978090005756, 4065.3430282399477, 4065.3430282399477, 3332.1099856268756, 3332.1099856268756, 4836.774246287384, 4836.774246287384, 3983.0830401363874, 3983.0830401363874, 5692.48941027513, 5692.48941027513, 4961.205718799405, 4961.205718799405, 5929.887025233056, 5929.887025233056, 4782.649607514468, 4782.649607514468, 5260.722447216685, 5260.722447216685, 3571.2559836676737, 3571.2559836676737, 3057.3485525989636, 3057.3485525989636, 6493.707739428388, 6493.707739428388, 4271.248992262773, 4271.248992262773, 6031.686591869695, 6031.686591869695, 3373.519227855868, 3373.519227855868, 4983.632567882277, 4983.632567882277, 5618.69101600515, 5618.69101600515, 5049.434997464223, 5049.434997464223, 6643.526021754604, 6643.526021754604, 7547.559434109386, 7547.559434109386, 3689.738404102254, 3689.738404102254, 4605.182755995158, 4605.182755995158, 3442.3642410378243, 3442.3642410378243, 3539.1756309654083, 3539.1756309654083, 3293.8153954444697, 3293.8153954444697, 4508.4875755437515, 4508.4875755437515, 5174.106441453134, 5174.106441453134, 5910.7348327843065, 5910.7348327843065, 6390.5577525598965, 6390.5577525598965, 4410.284320253877, 4410.284320253877, 4769.386736274566, 4769.386736274566, 5211.037863241037, 5211.037863241037, 5254.337239832557, 5254.337239832557, 3040.084253573189, 3040.084253573189, 2700.0, 2700.0, 4736.7363752789515, 4736.7363752789515, 4342.4663767865, 4342.4663767865, 5342.584223472361, 5342.584223472361, 6910.899291821606, 6910.899291821606, 4885.725736364437, 4885.725736364437, 5320.184236390836, 5320.184236390836, 6210.673542871675, 6210.673542871675, 3970.989798124154, 3970.989798124154, 4267.823275105598, 4267.823275105598, 6778.350464709878, 6778.350464709878, 4587.25143531821, 4587.25143531821, 7240.27249227605, 7240.27249227605, 3988.8667093377317, 3988.8667093377317, 3829.563749556036, 3829.563749556036, 6547.999313413424, 6547.999313413424, 4137.899543686568, 4137.899543686568, 5674.340977167614, 5674.340977167614, 8149.5440117429225, 8149.5440117429225, 6151.801765468707, 6151.801765468707, 5177.823964431648, 5177.823964431648, 5545.586982621668, 5545.586982621668, 7002.063919175416, 7002.063919175416, 6298.510482249596, 6298.510482249596, 5280.884218273219, 5280.884218273219, 4124.129057933917, 4124.129057933917, 5082.135574662367, 5082.135574662367, 9232.333081093515, 9232.333081093515, 6504.973897161608, 6504.973897161608, 7397.468180350781, 7397.468180350781, 5464.914342956299, 5464.914342956299, 4524.322842394924, 4524.322842394924, 4040.985422504439, 4040.985422504439, 4797.156393594316, 4797.156393594316, 5194.642724099882, 5194.642724099882, 5702.046943253108, 5702.046943253108, 5241.664747761993, 5241.664747761993, 4314.435726161131, 4314.435726161131, 5123.646215845316, 5123.646215845316, 5140.448080428195, 5140.448080428195, 3904.812486610421, 3904.812486610421, 5411.869749784554, 5411.869749784554, 7648.541156475036, 7648.541156475036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512453345791574, "mean_inference_ms": 1.2008557064404894, "mean_action_processing_ms": 0.13388292027551058, "mean_env_wait_ms": 3.368740275933309, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 771200, "timesteps_this_iter": 0, "agent_timesteps_total": 1542400, "timers": {"sample_time_ms": 1911.451, "sample_throughput": 1674.121, "load_time_ms": 0.138, "load_throughput": 23113092.475, "learn_time_ms": 65.23, "learn_throughput": 49056.958, "update_time_ms": 1.419}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7399890.0, "policy_entropy": 36006.46875, "policy_loss": 2611241.25, "vf_loss": 48547956.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 771200, "num_agent_steps_sampled": 1542400, "num_steps_trained": 771200, "num_agent_steps_trained": 1542400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 960, "training_iteration": 41, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-02-49", "timestamp": 1718794969, "time_this_iter_s": 11.648402690887451, "time_total_s": 449.220091342926, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf431f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 449.220091342926, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 58.57647058823529, "ram_util_percent": 33.27647058823529}}
{"episode_reward_max": 18464.66616218703, "episode_reward_min": 5400.0, "episode_reward_mean": 10770.021450584261, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2700.0}, "policy_reward_max": {"shared_policy": 9232.333081093515}, "policy_reward_mean": {"shared_policy": 5385.010725292129}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11754.349621444573, 10039.068899054873, 13925.956180011515, 8130.686056479895, 6664.219971253751, 9673.548492574762, 7966.166080272775, 11384.978820550248, 9922.411437598817, 11859.774050466127, 9565.299215028961, 10521.444894433367, 7142.511967335347, 6114.697105197927, 12987.415478856776, 8542.497984525562, 12063.373183739419, 6747.038455711736, 9967.265135764526, 11237.382032010282, 10098.869994928464, 13287.052043509233, 15095.11886821879, 7379.476808204507, 9210.36551199033, 6884.728482075649, 7078.351261930817, 6587.630790888939, 9016.975151087488, 10348.2128829063, 11821.469665568638, 12781.115505119815, 8820.568640507754, 9538.773472549146, 10422.07572648206, 10508.674479665107, 6080.168507146378, 5400.0, 9473.472750557914, 8684.932753573008, 10685.168446944768, 13821.798583643224, 9771.451472728855, 10640.368472781673, 12421.347085743364, 7941.979596248308, 8535.6465502112, 13556.700929419752, 9174.502870636443, 14480.544984552082, 7977.733418675463, 7659.127499112072, 13095.998626826826, 8275.799087373132, 11348.6819543352, 16299.088023485838, 12303.603530937402, 10355.647928863273, 11091.173965243343, 14004.127838350829, 12597.020964499188, 10561.768436546408, 8248.258115867833, 10164.271149324726, 18464.66616218703, 13009.947794323209, 14794.936360701555, 10929.82868591262, 9048.645684789855, 8081.970845008878, 9594.312787188635, 10389.285448199767, 11404.093886506216, 10483.329495524013, 8628.871452322255, 10247.292431690646, 10280.89616085637, 7809.624973220842, 10823.739499569103, 15297.082312950075, 5923.129748054063, 14500.279096712766, 12512.772906138951, 7464.834452710085, 6803.470764689777, 15969.59394603382, 7466.072032076207, 13289.771281746129, 15225.61309483543, 16420.222687159046, 10989.803806005231, 15937.0274556611, 9641.000060776765, 10661.5612463941, 15892.166725222585, 13118.98710134139, 14446.947557388572, 15273.599094668705, 11058.66649399911, 15378.1736342884], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5877.174810722285, 5877.174810722285, 5019.534449527442, 5019.534449527442, 6962.978090005756, 6962.978090005756, 4065.3430282399477, 4065.3430282399477, 3332.1099856268756, 3332.1099856268756, 4836.774246287384, 4836.774246287384, 3983.0830401363874, 3983.0830401363874, 5692.48941027513, 5692.48941027513, 4961.205718799405, 4961.205718799405, 5929.887025233056, 5929.887025233056, 4782.649607514468, 4782.649607514468, 5260.722447216685, 5260.722447216685, 3571.2559836676737, 3571.2559836676737, 3057.3485525989636, 3057.3485525989636, 6493.707739428388, 6493.707739428388, 4271.248992262773, 4271.248992262773, 6031.686591869695, 6031.686591869695, 3373.519227855868, 3373.519227855868, 4983.632567882277, 4983.632567882277, 5618.69101600515, 5618.69101600515, 5049.434997464223, 5049.434997464223, 6643.526021754604, 6643.526021754604, 7547.559434109386, 7547.559434109386, 3689.738404102254, 3689.738404102254, 4605.182755995158, 4605.182755995158, 3442.3642410378243, 3442.3642410378243, 3539.1756309654083, 3539.1756309654083, 3293.8153954444697, 3293.8153954444697, 4508.4875755437515, 4508.4875755437515, 5174.106441453134, 5174.106441453134, 5910.7348327843065, 5910.7348327843065, 6390.5577525598965, 6390.5577525598965, 4410.284320253877, 4410.284320253877, 4769.386736274566, 4769.386736274566, 5211.037863241037, 5211.037863241037, 5254.337239832557, 5254.337239832557, 3040.084253573189, 3040.084253573189, 2700.0, 2700.0, 4736.7363752789515, 4736.7363752789515, 4342.4663767865, 4342.4663767865, 5342.584223472361, 5342.584223472361, 6910.899291821606, 6910.899291821606, 4885.725736364437, 4885.725736364437, 5320.184236390836, 5320.184236390836, 6210.673542871675, 6210.673542871675, 3970.989798124154, 3970.989798124154, 4267.823275105598, 4267.823275105598, 6778.350464709878, 6778.350464709878, 4587.25143531821, 4587.25143531821, 7240.27249227605, 7240.27249227605, 3988.8667093377317, 3988.8667093377317, 3829.563749556036, 3829.563749556036, 6547.999313413424, 6547.999313413424, 4137.899543686568, 4137.899543686568, 5674.340977167614, 5674.340977167614, 8149.5440117429225, 8149.5440117429225, 6151.801765468707, 6151.801765468707, 5177.823964431648, 5177.823964431648, 5545.586982621668, 5545.586982621668, 7002.063919175416, 7002.063919175416, 6298.510482249596, 6298.510482249596, 5280.884218273219, 5280.884218273219, 4124.129057933917, 4124.129057933917, 5082.135574662367, 5082.135574662367, 9232.333081093515, 9232.333081093515, 6504.973897161608, 6504.973897161608, 7397.468180350781, 7397.468180350781, 5464.914342956299, 5464.914342956299, 4524.322842394924, 4524.322842394924, 4040.985422504439, 4040.985422504439, 4797.156393594316, 4797.156393594316, 5194.642724099882, 5194.642724099882, 5702.046943253108, 5702.046943253108, 5241.664747761993, 5241.664747761993, 4314.435726161131, 4314.435726161131, 5123.646215845316, 5123.646215845316, 5140.448080428195, 5140.448080428195, 3904.812486610421, 3904.812486610421, 5411.869749784554, 5411.869749784554, 7648.541156475036, 7648.541156475036, 2961.5648740270317, 2961.5648740270317, 7250.13954835639, 7250.13954835639, 6256.386453069488, 6256.386453069488, 3732.4172263550427, 3732.4172263550427, 3401.7353823448884, 3401.7353823448884, 7984.796973016913, 7984.796973016913, 3733.0360160381033, 3733.0360160381033, 6644.885640873081, 6644.885640873081, 7612.806547417715, 7612.806547417715, 8210.11134357951, 8210.11134357951, 5494.9019030026175, 5494.9019030026175, 7968.513727830537, 7968.513727830537, 4820.500030388393, 4820.500030388393, 5330.780623197036, 5330.780623197036, 7946.083362611289, 7946.083362611289, 6559.493550670693, 6559.493550670693, 7223.473778694286, 7223.473778694286, 7636.799547334351, 7636.799547334351, 5529.333246999568, 5529.333246999568, 7689.0868171442, 7689.0868171442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2511628224204748, "mean_inference_ms": 1.2003749698826638, "mean_action_processing_ms": 0.1337774920626418, "mean_env_wait_ms": 3.3702257836098726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 790400, "timesteps_this_iter": 0, "agent_timesteps_total": 1580800, "timers": {"sample_time_ms": 1923.02, "sample_throughput": 1664.05, "load_time_ms": 0.13, "load_throughput": 24618071.9, "learn_time_ms": 65.483, "learn_throughput": 48867.469, "update_time_ms": 1.418}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7697487.0, "policy_entropy": 37407.44921875, "policy_loss": 2805475.0, "vf_loss": 54681468.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 790400, "num_agent_steps_sampled": 1580800, "num_steps_trained": 790400, "num_agent_steps_trained": 1580800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 980, "training_iteration": 42, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-03-01", "timestamp": 1718794981, "time_this_iter_s": 11.337254285812378, "time_total_s": 460.5573456287384, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9a8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 460.5573456287384, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 57.78125, "ram_util_percent": 33.21875}}
{"episode_reward_max": 18464.66616218703, "episode_reward_min": 5400.0, "episode_reward_mean": 11692.003565213075, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2700.0}, "policy_reward_max": {"shared_policy": 9232.333081093515}, "policy_reward_mean": {"shared_policy": 5846.00178260654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11821.469665568638, 12781.115505119815, 8820.568640507754, 9538.773472549146, 10422.07572648206, 10508.674479665107, 6080.168507146378, 5400.0, 9473.472750557914, 8684.932753573008, 10685.168446944768, 13821.798583643224, 9771.451472728855, 10640.368472781673, 12421.347085743364, 7941.979596248308, 8535.6465502112, 13556.700929419752, 9174.502870636443, 14480.544984552082, 7977.733418675463, 7659.127499112072, 13095.998626826826, 8275.799087373132, 11348.6819543352, 16299.088023485838, 12303.603530937402, 10355.647928863273, 11091.173965243343, 14004.127838350829, 12597.020964499188, 10561.768436546408, 8248.258115867833, 10164.271149324726, 18464.66616218703, 13009.947794323209, 14794.936360701555, 10929.82868591262, 9048.645684789855, 8081.970845008878, 9594.312787188635, 10389.285448199767, 11404.093886506216, 10483.329495524013, 8628.871452322255, 10247.292431690646, 10280.89616085637, 7809.624973220842, 10823.739499569103, 15297.082312950075, 5923.129748054063, 14500.279096712766, 12512.772906138951, 7464.834452710085, 6803.470764689777, 15969.59394603382, 7466.072032076207, 13289.771281746129, 15225.61309483543, 16420.222687159046, 10989.803806005231, 15937.0274556611, 9641.000060776765, 10661.5612463941, 15892.166725222585, 13118.98710134139, 14446.947557388572, 15273.599094668705, 11058.66649399911, 15378.1736342884, 15483.51731960375, 12894.15486919977, 13736.139958511172, 11250.133757167874, 8535.067728109923, 14680.48101316627, 6942.300496831893, 7943.719641973486, 10774.699743310925, 12960.771512514631, 11842.824533343817, 17628.71787897977, 11031.336752062503, 14365.763855528385, 12616.863648673825, 10706.883132064646, 14573.110786088939, 16390.093182663095, 11792.65359523558, 16675.962176375833, 9561.962374343479, 12331.589710601027, 14383.224677166087, 13022.440076101575, 13284.873590824136, 15357.746300110339, 14276.219150786343, 13129.415526046421, 11672.094827993573, 13550.316505554416], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5910.7348327843065, 5910.7348327843065, 6390.5577525598965, 6390.5577525598965, 4410.284320253877, 4410.284320253877, 4769.386736274566, 4769.386736274566, 5211.037863241037, 5211.037863241037, 5254.337239832557, 5254.337239832557, 3040.084253573189, 3040.084253573189, 2700.0, 2700.0, 4736.7363752789515, 4736.7363752789515, 4342.4663767865, 4342.4663767865, 5342.584223472361, 5342.584223472361, 6910.899291821606, 6910.899291821606, 4885.725736364437, 4885.725736364437, 5320.184236390836, 5320.184236390836, 6210.673542871675, 6210.673542871675, 3970.989798124154, 3970.989798124154, 4267.823275105598, 4267.823275105598, 6778.350464709878, 6778.350464709878, 4587.25143531821, 4587.25143531821, 7240.27249227605, 7240.27249227605, 3988.8667093377317, 3988.8667093377317, 3829.563749556036, 3829.563749556036, 6547.999313413424, 6547.999313413424, 4137.899543686568, 4137.899543686568, 5674.340977167614, 5674.340977167614, 8149.5440117429225, 8149.5440117429225, 6151.801765468707, 6151.801765468707, 5177.823964431648, 5177.823964431648, 5545.586982621668, 5545.586982621668, 7002.063919175416, 7002.063919175416, 6298.510482249596, 6298.510482249596, 5280.884218273219, 5280.884218273219, 4124.129057933917, 4124.129057933917, 5082.135574662367, 5082.135574662367, 9232.333081093515, 9232.333081093515, 6504.973897161608, 6504.973897161608, 7397.468180350781, 7397.468180350781, 5464.914342956299, 5464.914342956299, 4524.322842394924, 4524.322842394924, 4040.985422504439, 4040.985422504439, 4797.156393594316, 4797.156393594316, 5194.642724099882, 5194.642724099882, 5702.046943253108, 5702.046943253108, 5241.664747761993, 5241.664747761993, 4314.435726161131, 4314.435726161131, 5123.646215845316, 5123.646215845316, 5140.448080428195, 5140.448080428195, 3904.812486610421, 3904.812486610421, 5411.869749784554, 5411.869749784554, 7648.541156475036, 7648.541156475036, 2961.5648740270317, 2961.5648740270317, 7250.13954835639, 7250.13954835639, 6256.386453069488, 6256.386453069488, 3732.4172263550427, 3732.4172263550427, 3401.7353823448884, 3401.7353823448884, 7984.796973016913, 7984.796973016913, 3733.0360160381033, 3733.0360160381033, 6644.885640873081, 6644.885640873081, 7612.806547417715, 7612.806547417715, 8210.11134357951, 8210.11134357951, 5494.9019030026175, 5494.9019030026175, 7968.513727830537, 7968.513727830537, 4820.500030388393, 4820.500030388393, 5330.780623197036, 5330.780623197036, 7946.083362611289, 7946.083362611289, 6559.493550670693, 6559.493550670693, 7223.473778694286, 7223.473778694286, 7636.799547334351, 7636.799547334351, 5529.333246999568, 5529.333246999568, 7689.0868171442, 7689.0868171442, 7741.7586598018715, 7741.7586598018715, 6447.077434599885, 6447.077434599885, 6868.069979255586, 6868.069979255586, 5625.066878583938, 5625.066878583938, 4267.533864054972, 4267.533864054972, 7340.240506583128, 7340.240506583128, 3471.1502484159464, 3471.1502484159464, 3971.859820986743, 3971.859820986743, 5387.349871655455, 5387.349871655455, 6480.38575625731, 6480.38575625731, 5921.412266671914, 5921.412266671914, 8814.358939489892, 8814.358939489892, 5515.668376031261, 5515.668376031261, 7182.881927764203, 7182.881927764203, 6308.431824336922, 6308.431824336922, 5353.44156603231, 5353.44156603231, 7286.555393044466, 7286.555393044466, 8195.04659133155, 8195.04659133155, 5896.326797617785, 5896.326797617785, 8337.98108818792, 8337.98108818792, 4780.981187171738, 4780.981187171738, 6165.794855300503, 6165.794855300503, 7191.612338583065, 7191.612338583065, 6511.220038050793, 6511.220038050793, 6642.436795412086, 6642.436795412086, 7678.8731500551585, 7678.8731500551585, 7138.109575393173, 7138.109575393173, 6564.707763023211, 6564.707763023211, 5836.047413996778, 5836.047413996778, 6775.158252777206, 6775.158252777206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.251348812578633, "mean_inference_ms": 1.2013187897811413, "mean_action_processing_ms": 0.13393532166915645, "mean_env_wait_ms": 3.370765389732915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 809600, "timesteps_this_iter": 0, "agent_timesteps_total": 1619200, "timers": {"sample_time_ms": 1858.739, "sample_throughput": 1721.597, "load_time_ms": 0.139, "load_throughput": 23014013.717, "learn_time_ms": 66.021, "learn_throughput": 48469.224, "update_time_ms": 1.448}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8269323.5, "policy_entropy": 37308.15625, "policy_loss": 3003922.0, "vf_loss": 61617972.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 809600, "num_agent_steps_sampled": 1619200, "num_steps_trained": 809600, "num_agent_steps_trained": 1619200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1010, "training_iteration": 43, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-03-12", "timestamp": 1718794992, "time_this_iter_s": 11.15612268447876, "time_total_s": 471.71346831321716, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9af70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 471.71346831321716, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.31875, "ram_util_percent": 33.25625}}
{"episode_reward_max": 19635.706353792135, "episode_reward_min": 5923.129748054063, "episode_reward_mean": 12409.369582535925, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 2961.5648740270317}, "policy_reward_max": {"shared_policy": 9817.853176896071}, "policy_reward_mean": {"shared_policy": 6204.684791267961}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7977.733418675463, 7659.127499112072, 13095.998626826826, 8275.799087373132, 11348.6819543352, 16299.088023485838, 12303.603530937402, 10355.647928863273, 11091.173965243343, 14004.127838350829, 12597.020964499188, 10561.768436546408, 8248.258115867833, 10164.271149324726, 18464.66616218703, 13009.947794323209, 14794.936360701555, 10929.82868591262, 9048.645684789855, 8081.970845008878, 9594.312787188635, 10389.285448199767, 11404.093886506216, 10483.329495524013, 8628.871452322255, 10247.292431690646, 10280.89616085637, 7809.624973220842, 10823.739499569103, 15297.082312950075, 5923.129748054063, 14500.279096712766, 12512.772906138951, 7464.834452710085, 6803.470764689777, 15969.59394603382, 7466.072032076207, 13289.771281746129, 15225.61309483543, 16420.222687159046, 10989.803806005231, 15937.0274556611, 9641.000060776765, 10661.5612463941, 15892.166725222585, 13118.98710134139, 14446.947557388572, 15273.599094668705, 11058.66649399911, 15378.1736342884, 15483.51731960375, 12894.15486919977, 13736.139958511172, 11250.133757167874, 8535.067728109923, 14680.48101316627, 6942.300496831893, 7943.719641973486, 10774.699743310925, 12960.771512514631, 11842.824533343817, 17628.71787897977, 11031.336752062503, 14365.763855528385, 12616.863648673825, 10706.883132064646, 14573.110786088939, 16390.093182663095, 11792.65359523558, 16675.962176375833, 9561.962374343479, 12331.589710601027, 14383.224677166087, 13022.440076101575, 13284.873590824136, 15357.746300110339, 14276.219150786343, 13129.415526046421, 11672.094827993573, 13550.316505554416, 14511.98903081645, 15677.65661104178, 16141.892848682226, 14750.169740704918, 11626.742756093532, 14079.046920969755, 11392.417848763202, 14878.810609516913, 13850.125552227702, 19635.706353792135, 9668.918237963037, 15850.778460477912, 11487.815659704072, 13411.781890616654, 14338.108942684456, 13382.91543375669, 9965.398090311126, 15668.537797244739, 13576.959297715159, 12401.590143281548], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3988.8667093377317, 3988.8667093377317, 3829.563749556036, 3829.563749556036, 6547.999313413424, 6547.999313413424, 4137.899543686568, 4137.899543686568, 5674.340977167614, 5674.340977167614, 8149.5440117429225, 8149.5440117429225, 6151.801765468707, 6151.801765468707, 5177.823964431648, 5177.823964431648, 5545.586982621668, 5545.586982621668, 7002.063919175416, 7002.063919175416, 6298.510482249596, 6298.510482249596, 5280.884218273219, 5280.884218273219, 4124.129057933917, 4124.129057933917, 5082.135574662367, 5082.135574662367, 9232.333081093515, 9232.333081093515, 6504.973897161608, 6504.973897161608, 7397.468180350781, 7397.468180350781, 5464.914342956299, 5464.914342956299, 4524.322842394924, 4524.322842394924, 4040.985422504439, 4040.985422504439, 4797.156393594316, 4797.156393594316, 5194.642724099882, 5194.642724099882, 5702.046943253108, 5702.046943253108, 5241.664747761993, 5241.664747761993, 4314.435726161131, 4314.435726161131, 5123.646215845316, 5123.646215845316, 5140.448080428195, 5140.448080428195, 3904.812486610421, 3904.812486610421, 5411.869749784554, 5411.869749784554, 7648.541156475036, 7648.541156475036, 2961.5648740270317, 2961.5648740270317, 7250.13954835639, 7250.13954835639, 6256.386453069488, 6256.386453069488, 3732.4172263550427, 3732.4172263550427, 3401.7353823448884, 3401.7353823448884, 7984.796973016913, 7984.796973016913, 3733.0360160381033, 3733.0360160381033, 6644.885640873081, 6644.885640873081, 7612.806547417715, 7612.806547417715, 8210.11134357951, 8210.11134357951, 5494.9019030026175, 5494.9019030026175, 7968.513727830537, 7968.513727830537, 4820.500030388393, 4820.500030388393, 5330.780623197036, 5330.780623197036, 7946.083362611289, 7946.083362611289, 6559.493550670693, 6559.493550670693, 7223.473778694286, 7223.473778694286, 7636.799547334351, 7636.799547334351, 5529.333246999568, 5529.333246999568, 7689.0868171442, 7689.0868171442, 7741.7586598018715, 7741.7586598018715, 6447.077434599885, 6447.077434599885, 6868.069979255586, 6868.069979255586, 5625.066878583938, 5625.066878583938, 4267.533864054972, 4267.533864054972, 7340.240506583128, 7340.240506583128, 3471.1502484159464, 3471.1502484159464, 3971.859820986743, 3971.859820986743, 5387.349871655455, 5387.349871655455, 6480.38575625731, 6480.38575625731, 5921.412266671914, 5921.412266671914, 8814.358939489892, 8814.358939489892, 5515.668376031261, 5515.668376031261, 7182.881927764203, 7182.881927764203, 6308.431824336922, 6308.431824336922, 5353.44156603231, 5353.44156603231, 7286.555393044466, 7286.555393044466, 8195.04659133155, 8195.04659133155, 5896.326797617785, 5896.326797617785, 8337.98108818792, 8337.98108818792, 4780.981187171738, 4780.981187171738, 6165.794855300503, 6165.794855300503, 7191.612338583065, 7191.612338583065, 6511.220038050793, 6511.220038050793, 6642.436795412086, 6642.436795412086, 7678.8731500551585, 7678.8731500551585, 7138.109575393173, 7138.109575393173, 6564.707763023211, 6564.707763023211, 5836.047413996778, 5836.047413996778, 6775.158252777206, 6775.158252777206, 7255.994515408225, 7255.994515408225, 7838.828305520885, 7838.828305520885, 8070.946424341106, 8070.946424341106, 7375.084870352453, 7375.084870352453, 5813.371378046767, 5813.371378046767, 7039.5234604848665, 7039.5234604848665, 5696.208924381608, 5696.208924381608, 7439.405304758458, 7439.405304758458, 6925.062776113857, 6925.062776113857, 9817.853176896071, 9817.853176896071, 4834.459118981523, 4834.459118981523, 7925.389230238952, 7925.389230238952, 5743.907829852033, 5743.907829852033, 6705.890945308303, 6705.890945308303, 7169.0544713422205, 7169.0544713422205, 6691.457716878351, 6691.457716878351, 4982.6990451555575, 4982.6990451555575, 7834.268898622382, 7834.268898622382, 6788.479648857587, 6788.479648857587, 6200.79507164079, 6200.79507164079]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512951258247964, "mean_inference_ms": 1.2009808460041842, "mean_action_processing_ms": 0.13385002640113022, "mean_env_wait_ms": 3.372750160331662, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 828800, "timesteps_this_iter": 0, "agent_timesteps_total": 1657600, "timers": {"sample_time_ms": 1857.95, "sample_throughput": 1722.329, "load_time_ms": 0.142, "load_throughput": 22576573.255, "learn_time_ms": 68.251, "learn_throughput": 46885.538, "update_time_ms": 1.489}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8883721.0, "policy_entropy": 36934.23046875, "policy_loss": 3204584.75, "vf_loss": 62399612.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 828800, "num_agent_steps_sampled": 1657600, "num_steps_trained": 828800, "num_agent_steps_trained": 1657600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1030, "training_iteration": 44, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-03-23", "timestamp": 1718795003, "time_this_iter_s": 11.228252172470093, "time_total_s": 482.94172048568726, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 482.94172048568726, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 57.89375, "ram_util_percent": 33.25}}
{"episode_reward_max": 19635.706353792135, "episode_reward_min": 5923.129748054063, "episode_reward_mean": 12993.053620079074, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 2961.5648740270317}, "policy_reward_max": {"shared_policy": 9817.853176896071}, "policy_reward_mean": {"shared_policy": 6496.526810039536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5923.129748054063, 14500.279096712766, 12512.772906138951, 7464.834452710085, 6803.470764689777, 15969.59394603382, 7466.072032076207, 13289.771281746129, 15225.61309483543, 16420.222687159046, 10989.803806005231, 15937.0274556611, 9641.000060776765, 10661.5612463941, 15892.166725222585, 13118.98710134139, 14446.947557388572, 15273.599094668705, 11058.66649399911, 15378.1736342884, 15483.51731960375, 12894.15486919977, 13736.139958511172, 11250.133757167874, 8535.067728109923, 14680.48101316627, 6942.300496831893, 7943.719641973486, 10774.699743310925, 12960.771512514631, 11842.824533343817, 17628.71787897977, 11031.336752062503, 14365.763855528385, 12616.863648673825, 10706.883132064646, 14573.110786088939, 16390.093182663095, 11792.65359523558, 16675.962176375833, 9561.962374343479, 12331.589710601027, 14383.224677166087, 13022.440076101575, 13284.873590824136, 15357.746300110339, 14276.219150786343, 13129.415526046421, 11672.094827993573, 13550.316505554416, 14511.98903081645, 15677.65661104178, 16141.892848682226, 14750.169740704918, 11626.742756093532, 14079.046920969755, 11392.417848763202, 14878.810609516913, 13850.125552227702, 19635.706353792135, 9668.918237963037, 15850.778460477912, 11487.815659704072, 13411.781890616654, 14338.108942684456, 13382.91543375669, 9965.398090311126, 15668.537797244739, 13576.959297715159, 12401.590143281548, 12324.514244011942, 11041.448227106943, 13912.82245003765, 11070.571023749115, 9929.496337132201, 11619.560653353765, 14621.781671150893, 16253.363496727306, 9393.762685675829, 13163.952278519333, 13357.056489349048, 11542.95225213483, 11471.625454078923, 11876.127531898448, 13219.668837315265, 14996.886124469696, 13562.682439971788, 15699.103571334243, 12401.773757707782, 8683.262971120632, 9818.17127950364, 17702.816136241257, 14766.872052094852, 14143.791547356981, 16328.379793529184, 15603.710184739371, 12132.272906322552, 11176.546773159625, 15740.21208878505, 14084.043016129395], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2961.5648740270317, 2961.5648740270317, 7250.13954835639, 7250.13954835639, 6256.386453069488, 6256.386453069488, 3732.4172263550427, 3732.4172263550427, 3401.7353823448884, 3401.7353823448884, 7984.796973016913, 7984.796973016913, 3733.0360160381033, 3733.0360160381033, 6644.885640873081, 6644.885640873081, 7612.806547417715, 7612.806547417715, 8210.11134357951, 8210.11134357951, 5494.9019030026175, 5494.9019030026175, 7968.513727830537, 7968.513727830537, 4820.500030388393, 4820.500030388393, 5330.780623197036, 5330.780623197036, 7946.083362611289, 7946.083362611289, 6559.493550670693, 6559.493550670693, 7223.473778694286, 7223.473778694286, 7636.799547334351, 7636.799547334351, 5529.333246999568, 5529.333246999568, 7689.0868171442, 7689.0868171442, 7741.7586598018715, 7741.7586598018715, 6447.077434599885, 6447.077434599885, 6868.069979255586, 6868.069979255586, 5625.066878583938, 5625.066878583938, 4267.533864054972, 4267.533864054972, 7340.240506583128, 7340.240506583128, 3471.1502484159464, 3471.1502484159464, 3971.859820986743, 3971.859820986743, 5387.349871655455, 5387.349871655455, 6480.38575625731, 6480.38575625731, 5921.412266671914, 5921.412266671914, 8814.358939489892, 8814.358939489892, 5515.668376031261, 5515.668376031261, 7182.881927764203, 7182.881927764203, 6308.431824336922, 6308.431824336922, 5353.44156603231, 5353.44156603231, 7286.555393044466, 7286.555393044466, 8195.04659133155, 8195.04659133155, 5896.326797617785, 5896.326797617785, 8337.98108818792, 8337.98108818792, 4780.981187171738, 4780.981187171738, 6165.794855300503, 6165.794855300503, 7191.612338583065, 7191.612338583065, 6511.220038050793, 6511.220038050793, 6642.436795412086, 6642.436795412086, 7678.8731500551585, 7678.8731500551585, 7138.109575393173, 7138.109575393173, 6564.707763023211, 6564.707763023211, 5836.047413996778, 5836.047413996778, 6775.158252777206, 6775.158252777206, 7255.994515408225, 7255.994515408225, 7838.828305520885, 7838.828305520885, 8070.946424341106, 8070.946424341106, 7375.084870352453, 7375.084870352453, 5813.371378046767, 5813.371378046767, 7039.5234604848665, 7039.5234604848665, 5696.208924381608, 5696.208924381608, 7439.405304758458, 7439.405304758458, 6925.062776113857, 6925.062776113857, 9817.853176896071, 9817.853176896071, 4834.459118981523, 4834.459118981523, 7925.389230238952, 7925.389230238952, 5743.907829852033, 5743.907829852033, 6705.890945308303, 6705.890945308303, 7169.0544713422205, 7169.0544713422205, 6691.457716878351, 6691.457716878351, 4982.6990451555575, 4982.6990451555575, 7834.268898622382, 7834.268898622382, 6788.479648857587, 6788.479648857587, 6200.79507164079, 6200.79507164079, 6162.257122005976, 6162.257122005976, 5520.724113553463, 5520.724113553463, 6956.411225018828, 6956.411225018828, 5535.285511874556, 5535.285511874556, 4964.748168566086, 4964.748168566086, 5809.780326676864, 5809.780326676864, 7310.890835575465, 7310.890835575465, 8126.6817483636605, 8126.6817483636605, 4696.881342837915, 4696.881342837915, 6581.976139259674, 6581.976139259674, 6678.528244674533, 6678.528244674533, 5771.476126067416, 5771.476126067416, 5735.812727039459, 5735.812727039459, 5938.063765949224, 5938.063765949224, 6609.834418657643, 6609.834418657643, 7498.443062234848, 7498.443062234848, 6781.3412199859085, 6781.3412199859085, 7849.551785667081, 7849.551785667081, 6200.886878853882, 6200.886878853882, 4341.631485560312, 4341.631485560312, 4909.085639751822, 4909.085639751822, 8851.408068120625, 8851.408068120625, 7383.436026047422, 7383.436026047422, 7071.895773678494, 7071.895773678494, 8164.189896764594, 8164.189896764594, 7801.855092369675, 7801.855092369675, 6066.136453161272, 6066.136453161272, 5588.273386579809, 5588.273386579809, 7870.106044392509, 7870.106044392509, 7042.021508064698, 7042.021508064698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25139022618078255, "mean_inference_ms": 1.201594793017697, "mean_action_processing_ms": 0.1339691301576995, "mean_env_wait_ms": 3.372423136251187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 848000, "timesteps_this_iter": 0, "agent_timesteps_total": 1696000, "timers": {"sample_time_ms": 1831.207, "sample_throughput": 1747.481, "load_time_ms": 0.132, "load_throughput": 24244531.792, "learn_time_ms": 66.544, "learn_throughput": 48088.804, "update_time_ms": 1.497}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7795010.0, "policy_entropy": 38512.90234375, "policy_loss": 2899413.0, "vf_loss": 59775964.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 848000, "num_agent_steps_sampled": 1696000, "num_steps_trained": 848000, "num_agent_steps_trained": 1696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1060, "training_iteration": 45, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-03-34", "timestamp": 1718795014, "time_this_iter_s": 10.867834091186523, "time_total_s": 493.8095545768738, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 493.8095545768738, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.86875, "ram_util_percent": 33.23125}}
{"episode_reward_max": 19635.706353792135, "episode_reward_min": 6942.300496831893, "episode_reward_mean": 13287.377546479727, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 3471.1502484159464}, "policy_reward_max": {"shared_policy": 9817.853176896071}, "policy_reward_mean": {"shared_policy": 6643.688773239864}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15483.51731960375, 12894.15486919977, 13736.139958511172, 11250.133757167874, 8535.067728109923, 14680.48101316627, 6942.300496831893, 7943.719641973486, 10774.699743310925, 12960.771512514631, 11842.824533343817, 17628.71787897977, 11031.336752062503, 14365.763855528385, 12616.863648673825, 10706.883132064646, 14573.110786088939, 16390.093182663095, 11792.65359523558, 16675.962176375833, 9561.962374343479, 12331.589710601027, 14383.224677166087, 13022.440076101575, 13284.873590824136, 15357.746300110339, 14276.219150786343, 13129.415526046421, 11672.094827993573, 13550.316505554416, 14511.98903081645, 15677.65661104178, 16141.892848682226, 14750.169740704918, 11626.742756093532, 14079.046920969755, 11392.417848763202, 14878.810609516913, 13850.125552227702, 19635.706353792135, 9668.918237963037, 15850.778460477912, 11487.815659704072, 13411.781890616654, 14338.108942684456, 13382.91543375669, 9965.398090311126, 15668.537797244739, 13576.959297715159, 12401.590143281548, 12324.514244011942, 11041.448227106943, 13912.82245003765, 11070.571023749115, 9929.496337132201, 11619.560653353765, 14621.781671150893, 16253.363496727306, 9393.762685675829, 13163.952278519333, 13357.056489349048, 11542.95225213483, 11471.625454078923, 11876.127531898448, 13219.668837315265, 14996.886124469696, 13562.682439971788, 15699.103571334243, 12401.773757707782, 8683.262971120632, 9818.17127950364, 17702.816136241257, 14766.872052094852, 14143.791547356981, 16328.379793529184, 15603.710184739371, 12132.272906322552, 11176.546773159625, 15740.21208878505, 14084.043016129395, 14492.021757826857, 13156.987219558396, 16257.052229751629, 10537.756006099095, 11092.293895089031, 15272.603573778986, 12077.232260137185, 11062.776548872116, 13715.724979988518, 15643.259320505662, 15194.1084678839, 14147.543426203058, 15829.797193040577, 13266.57806586981, 16035.842855022369, 14846.71992906418, 11007.274854208634, 16716.45052770302, 11689.392223366602, 15364.67049199828], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7741.7586598018715, 7741.7586598018715, 6447.077434599885, 6447.077434599885, 6868.069979255586, 6868.069979255586, 5625.066878583938, 5625.066878583938, 4267.533864054972, 4267.533864054972, 7340.240506583128, 7340.240506583128, 3471.1502484159464, 3471.1502484159464, 3971.859820986743, 3971.859820986743, 5387.349871655455, 5387.349871655455, 6480.38575625731, 6480.38575625731, 5921.412266671914, 5921.412266671914, 8814.358939489892, 8814.358939489892, 5515.668376031261, 5515.668376031261, 7182.881927764203, 7182.881927764203, 6308.431824336922, 6308.431824336922, 5353.44156603231, 5353.44156603231, 7286.555393044466, 7286.555393044466, 8195.04659133155, 8195.04659133155, 5896.326797617785, 5896.326797617785, 8337.98108818792, 8337.98108818792, 4780.981187171738, 4780.981187171738, 6165.794855300503, 6165.794855300503, 7191.612338583065, 7191.612338583065, 6511.220038050793, 6511.220038050793, 6642.436795412086, 6642.436795412086, 7678.8731500551585, 7678.8731500551585, 7138.109575393173, 7138.109575393173, 6564.707763023211, 6564.707763023211, 5836.047413996778, 5836.047413996778, 6775.158252777206, 6775.158252777206, 7255.994515408225, 7255.994515408225, 7838.828305520885, 7838.828305520885, 8070.946424341106, 8070.946424341106, 7375.084870352453, 7375.084870352453, 5813.371378046767, 5813.371378046767, 7039.5234604848665, 7039.5234604848665, 5696.208924381608, 5696.208924381608, 7439.405304758458, 7439.405304758458, 6925.062776113857, 6925.062776113857, 9817.853176896071, 9817.853176896071, 4834.459118981523, 4834.459118981523, 7925.389230238952, 7925.389230238952, 5743.907829852033, 5743.907829852033, 6705.890945308303, 6705.890945308303, 7169.0544713422205, 7169.0544713422205, 6691.457716878351, 6691.457716878351, 4982.6990451555575, 4982.6990451555575, 7834.268898622382, 7834.268898622382, 6788.479648857587, 6788.479648857587, 6200.79507164079, 6200.79507164079, 6162.257122005976, 6162.257122005976, 5520.724113553463, 5520.724113553463, 6956.411225018828, 6956.411225018828, 5535.285511874556, 5535.285511874556, 4964.748168566086, 4964.748168566086, 5809.780326676864, 5809.780326676864, 7310.890835575465, 7310.890835575465, 8126.6817483636605, 8126.6817483636605, 4696.881342837915, 4696.881342837915, 6581.976139259674, 6581.976139259674, 6678.528244674533, 6678.528244674533, 5771.476126067416, 5771.476126067416, 5735.812727039459, 5735.812727039459, 5938.063765949224, 5938.063765949224, 6609.834418657643, 6609.834418657643, 7498.443062234848, 7498.443062234848, 6781.3412199859085, 6781.3412199859085, 7849.551785667081, 7849.551785667081, 6200.886878853882, 6200.886878853882, 4341.631485560312, 4341.631485560312, 4909.085639751822, 4909.085639751822, 8851.408068120625, 8851.408068120625, 7383.436026047422, 7383.436026047422, 7071.895773678494, 7071.895773678494, 8164.189896764594, 8164.189896764594, 7801.855092369675, 7801.855092369675, 6066.136453161272, 6066.136453161272, 5588.273386579809, 5588.273386579809, 7870.106044392509, 7870.106044392509, 7042.021508064698, 7042.021508064698, 7246.010878913425, 7246.010878913425, 6578.493609779209, 6578.493609779209, 8128.526114875804, 8128.526114875804, 5268.878003049545, 5268.878003049545, 5546.146947544517, 5546.146947544517, 7636.301786889489, 7636.301786889489, 6038.616130068591, 6038.616130068591, 5531.388274436057, 5531.388274436057, 6857.862489994255, 6857.862489994255, 7821.629660252835, 7821.629660252835, 7597.054233941948, 7597.054233941948, 7073.77171310154, 7073.77171310154, 7914.898596520281, 7914.898596520281, 6633.28903293491, 6633.28903293491, 8017.92142751119, 8017.92142751119, 7423.359964532083, 7423.359964532083, 5503.637427104299, 5503.637427104299, 8358.22526385151, 8358.22526385151, 5844.696111683315, 5844.696111683315, 7682.335245999155, 7682.335245999155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2513464379141785, "mean_inference_ms": 1.2013930840204705, "mean_action_processing_ms": 0.13394706113347887, "mean_env_wait_ms": 3.3719469518449374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 867200, "timesteps_this_iter": 0, "agent_timesteps_total": 1734400, "timers": {"sample_time_ms": 1844.632, "sample_throughput": 1734.764, "load_time_ms": 0.13, "load_throughput": 24609044.371, "learn_time_ms": 64.905, "learn_throughput": 49302.918, "update_time_ms": 1.527}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8948960.0, "policy_entropy": 37356.94921875, "policy_loss": 3271957.0, "vf_loss": 60665248.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 867200, "num_agent_steps_sampled": 1734400, "num_steps_trained": 867200, "num_agent_steps_trained": 1734400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 46, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-03-45", "timestamp": 1718795025, "time_this_iter_s": 11.110462665557861, "time_total_s": 504.92001724243164, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 504.92001724243164, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 57.849999999999994, "ram_util_percent": 33.2}}
{"episode_reward_max": 19635.706353792135, "episode_reward_min": 8683.262971120632, "episode_reward_mean": 13456.525423131057, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 4341.631485560312}, "policy_reward_max": {"shared_policy": 9817.853176896071}, "policy_reward_mean": {"shared_policy": 6728.262711565527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9561.962374343479, 12331.589710601027, 14383.224677166087, 13022.440076101575, 13284.873590824136, 15357.746300110339, 14276.219150786343, 13129.415526046421, 11672.094827993573, 13550.316505554416, 14511.98903081645, 15677.65661104178, 16141.892848682226, 14750.169740704918, 11626.742756093532, 14079.046920969755, 11392.417848763202, 14878.810609516913, 13850.125552227702, 19635.706353792135, 9668.918237963037, 15850.778460477912, 11487.815659704072, 13411.781890616654, 14338.108942684456, 13382.91543375669, 9965.398090311126, 15668.537797244739, 13576.959297715159, 12401.590143281548, 12324.514244011942, 11041.448227106943, 13912.82245003765, 11070.571023749115, 9929.496337132201, 11619.560653353765, 14621.781671150893, 16253.363496727306, 9393.762685675829, 13163.952278519333, 13357.056489349048, 11542.95225213483, 11471.625454078923, 11876.127531898448, 13219.668837315265, 14996.886124469696, 13562.682439971788, 15699.103571334243, 12401.773757707782, 8683.262971120632, 9818.17127950364, 17702.816136241257, 14766.872052094852, 14143.791547356981, 16328.379793529184, 15603.710184739371, 12132.272906322552, 11176.546773159625, 15740.21208878505, 14084.043016129395, 14492.021757826857, 13156.987219558396, 16257.052229751629, 10537.756006099095, 11092.293895089031, 15272.603573778986, 12077.232260137185, 11062.776548872116, 13715.724979988518, 15643.259320505662, 15194.1084678839, 14147.543426203058, 15829.797193040577, 13266.57806586981, 16035.842855022369, 14846.71992906418, 11007.274854208634, 16716.45052770302, 11689.392223366602, 15364.67049199828, 12729.025200622553, 13509.399994169456, 13351.663624052278, 12061.439067970463, 12674.995178153586, 15621.70091673118, 9519.81204774325, 9038.72666369635, 17314.738832601142, 16658.541065446778, 14531.734878655538, 15255.552779871763, 13348.666314821523, 8772.804008092819, 11400.815252889322, 15828.873096751202, 12591.518632544616, 13406.345666651454, 14798.037924129407, 17325.592100944195], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4780.981187171738, 4780.981187171738, 6165.794855300503, 6165.794855300503, 7191.612338583065, 7191.612338583065, 6511.220038050793, 6511.220038050793, 6642.436795412086, 6642.436795412086, 7678.8731500551585, 7678.8731500551585, 7138.109575393173, 7138.109575393173, 6564.707763023211, 6564.707763023211, 5836.047413996778, 5836.047413996778, 6775.158252777206, 6775.158252777206, 7255.994515408225, 7255.994515408225, 7838.828305520885, 7838.828305520885, 8070.946424341106, 8070.946424341106, 7375.084870352453, 7375.084870352453, 5813.371378046767, 5813.371378046767, 7039.5234604848665, 7039.5234604848665, 5696.208924381608, 5696.208924381608, 7439.405304758458, 7439.405304758458, 6925.062776113857, 6925.062776113857, 9817.853176896071, 9817.853176896071, 4834.459118981523, 4834.459118981523, 7925.389230238952, 7925.389230238952, 5743.907829852033, 5743.907829852033, 6705.890945308303, 6705.890945308303, 7169.0544713422205, 7169.0544713422205, 6691.457716878351, 6691.457716878351, 4982.6990451555575, 4982.6990451555575, 7834.268898622382, 7834.268898622382, 6788.479648857587, 6788.479648857587, 6200.79507164079, 6200.79507164079, 6162.257122005976, 6162.257122005976, 5520.724113553463, 5520.724113553463, 6956.411225018828, 6956.411225018828, 5535.285511874556, 5535.285511874556, 4964.748168566086, 4964.748168566086, 5809.780326676864, 5809.780326676864, 7310.890835575465, 7310.890835575465, 8126.6817483636605, 8126.6817483636605, 4696.881342837915, 4696.881342837915, 6581.976139259674, 6581.976139259674, 6678.528244674533, 6678.528244674533, 5771.476126067416, 5771.476126067416, 5735.812727039459, 5735.812727039459, 5938.063765949224, 5938.063765949224, 6609.834418657643, 6609.834418657643, 7498.443062234848, 7498.443062234848, 6781.3412199859085, 6781.3412199859085, 7849.551785667081, 7849.551785667081, 6200.886878853882, 6200.886878853882, 4341.631485560312, 4341.631485560312, 4909.085639751822, 4909.085639751822, 8851.408068120625, 8851.408068120625, 7383.436026047422, 7383.436026047422, 7071.895773678494, 7071.895773678494, 8164.189896764594, 8164.189896764594, 7801.855092369675, 7801.855092369675, 6066.136453161272, 6066.136453161272, 5588.273386579809, 5588.273386579809, 7870.106044392509, 7870.106044392509, 7042.021508064698, 7042.021508064698, 7246.010878913425, 7246.010878913425, 6578.493609779209, 6578.493609779209, 8128.526114875804, 8128.526114875804, 5268.878003049545, 5268.878003049545, 5546.146947544517, 5546.146947544517, 7636.301786889489, 7636.301786889489, 6038.616130068591, 6038.616130068591, 5531.388274436057, 5531.388274436057, 6857.862489994255, 6857.862489994255, 7821.629660252835, 7821.629660252835, 7597.054233941948, 7597.054233941948, 7073.77171310154, 7073.77171310154, 7914.898596520281, 7914.898596520281, 6633.28903293491, 6633.28903293491, 8017.92142751119, 8017.92142751119, 7423.359964532083, 7423.359964532083, 5503.637427104299, 5503.637427104299, 8358.22526385151, 8358.22526385151, 5844.696111683315, 5844.696111683315, 7682.335245999155, 7682.335245999155, 6364.512600311276, 6364.512600311276, 6754.699997084748, 6754.699997084748, 6675.831812026152, 6675.831812026152, 6030.719533985233, 6030.719533985233, 6337.4975890768055, 6337.4975890768055, 7810.850458365585, 7810.850458365585, 4759.906023871625, 4759.906023871625, 4519.36333184817, 4519.36333184817, 8657.369416300551, 8657.369416300551, 8329.27053272338, 8329.27053272338, 7265.867439327756, 7265.867439327756, 7627.776389935871, 7627.776389935871, 6674.333157410754, 6674.333157410754, 4386.40200404641, 4386.40200404641, 5700.407626444654, 5700.407626444654, 7914.436548375601, 7914.436548375601, 6295.759316272315, 6295.759316272315, 6703.172833325731, 6703.172833325731, 7399.0189620646925, 7399.0189620646925, 8662.796050472105, 8662.796050472105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2512279428116878, "mean_inference_ms": 1.2007747446903747, "mean_action_processing_ms": 0.1338318533971303, "mean_env_wait_ms": 3.3729946647068583, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 886400, "timesteps_this_iter": 0, "agent_timesteps_total": 1772800, "timers": {"sample_time_ms": 1905.831, "sample_throughput": 1679.057, "load_time_ms": 0.132, "load_throughput": 24205180.884, "learn_time_ms": 64.967, "learn_throughput": 49255.676, "update_time_ms": 1.583}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6894627.0, "policy_entropy": 36878.71484375, "policy_loss": 2500169.5, "vf_loss": 51301116.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 886400, "num_agent_steps_sampled": 1772800, "num_steps_trained": 886400, "num_agent_steps_trained": 1772800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1100, "training_iteration": 47, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-03-57", "timestamp": 1718795037, "time_this_iter_s": 11.570040941238403, "time_total_s": 516.49005818367, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9aee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 516.49005818367, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 58.631249999999994, "ram_util_percent": 33.2}}
{"episode_reward_max": 17702.816136241257, "episode_reward_min": 8437.508374513302, "episode_reward_mean": 13093.247209548254, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 4218.754187256649}, "policy_reward_max": {"shared_policy": 8851.408068120625}, "policy_reward_mean": {"shared_policy": 6546.623604774127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12324.514244011942, 11041.448227106943, 13912.82245003765, 11070.571023749115, 9929.496337132201, 11619.560653353765, 14621.781671150893, 16253.363496727306, 9393.762685675829, 13163.952278519333, 13357.056489349048, 11542.95225213483, 11471.625454078923, 11876.127531898448, 13219.668837315265, 14996.886124469696, 13562.682439971788, 15699.103571334243, 12401.773757707782, 8683.262971120632, 9818.17127950364, 17702.816136241257, 14766.872052094852, 14143.791547356981, 16328.379793529184, 15603.710184739371, 12132.272906322552, 11176.546773159625, 15740.21208878505, 14084.043016129395, 14492.021757826857, 13156.987219558396, 16257.052229751629, 10537.756006099095, 11092.293895089031, 15272.603573778986, 12077.232260137185, 11062.776548872116, 13715.724979988518, 15643.259320505662, 15194.1084678839, 14147.543426203058, 15829.797193040577, 13266.57806586981, 16035.842855022369, 14846.71992906418, 11007.274854208634, 16716.45052770302, 11689.392223366602, 15364.67049199828, 12729.025200622553, 13509.399994169456, 13351.663624052278, 12061.439067970463, 12674.995178153586, 15621.70091673118, 9519.81204774325, 9038.72666369635, 17314.738832601142, 16658.541065446778, 14531.734878655538, 15255.552779871763, 13348.666314821523, 8772.804008092819, 11400.815252889322, 15828.873096751202, 12591.518632544616, 13406.345666651454, 14798.037924129407, 17325.592100944195, 13419.46550719799, 12587.198480848736, 10985.917321296718, 11548.343405336058, 14755.898935913541, 16866.873805909083, 9109.090262025562, 9518.145284870436, 15551.567811047436, 14029.269333583754, 8437.508374513302, 14320.758374173824, 12934.144536324791, 15936.163644719425, 11004.271704885588, 13939.15709331043, 9001.166103914093, 11966.969479468382, 10302.53300896387, 9599.324888957875, 14638.59724628324, 16043.842073295124, 9414.659174902059, 14256.834169903319, 12126.97439759691, 13659.809252123505, 11225.265935762345, 9442.887920738307, 11757.744886967324, 12159.041192778332], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6162.257122005976, 6162.257122005976, 5520.724113553463, 5520.724113553463, 6956.411225018828, 6956.411225018828, 5535.285511874556, 5535.285511874556, 4964.748168566086, 4964.748168566086, 5809.780326676864, 5809.780326676864, 7310.890835575465, 7310.890835575465, 8126.6817483636605, 8126.6817483636605, 4696.881342837915, 4696.881342837915, 6581.976139259674, 6581.976139259674, 6678.528244674533, 6678.528244674533, 5771.476126067416, 5771.476126067416, 5735.812727039459, 5735.812727039459, 5938.063765949224, 5938.063765949224, 6609.834418657643, 6609.834418657643, 7498.443062234848, 7498.443062234848, 6781.3412199859085, 6781.3412199859085, 7849.551785667081, 7849.551785667081, 6200.886878853882, 6200.886878853882, 4341.631485560312, 4341.631485560312, 4909.085639751822, 4909.085639751822, 8851.408068120625, 8851.408068120625, 7383.436026047422, 7383.436026047422, 7071.895773678494, 7071.895773678494, 8164.189896764594, 8164.189896764594, 7801.855092369675, 7801.855092369675, 6066.136453161272, 6066.136453161272, 5588.273386579809, 5588.273386579809, 7870.106044392509, 7870.106044392509, 7042.021508064698, 7042.021508064698, 7246.010878913425, 7246.010878913425, 6578.493609779209, 6578.493609779209, 8128.526114875804, 8128.526114875804, 5268.878003049545, 5268.878003049545, 5546.146947544517, 5546.146947544517, 7636.301786889489, 7636.301786889489, 6038.616130068591, 6038.616130068591, 5531.388274436057, 5531.388274436057, 6857.862489994255, 6857.862489994255, 7821.629660252835, 7821.629660252835, 7597.054233941948, 7597.054233941948, 7073.77171310154, 7073.77171310154, 7914.898596520281, 7914.898596520281, 6633.28903293491, 6633.28903293491, 8017.92142751119, 8017.92142751119, 7423.359964532083, 7423.359964532083, 5503.637427104299, 5503.637427104299, 8358.22526385151, 8358.22526385151, 5844.696111683315, 5844.696111683315, 7682.335245999155, 7682.335245999155, 6364.512600311276, 6364.512600311276, 6754.699997084748, 6754.699997084748, 6675.831812026152, 6675.831812026152, 6030.719533985233, 6030.719533985233, 6337.4975890768055, 6337.4975890768055, 7810.850458365585, 7810.850458365585, 4759.906023871625, 4759.906023871625, 4519.36333184817, 4519.36333184817, 8657.369416300551, 8657.369416300551, 8329.27053272338, 8329.27053272338, 7265.867439327756, 7265.867439327756, 7627.776389935871, 7627.776389935871, 6674.333157410754, 6674.333157410754, 4386.40200404641, 4386.40200404641, 5700.407626444654, 5700.407626444654, 7914.436548375601, 7914.436548375601, 6295.759316272315, 6295.759316272315, 6703.172833325731, 6703.172833325731, 7399.0189620646925, 7399.0189620646925, 8662.796050472105, 8662.796050472105, 6709.732753599004, 6709.732753599004, 6293.59924042437, 6293.59924042437, 5492.9586606483645, 5492.9586606483645, 5774.171702668034, 5774.171702668034, 7377.949467956765, 7377.949467956765, 8433.436902954541, 8433.436902954541, 4554.545131012765, 4554.545131012765, 4759.072642435215, 4759.072642435215, 7775.7839055237255, 7775.7839055237255, 7014.634666791877, 7014.634666791877, 4218.754187256649, 4218.754187256649, 7160.379187086912, 7160.379187086912, 6467.072268162394, 6467.072268162394, 7968.0818223597125, 7968.0818223597125, 5502.135852442803, 5502.135852442803, 6969.578546655201, 6969.578546655201, 4500.583051957045, 4500.583051957045, 5983.48473973418, 5983.48473973418, 5151.26650448195, 5151.26650448195, 4799.66244447893, 4799.66244447893, 7319.2986231416035, 7319.2986231416035, 8021.921036647553, 8021.921036647553, 4707.329587451039, 4707.329587451039, 7128.417084951656, 7128.417084951656, 6063.4871987984625, 6063.4871987984625, 6829.904626061747, 6829.904626061747, 5612.632967881158, 5612.632967881158, 4721.443960369159, 4721.443960369159, 5878.87244348366, 5878.87244348366, 6079.520596389156, 6079.520596389156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2513544284148859, "mean_inference_ms": 1.2014806256263504, "mean_action_processing_ms": 0.13395977184961683, "mean_env_wait_ms": 3.3729763346038304, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 905600, "timesteps_this_iter": 0, "agent_timesteps_total": 1811200, "timers": {"sample_time_ms": 1889.654, "sample_throughput": 1693.431, "load_time_ms": 0.135, "load_throughput": 23642368.857, "learn_time_ms": 64.771, "learn_throughput": 49404.62, "update_time_ms": 1.47}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6645555.5, "policy_entropy": 35624.8203125, "policy_loss": 2301673.0, "vf_loss": 41965696.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 905600, "num_agent_steps_sampled": 1811200, "num_steps_trained": 905600, "num_agent_steps_trained": 1811200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1130, "training_iteration": 48, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-04-08", "timestamp": 1718795048, "time_this_iter_s": 11.270065307617188, "time_total_s": 527.7601234912872, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cfe9940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 527.7601234912872, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 57.80625, "ram_util_percent": 33.2}}
{"episode_reward_max": 17718.76750924815, "episode_reward_min": 8437.508374513302, "episode_reward_mean": 13443.742464817376, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 4218.754187256649}, "policy_reward_max": {"shared_policy": 8859.383754624085}, "policy_reward_mean": {"shared_policy": 6721.871232408688}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9818.17127950364, 17702.816136241257, 14766.872052094852, 14143.791547356981, 16328.379793529184, 15603.710184739371, 12132.272906322552, 11176.546773159625, 15740.21208878505, 14084.043016129395, 14492.021757826857, 13156.987219558396, 16257.052229751629, 10537.756006099095, 11092.293895089031, 15272.603573778986, 12077.232260137185, 11062.776548872116, 13715.724979988518, 15643.259320505662, 15194.1084678839, 14147.543426203058, 15829.797193040577, 13266.57806586981, 16035.842855022369, 14846.71992906418, 11007.274854208634, 16716.45052770302, 11689.392223366602, 15364.67049199828, 12729.025200622553, 13509.399994169456, 13351.663624052278, 12061.439067970463, 12674.995178153586, 15621.70091673118, 9519.81204774325, 9038.72666369635, 17314.738832601142, 16658.541065446778, 14531.734878655538, 15255.552779871763, 13348.666314821523, 8772.804008092819, 11400.815252889322, 15828.873096751202, 12591.518632544616, 13406.345666651454, 14798.037924129407, 17325.592100944195, 13419.46550719799, 12587.198480848736, 10985.917321296718, 11548.343405336058, 14755.898935913541, 16866.873805909083, 9109.090262025562, 9518.145284870436, 15551.567811047436, 14029.269333583754, 8437.508374513302, 14320.758374173824, 12934.144536324791, 15936.163644719425, 11004.271704885588, 13939.15709331043, 9001.166103914093, 11966.969479468382, 10302.53300896387, 9599.324888957875, 14638.59724628324, 16043.842073295124, 9414.659174902059, 14256.834169903319, 12126.97439759691, 13659.809252123505, 11225.265935762345, 9442.887920738307, 11757.744886967324, 12159.041192778332, 14955.76862800344, 13959.393180472558, 8514.480982086123, 13389.93323934636, 16725.97797595618, 17718.76750924815, 11414.13232711508, 13681.5797960015, 16271.62802566151, 14428.178216434328, 16366.200397650135, 12614.341988213233, 14640.411203158601, 13949.599690158975, 17366.94750726514, 12249.380244217238, 13764.837720892352, 14534.1200864577, 13523.794382378335, 15122.464923040752], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4909.085639751822, 4909.085639751822, 8851.408068120625, 8851.408068120625, 7383.436026047422, 7383.436026047422, 7071.895773678494, 7071.895773678494, 8164.189896764594, 8164.189896764594, 7801.855092369675, 7801.855092369675, 6066.136453161272, 6066.136453161272, 5588.273386579809, 5588.273386579809, 7870.106044392509, 7870.106044392509, 7042.021508064698, 7042.021508064698, 7246.010878913425, 7246.010878913425, 6578.493609779209, 6578.493609779209, 8128.526114875804, 8128.526114875804, 5268.878003049545, 5268.878003049545, 5546.146947544517, 5546.146947544517, 7636.301786889489, 7636.301786889489, 6038.616130068591, 6038.616130068591, 5531.388274436057, 5531.388274436057, 6857.862489994255, 6857.862489994255, 7821.629660252835, 7821.629660252835, 7597.054233941948, 7597.054233941948, 7073.77171310154, 7073.77171310154, 7914.898596520281, 7914.898596520281, 6633.28903293491, 6633.28903293491, 8017.92142751119, 8017.92142751119, 7423.359964532083, 7423.359964532083, 5503.637427104299, 5503.637427104299, 8358.22526385151, 8358.22526385151, 5844.696111683315, 5844.696111683315, 7682.335245999155, 7682.335245999155, 6364.512600311276, 6364.512600311276, 6754.699997084748, 6754.699997084748, 6675.831812026152, 6675.831812026152, 6030.719533985233, 6030.719533985233, 6337.4975890768055, 6337.4975890768055, 7810.850458365585, 7810.850458365585, 4759.906023871625, 4759.906023871625, 4519.36333184817, 4519.36333184817, 8657.369416300551, 8657.369416300551, 8329.27053272338, 8329.27053272338, 7265.867439327756, 7265.867439327756, 7627.776389935871, 7627.776389935871, 6674.333157410754, 6674.333157410754, 4386.40200404641, 4386.40200404641, 5700.407626444654, 5700.407626444654, 7914.436548375601, 7914.436548375601, 6295.759316272315, 6295.759316272315, 6703.172833325731, 6703.172833325731, 7399.0189620646925, 7399.0189620646925, 8662.796050472105, 8662.796050472105, 6709.732753599004, 6709.732753599004, 6293.59924042437, 6293.59924042437, 5492.9586606483645, 5492.9586606483645, 5774.171702668034, 5774.171702668034, 7377.949467956765, 7377.949467956765, 8433.436902954541, 8433.436902954541, 4554.545131012765, 4554.545131012765, 4759.072642435215, 4759.072642435215, 7775.7839055237255, 7775.7839055237255, 7014.634666791877, 7014.634666791877, 4218.754187256649, 4218.754187256649, 7160.379187086912, 7160.379187086912, 6467.072268162394, 6467.072268162394, 7968.0818223597125, 7968.0818223597125, 5502.135852442803, 5502.135852442803, 6969.578546655201, 6969.578546655201, 4500.583051957045, 4500.583051957045, 5983.48473973418, 5983.48473973418, 5151.26650448195, 5151.26650448195, 4799.66244447893, 4799.66244447893, 7319.2986231416035, 7319.2986231416035, 8021.921036647553, 8021.921036647553, 4707.329587451039, 4707.329587451039, 7128.417084951656, 7128.417084951656, 6063.4871987984625, 6063.4871987984625, 6829.904626061747, 6829.904626061747, 5612.632967881158, 5612.632967881158, 4721.443960369159, 4721.443960369159, 5878.87244348366, 5878.87244348366, 6079.520596389156, 6079.520596389156, 7477.884314001702, 7477.884314001702, 6979.6965902362645, 6979.6965902362645, 4257.24049104306, 4257.24049104306, 6694.9666196731705, 6694.9666196731705, 8362.988987978086, 8362.988987978086, 8859.383754624085, 8859.383754624085, 5707.0661635575525, 5707.0661635575525, 6840.789898000752, 6840.789898000752, 8135.814012830742, 8135.814012830742, 7214.089108217166, 7214.089108217166, 8183.100198825052, 8183.100198825052, 6307.170994106607, 6307.170994106607, 7320.205601579317, 7320.205601579317, 6974.799845079484, 6974.799845079484, 8683.473753632567, 8683.473753632567, 6124.690122108601, 6124.690122108601, 6882.418860446163, 6882.418860446163, 7267.060043228852, 7267.060043228852, 6761.89719118918, 6761.89719118918, 7561.232461520376, 7561.232461520376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25126893638532954, "mean_inference_ms": 1.200962643974645, "mean_action_processing_ms": 0.1338572041997432, "mean_env_wait_ms": 3.3743792864534923, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 924800, "timesteps_this_iter": 0, "agent_timesteps_total": 1849600, "timers": {"sample_time_ms": 1865.32, "sample_throughput": 1715.523, "load_time_ms": 0.136, "load_throughput": 23592499.209, "learn_time_ms": 64.431, "learn_throughput": 49665.571, "update_time_ms": 1.516}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8495962.0, "policy_entropy": 37216.77734375, "policy_loss": 3087659.75, "vf_loss": 56900620.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 924800, "num_agent_steps_sampled": 1849600, "num_steps_trained": 924800, "num_agent_steps_trained": 1849600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1150, "training_iteration": 49, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-04-19", "timestamp": 1718795059, "time_this_iter_s": 11.11631464958191, "time_total_s": 538.8764381408691, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54ce86820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 538.8764381408691, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 58.150000000000006, "ram_util_percent": 33.181250000000006}}
{"episode_reward_max": 18844.13993565437, "episode_reward_min": 7863.285203775562, "episode_reward_mean": 13500.039788864506, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 3931.642601887781}, "policy_reward_max": {"shared_policy": 9422.0699678272}, "policy_reward_mean": {"shared_policy": 6750.019894432252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12729.025200622553, 13509.399994169456, 13351.663624052278, 12061.439067970463, 12674.995178153586, 15621.70091673118, 9519.81204774325, 9038.72666369635, 17314.738832601142, 16658.541065446778, 14531.734878655538, 15255.552779871763, 13348.666314821523, 8772.804008092819, 11400.815252889322, 15828.873096751202, 12591.518632544616, 13406.345666651454, 14798.037924129407, 17325.592100944195, 13419.46550719799, 12587.198480848736, 10985.917321296718, 11548.343405336058, 14755.898935913541, 16866.873805909083, 9109.090262025562, 9518.145284870436, 15551.567811047436, 14029.269333583754, 8437.508374513302, 14320.758374173824, 12934.144536324791, 15936.163644719425, 11004.271704885588, 13939.15709331043, 9001.166103914093, 11966.969479468382, 10302.53300896387, 9599.324888957875, 14638.59724628324, 16043.842073295124, 9414.659174902059, 14256.834169903319, 12126.97439759691, 13659.809252123505, 11225.265935762345, 9442.887920738307, 11757.744886967324, 12159.041192778332, 14955.76862800344, 13959.393180472558, 8514.480982086123, 13389.93323934636, 16725.97797595618, 17718.76750924815, 11414.13232711508, 13681.5797960015, 16271.62802566151, 14428.178216434328, 16366.200397650135, 12614.341988213233, 14640.411203158601, 13949.599690158975, 17366.94750726514, 12249.380244217238, 13764.837720892352, 14534.1200864577, 13523.794382378335, 15122.464923040752, 12746.402158911493, 16124.424241574892, 18844.13993565437, 10526.30140402884, 14414.595349483792, 14075.810932401091, 14914.083875015716, 18653.11438134843, 14854.48177036172, 15726.2876655269, 10586.811884325416, 15145.488088917253, 16637.426797923166, 12300.005180937456, 10922.477784748306, 14397.561755311184, 14722.001848763372, 14211.949649355418, 14262.500970728204, 14211.146652281906, 15451.607341320501, 13639.463646967532, 14497.970385626755, 16465.408329790152, 7863.285203775562, 17270.13754853471, 11465.116277246918, 10831.597273693907, 15486.988616312745, 13284.047057674892], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6364.512600311276, 6364.512600311276, 6754.699997084748, 6754.699997084748, 6675.831812026152, 6675.831812026152, 6030.719533985233, 6030.719533985233, 6337.4975890768055, 6337.4975890768055, 7810.850458365585, 7810.850458365585, 4759.906023871625, 4759.906023871625, 4519.36333184817, 4519.36333184817, 8657.369416300551, 8657.369416300551, 8329.27053272338, 8329.27053272338, 7265.867439327756, 7265.867439327756, 7627.776389935871, 7627.776389935871, 6674.333157410754, 6674.333157410754, 4386.40200404641, 4386.40200404641, 5700.407626444654, 5700.407626444654, 7914.436548375601, 7914.436548375601, 6295.759316272315, 6295.759316272315, 6703.172833325731, 6703.172833325731, 7399.0189620646925, 7399.0189620646925, 8662.796050472105, 8662.796050472105, 6709.732753599004, 6709.732753599004, 6293.59924042437, 6293.59924042437, 5492.9586606483645, 5492.9586606483645, 5774.171702668034, 5774.171702668034, 7377.949467956765, 7377.949467956765, 8433.436902954541, 8433.436902954541, 4554.545131012765, 4554.545131012765, 4759.072642435215, 4759.072642435215, 7775.7839055237255, 7775.7839055237255, 7014.634666791877, 7014.634666791877, 4218.754187256649, 4218.754187256649, 7160.379187086912, 7160.379187086912, 6467.072268162394, 6467.072268162394, 7968.0818223597125, 7968.0818223597125, 5502.135852442803, 5502.135852442803, 6969.578546655201, 6969.578546655201, 4500.583051957045, 4500.583051957045, 5983.48473973418, 5983.48473973418, 5151.26650448195, 5151.26650448195, 4799.66244447893, 4799.66244447893, 7319.2986231416035, 7319.2986231416035, 8021.921036647553, 8021.921036647553, 4707.329587451039, 4707.329587451039, 7128.417084951656, 7128.417084951656, 6063.4871987984625, 6063.4871987984625, 6829.904626061747, 6829.904626061747, 5612.632967881158, 5612.632967881158, 4721.443960369159, 4721.443960369159, 5878.87244348366, 5878.87244348366, 6079.520596389156, 6079.520596389156, 7477.884314001702, 7477.884314001702, 6979.6965902362645, 6979.6965902362645, 4257.24049104306, 4257.24049104306, 6694.9666196731705, 6694.9666196731705, 8362.988987978086, 8362.988987978086, 8859.383754624085, 8859.383754624085, 5707.0661635575525, 5707.0661635575525, 6840.789898000752, 6840.789898000752, 8135.814012830742, 8135.814012830742, 7214.089108217166, 7214.089108217166, 8183.100198825052, 8183.100198825052, 6307.170994106607, 6307.170994106607, 7320.205601579317, 7320.205601579317, 6974.799845079484, 6974.799845079484, 8683.473753632567, 8683.473753632567, 6124.690122108601, 6124.690122108601, 6882.418860446163, 6882.418860446163, 7267.060043228852, 7267.060043228852, 6761.89719118918, 6761.89719118918, 7561.232461520376, 7561.232461520376, 6373.201079455759, 6373.201079455759, 8062.212120787444, 8062.212120787444, 9422.0699678272, 9422.0699678272, 5263.150702014413, 5263.150702014413, 7207.297674741902, 7207.297674741902, 7037.905466200547, 7037.905466200547, 7457.0419375078545, 7457.0419375078545, 9326.557190674233, 9326.557190674233, 7427.240885180861, 7427.240885180861, 7863.143832763446, 7863.143832763446, 5293.405942162704, 5293.405942162704, 7572.744044458614, 7572.744044458614, 8318.713398961589, 8318.713398961589, 6150.0025904687245, 6150.0025904687245, 5461.238892374142, 5461.238892374142, 7198.780877655576, 7198.780877655576, 7361.0009243816785, 7361.0009243816785, 7105.974824677713, 7105.974824677713, 7131.250485364086, 7131.250485364086, 7105.573326140959, 7105.573326140959, 7725.803670660249, 7725.803670660249, 6819.731823483762, 6819.731823483762, 7248.985192813381, 7248.985192813381, 8232.704164895094, 8232.704164895094, 3931.642601887781, 3931.642601887781, 8635.068774267358, 8635.068774267358, 5732.558138623477, 5732.558138623477, 5415.798636846956, 5415.798636846956, 7743.494308156387, 7743.494308156387, 6642.023528837446, 6642.023528837446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25143694421575874, "mean_inference_ms": 1.2018190054281281, "mean_action_processing_ms": 0.13400070334478306, "mean_env_wait_ms": 3.37505571746937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 944000, "timesteps_this_iter": 0, "agent_timesteps_total": 1888000, "timers": {"sample_time_ms": 1840.746, "sample_throughput": 1738.425, "load_time_ms": 0.134, "load_throughput": 23890660.021, "learn_time_ms": 63.805, "learn_throughput": 50152.953, "update_time_ms": 1.488}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8231008.5, "policy_entropy": 38244.48046875, "policy_loss": 3022514.0, "vf_loss": 64412544.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 944000, "num_agent_steps_sampled": 1888000, "num_steps_trained": 944000, "num_agent_steps_trained": 1888000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 19937.26682042468, "episode_reward_min": 8836.908418248662, "episode_reward_mean": 13951.396448665415, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 4418.454209124331}, "policy_reward_max": {"shared_policy": 9968.633410212344}, "policy_reward_mean": {"shared_policy": 6975.698224332706}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14858.97447922561, 10436.627157893327, 14534.776676696118, 19937.26682042468, 14935.306717589381, 17028.772151634097, 8836.908418248662, 16581.64401175503, 10445.951558152577, 11917.73649503466], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7429.487239612807, 7429.487239612807, 5218.313578946669, 5218.313578946669, 7267.388338348059, 7267.388338348059, 9968.633410212344, 9968.633410212344, 7467.653358794685, 7467.653358794685, 8514.386075817049, 8514.386075817049, 4418.454209124331, 4418.454209124331, 8290.822005877511, 8290.822005877511, 5222.975779076283, 5222.975779076283, 5958.868247517319, 5958.868247517319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.10605726133598534, "mean_inference_ms": 0.695921870831057, "mean_action_processing_ms": 0.07369109741256709, "mean_env_wait_ms": 1.8924101488752048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 1180, "training_iteration": 50, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-04-52", "timestamp": 1718795092, "time_this_iter_s": 33.292030572891235, "time_total_s": 572.1684687137604, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 572.1684687137604, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.97083333333333, "ram_util_percent": 33.199999999999996}}
{"episode_reward_max": 18844.13993565437, "episode_reward_min": 7863.285203775562, "episode_reward_mean": 13500.039788864506, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"shared_policy": 3931.642601887781}, "policy_reward_max": {"shared_policy": 9422.0699678272}, "policy_reward_mean": {"shared_policy": 6750.019894432252}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12729.025200622553, 13509.399994169456, 13351.663624052278, 12061.439067970463, 12674.995178153586, 15621.70091673118, 9519.81204774325, 9038.72666369635, 17314.738832601142, 16658.541065446778, 14531.734878655538, 15255.552779871763, 13348.666314821523, 8772.804008092819, 11400.815252889322, 15828.873096751202, 12591.518632544616, 13406.345666651454, 14798.037924129407, 17325.592100944195, 13419.46550719799, 12587.198480848736, 10985.917321296718, 11548.343405336058, 14755.898935913541, 16866.873805909083, 9109.090262025562, 9518.145284870436, 15551.567811047436, 14029.269333583754, 8437.508374513302, 14320.758374173824, 12934.144536324791, 15936.163644719425, 11004.271704885588, 13939.15709331043, 9001.166103914093, 11966.969479468382, 10302.53300896387, 9599.324888957875, 14638.59724628324, 16043.842073295124, 9414.659174902059, 14256.834169903319, 12126.97439759691, 13659.809252123505, 11225.265935762345, 9442.887920738307, 11757.744886967324, 12159.041192778332, 14955.76862800344, 13959.393180472558, 8514.480982086123, 13389.93323934636, 16725.97797595618, 17718.76750924815, 11414.13232711508, 13681.5797960015, 16271.62802566151, 14428.178216434328, 16366.200397650135, 12614.341988213233, 14640.411203158601, 13949.599690158975, 17366.94750726514, 12249.380244217238, 13764.837720892352, 14534.1200864577, 13523.794382378335, 15122.464923040752, 12746.402158911493, 16124.424241574892, 18844.13993565437, 10526.30140402884, 14414.595349483792, 14075.810932401091, 14914.083875015716, 18653.11438134843, 14854.48177036172, 15726.2876655269, 10586.811884325416, 15145.488088917253, 16637.426797923166, 12300.005180937456, 10922.477784748306, 14397.561755311184, 14722.001848763372, 14211.949649355418, 14262.500970728204, 14211.146652281906, 15451.607341320501, 13639.463646967532, 14497.970385626755, 16465.408329790152, 7863.285203775562, 17270.13754853471, 11465.116277246918, 10831.597273693907, 15486.988616312745, 13284.047057674892], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6364.512600311276, 6364.512600311276, 6754.699997084748, 6754.699997084748, 6675.831812026152, 6675.831812026152, 6030.719533985233, 6030.719533985233, 6337.4975890768055, 6337.4975890768055, 7810.850458365585, 7810.850458365585, 4759.906023871625, 4759.906023871625, 4519.36333184817, 4519.36333184817, 8657.369416300551, 8657.369416300551, 8329.27053272338, 8329.27053272338, 7265.867439327756, 7265.867439327756, 7627.776389935871, 7627.776389935871, 6674.333157410754, 6674.333157410754, 4386.40200404641, 4386.40200404641, 5700.407626444654, 5700.407626444654, 7914.436548375601, 7914.436548375601, 6295.759316272315, 6295.759316272315, 6703.172833325731, 6703.172833325731, 7399.0189620646925, 7399.0189620646925, 8662.796050472105, 8662.796050472105, 6709.732753599004, 6709.732753599004, 6293.59924042437, 6293.59924042437, 5492.9586606483645, 5492.9586606483645, 5774.171702668034, 5774.171702668034, 7377.949467956765, 7377.949467956765, 8433.436902954541, 8433.436902954541, 4554.545131012765, 4554.545131012765, 4759.072642435215, 4759.072642435215, 7775.7839055237255, 7775.7839055237255, 7014.634666791877, 7014.634666791877, 4218.754187256649, 4218.754187256649, 7160.379187086912, 7160.379187086912, 6467.072268162394, 6467.072268162394, 7968.0818223597125, 7968.0818223597125, 5502.135852442803, 5502.135852442803, 6969.578546655201, 6969.578546655201, 4500.583051957045, 4500.583051957045, 5983.48473973418, 5983.48473973418, 5151.26650448195, 5151.26650448195, 4799.66244447893, 4799.66244447893, 7319.2986231416035, 7319.2986231416035, 8021.921036647553, 8021.921036647553, 4707.329587451039, 4707.329587451039, 7128.417084951656, 7128.417084951656, 6063.4871987984625, 6063.4871987984625, 6829.904626061747, 6829.904626061747, 5612.632967881158, 5612.632967881158, 4721.443960369159, 4721.443960369159, 5878.87244348366, 5878.87244348366, 6079.520596389156, 6079.520596389156, 7477.884314001702, 7477.884314001702, 6979.6965902362645, 6979.6965902362645, 4257.24049104306, 4257.24049104306, 6694.9666196731705, 6694.9666196731705, 8362.988987978086, 8362.988987978086, 8859.383754624085, 8859.383754624085, 5707.0661635575525, 5707.0661635575525, 6840.789898000752, 6840.789898000752, 8135.814012830742, 8135.814012830742, 7214.089108217166, 7214.089108217166, 8183.100198825052, 8183.100198825052, 6307.170994106607, 6307.170994106607, 7320.205601579317, 7320.205601579317, 6974.799845079484, 6974.799845079484, 8683.473753632567, 8683.473753632567, 6124.690122108601, 6124.690122108601, 6882.418860446163, 6882.418860446163, 7267.060043228852, 7267.060043228852, 6761.89719118918, 6761.89719118918, 7561.232461520376, 7561.232461520376, 6373.201079455759, 6373.201079455759, 8062.212120787444, 8062.212120787444, 9422.0699678272, 9422.0699678272, 5263.150702014413, 5263.150702014413, 7207.297674741902, 7207.297674741902, 7037.905466200547, 7037.905466200547, 7457.0419375078545, 7457.0419375078545, 9326.557190674233, 9326.557190674233, 7427.240885180861, 7427.240885180861, 7863.143832763446, 7863.143832763446, 5293.405942162704, 5293.405942162704, 7572.744044458614, 7572.744044458614, 8318.713398961589, 8318.713398961589, 6150.0025904687245, 6150.0025904687245, 5461.238892374142, 5461.238892374142, 7198.780877655576, 7198.780877655576, 7361.0009243816785, 7361.0009243816785, 7105.974824677713, 7105.974824677713, 7131.250485364086, 7131.250485364086, 7105.573326140959, 7105.573326140959, 7725.803670660249, 7725.803670660249, 6819.731823483762, 6819.731823483762, 7248.985192813381, 7248.985192813381, 8232.704164895094, 8232.704164895094, 3931.642601887781, 3931.642601887781, 8635.068774267358, 8635.068774267358, 5732.558138623477, 5732.558138623477, 5415.798636846956, 5415.798636846956, 7743.494308156387, 7743.494308156387, 6642.023528837446, 6642.023528837446]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25143694421575874, "mean_inference_ms": 1.2018190054281281, "mean_action_processing_ms": 0.13400070334478306, "mean_env_wait_ms": 3.37505571746937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 947200, "timesteps_this_iter": 0, "agent_timesteps_total": 1894400, "timers": {"sample_time_ms": 4068.985, "sample_throughput": 786.437, "load_time_ms": 0.132, "load_throughput": 24187732.564, "learn_time_ms": 64.122, "learn_throughput": 49904.973, "update_time_ms": 1.493}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7518852.0, "policy_entropy": 37114.30078125, "policy_loss": 2689513.5, "vf_loss": 49000448.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 947200, "num_agent_steps_sampled": 1894400, "num_steps_trained": 947200, "num_agent_steps_trained": 1894400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1180, "training_iteration": 51, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-04-54", "timestamp": 1718795094, "time_this_iter_s": 1.8208012580871582, "time_total_s": 573.9892699718475, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 573.9892699718475, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 55.75, "ram_util_percent": 33.2}}
{"episode_reward_max": 18844.13993565437, "episode_reward_min": 7863.285203775562, "episode_reward_mean": 13270.468327029583, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 3931.642601887781}, "policy_reward_max": {"shared_policy": 9422.0699678272}, "policy_reward_mean": {"shared_policy": 6635.234163514792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13419.46550719799, 12587.198480848736, 10985.917321296718, 11548.343405336058, 14755.898935913541, 16866.873805909083, 9109.090262025562, 9518.145284870436, 15551.567811047436, 14029.269333583754, 8437.508374513302, 14320.758374173824, 12934.144536324791, 15936.163644719425, 11004.271704885588, 13939.15709331043, 9001.166103914093, 11966.969479468382, 10302.53300896387, 9599.324888957875, 14638.59724628324, 16043.842073295124, 9414.659174902059, 14256.834169903319, 12126.97439759691, 13659.809252123505, 11225.265935762345, 9442.887920738307, 11757.744886967324, 12159.041192778332, 14955.76862800344, 13959.393180472558, 8514.480982086123, 13389.93323934636, 16725.97797595618, 17718.76750924815, 11414.13232711508, 13681.5797960015, 16271.62802566151, 14428.178216434328, 16366.200397650135, 12614.341988213233, 14640.411203158601, 13949.599690158975, 17366.94750726514, 12249.380244217238, 13764.837720892352, 14534.1200864577, 13523.794382378335, 15122.464923040752, 12746.402158911493, 16124.424241574892, 18844.13993565437, 10526.30140402884, 14414.595349483792, 14075.810932401091, 14914.083875015716, 18653.11438134843, 14854.48177036172, 15726.2876655269, 10586.811884325416, 15145.488088917253, 16637.426797923166, 12300.005180937456, 10922.477784748306, 14397.561755311184, 14722.001848763372, 14211.949649355418, 14262.500970728204, 14211.146652281906, 15451.607341320501, 13639.463646967532, 14497.970385626755, 16465.408329790152, 7863.285203775562, 17270.13754853471, 11465.116277246918, 10831.597273693907, 15486.988616312745, 13284.047057674892, 9691.497551629884, 9628.982871068383, 11283.646246899989, 11890.94856510706, 9392.311543087038, 14015.401521092896, 10496.06509835998, 13349.234890778549, 14825.121759930578, 9080.524888388962, 12666.992402652744, 10365.616091358203, 14392.832036372703, 15467.911155470261, 15917.750648129357, 15583.60241173199, 13793.875260454344, 11421.81493825579, 9840.70743925017, 13677.99974302794], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6709.732753599004, 6709.732753599004, 6293.59924042437, 6293.59924042437, 5492.9586606483645, 5492.9586606483645, 5774.171702668034, 5774.171702668034, 7377.949467956765, 7377.949467956765, 8433.436902954541, 8433.436902954541, 4554.545131012765, 4554.545131012765, 4759.072642435215, 4759.072642435215, 7775.7839055237255, 7775.7839055237255, 7014.634666791877, 7014.634666791877, 4218.754187256649, 4218.754187256649, 7160.379187086912, 7160.379187086912, 6467.072268162394, 6467.072268162394, 7968.0818223597125, 7968.0818223597125, 5502.135852442803, 5502.135852442803, 6969.578546655201, 6969.578546655201, 4500.583051957045, 4500.583051957045, 5983.48473973418, 5983.48473973418, 5151.26650448195, 5151.26650448195, 4799.66244447893, 4799.66244447893, 7319.2986231416035, 7319.2986231416035, 8021.921036647553, 8021.921036647553, 4707.329587451039, 4707.329587451039, 7128.417084951656, 7128.417084951656, 6063.4871987984625, 6063.4871987984625, 6829.904626061747, 6829.904626061747, 5612.632967881158, 5612.632967881158, 4721.443960369159, 4721.443960369159, 5878.87244348366, 5878.87244348366, 6079.520596389156, 6079.520596389156, 7477.884314001702, 7477.884314001702, 6979.6965902362645, 6979.6965902362645, 4257.24049104306, 4257.24049104306, 6694.9666196731705, 6694.9666196731705, 8362.988987978086, 8362.988987978086, 8859.383754624085, 8859.383754624085, 5707.0661635575525, 5707.0661635575525, 6840.789898000752, 6840.789898000752, 8135.814012830742, 8135.814012830742, 7214.089108217166, 7214.089108217166, 8183.100198825052, 8183.100198825052, 6307.170994106607, 6307.170994106607, 7320.205601579317, 7320.205601579317, 6974.799845079484, 6974.799845079484, 8683.473753632567, 8683.473753632567, 6124.690122108601, 6124.690122108601, 6882.418860446163, 6882.418860446163, 7267.060043228852, 7267.060043228852, 6761.89719118918, 6761.89719118918, 7561.232461520376, 7561.232461520376, 6373.201079455759, 6373.201079455759, 8062.212120787444, 8062.212120787444, 9422.0699678272, 9422.0699678272, 5263.150702014413, 5263.150702014413, 7207.297674741902, 7207.297674741902, 7037.905466200547, 7037.905466200547, 7457.0419375078545, 7457.0419375078545, 9326.557190674233, 9326.557190674233, 7427.240885180861, 7427.240885180861, 7863.143832763446, 7863.143832763446, 5293.405942162704, 5293.405942162704, 7572.744044458614, 7572.744044458614, 8318.713398961589, 8318.713398961589, 6150.0025904687245, 6150.0025904687245, 5461.238892374142, 5461.238892374142, 7198.780877655576, 7198.780877655576, 7361.0009243816785, 7361.0009243816785, 7105.974824677713, 7105.974824677713, 7131.250485364086, 7131.250485364086, 7105.573326140959, 7105.573326140959, 7725.803670660249, 7725.803670660249, 6819.731823483762, 6819.731823483762, 7248.985192813381, 7248.985192813381, 8232.704164895094, 8232.704164895094, 3931.642601887781, 3931.642601887781, 8635.068774267358, 8635.068774267358, 5732.558138623477, 5732.558138623477, 5415.798636846956, 5415.798636846956, 7743.494308156387, 7743.494308156387, 6642.023528837446, 6642.023528837446, 4845.748775814947, 4845.748775814947, 4814.491435534195, 4814.491435534195, 5641.823123449993, 5641.823123449993, 5945.474282553543, 5945.474282553543, 4696.155771543519, 4696.155771543519, 7007.700760546457, 7007.700760546457, 5248.032549180001, 5248.032549180001, 6674.617445389278, 6674.617445389278, 7412.5608799652855, 7412.5608799652855, 4540.262444194474, 4540.262444194474, 6333.4962013263685, 6333.4962013263685, 5182.808045679114, 5182.808045679114, 7196.416018186346, 7196.416018186346, 7733.9555777351325, 7733.9555777351325, 7958.8753240646765, 7958.8753240646765, 7791.801205866004, 7791.801205866004, 6896.93763022717, 6896.93763022717, 5710.907469127898, 5710.907469127898, 4920.353719625069, 4920.353719625069, 6838.999871513977, 6838.999871513977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.251469573045425, "mean_inference_ms": 1.2019753465660434, "mean_action_processing_ms": 0.1340215705419192, "mean_env_wait_ms": 3.3758498609783567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 966400, "timesteps_this_iter": 0, "agent_timesteps_total": 1932800, "timers": {"sample_time_ms": 4103.201, "sample_throughput": 779.879, "load_time_ms": 0.14, "load_throughput": 22900141.273, "learn_time_ms": 64.666, "learn_throughput": 49485.24, "update_time_ms": 1.446}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9034868.0, "policy_entropy": 37999.51953125, "policy_loss": 3348831.5, "vf_loss": 70655368.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 966400, "num_agent_steps_sampled": 1932800, "num_steps_trained": 966400, "num_agent_steps_trained": 1932800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1200, "training_iteration": 52, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-05-06", "timestamp": 1718795106, "time_this_iter_s": 11.566357851028442, "time_total_s": 585.555627822876, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf9aee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 585.555627822876, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 59.694117647058825, "ram_util_percent": 33.27058823529411}}
{"episode_reward_max": 18844.13993565437, "episode_reward_min": 7863.285203775562, "episode_reward_mean": 13419.492841212636, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"shared_policy": 3931.642601887781}, "policy_reward_max": {"shared_policy": 9422.0699678272}, "policy_reward_mean": {"shared_policy": 6709.746420606319}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14955.76862800344, 13959.393180472558, 8514.480982086123, 13389.93323934636, 16725.97797595618, 17718.76750924815, 11414.13232711508, 13681.5797960015, 16271.62802566151, 14428.178216434328, 16366.200397650135, 12614.341988213233, 14640.411203158601, 13949.599690158975, 17366.94750726514, 12249.380244217238, 13764.837720892352, 14534.1200864577, 13523.794382378335, 15122.464923040752, 12746.402158911493, 16124.424241574892, 18844.13993565437, 10526.30140402884, 14414.595349483792, 14075.810932401091, 14914.083875015716, 18653.11438134843, 14854.48177036172, 15726.2876655269, 10586.811884325416, 15145.488088917253, 16637.426797923166, 12300.005180937456, 10922.477784748306, 14397.561755311184, 14722.001848763372, 14211.949649355418, 14262.500970728204, 14211.146652281906, 15451.607341320501, 13639.463646967532, 14497.970385626755, 16465.408329790152, 7863.285203775562, 17270.13754853471, 11465.116277246918, 10831.597273693907, 15486.988616312745, 13284.047057674892, 9691.497551629884, 9628.982871068383, 11283.646246899989, 11890.94856510706, 9392.311543087038, 14015.401521092896, 10496.06509835998, 13349.234890778549, 14825.121759930578, 9080.524888388962, 12666.992402652744, 10365.616091358203, 14392.832036372703, 15467.911155470261, 15917.750648129357, 15583.60241173199, 13793.875260454344, 11421.81493825579, 9840.70743925017, 13677.99974302794, 13095.608127551404, 10408.957672262386, 12905.1003231949, 15248.967521325096, 9412.017587584956, 14693.805312463464, 15468.792768545773, 10640.42054362109, 9208.18791019771, 15640.208415632002, 9723.27894042529, 11228.510247168193, 14234.834258989318, 13904.835703589295, 11804.010194181366, 17192.427667402124, 11396.497943537786, 13388.677202524144, 16674.28231659597, 12144.614343869882, 10995.991511851575, 11020.904027410877, 15130.448158399438, 13595.473535038982, 15178.508013139784, 13408.734484511067, 10035.012575075245, 13237.700981511585, 11218.14632461347, 13206.920413702293], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7477.884314001702, 7477.884314001702, 6979.6965902362645, 6979.6965902362645, 4257.24049104306, 4257.24049104306, 6694.9666196731705, 6694.9666196731705, 8362.988987978086, 8362.988987978086, 8859.383754624085, 8859.383754624085, 5707.0661635575525, 5707.0661635575525, 6840.789898000752, 6840.789898000752, 8135.814012830742, 8135.814012830742, 7214.089108217166, 7214.089108217166, 8183.100198825052, 8183.100198825052, 6307.170994106607, 6307.170994106607, 7320.205601579317, 7320.205601579317, 6974.799845079484, 6974.799845079484, 8683.473753632567, 8683.473753632567, 6124.690122108601, 6124.690122108601, 6882.418860446163, 6882.418860446163, 7267.060043228852, 7267.060043228852, 6761.89719118918, 6761.89719118918, 7561.232461520376, 7561.232461520376, 6373.201079455759, 6373.201079455759, 8062.212120787444, 8062.212120787444, 9422.0699678272, 9422.0699678272, 5263.150702014413, 5263.150702014413, 7207.297674741902, 7207.297674741902, 7037.905466200547, 7037.905466200547, 7457.0419375078545, 7457.0419375078545, 9326.557190674233, 9326.557190674233, 7427.240885180861, 7427.240885180861, 7863.143832763446, 7863.143832763446, 5293.405942162704, 5293.405942162704, 7572.744044458614, 7572.744044458614, 8318.713398961589, 8318.713398961589, 6150.0025904687245, 6150.0025904687245, 5461.238892374142, 5461.238892374142, 7198.780877655576, 7198.780877655576, 7361.0009243816785, 7361.0009243816785, 7105.974824677713, 7105.974824677713, 7131.250485364086, 7131.250485364086, 7105.573326140959, 7105.573326140959, 7725.803670660249, 7725.803670660249, 6819.731823483762, 6819.731823483762, 7248.985192813381, 7248.985192813381, 8232.704164895094, 8232.704164895094, 3931.642601887781, 3931.642601887781, 8635.068774267358, 8635.068774267358, 5732.558138623477, 5732.558138623477, 5415.798636846956, 5415.798636846956, 7743.494308156387, 7743.494308156387, 6642.023528837446, 6642.023528837446, 4845.748775814947, 4845.748775814947, 4814.491435534195, 4814.491435534195, 5641.823123449993, 5641.823123449993, 5945.474282553543, 5945.474282553543, 4696.155771543519, 4696.155771543519, 7007.700760546457, 7007.700760546457, 5248.032549180001, 5248.032549180001, 6674.617445389278, 6674.617445389278, 7412.5608799652855, 7412.5608799652855, 4540.262444194474, 4540.262444194474, 6333.4962013263685, 6333.4962013263685, 5182.808045679114, 5182.808045679114, 7196.416018186346, 7196.416018186346, 7733.9555777351325, 7733.9555777351325, 7958.8753240646765, 7958.8753240646765, 7791.801205866004, 7791.801205866004, 6896.93763022717, 6896.93763022717, 5710.907469127898, 5710.907469127898, 4920.353719625069, 4920.353719625069, 6838.999871513977, 6838.999871513977, 6547.804063775726, 6547.804063775726, 5204.478836131193, 5204.478836131193, 6452.550161597457, 6452.550161597457, 7624.48376066255, 7624.48376066255, 4706.00879379248, 4706.00879379248, 7346.902656231732, 7346.902656231732, 7734.396384272888, 7734.396384272888, 5320.210271810548, 5320.210271810548, 4604.0939550988605, 4604.0939550988605, 7820.104207815992, 7820.104207815992, 4861.639470212648, 4861.639470212648, 5614.255123584108, 5614.255123584108, 7117.417129494657, 7117.417129494657, 6952.417851794649, 6952.417851794649, 5902.005097090701, 5902.005097090701, 8596.213833701055, 8596.213833701055, 5698.248971768899, 5698.248971768899, 6694.338601262081, 6694.338601262081, 8337.141158297996, 8337.141158297996, 6072.30717193493, 6072.30717193493, 5497.995755925787, 5497.995755925787, 5510.452013705431, 5510.452013705431, 7565.224079199714, 7565.224079199714, 6797.736767519478, 6797.736767519478, 7589.254006569909, 7589.254006569909, 6704.3672422555355, 6704.3672422555355, 5017.506287537621, 5017.506287537621, 6618.850490755794, 6618.850490755794, 5609.07316230673, 5609.07316230673, 6603.460206851156, 6603.460206851156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.251491996984545, "mean_inference_ms": 1.2022082292507177, "mean_action_processing_ms": 0.1340436839178056, "mean_env_wait_ms": 3.376638209133651, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 985600, "timesteps_this_iter": 0, "agent_timesteps_total": 1971200, "timers": {"sample_time_ms": 1893.61, "sample_throughput": 1689.894, "load_time_ms": 0.14, "load_throughput": 22787390.153, "learn_time_ms": 65.316, "learn_throughput": 48992.726, "update_time_ms": 1.432}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7733767.0, "policy_entropy": 38027.078125, "policy_loss": 2824566.25, "vf_loss": 57380672.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 985600, "num_agent_steps_sampled": 1971200, "num_steps_trained": 985600, "num_agent_steps_trained": 1971200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1230, "training_iteration": 53, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-05-17", "timestamp": 1718795117, "time_this_iter_s": 11.053329467773438, "time_total_s": 596.6089572906494, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf43d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 596.6089572906494, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 58.40666666666667, "ram_util_percent": 33.28000000000001}}
{"episode_reward_max": 18844.13993565437, "episode_reward_min": 7551.453100923902, "episode_reward_mean": 13136.338107159385, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"shared_policy": 3775.726550461951}, "policy_reward_max": {"shared_policy": 9422.0699678272}, "policy_reward_mean": {"shared_policy": 6568.169053579692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12746.402158911493, 16124.424241574892, 18844.13993565437, 10526.30140402884, 14414.595349483792, 14075.810932401091, 14914.083875015716, 18653.11438134843, 14854.48177036172, 15726.2876655269, 10586.811884325416, 15145.488088917253, 16637.426797923166, 12300.005180937456, 10922.477784748306, 14397.561755311184, 14722.001848763372, 14211.949649355418, 14262.500970728204, 14211.146652281906, 15451.607341320501, 13639.463646967532, 14497.970385626755, 16465.408329790152, 7863.285203775562, 17270.13754853471, 11465.116277246918, 10831.597273693907, 15486.988616312745, 13284.047057674892, 9691.497551629884, 9628.982871068383, 11283.646246899989, 11890.94856510706, 9392.311543087038, 14015.401521092896, 10496.06509835998, 13349.234890778549, 14825.121759930578, 9080.524888388962, 12666.992402652744, 10365.616091358203, 14392.832036372703, 15467.911155470261, 15917.750648129357, 15583.60241173199, 13793.875260454344, 11421.81493825579, 9840.70743925017, 13677.99974302794, 13095.608127551404, 10408.957672262386, 12905.1003231949, 15248.967521325096, 9412.017587584956, 14693.805312463464, 15468.792768545773, 10640.42054362109, 9208.18791019771, 15640.208415632002, 9723.27894042529, 11228.510247168193, 14234.834258989318, 13904.835703589295, 11804.010194181366, 17192.427667402124, 11396.497943537786, 13388.677202524144, 16674.28231659597, 12144.614343869882, 10995.991511851575, 11020.904027410877, 15130.448158399438, 13595.473535038982, 15178.508013139784, 13408.734484511067, 10035.012575075245, 13237.700981511585, 11218.14632461347, 13206.920413702293, 17395.425544796337, 13734.801244308466, 13589.398699925852, 15733.487874696802, 12921.44985244951, 13861.38524871095, 10044.105755678094, 14796.35696503798, 11177.852039075304, 12163.423746072946, 14054.423587833466, 7551.453100923902, 14668.214931165814, 16754.166614688467, 9732.467433785252, 12251.584400512409, 13376.553016934446, 11918.958241592994, 8336.71598215765, 12814.240338085729], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6373.201079455759, 6373.201079455759, 8062.212120787444, 8062.212120787444, 9422.0699678272, 9422.0699678272, 5263.150702014413, 5263.150702014413, 7207.297674741902, 7207.297674741902, 7037.905466200547, 7037.905466200547, 7457.0419375078545, 7457.0419375078545, 9326.557190674233, 9326.557190674233, 7427.240885180861, 7427.240885180861, 7863.143832763446, 7863.143832763446, 5293.405942162704, 5293.405942162704, 7572.744044458614, 7572.744044458614, 8318.713398961589, 8318.713398961589, 6150.0025904687245, 6150.0025904687245, 5461.238892374142, 5461.238892374142, 7198.780877655576, 7198.780877655576, 7361.0009243816785, 7361.0009243816785, 7105.974824677713, 7105.974824677713, 7131.250485364086, 7131.250485364086, 7105.573326140959, 7105.573326140959, 7725.803670660249, 7725.803670660249, 6819.731823483762, 6819.731823483762, 7248.985192813381, 7248.985192813381, 8232.704164895094, 8232.704164895094, 3931.642601887781, 3931.642601887781, 8635.068774267358, 8635.068774267358, 5732.558138623477, 5732.558138623477, 5415.798636846956, 5415.798636846956, 7743.494308156387, 7743.494308156387, 6642.023528837446, 6642.023528837446, 4845.748775814947, 4845.748775814947, 4814.491435534195, 4814.491435534195, 5641.823123449993, 5641.823123449993, 5945.474282553543, 5945.474282553543, 4696.155771543519, 4696.155771543519, 7007.700760546457, 7007.700760546457, 5248.032549180001, 5248.032549180001, 6674.617445389278, 6674.617445389278, 7412.5608799652855, 7412.5608799652855, 4540.262444194474, 4540.262444194474, 6333.4962013263685, 6333.4962013263685, 5182.808045679114, 5182.808045679114, 7196.416018186346, 7196.416018186346, 7733.9555777351325, 7733.9555777351325, 7958.8753240646765, 7958.8753240646765, 7791.801205866004, 7791.801205866004, 6896.93763022717, 6896.93763022717, 5710.907469127898, 5710.907469127898, 4920.353719625069, 4920.353719625069, 6838.999871513977, 6838.999871513977, 6547.804063775726, 6547.804063775726, 5204.478836131193, 5204.478836131193, 6452.550161597457, 6452.550161597457, 7624.48376066255, 7624.48376066255, 4706.00879379248, 4706.00879379248, 7346.902656231732, 7346.902656231732, 7734.396384272888, 7734.396384272888, 5320.210271810548, 5320.210271810548, 4604.0939550988605, 4604.0939550988605, 7820.104207815992, 7820.104207815992, 4861.639470212648, 4861.639470212648, 5614.255123584108, 5614.255123584108, 7117.417129494657, 7117.417129494657, 6952.417851794649, 6952.417851794649, 5902.005097090701, 5902.005097090701, 8596.213833701055, 8596.213833701055, 5698.248971768899, 5698.248971768899, 6694.338601262081, 6694.338601262081, 8337.141158297996, 8337.141158297996, 6072.30717193493, 6072.30717193493, 5497.995755925787, 5497.995755925787, 5510.452013705431, 5510.452013705431, 7565.224079199714, 7565.224079199714, 6797.736767519478, 6797.736767519478, 7589.254006569909, 7589.254006569909, 6704.3672422555355, 6704.3672422555355, 5017.506287537621, 5017.506287537621, 6618.850490755794, 6618.850490755794, 5609.07316230673, 5609.07316230673, 6603.460206851156, 6603.460206851156, 8697.712772398165, 8697.712772398165, 6867.40062215422, 6867.40062215422, 6794.699349962928, 6794.699349962928, 7866.7439373483885, 7866.7439373483885, 6460.724926224761, 6460.724926224761, 6930.692624355477, 6930.692624355477, 5022.05287783905, 5022.05287783905, 7398.178482518981, 7398.178482518981, 5588.926019537662, 5588.926019537662, 6081.7118730364855, 6081.7118730364855, 7027.211793916727, 7027.211793916727, 3775.726550461951, 3775.726550461951, 7334.1074655829, 7334.1074655829, 8377.083307344232, 8377.083307344232, 4866.233716892618, 4866.233716892618, 6125.792200256203, 6125.792200256203, 6688.276508467241, 6688.276508467241, 5959.479120796514, 5959.479120796514, 4168.357991078825, 4168.357991078825, 6407.120169042844, 6407.120169042844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25148146847230207, "mean_inference_ms": 1.2022972841732156, "mean_action_processing_ms": 0.13404968915237594, "mean_env_wait_ms": 3.376654206333592, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1004800, "timesteps_this_iter": 0, "agent_timesteps_total": 2009600, "timers": {"sample_time_ms": 1833.866, "sample_throughput": 1744.948, "load_time_ms": 0.142, "load_throughput": 22595577.104, "learn_time_ms": 65.334, "learn_throughput": 48979.335, "update_time_ms": 1.513}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8318074.5, "policy_entropy": 37651.91015625, "policy_loss": 3062085.5, "vf_loss": 62949904.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1004800, "num_agent_steps_sampled": 2009600, "num_steps_trained": 1004800, "num_agent_steps_trained": 2009600, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 1250, "training_iteration": 54, "trial_id": "6a067_00000", "experiment_id": "117843b70b6344b19af063c61dbbfc87", "date": "2024-06-19_20-05-28", "timestamp": 1718795128, "time_this_iter_s": 10.764599084854126, "time_total_s": 607.3735563755035, "pid": 1098130, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 20, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 1600, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "vf_loss_coeff": 1.0, "batch_episode": 10, "batch_mode": "truncate_episodes", "lr": 0.0005, "entropy_coeff": 0.01}, "algorithm": "maa2c", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 10, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAA2CTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fb54cf430d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "grad_clip": 40.0, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "microbatch_size": null}, "time_since_restore": 607.3735563755035, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 58.89375, "ram_util_percent": 33.23125}}
