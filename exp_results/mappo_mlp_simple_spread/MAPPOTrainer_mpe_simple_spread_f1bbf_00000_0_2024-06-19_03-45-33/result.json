{"episode_reward_max": -64.30512726383887, "episode_reward_min": -217.1387172131228, "episode_reward_mean": -117.31327900700813, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -73.0462390710409}, "policy_reward_max": {"shared_policy": -21.435042421279622}, "policy_reward_mean": {"shared_policy": -39.10442633566938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.6605009489985, -145.66568482611558, -97.4933703574491, -125.40682069735409, -126.8218659223418, -143.0721983451086, -217.1387172131228, -121.86941529614707, -119.4161121029738, -124.31557839444449, -122.62354099187493, -84.38767940136397, -136.5307059944653, -120.33190605153021, -112.75202466856267, -111.15720491550465, -115.41660097053973, -128.1663962730511, -117.36078342477558, -113.38606712293341, -174.7231049100664, -120.16431733994311, -118.67120402713306, -114.088824821614, -135.3843887979205, -140.88245709173748, -73.50733137613749, -64.30512726383887, -97.64195984332085, -97.8184593078088, -110.11595431450078, -123.57721781881854, -166.37835369359064, -168.96460150625106, -119.27446437594926, -176.4691903173554, -112.77280732471996, -88.23921582933454, -129.65183569329733, -134.27020628827682, -100.08462106536672, -104.10550012562275, -117.49171897633136, -166.48358939923344, -104.90523382421846, -80.41866807297293, -91.15196747560626, -97.95566748730246, -106.84103588289032, -126.31577163544772, -134.66259237414715, -115.42142282224548, -95.5382722238422, -88.70278662922364, -113.26027250086396, -114.28806696720699, -116.78140751140664, -123.27140788312563, -123.9962406485999, -130.16063027957412, -143.9439279330725, -87.75146064276555, -109.23260678029196, -104.31149533211027, -106.491829941882, -105.79384318669074, -127.56292495773896, -89.99351295576498, -74.04801766898001, -169.30452559109574, -134.1317192237322, -107.94337705254559, -104.32569481474022, -122.06532298594351, -116.51998003526093, -122.6032015907468, -120.91983328917284, -109.99472482170181, -173.85305277418325, -148.06491332725633, -160.75252508165025, -114.36969162259693, -125.20487863508184, -162.05551968125388, -87.77774480212584, -88.53246122320249, -119.78200102987162, -94.26501291413213, -102.18671826247171, -86.77139101732267, -104.17029083452545, -116.47525610256336, -116.671689966842, -137.17204997600044, -83.8189857615014, -99.55233989241897, -126.12275494947562, -84.77458746923772, -90.89821095091256, -93.5936072895752, -106.67927887891197, -139.0194287013866, -100.09671642114951, -133.27905989188105, -121.31013278313833, -96.6468702258493, -139.0307846328358, -88.01962002789593, -100.69454900049098, -99.64253844661681, -99.15186953004229, -122.09654493250638, -110.18186061392137, -146.50873705760935, -133.10024776647887, -103.08279482044176, -125.00531644494268, -95.77127451737567, -86.70020571363881, -125.06089841992444], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-43.553500316332816, -43.553500316332816, -43.553500316332816, -48.55522827537185, -48.55522827537185, -48.55522827537185, -32.49779011914971, -32.49779011914971, -32.49779011914971, -41.80227356578471, -41.80227356578471, -41.80227356578471, -42.27395530744727, -42.27395530744727, -42.27395530744727, -47.024066115036206, -48.024066115036206, -48.024066115036206, -73.0462390710409, -73.0462390710409, -71.0462390710409, -40.78980509871568, -40.28980509871568, -40.78980509871568, -40.13870403432456, -39.13870403432456, -40.13870403432456, -41.438526131481495, -41.438526131481495, -41.438526131481495, -40.8745136639583, -40.8745136639583, -40.8745136639583, -28.462559800454642, -27.462559800454642, -28.462559800454642, -45.676901998155095, -45.176901998155095, -45.676901998155095, -39.77730201717672, -40.27730201717672, -40.27730201717672, -37.58400822285425, -37.58400822285425, -37.58400822285425, -37.05240163850156, -37.05240163850156, -37.05240163850156, -38.47220032351322, -38.47220032351322, -38.47220032351322, -42.72213209101701, -42.72213209101701, -42.72213209101701, -39.120261141591875, -39.120261141591875, -39.120261141591875, -37.9620223743111, -37.4620223743111, -37.9620223743111, -58.24103497002218, -58.24103497002218, -58.24103497002218, -40.388105779981075, -40.388105779981075, -39.38810577998108, -39.557068009044336, -39.557068009044336, -39.557068009044336, -38.0296082738713, -38.0296082738713, -38.0296082738713, -45.46146293264018, -45.46146293264018, -44.46146293264018, -46.96081903057916, -46.96081903057916, -46.96081903057916, -24.83577712537917, -24.83577712537917, -23.83577712537917, -21.435042421279622, -21.435042421279622, -21.435042421279622, -32.54731994777361, -32.54731994777361, -32.54731994777361, -32.60615310260293, -32.60615310260293, -32.60615310260293, -36.7053181048336, -36.7053181048336, -36.7053181048336, -40.69240593960619, -41.19240593960619, -41.69240593960619, -55.62611789786354, -55.12611789786354, -55.62611789786354, -56.65486716875034, -55.65486716875034, -56.65486716875034, -39.75815479198308, -39.75815479198308, -39.75815479198308, -58.82306343911849, -59.82306343911849, -57.82306343911849, -37.59093577490666, -37.59093577490666, -37.59093577490666, -29.41307194311149, -29.41307194311149, -29.41307194311149, -43.550611897765755, -42.550611897765755, -43.550611897765755, -44.7567354294256, -44.7567354294256, -44.7567354294256, -33.361540355122244, -33.361540355122244, -33.361540355122244, -34.70183337520757, -34.70183337520757, -34.70183337520757, -39.16390632544379, -39.16390632544379, -39.16390632544379, -55.49452979974444, -55.49452979974444, -55.49452979974444, -34.96841127473947, -34.96841127473947, -34.96841127473947, -27.472889357657635, -25.972889357657635, -26.972889357657635, -31.21732249186875, -30.21732249186875, -29.717322491868742, -32.65188916243416, -32.65188916243416, -32.65188916243416, -35.61367862763012, -35.61367862763012, -35.61367862763012, -42.10525721181591, -42.10525721181591, -42.10525721181591, -44.88753079138238, -44.88753079138238, -44.88753079138238, -38.473807607415175, -38.473807607415175, -38.473807607415175, -31.17942407461407, -32.17942407461407, -32.17942407461407, -29.567595543074532, -29.567595543074532, -29.567595543074532, -37.753424166954666, -37.753424166954666, -37.753424166954666, -38.09602232240234, -38.09602232240234, -38.09602232240234, -38.92713583713554, -38.92713583713554, -38.92713583713554, -41.0904692943752, -41.0904692943752, -41.0904692943752, -40.998746882866655, -41.498746882866655, -41.498746882866655, -43.386876759858055, -43.386876759858055, -43.386876759858055, -47.98130931102418, -47.98130931102418, -47.98130931102418, -29.583820214255205, -29.583820214255205, -28.583820214255205, -35.74420226009734, -36.74420226009734, -36.74420226009734, -34.770498444036754, -34.770498444036754, -34.770498444036754, -35.49727664729397, -35.49727664729397, -35.49727664729397, -34.59794772889691, -35.597947728896905, -35.597947728896905, -42.520974985912986, -42.520974985912986, -42.520974985912986, -29.997837651921653, -29.997837651921653, -29.997837651921653, -24.016005889660015, -25.016005889660015, -25.016005889660015, -56.43484186369853, -56.43484186369853, -56.43484186369853, -44.7105730745774, -44.7105730745774, -44.7105730745774, -35.98112568418187, -35.98112568418187, -35.98112568418187, -34.94189827158009, -34.44189827158009, -34.94189827158009, -40.02177432864783, -41.02177432864782, -41.02177432864782, -38.83999334508698, -38.83999334508698, -38.83999334508698, -40.86773386358229, -40.86773386358229, -40.86773386358229, -40.30661109639095, -40.30661109639095, -40.30661109639095, -36.99824160723392, -36.99824160723392, -35.99824160723392, -57.617684258061054, -58.117684258061054, -58.117684258061054, -49.354971109085426, -49.354971109085426, -49.354971109085426, -53.584175027216766, -53.584175027216766, -53.584175027216766, -38.28989720753229, -38.28989720753229, -37.78989720753229, -41.734959545027294, -41.734959545027294, -41.734959545027294, -54.01850656041799, -54.01850656041799, -54.01850656041799, -28.925914934041945, -29.425914934041945, -29.425914934041945, -29.677487074400815, -29.677487074400815, -29.177487074400815, -38.92733367662388, -40.42733367662388, -40.42733367662388, -31.421670971377363, -31.421670971377363, -31.421670971377363, -34.06223942082391, -34.06223942082391, -34.06223942082391, -29.25713033910756, -28.25713033910756, -29.25713033910756, -34.89009694484184, -34.39009694484184, -34.89009694484184, -38.491752034187776, -38.991752034187776, -38.991752034187776, -38.890563322280656, -38.890563322280656, -38.890563322280656, -45.72401665866684, -45.72401665866684, -45.72401665866684, -27.939661920500455, -27.939661920500455, -27.939661920500455, -33.184113297472976, -33.184113297472976, -33.184113297472976, -43.70758498315856, -39.70758498315856, -42.70758498315856, -28.25819582307925, -28.25819582307925, -28.25819582307925, -30.299403650304214, -30.299403650304214, -30.299403650304214, -31.1978690965251, -31.1978690965251, -31.1978690965251, -35.55975962630397, -35.55975962630397, -35.55975962630397, -46.67314290046219, -46.67314290046219, -45.67314290046219, -33.36557214038316, -33.36557214038316, -33.36557214038316, -44.42635329729368, -44.42635329729368, -44.42635329729368, -40.936710927712774, -39.436710927712774, -40.936710927712774, -32.21562340861643, -32.21562340861643, -32.21562340861643, -46.34359487761195, -46.34359487761195, -46.34359487761195, -29.339873342631954, -29.339873342631954, -29.339873342631954, -33.56484966683031, -33.56484966683031, -33.56484966683031, -33.214179482205594, -33.214179482205594, -33.214179482205594, -33.05062317668077, -33.05062317668077, -33.05062317668077, -40.69884831083547, -40.69884831083547, -40.69884831083547, -36.727286871307115, -36.727286871307115, -36.727286871307115, -48.83624568586977, -48.83624568586977, -48.83624568586977, -43.7000825888263, -44.7000825888263, -44.7000825888263, -34.36093160681395, -34.36093160681395, -34.36093160681395, -42.00177214831425, -41.00177214831425, -42.00177214831425, -30.590424839125223, -32.59042483912521, -32.59042483912521, -29.06673523787961, -28.56673523787961, -29.06673523787961, -41.6869661399748, -41.6869661399748, -41.6869661399748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2974433690959419, "mean_inference_ms": 1.2158306216896508, "mean_action_processing_ms": 0.0681559987528673, "mean_env_wait_ms": 0.5600376663921035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 3200, "timesteps_this_iter": 0, "agent_timesteps_total": 9600, "timers": {"sample_time_ms": 857.533, "sample_throughput": 3731.637, "load_time_ms": 0.273, "load_throughput": 11732318.881, "learn_time_ms": 818.009, "learn_throughput": 3911.938, "update_time_ms": 2.435}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005000000000000001, "total_loss": 478.5010559082031, "policy_loss": -0.003843704021846861, "vf_loss": 478.52000732421874, "vf_explained_var": 0.0009379565715789794, "kl": 0.0047036330862451955, "entropy": 1.6047338128089905, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 3200, "num_agent_steps_sampled": 9600, "num_steps_trained": 3200, "num_agent_steps_trained": 9600}, "done": false, "episodes_total": 120, "training_iteration": 1, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-37", "timestamp": 1718736337, "time_this_iter_s": 1.6720046997070312, "time_total_s": 1.6720046997070312, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1.6720046997070312, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.0, "ram_util_percent": 29.566666666666663}}
{"episode_reward_max": -71.42179354130363, "episode_reward_min": -213.82654719160823, "episode_reward_mean": -115.27532007834603, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -71.60884906386943}, "policy_reward_max": {"shared_policy": -22.1405978471012}, "policy_reward_mean": {"shared_policy": -38.42510669278201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115.68911401690289, -108.8686552803972, -95.44642460809669, -89.90110038933335, -196.77533403779188, -82.6878651925102, -90.10137395500898, -106.12585756031272, -119.96248049878126, -90.42444786856095, -107.92358945747912, -143.13062978812428, -123.03969315641665, -131.62650701173257, -82.26434228453849, -99.62632322534247, -139.738744502263, -140.37516346908052, -116.81035364421794, -118.03282922880857, -114.18878545654341, -92.28070795318376, -213.82654719160823, -97.7884225740135, -116.1178918756623, -140.5919238387725, -88.52725426189407, -105.05517066642558, -83.88365933802656, -96.88981353779992, -116.18515206972653, -101.23216405480913, -80.89398784137131, -118.95416480314412, -153.95830472048974, -93.8474380654127, -119.53938241105588, -125.71797943008629, -141.80990611099008, -83.28951715677648, -79.87846256814383, -93.77660171059611, -106.90626521202655, -83.41135881412931, -121.56844738950787, -120.27182765798167, -135.67078102975225, -109.2958040535243, -120.9777733878644, -105.56210130190952, -145.02410072464127, -115.81333401336789, -184.95911693936588, -91.96146432524438, -97.34694262178094, -127.5476396045724, -126.85720644080645, -107.06633778440198, -123.61286181344815, -109.78165110344632, -155.34382998743396, -120.74446622990267, -97.4531749661929, -99.40398381111385, -95.97676728713036, -112.08544043937306, -112.06363917854209, -114.25297049578985, -95.92539793825166, -127.66899513449958, -177.83864760599837, -91.26467440082871, -104.62168158093885, -145.73739971216702, -159.6467866948856, -127.19733037225723, -128.5065562848438, -107.87386411325853, -129.56668143911173, -108.84470268622371, -113.16268146061236, -114.84842226089799, -99.37475770407919, -89.05333817512309, -131.89749378641648, -138.96562189646667, -97.33112676386067, -129.2247598180975, -125.33108883086805, -91.91323967493767, -105.79056421357394, -147.8157280799618, -126.62961036939429, -106.6446652053524, -71.42179354130363, -177.51118792284603, -117.49580146137451, -99.90750360056252, -90.05343242007262, -112.36175802618054, -131.45097585319195, -93.19192687150577, -104.73946122560454, -103.5805549809285, -130.8442074023216, -119.96952223788739, -116.81536841811793, -115.79104655130796, -103.8453945392889, -101.63895427865296, -126.75612029183911, -106.5173315191284, -101.84934762640628, -82.3305338468822, -77.88743302936507, -93.01127251578, -91.88159153012909, -129.8029807884439, -146.9683227201029, -121.00459250685101, -143.05134450096125, -145.73494205502934, -124.11641848077304, -115.28929536328593, -113.98013219162449, -144.05270211164435, -102.75703355652139, -106.32469797747157, -122.58890487572143, -78.84855373748542], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-38.5630380056343, -38.5630380056343, -38.5630380056343, -36.289551760132404, -36.289551760132404, -36.289551760132404, -31.815474869365573, -31.815474869365573, -31.815474869365573, -29.967033463111104, -29.967033463111104, -29.967033463111104, -64.5917780125973, -66.0917780125973, -66.0917780125973, -26.89595506417006, -27.89595506417006, -27.89595506417006, -30.033791318336334, -30.033791318336334, -30.033791318336334, -35.375285853437575, -35.375285853437575, -35.375285853437575, -39.98749349959374, -39.98749349959374, -39.98749349959374, -30.141482622853644, -30.141482622853644, -30.141482622853644, -35.97452981915969, -35.97452981915969, -35.97452981915969, -47.71020992937479, -47.71020992937479, -47.71020992937479, -41.01323105213885, -41.01323105213885, -41.01323105213885, -44.042169003910885, -43.542169003910885, -44.042169003910885, -27.42144742817949, -27.42144742817949, -27.42144742817949, -33.20877440844749, -33.20877440844749, -33.20877440844749, -46.57958150075432, -46.57958150075432, -46.57958150075432, -46.79172115636018, -46.79172115636018, -46.79172115636018, -38.93678454807266, -38.93678454807266, -38.93678454807266, -39.344276409602855, -39.344276409602855, -39.344276409602855, -38.062928485514476, -38.062928485514476, -38.062928485514476, -30.92690265106124, -30.42690265106124, -30.92690265106124, -70.60884906386943, -71.60884906386943, -71.60884906386943, -32.76280752467116, -32.76280752467116, -32.26280752467116, -38.70596395855411, -38.70596395855411, -38.70596395855411, -46.863974612924174, -46.863974612924174, -46.863974612924174, -29.50908475396468, -29.50908475396468, -29.50908475396468, -35.01839022214185, -35.01839022214185, -35.01839022214185, -27.96121977934219, -27.96121977934219, -27.96121977934219, -32.29660451259999, -32.29660451259999, -32.29660451259999, -38.72838402324217, -38.72838402324217, -38.72838402324217, -33.74405468493639, -33.74405468493639, -33.74405468493639, -26.29799594712377, -27.29799594712377, -27.29799594712377, -39.15138826771473, -39.65138826771473, -40.15138826771473, -50.819434906829905, -51.819434906829905, -51.319434906829905, -31.44914602180421, -31.44914602180421, -30.94914602180421, -39.84646080368532, -39.84646080368532, -39.84646080368532, -41.90599314336208, -41.90599314336208, -41.90599314336208, -47.26996870366334, -47.26996870366334, -47.26996870366334, -27.763172385592178, -27.763172385592178, -27.763172385592178, -26.626154189381285, -26.626154189381285, -26.626154189381285, -31.592200570198717, -30.59220057019871, -31.592200570198717, -35.63542173734218, -35.63542173734218, -35.63542173734218, -27.803786271376467, -27.803786271376467, -27.803786271376467, -41.35614912983595, -41.35614912983595, -38.85614912983594, -40.59060921932725, -39.09060921932725, -40.59060921932725, -45.22359367658407, -45.22359367658407, -45.22359367658407, -36.43193468450812, -36.43193468450812, -36.43193468450812, -40.32592446262147, -40.32592446262147, -40.32592446262147, -35.520700433969814, -35.520700433969814, -34.520700433969814, -49.1747002415471, -49.1747002415471, -46.6747002415471, -38.77111133778929, -38.27111133778929, -38.77111133778929, -61.65303897978864, -61.65303897978864, -61.65303897978864, -30.65382144174813, -30.65382144174813, -30.65382144174813, -32.448980873926956, -32.448980873926956, -32.448980873926956, -42.682546534857465, -42.682546534857465, -42.182546534857465, -42.285735480268826, -42.285735480268826, -42.285735480268826, -35.18877926146734, -35.68877926146734, -36.18877926146734, -40.87095393781605, -41.37095393781605, -41.37095393781605, -35.59388370114878, -37.09388370114878, -37.09388370114878, -51.781276662477985, -51.781276662477985, -51.781276662477985, -40.08148874330091, -40.08148874330091, -40.58148874330091, -32.484391655397616, -32.484391655397616, -32.484391655397616, -33.1346612703713, -33.1346612703713, -33.1346612703713, -31.99225576237677, -31.99225576237677, -31.99225576237677, -37.695146813124346, -37.695146813124346, -36.695146813124346, -37.35454639284735, -37.35454639284735, -37.35454639284735, -38.08432349859664, -38.08432349859664, -38.08432349859664, -31.975132646083882, -31.975132646083882, -31.975132646083882, -42.556331711499865, -42.556331711499865, -42.556331711499865, -59.11288253533279, -60.61288253533279, -58.11288253533279, -30.421558133609572, -30.421558133609572, -30.421558133609572, -34.87389386031297, -34.87389386031297, -34.87389386031297, -47.91246657072232, -48.91246657072232, -48.91246657072232, -52.54892889829517, -53.54892889829517, -53.54892889829517, -42.39911012408573, -42.39911012408573, -42.39911012408573, -42.83551876161459, -42.83551876161459, -42.83551876161459, -35.9579547044195, -35.9579547044195, -35.9579547044195, -43.188893813037275, -43.188893813037275, -43.188893813037275, -36.28156756207456, -36.28156756207456, -36.28156756207456, -37.88756048687079, -37.38756048687079, -37.88756048687079, -38.28280742029933, -37.78280742029933, -38.78280742029933, -33.124919234693074, -33.124919234693074, -33.124919234693074, -29.68444605837435, -29.68444605837435, -29.68444605837435, -44.132497928805506, -43.632497928805506, -44.132497928805506, -46.3218739654889, -46.3218739654889, -46.3218739654889, -32.61037558795358, -32.11037558795358, -32.61037558795358, -43.074919939365834, -43.074919939365834, -43.074919939365834, -42.11036294362267, -42.11036294362267, -41.11036294362267, -30.637746558312568, -30.637746558312568, -30.637746558312568, -35.26352140452463, -35.26352140452463, -35.26352140452463, -49.60524269332062, -49.60524269332062, -48.60524269332061, -42.54320345646478, -41.54320345646477, -42.54320345646478, -35.54822173511749, -35.54822173511749, -35.54822173511749, -22.1405978471012, -24.6405978471012, -24.6405978471012, -59.337062640948695, -58.837062640948695, -59.337062640948695, -38.83193382045818, -39.33193382045818, -39.33193382045818, -33.30250120018749, -33.30250120018749, -33.30250120018749, -30.017810806690886, -30.017810806690886, -30.017810806690886, -37.62058600872684, -37.62058600872684, -37.12058600872684, -43.816991951064, -43.816991951064, -43.816991951064, -31.397308957168608, -31.397308957168608, -30.397308957168615, -35.57982040853486, -33.57982040853485, -35.57982040853486, -34.526851660309475, -34.526851660309475, -34.526851660309475, -43.614735800773865, -43.614735800773865, -43.614735800773865, -39.98984074596247, -39.98984074596247, -39.98984074596247, -38.77178947270597, -38.77178947270597, -39.27178947270597, -38.930348850435976, -37.930348850435976, -38.930348850435976, -35.44846484642962, -35.44846484642962, -32.94846484642962, -33.879651426217656, -33.879651426217656, -33.879651426217656, -42.25204009727973, -42.25204009727973, -42.25204009727973, -35.505777173042794, -35.505777173042794, -35.505777173042794, -33.94978254213545, -33.94978254213545, -33.94978254213545, -27.443511282294086, -27.443511282294086, -27.443511282294086, -26.129144343121688, -25.629144343121688, -26.129144343121688, -31.003757505260012, -31.003757505260012, -31.003757505260012, -31.793863843376364, -28.293863843376368, -31.793863843376364, -43.26766026281464, -43.26766026281464, -43.26766026281464, -49.15610757336765, -49.15610757336765, -48.65610757336765, -40.834864168950325, -39.334864168950325, -40.834864168950325, -47.68378150032041, -47.68378150032041, -47.68378150032041, -48.578314018343136, -48.578314018343136, -48.578314018343136, -41.70547282692432, -40.70547282692432, -41.70547282692432, -38.42976512109532, -38.42976512109532, -38.42976512109532, -37.99337739720814, -37.99337739720814, -37.99337739720814, -47.684234037214786, -48.184234037214786, -48.184234037214786, -34.25234451884045, -34.25234451884045, -34.25234451884045, -35.441565992490524, -35.441565992490524, -35.441565992490524, -40.52963495857382, -41.02963495857382, -41.02963495857382, -26.282851245828468, -26.282851245828468, -26.282851245828468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.326742620066436, "mean_inference_ms": 1.3097831499929917, "mean_action_processing_ms": 0.07326268182715834, "mean_env_wait_ms": 0.5969124911541873, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 6400, "timesteps_this_iter": 0, "agent_timesteps_total": 19200, "timers": {"sample_time_ms": 1260.1, "sample_throughput": 2539.481, "load_time_ms": 0.208, "load_throughput": 15374310.195, "learn_time_ms": 802.698, "learn_throughput": 3986.556, "update_time_ms": 1.934}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005000000000000001, "total_loss": 439.26511840820314, "policy_loss": -0.003195390829816347, "vf_loss": 439.283984375, "vf_explained_var": -0.0028757572174072264, "kl": 0.002988954447315137, "entropy": 1.5952781796455384, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 6400, "num_agent_steps_sampled": 19200, "num_steps_trained": 6400, "num_agent_steps_trained": 19200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 250, "training_iteration": 2, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-39", "timestamp": 1718736339, "time_this_iter_s": 1.6054275035858154, "time_total_s": 3.2774322032928467, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2925ccf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3.2774322032928467, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.099999999999994, "ram_util_percent": 30.15}}
{"episode_reward_max": -67.139517107438, "episode_reward_min": -189.5622028578335, "episode_reward_mean": -109.94232159400656, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -63.187400952611185}, "policy_reward_max": {"shared_policy": -22.046505702479333}, "policy_reward_mean": {"shared_policy": -36.647440531335526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.88563649043492, -137.5686996431518, -108.11156096148781, -113.87162310236478, -134.66099211556966, -82.80562559165006, -121.70601412896048, -118.32095356726582, -67.139517107438, -103.21985018007015, -134.25652763405824, -163.77829074978487, -136.75469442894186, -110.81609233824915, -107.09676262869378, -146.10551800777242, -76.18508271453315, -96.22448449232435, -104.69821227609626, -89.48247479769475, -118.53106760196921, -128.52040049820582, -100.97668178687046, -111.76426990026911, -141.22181184358175, -87.26846704012287, -102.30059081183099, -80.28064696850693, -70.86278249647079, -87.4176649481178, -120.15992311945968, -90.18302105434734, -92.19881718351702, -108.89490959745743, -81.45147732048837, -104.2420866750498, -92.6096661732573, -110.61117647930143, -113.59756129386561, -83.7288176097201, -98.47193941554663, -108.13928305780799, -111.26761817940934, -102.20823851773581, -136.7430337761734, -116.16094402575236, -112.42225872727685, -89.76532792464027, -110.69294359004441, -138.76297511307845, -98.74984484963635, -134.04184455699775, -109.60761991400766, -189.5622028578335, -117.7366274404574, -92.7337760466396, -110.081959275313, -114.55731874709402, -102.67491660005587, -97.27662771186459, -93.72227941544497, -101.1362803884636, -79.2394343791448, -102.10163232870856, -101.10595413448418, -128.20886234260018, -125.05492633889898, -83.30245098363393, -134.41370367256724, -152.5007430920832, -127.9995517143008, -94.0640962080726, -100.2258205151252, -91.37321756535061, -179.41872944524573, -95.20717029726174, -110.08795041658455, -132.86479116988792, -117.74864831031566, -90.8925570726775, -94.24705594414414, -113.3121035590998, -89.49549871672082, -116.57054574689039, -110.91176538873236, -81.7494633841264, -140.0452036293389, -91.73999598397324, -100.41659780519394, -123.13129536742453, -82.00365911297109, -101.80652089301228, -111.77447554155867, -114.2476178989398, -140.46585309194205, -89.26247277898881, -96.02593422777613, -145.56664580853953, -101.8251249594789, -102.78980731446998, -102.26644374876017, -122.75985553612009, -87.91824248962665, -114.87934409574292, -92.21216727680486, -105.32830007653845, -130.54275335151564, -113.4208283569003, -155.26964825725784, -104.86727084659734, -146.58270888105417, -94.76602173078207, -107.6684626208317, -101.12370922416832, -89.97906464896212, -96.05744754178752, -88.10190499115957, -128.99181391751114, -92.81976962807207, -107.4097675672167, -72.09882188487298, -96.27813339075655, -113.42856923974011, -91.10065499898107, -146.35634669138224, -137.51274024109827, -126.19192546197827, -88.57504385882858, -135.6727231396557, -141.0971328956594], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.29521216347829, -34.29521216347829, -34.29521216347829, -45.52289988105062, -46.022899881050606, -46.022899881050606, -35.87052032049595, -35.87052032049595, -36.37052032049595, -37.62387436745494, -38.12387436745494, -38.12387436745494, -45.22033070518989, -45.22033070518989, -44.22033070518989, -27.935208530550046, -27.935208530550046, -26.935208530550046, -40.56867137632014, -40.56867137632014, -40.56867137632014, -39.44031785575524, -39.44031785575524, -39.44031785575524, -22.546505702479333, -22.546505702479333, -22.046505702479333, -34.90661672669005, -34.90661672669005, -33.40661672669005, -45.08550921135275, -44.08550921135276, -45.08550921135275, -54.59276358326165, -54.59276358326165, -54.59276358326165, -45.58489814298059, -45.58489814298059, -45.58489814298059, -36.605364112749726, -37.605364112749726, -36.605364112749726, -35.69892087623128, -35.69892087623128, -35.69892087623128, -48.701839335924184, -48.701839335924184, -48.701839335924184, -25.395027571511065, -25.395027571511065, -25.395027571511065, -32.24149483077478, -32.24149483077478, -31.741494830774784, -34.89940409203209, -34.89940409203209, -34.89940409203209, -29.49415826589824, -29.99415826589824, -29.99415826589824, -39.51035586732306, -39.51035586732306, -39.51035586732306, -42.50680016606862, -43.00680016606862, -43.00680016606862, -33.82556059562348, -33.32556059562348, -33.82556059562348, -37.25475663342303, -37.25475663342303, -37.25475663342303, -47.073937281193906, -47.073937281193906, -47.073937281193906, -29.089489013374276, -29.089489013374276, -29.089489013374276, -34.100196937277, -34.100196937277, -34.100196937277, -25.426882322835638, -27.426882322835638, -27.426882322835638, -22.620927498823594, -24.120927498823594, -24.120927498823594, -29.305888316039276, -28.805888316039276, -29.305888316039276, -40.053307706486564, -40.053307706486564, -40.053307706486564, -30.061007018115777, -30.061007018115777, -30.061007018115777, -30.732939061172345, -30.732939061172345, -30.732939061172345, -34.964969865819164, -36.964969865819164, -36.964969865819164, -27.483825773496108, -27.483825773496108, -26.483825773496108, -35.080695558349916, -35.080695558349916, -34.080695558349916, -30.86988872441912, -30.86988872441912, -30.86988872441912, -36.20372549310049, -37.70372549310049, -36.70372549310049, -38.03252043128858, -37.53252043128858, -38.03252043128858, -27.90960586990671, -27.90960586990671, -27.90960586990671, -32.99064647184888, -32.99064647184888, -32.49064647184888, -36.04642768593603, -36.04642768593603, -36.04642768593603, -36.75587272646978, -37.75587272646979, -36.75587272646979, -34.23607950591191, -33.73607950591191, -34.23607950591191, -45.58101125872447, -45.08101125872447, -46.08101125872447, -38.72031467525081, -38.72031467525081, -38.72031467525081, -36.4740862424256, -37.9740862424256, -37.9740862424256, -29.921775974880084, -29.921775974880084, -29.921775974880084, -36.89764786334814, -36.89764786334814, -36.89764786334814, -47.25432503769279, -46.25432503769277, -45.25432503769277, -33.583281616545456, -31.583281616545456, -33.583281616545456, -44.6806148523326, -44.6806148523326, -44.6806148523326, -36.53587330466924, -36.53587330466924, -36.53587330466924, -63.187400952611185, -63.187400952611185, -63.187400952611185, -39.24554248015244, -39.24554248015244, -39.24554248015244, -30.91125868221322, -30.91125868221322, -30.91125868221322, -36.69398642510432, -36.69398642510432, -36.69398642510432, -38.18577291569799, -38.18577291569799, -38.18577291569799, -34.22497220001862, -34.22497220001862, -34.22497220001862, -32.425542570621516, -32.425542570621516, -32.425542570621516, -31.407426471814958, -30.907426471814958, -31.407426471814958, -34.54542679615456, -32.54542679615456, -34.04542679615456, -26.413144793048268, -26.413144793048268, -26.413144793048268, -34.03387744290285, -34.03387744290285, -34.03387744290285, -33.701984711494724, -33.701984711494724, -33.701984711494724, -43.06962078086673, -43.06962078086673, -42.06962078086674, -41.85164211296634, -41.85164211296634, -41.35164211296634, -27.767483661211315, -27.767483661211315, -27.767483661211315, -45.13790122418908, -44.13790122418908, -45.13790122418908, -51.00024769736106, -51.00024769736106, -50.50024769736106, -42.99985057143361, -42.99985057143361, -41.99985057143361, -31.854698736024197, -30.854698736024197, -31.354698736024197, -33.408606838375064, -33.408606838375064, -33.408606838375064, -30.45773918845018, -30.45773918845018, -30.45773918845018, -60.1395764817486, -60.1395764817486, -59.1395764817486, -31.735723432420585, -31.735723432420585, -31.735723432420585, -37.36265013886152, -37.36265013886152, -35.36265013886151, -44.28826372329597, -44.28826372329597, -44.28826372329597, -39.24954943677189, -39.24954943677189, -39.24954943677189, -30.29751902422583, -30.29751902422583, -30.29751902422583, -32.0823519813814, -32.0823519813814, -30.0823519813814, -36.770701186366594, -38.2707011863666, -38.2707011863666, -29.831832905573613, -29.831832905573613, -29.831832905573613, -39.023515248963456, -38.523515248963456, -39.023515248963456, -36.970588462910776, -36.970588462910776, -36.970588462910776, -27.249821128042125, -27.249821128042125, -27.249821128042125, -46.68173454311297, -46.68173454311297, -46.68173454311297, -30.5799986613244, -30.5799986613244, -30.5799986613244, -33.63886593506465, -33.63886593506465, -33.13886593506465, -41.04376512247484, -41.04376512247484, -41.04376512247484, -27.667886370990374, -27.667886370990374, -26.667886370990374, -33.93550696433743, -33.93550696433743, -33.93550696433743, -37.258158513852905, -37.258158513852905, -37.258158513852905, -38.082539299646584, -38.082539299646584, -38.082539299646584, -46.65528436398069, -46.65528436398069, -47.15528436398069, -29.087490926329593, -30.087490926329593, -30.087490926329593, -32.00864474259205, -32.00864474259205, -32.00864474259205, -48.35554860284651, -47.85554860284651, -49.35554860284651, -33.941708319826304, -33.941708319826304, -33.941708319826304, -34.26326910482332, -34.26326910482332, -34.26326910482332, -34.088814582920065, -34.088814582920065, -34.088814582920065, -40.58661851204002, -41.08661851204002, -41.08661851204002, -28.972747496542222, -29.472747496542222, -29.472747496542222, -38.29311469858096, -38.29311469858096, -38.29311469858096, -30.90405575893496, -30.90405575893496, -30.404055758934955, -35.10943335884615, -35.10943335884615, -35.10943335884615, -43.84758445050521, -42.84758445050521, -43.84758445050521, -37.80694278563343, -37.80694278563343, -37.80694278563343, -51.756549419085964, -51.756549419085964, -51.756549419085964, -34.955756948865776, -34.955756948865776, -34.955756948865776, -48.86090296035144, -48.86090296035144, -48.86090296035144, -31.755340576927374, -31.755340576927374, -31.255340576927374, -35.88948754027723, -35.88948754027723, -35.88948754027723, -33.70790307472276, -33.70790307472276, -33.70790307472276, -29.993021549654046, -29.993021549654046, -29.993021549654046, -32.01914918059584, -32.01914918059584, -32.01914918059584, -29.367301663719857, -29.367301663719857, -29.367301663719857, -42.6639379725037, -43.1639379725037, -43.1639379725037, -31.27325654269071, -30.27325654269071, -31.27325654269071, -35.46992252240558, -35.969922522405575, -35.969922522405575, -24.032940628290973, -24.032940628290973, -24.032940628290973, -31.592711130252205, -32.092711130252205, -32.592711130252205, -38.14285641324672, -37.14285641324672, -38.14285641324672, -30.533551666327032, -30.033551666327032, -30.533551666327032, -47.452115563794095, -49.452115563794095, -49.452115563794095, -45.83758008036609, -45.33758008036609, -46.33758008036609, -41.39730848732608, -42.39730848732608, -42.39730848732608, -28.858347952942864, -29.858347952942864, -29.858347952942864, -44.55757437988526, -45.55757437988526, -45.55757437988526, -46.69904429855307, -48.19904429855307, -46.19904429855307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3256311773881704, "mean_inference_ms": 1.3034090167153762, "mean_action_processing_ms": 0.07329297239400841, "mean_env_wait_ms": 0.5947065154918151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 9600, "timesteps_this_iter": 0, "agent_timesteps_total": 28800, "timers": {"sample_time_ms": 1360.559, "sample_throughput": 2351.975, "load_time_ms": 0.192, "load_throughput": 16679916.487, "learn_time_ms": 796.462, "learn_throughput": 4017.77, "update_time_ms": 1.782}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005000000000000001, "total_loss": 397.75084533691404, "policy_loss": -0.002050348064202012, "vf_loss": 397.7685943603516, "vf_explained_var": 0.00014885663986206055, "kl": 0.002520438809711023, "entropy": 1.5819709658622743, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 9600, "num_agent_steps_sampled": 28800, "num_steps_trained": 9600, "num_agent_steps_trained": 28800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 3, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-40", "timestamp": 1718736340, "time_this_iter_s": 1.5442595481872559, "time_total_s": 4.8216917514801025, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4.8216917514801025, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.45, "ram_util_percent": 30.15}}
{"episode_reward_max": -67.69024492710638, "episode_reward_min": -197.20150694335913, "episode_reward_mean": -110.80409530980351, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -66.06716898111968}, "policy_reward_max": {"shared_policy": -22.563414975702123}, "policy_reward_mean": {"shared_policy": -36.934698436601174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.46514068362495, -120.52301918634511, -117.39105070323346, -129.97047831590936, -108.87444549426796, -98.34816372621596, -108.53670787922773, -123.22967584400631, -105.63838412595445, -102.66020376610938, -68.03395735047916, -102.2092479199161, -134.47127450252697, -116.47910827147409, -136.9711212825165, -103.17815334318033, -112.46419170502983, -105.04329134105859, -119.15531787604809, -96.44955580933876, -162.18593095997892, -122.74892595620078, -101.37643511626354, -99.59972444096394, -89.95557562197831, -110.91551078559877, -197.20150694335913, -93.82796850807648, -104.35209755631374, -100.98744611315361, -92.60268164586101, -108.50638704021837, -100.37835221542377, -86.58349814655632, -91.60635103098117, -108.23389892798907, -128.9525604045155, -116.551915623641, -112.26032895995813, -89.76787740142156, -107.09865870770508, -94.73852299932007, -86.93977440950401, -73.63965327111379, -122.0997301822074, -96.42164317596671, -95.92782373036039, -96.88286504637263, -91.52475023526566, -115.79978319345916, -98.46935060612505, -125.81620119344262, -125.98068197747163, -122.86364599954045, -114.75879825343868, -110.50237645315056, -149.24287677060812, -73.87454091683395, -86.94555540226176, -112.03382356832222, -123.18572980601064, -147.18342692553173, -105.4939749513919, -124.79671603860552, -127.84884656553338, -120.78917854187961, -109.69677704872619, -105.34373660670079, -96.03870824224666, -128.67906230871165, -157.96324252694492, -133.55689823338076, -140.91857407383205, -111.78725294348463, -105.72194581407867, -101.68101615879218, -110.22223050148989, -99.40741224058603, -96.84070147757835, -131.08193305447244, -116.66127184328627, -116.98540879125929, -92.47226848976644, -79.67638340651908, -90.36003060894095, -98.08480671042528, -113.52210551167948, -103.29876894241002, -111.51379114669142, -123.30169172925345, -181.32505802178792, -106.22409651330167, -152.3020217732161, -67.69024492710638, -93.22100660378523, -100.65553366594116, -85.63721360294349, -119.88100817048888, -81.84352848713779, -106.45125750388351, -133.69769858512393, -106.87414953234251, -84.07520079609913, -140.27261448598276, -126.30228160241316, -113.91341095199856, -112.58789675686056, -118.67782073886313, -95.90481870469164, -86.16999839208287, -112.64810707508283, -88.44644036755537, -100.580036040552, -101.34347781275152, -108.38928015437729, -76.54864616630725, -150.4218107503387, -98.36159162124137, -140.1079420866435, -112.79193644120942, -100.60345701871918, -108.59990881347761, -105.92465196364857, -133.27594000479033, -71.17652052195425, -109.00623437853801, -162.7327473832764, -131.03876869316693, -108.20390966915755, -108.26171363802119], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-36.488380227874984, -36.488380227874984, -35.488380227874984, -39.50767306211507, -40.50767306211507, -40.50767306211507, -39.297016901077846, -39.297016901077846, -38.797016901077846, -43.65682610530309, -43.15682610530309, -43.15682610530309, -36.291481831422665, -36.291481831422665, -36.291481831422665, -32.78272124207197, -32.78272124207197, -32.78272124207197, -36.5122359597426, -36.5122359597426, -35.51223595974259, -41.07655861466876, -41.07655861466876, -41.07655861466876, -35.21279470865148, -35.21279470865148, -35.21279470865148, -34.22006792203643, -34.22006792203643, -34.22006792203643, -22.677985783493057, -22.677985783493057, -22.677985783493057, -34.40308263997201, -34.40308263997201, -33.40308263997201, -43.823758167508984, -45.323758167508984, -45.323758167508984, -39.326369423824694, -39.326369423824694, -37.8263694238247, -45.990373760838864, -44.990373760838864, -45.990373760838864, -34.39271778106012, -34.39271778106012, -34.39271778106012, -37.4880639016766, -37.4880639016766, -37.4880639016766, -35.01443044701953, -35.01443044701953, -35.01443044701953, -39.05177262534937, -40.05177262534937, -40.05177262534937, -32.14985193644627, -32.14985193644627, -32.14985193644627, -54.06197698665966, -54.06197698665966, -54.06197698665966, -40.916308652066945, -40.916308652066945, -40.916308652066945, -33.79214503875453, -33.79214503875453, -33.79214503875453, -33.19990814698797, -33.19990814698797, -33.19990814698797, -30.318525207326076, -29.318525207326076, -30.318525207326076, -37.63850359519959, -35.63850359519959, -37.63850359519959, -66.06716898111968, -66.06716898111968, -65.06716898111968, -31.609322836025502, -30.609322836025502, -31.609322836025502, -34.784032518771255, -34.784032518771255, -34.784032518771255, -33.66248203771786, -33.66248203771786, -33.66248203771786, -31.200893881953665, -30.200893881953665, -31.200893881953665, -35.00212901340613, -37.00212901340613, -36.50212901340613, -33.45945073847459, -33.45945073847459, -33.45945073847459, -29.19449938218544, -29.19449938218544, -28.19449938218544, -30.5354503436604, -30.5354503436604, -30.5354503436604, -36.24463297599636, -36.24463297599636, -35.74463297599636, -42.9841868015052, -43.4841868015052, -42.4841868015052, -38.18397187454699, -39.18397187454699, -39.18397187454699, -37.42010965331934, -37.42010965331934, -37.42010965331934, -30.255959133807178, -30.255959133807178, -29.255959133807178, -35.366219569235035, -36.36621956923503, -35.366219569235035, -30.746174333106698, -32.246174333106694, -31.746174333106698, -29.14659146983466, -29.14659146983466, -28.64659146983466, -24.71321775703793, -24.71321775703793, -24.21321775703793, -40.6999100607358, -40.6999100607358, -40.6999100607358, -32.140547725322236, -32.140547725322236, -32.140547725322236, -32.47594124345346, -32.47594124345346, -30.975941243453462, -30.96095501545754, -32.96095501545754, -32.96095501545754, -30.174916745088552, -30.674916745088552, -30.674916745088552, -38.93326106448638, -38.93326106448638, -37.93326106448638, -33.98978353537503, -31.489783535375025, -32.989783535375025, -41.938733731147536, -41.938733731147536, -41.938733731147536, -41.99356065915719, -41.99356065915719, -41.99356065915719, -40.9545486665135, -40.9545486665135, -40.9545486665135, -38.25293275114619, -38.25293275114619, -38.25293275114619, -36.66745881771685, -36.66745881771685, -37.16745881771685, -49.74762559020271, -49.74762559020271, -49.74762559020271, -24.62484697227798, -24.62484697227798, -24.62484697227798, -28.98185180075393, -28.98185180075393, -28.98185180075393, -37.34460785610741, -37.34460785610741, -37.34460785610741, -41.06190993533689, -41.06190993533689, -41.06190993533689, -49.394475641843904, -50.394475641843904, -47.3944756418439, -35.3313249837973, -34.8313249837973, -35.3313249837973, -40.93223867953516, -41.93223867953516, -41.93223867953516, -42.61628218851114, -42.61628218851114, -42.61628218851114, -40.763059513959846, -39.263059513959846, -40.763059513959846, -36.56559234957544, -36.56559234957544, -36.56559234957544, -34.11457886890024, -35.61457886890023, -35.61457886890023, -32.17956941408222, -31.679569414082223, -32.17956941408222, -43.059687436237226, -42.559687436237226, -43.059687436237226, -52.6544141756483, -52.6544141756483, -52.6544141756483, -44.518966077793614, -44.518966077793614, -44.518966077793614, -46.97285802461072, -46.97285802461072, -46.97285802461072, -37.262417647828215, -37.262417647828215, -37.262417647828215, -35.2406486046929, -35.2406486046929, -35.2406486046929, -33.89367205293074, -33.89367205293074, -33.89367205293074, -36.907410167163306, -36.407410167163306, -36.907410167163306, -33.13580408019533, -33.13580408019533, -33.13580408019533, -31.61356715919277, -33.11356715919277, -32.11356715919277, -43.69397768482416, -43.19397768482416, -44.19397768482416, -38.88709061442877, -38.88709061442877, -38.88709061442877, -38.99513626375308, -38.99513626375308, -38.99513626375308, -30.990756163255472, -30.990756163255472, -30.490756163255472, -26.55879446883969, -26.55879446883969, -26.55879446883969, -29.453343536313643, -30.453343536313643, -30.453343536313643, -32.69493557014174, -32.69493557014174, -32.69493557014174, -36.67403517055983, -38.67403517055983, -38.17403517055983, -34.43292298080333, -34.43292298080333, -34.43292298080333, -37.17126371556378, -37.17126371556378, -37.17126371556378, -41.43389724308449, -41.43389724308449, -40.43389724308449, -60.77501934059599, -59.77501934059599, -60.77501934059599, -35.408032171100544, -35.408032171100544, -35.408032171100544, -51.100673924405385, -50.100673924405385, -51.100673924405385, -22.563414975702123, -22.563414975702123, -22.563414975702123, -30.74033553459509, -31.24033553459509, -31.24033553459509, -33.55184455531371, -33.55184455531371, -33.55184455531371, -28.545737867647833, -28.545737867647833, -28.545737867647833, -39.96033605682961, -39.96033605682961, -39.96033605682961, -27.281176162379264, -27.281176162379264, -27.281176162379264, -35.48375250129451, -35.48375250129451, -35.48375250129451, -44.565899528374636, -44.565899528374636, -44.565899528374636, -35.62471651078086, -35.62471651078086, -35.62471651078086, -28.025066932033052, -28.025066932033052, -28.025066932033052, -46.75753816199425, -46.75753816199425, -46.75753816199425, -41.43409386747105, -42.43409386747105, -42.43409386747105, -37.80447031733285, -37.30447031733285, -38.80447031733284, -36.86263225228686, -37.86263225228686, -37.86263225228686, -39.225940246287706, -40.225940246287706, -39.225940246287706, -31.968272901563864, -31.968272901563864, -31.968272901563864, -28.056666130694282, -29.056666130694282, -29.056666130694282, -36.88270235836094, -37.88270235836094, -37.88270235836094, -29.48214678918514, -29.48214678918514, -29.48214678918514, -33.86001201351734, -32.86001201351734, -33.86001201351734, -34.1144926042505, -33.6144926042505, -33.6144926042505, -36.463093384792444, -36.463093384792444, -35.46309338479245, -25.516215388769062, -25.516215388769062, -25.516215388769062, -48.97393691677958, -50.47393691677958, -50.97393691677958, -33.12053054041381, -32.12053054041381, -33.12053054041381, -47.035980695547835, -47.035980695547835, -46.035980695547835, -37.5973121470698, -37.5973121470698, -37.5973121470698, -33.5344856729064, -33.5344856729064, -33.5344856729064, -35.866636271159194, -36.366636271159194, -36.366636271159194, -35.30821732121619, -35.30821732121619, -35.30821732121619, -44.42531333493012, -44.42531333493012, -44.42531333493012, -23.725506840651416, -23.725506840651416, -23.725506840651416, -36.33541145951266, -36.33541145951266, -36.33541145951266, -54.57758246109213, -55.57758246109213, -52.57758246109213, -44.17958956438898, -44.17958956438898, -42.67958956438898, -36.0679698897192, -36.0679698897192, -36.0679698897192, -36.08723787934039, -36.08723787934039, -36.08723787934039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32113143748179906, "mean_inference_ms": 1.2848374063758345, "mean_action_processing_ms": 0.07212632899168969, "mean_env_wait_ms": 0.5873666155812891, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 12800, "timesteps_this_iter": 0, "agent_timesteps_total": 38400, "timers": {"sample_time_ms": 1400.356, "sample_throughput": 2285.134, "load_time_ms": 0.183, "load_throughput": 17487651.857, "learn_time_ms": 790.449, "learn_throughput": 4048.333, "update_time_ms": 1.702}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005000000000000001, "total_loss": 404.7592376708984, "policy_loss": -0.0025561265799915133, "vf_loss": 404.77744445800784, "vf_explained_var": 0.0030146658420562742, "kl": 0.002153143904675134, "entropy": 1.5701201915740968, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12800, "num_agent_steps_sampled": 38400, "num_steps_trained": 12800, "num_agent_steps_trained": 38400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 510, "training_iteration": 4, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-42", "timestamp": 1718736342, "time_this_iter_s": 1.4931426048278809, "time_total_s": 6.314834356307983, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924dedc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6.314834356307983, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.133333333333336, "ram_util_percent": 30.266666666666666}}
{"episode_reward_max": -70.2667244841224, "episode_reward_min": -183.19812139082916, "episode_reward_mean": -114.32145609601002, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -61.066040463609674}, "policy_reward_max": {"shared_policy": -23.42224149470747}, "policy_reward_mean": {"shared_policy": -38.10715203200334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-123.36804275439272, -116.1068903783196, -160.8954969252621, -174.15944986525272, -127.88890327762282, -133.89131284359416, -112.67235944875401, -91.62112564497288, -108.4320330202019, -113.74002134539913, -98.8429553436924, -164.97388997590147, -111.24713762112991, -132.43725815191254, -141.23218565163364, -101.09238918895588, -141.21626733579066, -107.83287286890838, -91.0026014186038, -145.837949779848, -127.93967648079975, -162.80773279436613, -117.10646032784149, -125.23116968896969, -119.31065729298528, -110.68650632927123, -111.23702873445887, -129.86747487802432, -142.9155014435715, -161.25184643898905, -137.79157528872273, -105.98442507747386, -101.60973913158193, -107.66222816672773, -98.56868121729042, -70.2667244841224, -98.38935523762663, -84.43606578393481, -183.19812139082916, -93.71441888729738, -129.32143364419503, -70.41975897288246, -72.07542799355515, -85.63346860390851, -129.05998809792447, -119.24267369260221, -166.51844125397378, -112.89081978554478, -118.93231965652541, -150.0252693396594, -96.9012593891494, -162.0704895668525, -137.85361728287262, -112.44229309885604, -130.27445894960312, -128.21873964760698, -112.78926438443013, -132.4815671922794, -132.5798453423051, -83.77811358535699, -103.5906114610842, -76.39931464025003, -127.82601094478217, -118.56042500817286, -92.77250296456701, -118.72072306401786, -81.74216110633326, -154.33062949252087, -123.24441563878771, -133.51519667278978, -102.47305063783486, -95.70944529201263, -91.07927844946269, -101.71803446981426, -131.84267480927463, -93.13872680757348, -88.53289136563798, -115.35590232710328, -98.35305440559881, -119.33130009713156, -99.30075785469316, -92.56680008909805, -90.84024688819217, -129.87924543759246, -99.19659556569447, -86.28079763317716, -76.74430404247923, -127.84049054638486, -111.50120235560746, -93.82680786792383, -106.54864971396732, -96.19804973630245, -114.96113883410455, -96.65933797031529, -107.01574421265663, -93.85258550859614, -110.56947660712567, -136.57826490233694, -100.20711930594085, -94.99215621178274, -117.64088301425605, -95.24724624297525, -98.023479561927, -129.06788563554323, -116.86208839552859, -104.43331511553106, -133.266107271298, -120.24203510696071, -114.06503192094644, -84.42369123887491, -135.9168463911462, -79.37534023484173, -151.30108623852976, -90.88840682016762, -104.07666156852493, -81.39644687999082, -120.55221918138831, -101.99205151480336, -105.54731029799814, -115.4921054905715, -135.2787589991831, -94.20080417938473, -110.68395001065292, -104.52155415469718, -160.01632481955988, -122.09670478541258, -125.62174689402171, -102.96344189852219, -105.05062400557199, -95.77324227865662], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-41.289347584797596, -40.789347584797596, -41.289347584797596, -38.70229679277317, -38.70229679277317, -38.70229679277317, -55.298498975087355, -54.798498975087355, -50.798498975087355, -58.05314995508426, -58.05314995508426, -58.05314995508426, -42.62963442587426, -42.62963442587426, -42.62963442587426, -44.96377094786472, -44.46377094786472, -44.46377094786472, -38.22411981625134, -37.22411981625134, -37.22411981625134, -30.540375214990963, -30.540375214990963, -30.540375214990963, -35.4773443400673, -36.47734434006729, -36.47734434006729, -37.91334044846637, -37.91334044846637, -37.91334044846637, -32.94765178123081, -32.94765178123081, -32.94765178123081, -54.324629991967214, -55.324629991967214, -55.324629991967214, -37.58237920704331, -37.58237920704331, -36.08237920704331, -44.14575271730416, -44.14575271730416, -44.14575271730416, -47.07739521721119, -47.07739521721119, -47.07739521721119, -33.69746306298531, -33.69746306298531, -33.69746306298531, -47.072089111930225, -47.072089111930225, -47.072089111930225, -35.94429095630275, -35.94429095630275, -35.94429095630275, -30.334200472867934, -30.334200472867934, -30.334200472867934, -48.94598325994933, -48.94598325994933, -47.94598325994933, -42.97989216026659, -41.97989216026659, -42.97989216026659, -53.2692442647887, -54.7692442647887, -54.7692442647887, -38.868820109280485, -39.868820109280485, -38.368820109280485, -41.74372322965658, -41.74372322965658, -41.74372322965658, -39.770219097661744, -39.770219097661744, -39.770219097661744, -37.06216877642374, -36.56216877642374, -37.06216877642374, -37.07900957815298, -37.07900957815298, -37.07900957815298, -42.95582495934144, -43.45582495934144, -43.45582495934144, -47.80516714785712, -47.80516714785712, -47.30516714785712, -53.75061547966305, -54.25061547966305, -53.25061547966305, -45.930525096240885, -46.43052509624087, -45.43052509624087, -35.32814169249129, -35.32814169249129, -35.32814169249129, -33.86991304386064, -33.86991304386064, -33.86991304386064, -35.88740938890926, -35.88740938890926, -35.88740938890926, -32.18956040576347, -33.18956040576347, -33.18956040576347, -23.42224149470747, -23.42224149470747, -23.42224149470747, -32.796451745875544, -32.796451745875544, -32.796451745875544, -28.14535526131161, -28.14535526131161, -28.14535526131161, -61.066040463609674, -61.066040463609674, -61.066040463609674, -31.238139629099138, -31.238139629099138, -31.238139629099138, -43.10714454806502, -43.10714454806502, -43.10714454806502, -23.473252990960827, -23.473252990960827, -23.473252990960827, -24.19180933118506, -23.69180933118506, -24.19180933118506, -28.877822867969495, -27.877822867969495, -28.877822867969495, -43.019996032641494, -43.019996032641494, -43.019996032641494, -39.74755789753406, -39.74755789753406, -39.74755789753406, -55.50614708465789, -55.50614708465789, -55.50614708465789, -37.630273261848245, -37.630273261848245, -37.630273261848245, -39.644106552175145, -39.644106552175145, -39.644106552175145, -49.6750897798865, -50.1750897798865, -50.1750897798865, -32.80041979638314, -32.80041979638314, -31.30041979638313, -54.19016318895082, -54.19016318895082, -53.69016318895083, -45.95120576095754, -45.95120576095754, -45.95120576095754, -37.64743103295202, -37.64743103295202, -37.14743103295202, -43.424819649867686, -43.424819649867686, -43.424819649867686, -43.07291321586897, -42.072913215868965, -43.07291321586897, -37.763088128143345, -37.763088128143345, -37.263088128143345, -43.4938557307598, -44.49385573075979, -44.49385573075979, -44.19328178076835, -44.19328178076835, -44.19328178076835, -27.09270452845234, -28.09270452845234, -28.59270452845234, -34.86353715369474, -34.86353715369474, -33.86353715369474, -25.46643821341668, -25.46643821341668, -25.46643821341668, -41.94200364826072, -42.94200364826072, -42.94200364826072, -39.52014166939096, -40.02014166939096, -39.02014166939096, -31.25750098818901, -31.25750098818901, -30.25750098818901, -39.74024102133928, -39.24024102133928, -39.74024102133928, -27.247387035444415, -27.247387035444415, -27.247387035444415, -51.443543164173605, -51.443543164173605, -51.443543164173605, -41.08147187959589, -41.08147187959589, -41.08147187959589, -44.5050655575966, -44.5050655575966, -44.5050655575966, -32.82435021261163, -34.82435021261163, -34.82435021261163, -30.569815097337553, -32.56981509733755, -32.56981509733755, -30.359759483154207, -30.359759483154207, -30.359759483154207, -32.73934482327138, -34.73934482327139, -34.23934482327139, -44.28089160309155, -43.28089160309155, -44.28089160309155, -31.379575602524504, -30.379575602524504, -31.379575602524504, -29.510963788546, -29.510963788546, -29.510963788546, -38.785300775701096, -37.7853007757011, -38.785300775701096, -32.78435146853295, -32.78435146853295, -32.78435146853295, -40.11043336571051, -40.11043336571051, -39.11043336571051, -33.266919284897696, -33.266919284897696, -32.7669192848977, -30.855600029699353, -30.855600029699353, -30.855600029699353, -30.28008229606406, -30.28008229606406, -30.28008229606406, -42.62641514586417, -43.62641514586417, -43.62641514586417, -32.3988651885648, -33.3988651885648, -33.3988651885648, -28.76026587772571, -28.76026587772571, -28.76026587772571, -24.91476801415973, -26.41476801415973, -25.414768014159723, -42.61349684879497, -42.61349684879497, -42.61349684879497, -36.83373411853583, -37.33373411853583, -37.33373411853583, -30.608935955974594, -31.608935955974594, -31.608935955974594, -34.1828832379891, -36.18288323798911, -36.18288323798911, -31.732683245434142, -32.23268324543414, -32.23268324543414, -37.32037961136818, -38.82037961136818, -38.82037961136818, -32.21977932343842, -32.21977932343842, -32.21977932343842, -36.505248070885564, -34.00524807088556, -36.505248070885564, -31.284195169532055, -31.284195169532055, -31.284195169532055, -36.52315886904188, -37.02315886904188, -37.02315886904188, -46.19275496744566, -45.19275496744566, -45.19275496744566, -33.40237310198029, -33.40237310198029, -33.40237310198029, -31.664052070594245, -31.664052070594245, -31.664052070594245, -39.21362767141868, -39.21362767141868, -39.21362767141868, -32.082415414325084, -31.082415414325084, -32.082415414325084, -32.67449318730901, -32.67449318730901, -32.67449318730901, -43.02262854518107, -43.02262854518107, -43.02262854518107, -38.28736279850954, -39.28736279850954, -39.28736279850954, -33.14443837184367, -35.64443837184367, -35.64443837184367, -44.08870242376601, -44.58870242376601, -44.58870242376601, -40.080678368986895, -40.080678368986895, -40.080678368986895, -39.35501064031548, -37.85501064031548, -36.85501064031548, -28.141230412958304, -28.141230412958304, -28.141230412958304, -45.30561546371542, -45.30561546371542, -45.30561546371542, -26.79178007828056, -25.79178007828056, -26.79178007828056, -48.76702874617659, -51.26702874617659, -51.26702874617659, -30.29613560672253, -30.29613560672253, -30.29613560672253, -35.19222052284162, -35.19222052284162, -33.69222052284162, -27.96548229333026, -27.96548229333026, -25.46548229333026, -40.517406393796115, -40.517406393796115, -39.51740639379611, -33.99735050493446, -33.99735050493446, -33.99735050493446, -35.18243676599938, -35.18243676599938, -35.18243676599938, -37.49736849685716, -38.99736849685716, -38.99736849685716, -45.092919666394394, -45.092919666394394, -45.092919666394394, -32.06693472646157, -31.066934726461565, -31.066934726461565, -36.89465000355098, -36.89465000355098, -36.89465000355098, -35.00718471823239, -34.50718471823239, -35.00718471823239, -53.338774939853295, -53.338774939853295, -53.338774939853295, -41.03223492847085, -41.03223492847085, -40.03223492847084, -41.87391563134058, -41.87391563134058, -41.87391563134058, -34.321147299507395, -34.321147299507395, -34.321147299507395, -34.68354133519067, -35.68354133519067, -34.68354133519067, -32.257747426218856, -32.257747426218856, -31.257747426218852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32086820620287215, "mean_inference_ms": 1.2883291774656829, "mean_action_processing_ms": 0.0719710188608926, "mean_env_wait_ms": 0.5907834730321061, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 1430.253, "sample_throughput": 2237.366, "load_time_ms": 0.176, "load_throughput": 18186684.011, "learn_time_ms": 788.462, "learn_throughput": 4058.532, "update_time_ms": 1.647}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 442.0350280761719, "policy_loss": -0.004485251586883976, "vf_loss": 442.05503540039064, "vf_explained_var": -0.012187230587005615, "kl": 0.00832117337814291, "entropy": 1.5626386642456054, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 48000, "num_steps_trained": 16000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 5, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-44", "timestamp": 1718736344, "time_this_iter_s": 1.5442118644714355, "time_total_s": 7.859046220779419, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 7.859046220779419, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.45, "ram_util_percent": 30.25}}
{"episode_reward_max": -68.88055863453852, "episode_reward_min": -166.16982733112263, "episode_reward_mean": -104.64449510396462, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -55.72327577704087}, "policy_reward_max": {"shared_policy": -22.460186211512855}, "policy_reward_mean": {"shared_policy": -34.88149836798821}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-122.8507316904238, -156.5164616913621, -106.89126382891853, -97.19605702008427, -123.62193387967389, -119.54039446668344, -76.65417582340025, -107.52376438159074, -103.54923808391197, -98.57505043329367, -86.24874588907579, -104.44517996646194, -97.43633574387206, -87.23524509066198, -109.59749425767995, -86.49396508779267, -83.47037308780669, -161.8810559914957, -99.22789808807822, -103.94445053632528, -159.8464777666474, -135.74244607291593, -112.47296898497956, -95.02566531767569, -107.05314532592712, -100.52172388467629, -100.08090450538064, -114.14313226150774, -106.31603200763584, -91.99798888130151, -115.01708451355773, -74.6607404195412, -101.78568558839544, -103.40008435067008, -92.22760765610992, -105.15027827498295, -125.13385721248041, -98.6817440690599, -87.69412697093551, -131.56582183619153, -90.48922249468914, -93.93543380975048, -152.063565726924, -81.80469089468431, -128.33923595220918, -93.35413665537833, -85.99387415012357, -100.96289685289761, -148.87478140520906, -84.88849368069468, -110.76711313907136, -98.80963558919721, -103.90470433208088, -102.4965793120314, -90.24203923650974, -109.2813556029972, -73.70078279998484, -79.56376048195092, -81.57256319382445, -91.73918940947766, -76.40630752800196, -88.50867409906348, -148.39863189910142, -80.56804531681296, -127.81578511704248, -106.2348145534488, -144.03625389375756, -98.18089785991867, -99.53626625753103, -90.59084016363828, -88.24869235500759, -109.13722232015994, -87.66093294062279, -126.08666960983913, -75.5011439072108, -95.51308564914058, -98.44287574620219, -90.41241018722121, -68.88055863453852, -109.26452816880573, -130.45609964512337, -107.78780004835305, -79.2481236423357, -100.15100703518812, -88.93464573976712, -82.31490514093868, -108.5190940707562, -135.41533308406775, -118.02783878073203, -97.58100966419656, -98.29075751854378, -100.78979280175469, -113.32263979468952, -101.82653950725516, -151.0360982962368, -128.3738763713561, -107.05411187532087, -82.85567723633423, -80.34249570257995, -90.6445853340739, -100.78561873010297, -101.8906272230284, -88.83334611701049, -107.76741357311174, -109.25385850254597, -96.4395574556881, -125.96810280247766, -117.46246370255618, -98.49048625293806, -124.9322876278394, -105.34920516496824, -69.38542581414801, -98.38863739064617, -166.16982733112263, -137.80879906315434, -82.34469488720471, -102.23857064435174, -103.9330052100901, -116.99114270263942, -96.30788912460996], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-40.950243896807926, -40.950243896807926, -40.950243896807926, -52.50548723045405, -52.50548723045405, -51.50548723045405, -35.96375460963951, -34.963754609639516, -35.96375460963951, -32.39868567336143, -32.39868567336143, -32.39868567336143, -41.54064462655797, -41.04064462655797, -41.04064462655797, -39.84679815556113, -39.84679815556113, -39.84679815556113, -25.5513919411334, -25.5513919411334, -25.5513919411334, -35.84125479386358, -35.84125479386358, -35.84125479386358, -34.516412694637324, -34.516412694637324, -34.516412694637324, -32.85835014443121, -32.85835014443121, -32.85835014443121, -28.749581963025257, -28.749581963025257, -28.749581963025257, -34.81505998882062, -34.81505998882062, -34.81505998882062, -32.47877858129069, -32.47877858129069, -32.47877858129069, -29.078415030220675, -28.578415030220675, -29.578415030220675, -36.86583141922666, -36.86583141922666, -35.865831419226666, -28.831321695930892, -28.831321695930892, -28.831321695930892, -27.823457695935556, -27.823457695935556, -27.823457695935556, -54.29368533049857, -53.29368533049857, -54.29368533049857, -33.07596602935939, -33.07596602935939, -33.07596602935939, -34.648150178775076, -34.648150178775076, -34.648150178775076, -53.61549258888251, -53.61549258888251, -52.61549258888251, -45.24748202430529, -45.24748202430529, -45.24748202430529, -37.324322994993224, -38.324322994993224, -36.82432299499322, -32.00855510589191, -32.00855510589191, -31.008555105891908, -35.01771510864237, -36.01771510864237, -36.01771510864237, -33.507241294892076, -33.507241294892076, -33.507241294892076, -32.86030150179355, -33.86030150179354, -33.36030150179354, -37.04771075383592, -38.54771075383593, -38.54771075383593, -35.77201066921196, -34.77201066921196, -35.77201066921196, -30.665996293767154, -30.665996293767154, -30.665996293767154, -38.839028171185916, -37.339028171185916, -38.839028171185916, -24.886913473180392, -24.886913473180392, -24.886913473180392, -34.428561862798496, -34.428561862798496, -32.928561862798496, -34.466694783556676, -34.466694783556676, -34.466694783556676, -30.742535885369968, -30.742535885369968, -30.742535885369968, -35.38342609166099, -35.38342609166099, -34.38342609166099, -41.37795240416014, -41.37795240416014, -42.37795240416014, -32.89391468968664, -32.89391468968664, -32.89391468968664, -28.898042323645157, -29.398042323645157, -29.398042323645157, -43.85527394539721, -43.85527394539721, -43.85527394539721, -30.32974083156304, -29.82974083156304, -30.32974083156304, -31.311811269916806, -31.311811269916806, -31.311811269916806, -50.68785524230798, -50.68785524230798, -50.68785524230798, -27.2682302982281, -27.2682302982281, -27.2682302982281, -42.77974531740303, -42.77974531740303, -42.77974531740303, -30.11804555179279, -31.61804555179279, -31.61804555179279, -27.997958050041177, -28.997958050041177, -28.997958050041177, -33.654298950965874, -33.654298950965874, -33.654298950965874, -49.62492713506971, -49.62492713506971, -49.62492713506971, -28.29616456023155, -28.29616456023155, -28.29616456023155, -37.25570437969046, -36.25570437969046, -37.25570437969046, -32.93654519639909, -32.93654519639909, -32.93654519639909, -34.63490144402696, -34.63490144402696, -34.63490144402696, -34.83219310401046, -32.33219310401046, -35.33219310401046, -31.08067974550324, -29.58067974550324, -29.58067974550324, -36.4271185343324, -36.4271185343324, -36.4271185343324, -24.566927599994933, -24.566927599994933, -24.566927599994933, -26.521253493983647, -26.521253493983647, -26.521253493983647, -27.1908543979415, -27.1908543979415, -27.1908543979415, -30.579729803159196, -30.579729803159196, -30.579729803159196, -26.63543584266732, -24.13543584266732, -25.63543584266732, -29.502891366354486, -29.502891366354486, -29.502891366354486, -49.46621063303376, -49.46621063303376, -49.46621063303376, -26.856015105604307, -27.356015105604307, -26.356015105604307, -42.6052617056808, -42.6052617056808, -42.6052617056808, -35.57827151781626, -35.07827151781626, -35.57827151781626, -48.01208463125251, -48.01208463125251, -48.01208463125251, -32.226965953306234, -33.226965953306234, -32.726965953306234, -33.178755419177, -33.178755419177, -33.178755419177, -30.363613387879422, -30.363613387879422, -29.863613387879422, -29.41623078500254, -29.41623078500254, -29.41623078500254, -36.879074106719976, -35.379074106719976, -36.879074106719976, -28.886977646874243, -29.886977646874243, -28.886977646874243, -42.36222320327971, -41.36222320327971, -42.36222320327971, -25.500381302403593, -24.500381302403593, -25.500381302403593, -31.337695216380204, -32.337695216380204, -31.837695216380204, -32.814291915400744, -32.814291915400744, -32.814291915400744, -30.137470062407097, -30.137470062407097, -30.137470062407097, -23.460186211512855, -22.460186211512855, -22.960186211512855, -36.75484272293524, -35.75484272293524, -36.75484272293524, -43.48536654837445, -43.48536654837445, -43.48536654837445, -36.095933349451, -36.095933349451, -35.595933349451, -26.41604121411192, -26.41604121411192, -26.41604121411192, -32.38366901172938, -33.883669011729374, -33.883669011729374, -29.64488191325572, -29.64488191325572, -29.64488191325572, -27.438301713646233, -27.438301713646233, -27.438301713646233, -36.17303135691874, -35.67303135691874, -36.67303135691874, -45.47177769468926, -44.47177769468926, -45.47177769468926, -39.67594626024402, -39.67594626024402, -38.67594626024402, -32.527003221398864, -32.527003221398864, -32.527003221398864, -32.76358583951458, -32.76358583951458, -32.76358583951458, -33.59659760058491, -33.59659760058491, -33.59659760058491, -37.774213264896524, -37.774213264896524, -37.774213264896524, -34.27551316908507, -34.27551316908507, -33.27551316908509, -50.34536609874557, -49.84536609874557, -50.84536609874557, -42.95795879045201, -42.95795879045201, -42.45795879045201, -35.684703958440316, -35.684703958440316, -35.684703958440316, -27.78522574544476, -27.28522574544476, -27.78522574544476, -26.78083190085998, -26.78083190085998, -26.78083190085998, -29.881528444691284, -31.381528444691284, -29.381528444691284, -34.09520624336766, -32.59520624336766, -34.09520624336766, -33.96354240767613, -33.96354240767613, -33.96354240767613, -29.611115372336815, -29.611115372336815, -29.611115372336815, -36.25580452437058, -36.25580452437058, -35.25580452437059, -36.75128616751532, -36.75128616751532, -35.7512861675153, -31.3131858185627, -32.8131858185627, -32.3131858185627, -41.65603426749256, -42.15603426749255, -42.15603426749255, -39.15415456751876, -39.15415456751876, -39.15415456751876, -32.996828750979326, -32.996828750979326, -32.496828750979326, -40.64409587594649, -42.14409587594649, -42.14409587594649, -34.44973505498943, -35.44973505498944, -35.44973505498944, -22.628475271382673, -23.128475271382673, -23.628475271382673, -32.46287913021539, -32.96287913021539, -32.96287913021539, -55.72327577704087, -54.72327577704087, -55.72327577704087, -46.2695996877181, -45.2695996877181, -46.2695996877181, -27.781564962401564, -26.781564962401564, -27.781564962401564, -34.246190214783915, -33.746190214783915, -34.246190214783915, -33.64433507003002, -35.14433507003002, -35.14433507003002, -39.66371423421315, -37.66371423421315, -39.66371423421315, -31.76929637486999, -32.269296374869995, -32.269296374869995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31720170870477615, "mean_inference_ms": 1.2776100654145321, "mean_action_processing_ms": 0.07141611962067713, "mean_env_wait_ms": 0.5865660388912776, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 19200, "timesteps_this_iter": 0, "agent_timesteps_total": 57600, "timers": {"sample_time_ms": 1444.651, "sample_throughput": 2215.068, "load_time_ms": 0.17, "load_throughput": 18793614.189, "learn_time_ms": 784.33, "learn_throughput": 4079.915, "update_time_ms": 1.604}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005000000000000001, "total_loss": 354.23272399902345, "policy_loss": -0.0024105287620230344, "vf_loss": 354.2508026123047, "vf_explained_var": -0.002457857131958008, "kl": 0.002022962475119078, "entropy": 1.5691370368003845, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 19200, "num_agent_steps_sampled": 57600, "num_steps_trained": 19200, "num_agent_steps_trained": 57600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 760, "training_iteration": 6, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-45", "timestamp": 1718736345, "time_this_iter_s": 1.486079454421997, "time_total_s": 9.345125675201416, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.345125675201416, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.1, "ram_util_percent": 30.3}}
{"episode_reward_max": -68.22636681194044, "episode_reward_min": -175.88750655110914, "episode_reward_mean": -107.35669346707512, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -58.96250218370311}, "policy_reward_max": {"shared_policy": -21.822655326698463}, "policy_reward_mean": {"shared_policy": -35.78556448902504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.35468820351649, -105.43125114833961, -91.13910728194733, -121.52219632065616, -95.31080971340812, -85.75296048887057, -82.18976721746061, -87.45240405043482, -115.28224546513616, -116.26507789067863, -99.1903212776729, -133.53779665931933, -109.73060003098945, -98.09548017523025, -74.53122656013164, -142.6472712719515, -113.39903241094073, -87.36532130784357, -93.5609109741601, -79.09902423204755, -134.32002941599384, -83.01510961954273, -117.09460117845715, -98.72765987097004, -138.19037126542085, -102.35276851847811, -105.0466267145129, -119.4944355007243, -96.48668779314089, -92.66903545476848, -99.10900033849833, -103.34791098563481, -112.24157904314427, -107.07728477281857, -106.35881817936703, -109.37659973120283, -143.7443988831172, -80.62953489657315, -110.69263881194753, -97.10030340005243, -110.62990742628833, -125.9231608020578, -108.70357302781596, -109.10214579598941, -121.93315510208863, -105.12468662712757, -92.34045210001374, -131.00491925990556, -86.36720154799465, -107.0320955474845, -127.1297433500678, -119.84436924936932, -139.9919473438143, -114.26496218182501, -87.50576827565195, -93.33342409895727, -154.88499197991837, -89.02281967913771, -103.70438474539286, -101.59721695596711, -105.16306985862742, -103.18449009324439, -111.95821649200272, -158.63053548732506, -121.34787950504763, -118.29561682271411, -110.22513790134869, -156.9735258740735, -85.77448896447136, -74.66086287559021, -133.7455353903492, -94.97993693711919, -123.67860967442955, -87.64041443917266, -91.66688641354986, -90.02146835947075, -129.11497080183125, -126.4506500765687, -100.0668820816089, -82.82872381745955, -110.0500587006365, -115.42533439284155, -101.47067684500894, -140.23732302269855, -98.384363520617, -111.58666159147327, -97.8065996536105, -76.79069985439276, -133.39290973464665, -109.90727432381752, -121.44326981197683, -93.90736032125095, -130.16939480834, -125.13424631931002, -126.14178911359292, -128.30697231041376, -91.11387648336208, -112.04260623519579, -103.17979605561027, -99.23475092313113, -87.3303094925999, -110.80188955856556, -116.39945376426824, -82.58877065978228, -175.88750655110914, -81.58018024907902, -101.3970918751316, -93.81224505874492, -95.96686589315703, -128.48244612703652, -108.36308574922215, -110.66738623475007, -78.26775293493662, -69.46796598009541, -104.5190355833132, -78.69906433997402, -137.31245824533926, -83.89723809913733, -107.82010725203861, -102.90071271412752, -119.59641597874459, -135.8680405851181, -83.38302532831948, -114.70298719370136, -84.96783921789692, -111.65255351157556, -68.22636681194044, -116.50007820637984, -125.29404711640007, -99.50955236738126], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-29.451562734505515, -30.451562734505515, -30.451562734505515, -35.143750382779864, -35.143750382779864, -35.143750382779864, -29.71303576064913, -30.71303576064913, -30.71303576064913, -40.507398773552076, -40.507398773552076, -40.507398773552076, -32.6036032378027, -31.1036032378027, -31.6036032378027, -29.08432016295685, -29.08432016295685, -27.58432016295685, -27.063255739153554, -27.563255739153554, -27.563255739153554, -29.150801350144924, -29.150801350144924, -29.150801350144924, -38.594081821712024, -38.094081821712024, -38.594081821712024, -38.75502596355955, -38.75502596355955, -38.75502596355955, -33.39677375922432, -32.39677375922431, -33.39677375922432, -44.51259888643978, -44.51259888643978, -44.51259888643978, -36.41020001032984, -36.91020001032984, -36.41020001032984, -32.69849339174343, -32.69849339174343, -32.69849339174343, -24.510408853377193, -25.010408853377193, -25.010408853377193, -47.715757090650506, -47.715757090650506, -47.215757090650506, -38.299677470313604, -36.7996774703136, -38.299677470313604, -29.12177376928119, -29.12177376928119, -29.12177376928119, -31.353636991386708, -30.853636991386708, -31.353636991386708, -26.36634141068252, -26.36634141068252, -26.36634141068252, -45.44000980533129, -44.44000980533129, -44.44000980533129, -28.3383698731809, -27.3383698731809, -27.3383698731809, -39.3648670594857, -38.3648670594857, -39.3648670594857, -32.90921995699, -32.90921995699, -32.90921995699, -46.39679042180696, -45.39679042180696, -46.39679042180696, -34.11758950615937, -34.11758950615937, -34.11758950615937, -34.68220890483763, -35.18220890483763, -35.18220890483763, -40.16481183357478, -40.16481183357478, -39.16481183357478, -32.1622292643803, -32.1622292643803, -32.1622292643803, -30.889678484922808, -30.889678484922808, -30.889678484922808, -32.36966677949944, -33.36966677949944, -33.36966677949944, -33.782636995211625, -34.782636995211625, -34.782636995211625, -37.41385968104808, -37.41385968104808, -37.41385968104808, -35.69242825760618, -35.69242825760618, -35.69242825760618, -35.95293939312234, -34.452939393122335, -35.95293939312234, -36.62553324373426, -36.12553324373426, -36.62553324373426, -47.58146629437239, -47.58146629437239, -48.58146629437239, -26.876511632191068, -26.876511632191068, -26.876511632191068, -37.230879603982494, -36.230879603982494, -37.230879603982494, -31.366767800017485, -32.86676780001748, -32.86676780001748, -36.54330247542942, -37.04330247542942, -37.04330247542942, -41.97438693401928, -41.97438693401928, -41.97438693401928, -36.2345243426053, -36.2345243426053, -36.2345243426053, -36.36738193199644, -36.36738193199644, -36.36738193199644, -39.977718367362854, -40.977718367362854, -40.977718367362854, -35.041562209042525, -35.041562209042525, -35.041562209042525, -30.78015070000459, -30.78015070000459, -30.78015070000459, -43.668306419968495, -43.668306419968495, -43.668306419968495, -29.122400515998212, -28.122400515998212, -29.122400515998212, -35.67736518249484, -35.67736518249484, -35.67736518249484, -43.2099144500226, -43.2099144500226, -40.709914450022595, -39.94812308312309, -39.94812308312309, -39.94812308312309, -46.99731578127144, -46.99731578127144, -45.99731578127144, -38.25498739394165, -38.25498739394165, -37.75498739394165, -29.001922758550627, -29.501922758550627, -29.001922758550627, -31.111141366319085, -31.111141366319085, -31.111141366319085, -51.96166399330613, -51.96166399330613, -50.961663993306125, -29.340939893045906, -29.840939893045906, -29.840939893045906, -34.568128248464305, -34.568128248464305, -34.568128248464305, -34.03240565198905, -33.53240565198905, -34.03240565198905, -34.72102328620917, -35.72102328620917, -34.72102328620917, -34.39483003108143, -34.39483003108143, -34.39483003108143, -37.986072164000916, -37.986072164000916, -35.986072164000916, -52.87684516244169, -52.87684516244169, -52.87684516244169, -40.11595983501587, -40.61595983501587, -40.61595983501587, -39.098538940904696, -39.098538940904696, -40.098538940904696, -36.908379300449596, -36.40837930044959, -36.908379300449596, -52.99117529135781, -52.99117529135781, -50.99117529135781, -27.591496321490443, -29.091496321490443, -29.091496321490443, -24.886954291863393, -24.886954291863393, -24.886954291863393, -44.58184513011638, -44.58184513011638, -44.58184513011638, -32.15997897903971, -30.659978979039707, -32.15997897903971, -40.22620322480986, -41.72620322480986, -41.72620322480986, -29.546804813057545, -28.546804813057545, -29.546804813057545, -30.55562880451663, -30.55562880451663, -30.55562880451663, -30.173822786490252, -29.673822786490252, -30.173822786490252, -43.37165693394376, -42.37165693394376, -43.37165693394376, -42.15021669218953, -42.15021669218953, -42.15021669218953, -33.52229402720296, -33.52229402720296, -33.02229402720295, -27.609574605819827, -27.609574605819827, -27.609574605819827, -36.68335290021214, -36.68335290021214, -36.68335290021214, -38.475111464280516, -38.475111464280516, -38.475111464280516, -33.990225615002984, -33.990225615002984, -33.490225615002984, -46.74577434089956, -46.74577434089956, -46.74577434089956, -32.79478784020568, -32.79478784020568, -32.79478784020568, -37.69555386382442, -37.19555386382442, -36.69555386382442, -32.602199884536844, -32.602199884536844, -32.602199884536844, -25.93023328479758, -25.93023328479758, -24.93023328479758, -44.13096991154888, -44.13096991154888, -45.13096991154888, -36.63575810793919, -36.63575810793919, -36.63575810793919, -40.481089937325635, -40.481089937325635, -40.481089937325635, -30.6357867737503, -31.6357867737503, -31.6357867737503, -43.38979826944665, -43.38979826944665, -43.38979826944665, -41.71141543977001, -41.71141543977001, -41.71141543977001, -42.04726303786433, -42.04726303786433, -42.04726303786433, -43.102324103471226, -42.10232410347122, -43.102324103471226, -30.53795882778734, -30.53795882778734, -30.03795882778734, -37.84753541173194, -37.84753541173194, -36.34753541173194, -34.39326535187009, -34.39326535187009, -34.39326535187009, -32.74491697437704, -33.24491697437704, -33.24491697437704, -29.110103164199963, -29.110103164199963, -29.110103164199963, -36.93396318618852, -36.93396318618852, -36.93396318618852, -39.46648458808942, -39.46648458808942, -37.46648458808943, -27.529590219927446, -27.529590219927446, -27.529590219927446, -57.96250218370311, -58.96250218370311, -58.96250218370311, -28.026726749693015, -26.526726749693022, -27.026726749693015, -33.46569729171053, -33.46569729171053, -34.46569729171053, -31.27074835291497, -31.27074835291497, -31.27074835291497, -31.988955297719002, -31.988955297719002, -31.988955297719002, -43.16081537567884, -43.16081537567884, -42.16081537567884, -36.12102858307405, -36.12102858307405, -36.12102858307405, -36.88912874491673, -36.88912874491673, -36.88912874491673, -26.255917644978876, -25.755917644978876, -26.255917644978876, -21.822655326698463, -23.822655326698463, -23.822655326698463, -34.83967852777106, -34.83967852777106, -34.83967852777106, -26.233021446657993, -26.233021446657993, -26.233021446657993, -45.770819415113074, -45.770819415113074, -45.770819415113074, -28.132412699712415, -27.632412699712415, -28.132412699712415, -35.94003575067955, -35.94003575067955, -35.94003575067955, -35.13357090470917, -35.13357090470917, -32.63357090470917, -39.86547199291486, -39.86547199291486, -39.86547199291486, -45.28934686170603, -45.28934686170603, -45.28934686170603, -28.294341776106485, -27.794341776106485, -27.294341776106485, -38.40099573123376, -37.90099573123376, -38.40099573123376, -28.822613072632294, -27.322613072632294, -28.822613072632294, -37.21751783719188, -37.21751783719188, -37.21751783719188, -22.408788937313492, -22.908788937313492, -22.908788937313492, -39.16669273545992, -40.16669273545992, -37.166692735459925, -41.76468237213336, -41.76468237213336, -41.76468237213336, -33.33651745579377, -33.33651745579377, -32.83651745579377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31225000412960985, "mean_inference_ms": 1.2579415111550258, "mean_action_processing_ms": 0.07017829066033558, "mean_env_wait_ms": 0.5782406652468434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 22400, "timesteps_this_iter": 0, "agent_timesteps_total": 67200, "timers": {"sample_time_ms": 1445.946, "sample_throughput": 2213.084, "load_time_ms": 0.164, "load_throughput": 19484116.466, "learn_time_ms": 780.815, "learn_throughput": 4098.281, "update_time_ms": 1.591}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 356.13758544921876, "policy_loss": -0.0029166905997939805, "vf_loss": 356.15593872070315, "vf_explained_var": -0.022947096824645997, "kl": 0.0050593674064683914, "entropy": 1.546245539188385, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 22400, "num_agent_steps_sampled": 67200, "num_steps_trained": 22400, "num_agent_steps_trained": 67200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 890, "training_iteration": 7, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-47", "timestamp": 1718736347, "time_this_iter_s": 1.4347336292266846, "time_total_s": 10.7798593044281, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 10.7798593044281, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.75, "ram_util_percent": 30.3}}
{"episode_reward_max": -70.74468540607783, "episode_reward_min": -159.8469126479907, "episode_reward_mean": -104.55202416008787, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -53.948970882663545}, "policy_reward_max": {"shared_policy": -23.248228468692606}, "policy_reward_mean": {"shared_policy": -34.85067472002929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.0875726264064, -103.52053659439534, -104.69744652857744, -98.39517166573778, -95.63055556817699, -95.32813936038616, -122.82356780884106, -86.6324906128835, -100.56720066183689, -104.39769348611523, -87.15179103151863, -93.86839676548684, -74.56347016416606, -104.10369427159979, -98.89577433581069, -103.64331549416329, -94.28452719101844, -113.02259472582668, -104.38946059252304, -144.97665228427917, -109.84843841026598, -139.2421450356232, -99.898432408391, -94.6279505889937, -121.08873207557299, -100.84939415757133, -98.58583388864781, -85.09389045200633, -87.74662940878385, -101.65139564078788, -101.34182590706367, -116.07311218657148, -104.63716091955993, -101.89713463317119, -94.65869036510699, -105.22107003986194, -102.08947242050282, -120.2391120855215, -103.54902746577294, -90.04297743138737, -80.3583288494234, -108.49019868963519, -93.70171329413166, -112.66805026956459, -128.58592693717108, -137.09416437865792, -108.66924441031942, -118.98213174497306, -112.63560629576828, -94.00107746544214, -102.50248723374918, -111.31691060572147, -97.0653683099866, -87.56217329218505, -155.54694032815362, -109.07845561744725, -99.65648939233549, -91.12291164075526, -96.95433685802523, -127.69468351630734, -106.84371371672451, -91.86430949925794, -82.59552711533702, -77.78366061241351, -85.30721608682914, -106.64792731320921, -100.76901453004753, -93.11282862053842, -78.56308567554265, -76.3887402372508, -100.07549296784232, -104.72182697678778, -110.04745324690677, -114.9875237304269, -81.30613380976932, -113.98741011044926, -74.60471730513092, -136.74183289044592, -95.44023651827418, -138.50661042453424, -96.26854564929913, -98.50312536618434, -140.25916886819215, -94.06222545711131, -94.20136065106863, -86.2708395052749, -101.86774727698354, -81.12728889274125, -117.51257818451279, -128.98796973469857, -97.83283752540754, -95.00550820681035, -95.37253380729861, -84.99990225175272, -102.45833641641693, -104.09001213234761, -133.0937943221246, -101.54426773353245, -85.05555888489313, -112.45677404579152, -99.05738322064065, -96.50787456653944, -95.92664596705391, -129.71049165440266, -121.50328672784552, -129.84589728082622, -87.02919225311197, -92.1792040574661, -113.87065501318736, -85.23451781847373, -144.74198275488342, -99.24120627912464, -159.8469126479907, -125.09900078490352, -93.51578057265489, -83.53029663481533, -100.04629555246355, -119.37485538286172, -97.93802104984553, -105.66597315663373, -114.3880609633728, -104.31182068496791, -112.52307266991293, -116.90305142940132, -125.81259259971047, -125.31601383637096, -110.26565208875766, -70.74468540607783, -103.06610081821353, -104.25130421808623], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-40.695857542135464, -38.69585754213546, -40.695857542135464, -34.67351219813178, -34.67351219813178, -34.17351219813178, -34.89914884285912, -34.89914884285912, -34.89914884285912, -32.79839055524593, -32.79839055524593, -32.79839055524593, -31.876851856059, -31.876851856059, -31.876851856059, -32.109379786795415, -32.109379786795415, -31.109379786795415, -40.94118926961367, -40.94118926961367, -40.94118926961367, -29.54416353762785, -28.54416353762785, -28.54416353762785, -33.85573355394564, -32.85573355394564, -33.85573355394564, -35.799231162038424, -33.799231162038424, -34.799231162038424, -29.550597010506216, -29.550597010506216, -28.050597010506213, -31.456132255162252, -30.956132255162252, -31.456132255162252, -24.854490054722028, -24.854490054722028, -24.854490054722028, -34.7012314238666, -34.7012314238666, -34.7012314238666, -32.79859144527024, -33.29859144527024, -32.79859144527024, -34.547771831387756, -34.547771831387756, -34.547771831387756, -32.26150906367282, -29.76150906367282, -32.26150906367282, -37.67419824194222, -37.67419824194222, -37.67419824194222, -34.463153530841, -33.963153530841, -35.963153530841, -48.32555076142644, -48.32555076142644, -48.32555076142644, -36.44947947008866, -36.44947947008866, -36.94947947008866, -46.914048345207696, -45.41404834520769, -46.914048345207696, -33.632810802797, -32.632810802797, -33.632810802797, -31.70931686299789, -31.70931686299789, -31.20931686299789, -40.86291069185767, -39.86291069185767, -40.36291069185767, -33.78313138585713, -33.78313138585713, -33.28313138585713, -33.36194462954928, -33.36194462954928, -31.861944629549278, -28.364630150668766, -28.364630150668766, -28.364630150668766, -29.24887646959463, -29.24887646959463, -29.24887646959463, -33.88379854692929, -33.88379854692929, -33.88379854692929, -34.78060863568791, -31.780608635687912, -34.78060863568791, -39.19103739552383, -37.69103739552383, -39.19103739552383, -35.545720306519975, -33.545720306519975, -35.545720306519975, -34.46571154439036, -34.46571154439036, -32.96571154439036, -31.552896788368958, -31.552896788368958, -31.552896788368958, -35.07369001328733, -35.07369001328733, -35.07369001328733, -34.02982414016759, -34.02982414016759, -34.02982414016759, -40.41303736184049, -39.41303736184049, -40.41303736184049, -34.516342488590986, -34.516342488590986, -34.516342488590986, -30.347659143795788, -29.347659143795788, -30.347659143795788, -26.786109616474477, -26.786109616474477, -26.786109616474477, -36.16339956321174, -36.16339956321174, -36.16339956321174, -31.567237764710562, -31.567237764710562, -30.567237764710562, -38.056016756521515, -36.556016756521515, -38.056016756521515, -42.861975645723696, -42.861975645723696, -42.861975645723696, -45.69805479288597, -45.69805479288597, -45.69805479288597, -36.22308147010648, -36.22308147010648, -36.22308147010648, -39.66071058165769, -39.66071058165769, -39.66071058165769, -37.545202098589414, -37.545202098589414, -37.545202098589414, -31.167025821814025, -30.667025821814025, -32.16702582181402, -33.5008290779164, -34.5008290779164, -34.5008290779164, -37.10563686857381, -37.10563686857381, -37.10563686857381, -32.355122769995525, -32.355122769995525, -32.355122769995525, -29.18739109739505, -29.18739109739505, -29.18739109739505, -51.84898010938455, -51.84898010938455, -51.84898010938455, -36.69281853914908, -36.69281853914908, -35.69281853914908, -33.55216313077849, -32.55216313077849, -33.55216313077849, -30.87430388025176, -30.37430388025176, -29.87430388025176, -32.651445619341736, -31.651445619341736, -32.651445619341736, -41.56489450543577, -43.06489450543577, -43.06489450543577, -35.614571238908155, -35.614571238908155, -35.614571238908155, -30.621436499752676, -30.621436499752676, -30.621436499752676, -26.531842371779014, -28.031842371779014, -28.031842371779014, -25.927886870804503, -25.927886870804503, -25.927886870804503, -28.43573869560972, -28.43573869560972, -28.43573869560972, -35.88264243773641, -35.88264243773641, -34.88264243773641, -33.92300484334917, -32.923004843349176, -33.92300484334917, -31.70427620684613, -31.70427620684613, -29.70427620684613, -26.187695225180896, -26.187695225180896, -26.187695225180896, -26.129580079083595, -25.129580079083595, -25.129580079083595, -32.69183098928078, -33.69183098928078, -33.69183098928078, -35.24060899226259, -34.24060899226258, -35.24060899226259, -37.01581774896891, -37.01581774896891, -36.01581774896891, -37.66250791014231, -39.16250791014231, -38.16250791014231, -27.435377936589788, -26.935377936589788, -26.935377936589788, -37.99580337014976, -37.99580337014976, -37.99580337014976, -25.034905768376973, -25.034905768376973, -24.534905768376973, -45.58061096348201, -45.58061096348201, -45.58061096348201, -31.813412172758056, -31.813412172758056, -31.813412172758056, -46.83553680817808, -45.83553680817808, -45.83553680817808, -32.25618188309972, -32.25618188309972, -31.756181883099725, -32.83437512206144, -33.83437512206144, -31.834375122061438, -46.753056289397364, -46.753056289397364, -46.753056289397364, -30.687408485703756, -31.687408485703756, -31.687408485703756, -31.56712021702287, -31.06712021702287, -31.56712021702287, -29.09027983509163, -28.09027983509163, -29.09027983509163, -33.95591575899454, -33.95591575899454, -33.95591575899454, -27.375762964247077, -26.375762964247077, -27.375762964247077, -39.504192728170935, -39.504192728170935, -38.504192728170935, -43.16265657823285, -42.16265657823284, -43.66265657823284, -32.94427917513587, -32.94427917513587, -31.944279175135865, -31.668502735603447, -31.168502735603454, -32.168502735603454, -31.45751126909957, -31.95751126909957, -31.95751126909957, -26.99996741725092, -28.99996741725092, -28.99996741725092, -34.152778805472316, -33.652778805472316, -34.652778805472316, -34.69667071078254, -34.69667071078254, -34.69667071078254, -44.364598107374874, -43.864598107374874, -44.864598107374874, -34.68142257784418, -32.181422577844174, -34.68142257784418, -28.85185296163104, -28.85185296163104, -27.35185296163104, -37.98559134859717, -36.48559134859717, -37.98559134859717, -33.01912774021355, -33.01912774021355, -33.01912774021355, -31.835958188846483, -32.33595818884648, -32.33595818884648, -30.975548655684626, -32.47554865568463, -32.47554865568463, -42.90349721813425, -43.40349721813425, -43.40349721813425, -40.5010955759485, -40.5010955759485, -40.5010955759485, -42.28196576027541, -43.78196576027541, -43.78196576027541, -28.00973075103735, -29.509730751037353, -29.509730751037353, -30.726401352488708, -30.726401352488708, -30.726401352488708, -37.956885004395765, -37.956885004395765, -37.956885004395765, -28.74483927282457, -27.744839272824567, -28.74483927282457, -46.41399425162784, -48.41399425162784, -49.91399425162784, -33.080402093041556, -33.080402093041556, -33.080402093041556, -53.448970882663545, -52.448970882663545, -53.948970882663545, -42.366333594967834, -42.866333594967834, -39.86633359496783, -31.505260190884968, -31.505260190884968, -30.505260190884965, -27.843432211605105, -27.843432211605105, -27.843432211605105, -33.34876518415451, -33.34876518415451, -33.34876518415451, -39.791618460953906, -39.791618460953906, -39.791618460953906, -32.64600701661521, -32.64600701661521, -32.64600701661521, -35.3886577188779, -34.8886577188779, -35.3886577188779, -38.62935365445761, -38.62935365445761, -37.1293536544576, -33.77060689498929, -35.2706068949893, -35.2706068949893, -38.00769088997101, -36.50769088997101, -38.00769088997101, -39.301017143133755, -38.301017143133755, -39.301017143133755, -41.27086419990348, -42.77086419990348, -41.77086419990348, -40.93867127879032, -42.43867127879032, -41.93867127879032, -36.75521736291923, -36.75521736291923, -36.75521736291923, -23.748228468692606, -23.248228468692606, -23.748228468692606, -34.35536693940453, -34.35536693940453, -34.35536693940453, -34.75043473936207, -34.75043473936207, -34.75043473936207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30977795804584923, "mean_inference_ms": 1.2500933770414724, "mean_action_processing_ms": 0.06968944345494353, "mean_env_wait_ms": 0.575043576995361, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 25600, "timesteps_this_iter": 0, "agent_timesteps_total": 76800, "timers": {"sample_time_ms": 1449.883, "sample_throughput": 2207.075, "load_time_ms": 0.16, "load_throughput": 20051201.195, "learn_time_ms": 780.737, "learn_throughput": 4098.693, "update_time_ms": 1.555}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005000000000000001, "total_loss": 333.97230224609376, "policy_loss": -0.001389102168940326, "vf_loss": 333.9890838623047, "vf_explained_var": -0.05833858251571655, "kl": 0.0014159120171917006, "entropy": 1.540431308746338, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 25600, "num_agent_steps_sampled": 76800, "num_steps_trained": 25600, "num_agent_steps_trained": 76800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1020, "training_iteration": 8, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-48", "timestamp": 1718736348, "time_this_iter_s": 1.4823191165924072, "time_total_s": 12.262178421020508, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219b670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 12.262178421020508, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.2, "ram_util_percent": 30.2}}
{"episode_reward_max": -64.25480446784607, "episode_reward_min": -147.7000448091614, "episode_reward_mean": -102.97623861888636, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -49.90001493638713}, "policy_reward_max": {"shared_policy": -20.751601489282027}, "policy_reward_mean": {"shared_policy": -34.32541287296212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.54561542467764, -98.98046477572763, -84.38453371719964, -115.4567033066446, -93.79332912236401, -112.24238476899737, -109.83661480054299, -100.79466172259559, -100.73752107013591, -82.16141462591658, -86.78047632613952, -82.5752822583853, -118.1114734898812, -132.60665855386586, -103.6505776318355, -84.04198042843427, -140.52376084151078, -109.3458356932526, -112.13814970276306, -100.91278554692052, -105.8508538444457, -78.24269612031378, -132.56909365922579, -147.7000448091614, -69.50082185330012, -136.47855689377127, -94.80935502866537, -75.8509998637792, -105.29347797601359, -128.32385222648696, -98.28825065993779, -120.57480042242506, -135.12594128279764, -114.12279433695318, -120.650847343643, -116.4377894848793, -102.91336731756797, -91.97230359842722, -90.93175661179735, -112.54115268070585, -88.34096126042462, -75.55535759026647, -123.32792207348163, -77.3028483629665, -142.6383823603611, -121.04551974781597, -97.22078377526329, -117.97080682448868, -94.96378433691643, -88.03864785713522, -129.2584656914212, -93.09602072694292, -107.5650683689622, -93.74052732307202, -81.84924682180196, -90.79519882965585, -113.50549472454809, -86.01295377634915, -109.17535137497578, -91.14737743028971, -110.27645365962904, -110.69656275291622, -95.05278619757622, -137.3356463029534, -96.14547589139956, -83.57284714588579, -93.90574827482071, -96.10786926915222, -99.13250901298747, -88.2367088527309, -105.50451681734545, -115.43819725376062, -134.60232099892664, -104.249519292612, -95.13904233233869, -93.3102256248887, -140.78968777714644, -79.6220026754684, -64.25480446784607, -101.67282522365721, -87.83141769896513, -88.31517227871593, -105.31067948628197, -96.60591808189716, -81.59462464457867, -86.67133920319877, -118.18773457555307, -100.10580994457418, -98.2854054677281, -113.23556818985381, -111.97969791782388, -106.34207685058688, -104.11215314348263, -87.55968352694414, -93.8332147649854, -75.82597589634234, -112.94243468211022, -99.54445481303502, -129.64786669109256, -98.4293974990561, -77.83489661954123, -102.19063968563951, -109.98317429023973, -90.41297728120566, -81.12837342164835, -124.6305564357937, -137.31023524885964, -87.93742552062265, -109.47177143781168, -92.7368875095875, -100.32168379107632, -97.03471892636001, -80.2386888035368, -112.79571514959824, -106.10403998831809, -92.85244588950066, -122.1628984008411, -96.92753789772362, -103.77141358361519, -123.0191447695861, -130.96002437759802, -97.17706497353, -97.33968990424233, -103.58018843027676, -109.67764146633495, -109.62618134292951, -93.34888980483832, -79.331851134546, -100.35689734534778, -100.89129276440384], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-34.848538474892564, -34.848538474892564, -34.848538474892564, -32.993488258575866, -32.993488258575866, -32.993488258575866, -28.461511239066557, -27.461511239066557, -28.461511239066557, -38.48556776888152, -38.48556776888152, -38.48556776888152, -31.264443040788, -31.264443040788, -31.264443040788, -37.74746158966577, -37.74746158966577, -36.74746158966577, -36.612204933514334, -36.612204933514334, -36.612204933514334, -32.931553907531864, -33.93155390753187, -33.93155390753187, -33.57917369004531, -33.07917369004531, -34.07917369004531, -26.553804875305506, -28.053804875305506, -27.553804875305506, -28.760158775379825, -28.260158775379825, -29.760158775379825, -26.858427419461773, -28.358427419461773, -27.35842741946177, -39.37049116329373, -39.37049116329373, -39.37049116329373, -44.20221951795526, -44.20221951795526, -44.20221951795526, -34.21685921061184, -34.21685921061184, -35.21685921061184, -28.01399347614474, -28.01399347614474, -28.01399347614474, -46.17458694717027, -47.674586947170276, -46.67458694717027, -36.448611897750865, -36.448611897750865, -36.448611897750865, -37.37938323425434, -37.87938323425433, -36.87938323425434, -34.30426184897351, -33.30426184897351, -33.30426184897351, -35.78361794814855, -34.78361794814855, -35.28361794814855, -25.414232040104597, -26.414232040104597, -26.414232040104597, -42.85636455307525, -44.85636455307525, -44.85636455307525, -49.90001493638713, -49.90001493638713, -47.90001493638713, -23.1669406177667, -23.1669406177667, -23.1669406177667, -44.8261856312571, -45.8261856312571, -45.8261856312571, -31.93645167622181, -30.93645167622181, -31.93645167622181, -25.283666621259705, -25.283666621259705, -25.283666621259705, -35.264492658671195, -35.264492658671195, -34.764492658671195, -43.607950742162366, -41.107950742162366, -43.607950742162366, -33.429416886645924, -32.42941688664592, -32.42941688664592, -40.191600140808326, -40.191600140808326, -40.191600140808326, -45.37531376093254, -44.37531376093254, -45.37531376093254, -38.37426477898437, -38.37426477898437, -37.37426477898437, -39.55028244788101, -40.55028244788101, -40.55028244788101, -38.81259649495975, -38.81259649495975, -38.81259649495975, -33.30445577252266, -34.80445577252266, -34.80445577252266, -30.99076786614241, -30.99076786614241, -29.99076786614241, -30.477252203932444, -29.977252203932444, -30.477252203932444, -37.513717560235264, -37.513717560235264, -37.513717560235264, -29.44698708680821, -29.44698708680821, -29.44698708680821, -25.185119196755466, -24.685119196755466, -25.685119196755466, -41.10930735782719, -41.10930735782719, -41.10930735782719, -26.4342827876555, -24.9342827876555, -25.9342827876555, -48.0461274534537, -47.04612745345369, -47.54612745345369, -39.681839915938674, -40.681839915938674, -40.681839915938674, -32.573594591754436, -32.573594591754436, -32.073594591754436, -39.32360227482957, -39.32360227482957, -39.32360227482957, -31.65459477897213, -31.65459477897213, -31.65459477897213, -29.679549285711733, -28.679549285711733, -29.679549285711733, -43.25282189714042, -43.25282189714042, -42.75282189714042, -30.69867357564764, -31.19867357564764, -31.19867357564764, -35.85502278965407, -35.85502278965407, -35.85502278965407, -31.246842441024004, -31.246842441024004, -31.246842441024004, -26.283082273933974, -27.783082273933974, -27.783082273933974, -30.265066276551938, -30.265066276551938, -30.265066276551938, -37.83516490818268, -37.83516490818268, -37.83516490818268, -28.004317925449712, -29.004317925449712, -29.004317925449712, -36.391783791658575, -36.391783791658575, -36.391783791658575, -30.382459143429898, -30.382459143429898, -30.382459143429898, -36.75881788654299, -36.75881788654299, -36.75881788654299, -37.232187584305414, -36.232187584305414, -37.232187584305414, -31.68426206585872, -31.68426206585872, -31.68426206585872, -45.7785487676511, -45.7785487676511, -45.7785487676511, -31.381825297133148, -32.38182529713315, -32.38182529713315, -27.85761571529525, -27.85761571529525, -27.85761571529525, -30.96858275827356, -31.468582758273566, -31.468582758273566, -32.035956423050756, -32.035956423050756, -32.035956423050756, -33.04416967099583, -33.04416967099583, -33.04416967099583, -29.41223628424363, -29.41223628424363, -29.41223628424363, -35.501505605781816, -35.501505605781816, -34.50150560578181, -38.47939908458687, -38.47939908458687, -38.47939908458687, -44.86744033297555, -44.86744033297555, -44.86744033297555, -34.083173097537326, -35.083173097537326, -35.083173097537326, -31.879680777446247, -31.879680777446247, -31.379680777446247, -31.103408541629545, -31.103408541629545, -31.103408541629545, -46.929895925715506, -46.929895925715506, -46.929895925715506, -27.540667558489467, -25.540667558489467, -26.540667558489467, -20.751601489282027, -21.75160148928203, -21.75160148928203, -33.89094174121906, -33.89094174121906, -33.89094174121906, -29.277139232988368, -29.277139232988368, -29.277139232988368, -28.77172409290532, -29.77172409290532, -29.77172409290532, -35.27022649542731, -35.27022649542731, -34.77022649542731, -32.201972693965715, -32.201972693965715, -32.201972693965715, -27.198208214859562, -27.198208214859562, -27.198208214859562, -29.890446401066228, -27.390446401066228, -29.390446401066228, -39.39591152518434, -39.39591152518434, -39.39591152518434, -34.03526998152473, -33.03526998152473, -33.03526998152473, -32.76180182257606, -32.76180182257606, -32.76180182257606, -37.745189396617924, -37.745189396617924, -37.745189396617924, -37.49323263927465, -36.99323263927465, -37.49323263927465, -35.44735895019565, -35.44735895019565, -35.44735895019565, -35.03738438116087, -35.03738438116087, -34.03738438116087, -28.519894508981388, -29.519894508981388, -29.519894508981388, -31.27773825499513, -31.27773825499513, -31.27773825499513, -25.775325298780796, -24.275325298780796, -25.775325298780796, -37.314144894036694, -37.814144894036694, -37.814144894036694, -33.01481827101169, -33.51481827101169, -33.01481827101169, -43.2159555636975, -43.2159555636975, -43.2159555636975, -32.47646583301869, -32.97646583301869, -32.97646583301869, -25.944965539847093, -25.944965539847093, -25.944965539847093, -34.063546561879825, -34.063546561879825, -34.063546561879825, -36.9943914300799, -35.9943914300799, -36.9943914300799, -29.47099242706855, -30.47099242706855, -30.47099242706855, -27.042791140549426, -27.042791140549426, -27.042791140549426, -40.54351881193123, -42.04351881193122, -42.04351881193122, -45.27007841628657, -45.77007841628657, -46.27007841628657, -29.312475173540864, -29.312475173540864, -29.312475173540864, -36.49059047927053, -36.49059047927053, -36.49059047927053, -31.245629169862532, -30.245629169862532, -31.245629169862532, -33.440561263692096, -33.440561263692096, -33.440561263692096, -32.34490630878668, -32.34490630878668, -32.34490630878668, -26.746229601178918, -26.746229601178918, -26.746229601178918, -37.931905049866074, -37.931905049866074, -36.931905049866074, -34.70134666277268, -35.70134666277268, -35.70134666277268, -31.117481963166885, -31.117481963166885, -30.617481963166885, -40.72096613361369, -40.72096613361369, -40.72096613361369, -32.64251263257456, -32.64251263257456, -31.642512632574558, -34.25713786120506, -34.25713786120506, -35.25713786120507, -41.00638158986206, -41.00638158986206, -41.00638158986206, -43.65334145919934, -43.65334145919934, -43.65334145919934, -32.39235499117665, -32.39235499117665, -32.39235499117665, -32.446563301414116, -32.446563301414116, -32.446563301414116, -34.52672947675893, -34.52672947675893, -34.52672947675893, -36.22588048877829, -36.72588048877829, -36.72588048877829, -36.70872711430983, -36.20872711430983, -36.70872711430983, -31.116296601612746, -31.116296601612746, -31.116296601612746, -26.44395037818201, -26.44395037818201, -26.44395037818201, -33.45229911511591, -33.45229911511591, -33.45229911511591, -33.63043092146795, -33.63043092146795, -33.63043092146795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31268936774251527, "mean_inference_ms": 1.2617983200698213, "mean_action_processing_ms": 0.07007928905864426, "mean_env_wait_ms": 0.579751593004867, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 28800, "timesteps_this_iter": 0, "agent_timesteps_total": 86400, "timers": {"sample_time_ms": 1465.496, "sample_throughput": 2183.561, "load_time_ms": 0.158, "load_throughput": 20250788.801, "learn_time_ms": 782.792, "learn_throughput": 4087.933, "update_time_ms": 1.526}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005000000000000001, "total_loss": 295.99233093261716, "policy_loss": -0.0025521414755687033, "vf_loss": 296.0102203369141, "vf_explained_var": -0.038494324684143065, "kl": 0.0027801442642285124, "entropy": 1.5361286401748657, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28800, "num_agent_steps_sampled": 86400, "num_steps_trained": 28800, "num_agent_steps_trained": 86400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1150, "training_iteration": 9, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-50", "timestamp": 1718736350, "time_this_iter_s": 1.5949382781982422, "time_total_s": 13.85711669921875, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219bdc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 13.85711669921875, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.8, "ram_util_percent": 30.25}}
{"episode_reward_max": -64.94364086264093, "episode_reward_min": -176.36595511210032, "episode_reward_mean": -101.0994594755415, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -59.45531837070009}, "policy_reward_max": {"shared_policy": -21.647880287546975}, "policy_reward_mean": {"shared_policy": -33.6998198251805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.62177535925471, -110.26230159134663, -131.13766436626452, -93.28242258855691, -104.17433484074392, -88.47379440083667, -98.8122741586777, -88.4653539985897, -73.01550346870994, -97.80148636339342, -94.15284070743459, -113.15040371835902, -113.3710609772775, -120.97980103282528, -110.00542568265925, -97.39378412193997, -92.00028036564856, -110.51952767000591, -80.52601501905288, -97.34715457113873, -98.15819928155877, -90.00308258004041, -91.81947768781404, -112.24931575182377, -119.34160289245034, -114.52194582003607, -87.58013705117163, -86.45926046783883, -107.72047012659854, -84.9948658814622, -97.16892153508101, -76.86556524336103, -91.03998432199631, -68.50298651284962, -120.47640147189654, -110.16443018300996, -118.3398932100629, -176.36595511210032, -83.72953969093659, -87.22820438331061, -87.51442134314738, -109.46202066610708, -115.70157300662503, -119.04407157058981, -124.69949732644064, -90.17404337535336, -99.45591354661725, -115.75740403513944, -104.55842238639053, -69.0355965373797, -90.76132110463627, -122.31109926546986, -94.41633430420266, -94.47565015891738, -100.13994402508699, -83.46634120441935, -104.91234600352563, -90.92934971082562, -92.67683644952324, -109.83666023367357, -100.93099226311024, -82.08031875209258, -105.49225118520488, -101.08245462980905, -123.81916723969617, -80.39865989254022, -75.02138088460508, -103.38584233533749, -128.26870044073493, -89.9818772284015, -103.9677545281652, -132.58885579831673, -111.90608323920219, -116.11536706939967, -87.35876391608682, -91.16536093677567, -122.51920723937178, -115.09806007004046, -111.808843066272, -83.399838963231, -86.21165046423769, -86.96442422545266, -77.7818206033786, -96.68038690445059, -80.0583239129459, -97.28068884895951, -115.60811844440423, -86.23995070885063, -104.763600741744, -83.28094152927882, -109.0102673538322, -84.11735544751785, -114.3129638917646, -109.36204201293917, -133.0592640174272, -74.38658264426321, -88.24175723664621, -140.41865497416975, -104.76819090371221, -98.46353481842458, -117.7938329377902, -64.94364086264093, -103.48247158099048, -97.64114039020303, -74.62497805528947, -120.5745878113155, -138.48431674272751, -93.60205620933831, -99.34526047141594, -87.6450750056788, -111.80477013864629, -72.66073353484089, -105.88866493478903, -114.20147773994061, -113.81079110809657, -121.87919997956598, -95.54038341381448, -123.80824032242059, -102.15721621705171, -95.37339297712296, -90.00215707981728, -107.77919686519708, -84.03831850754638, -95.95318391059095, -85.05008845310284, -124.20403045424516, -95.60865019567292, -78.5144012402766, -142.74111529512166, -119.82376956016418], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-23.207258453084897, -23.207258453084897, -23.207258453084897, -36.754100530448866, -36.754100530448866, -36.754100530448866, -43.3792214554215, -43.8792214554215, -43.8792214554215, -30.760807529518967, -31.260807529518967, -31.260807529518967, -34.72477828024798, -34.72477828024798, -34.72477828024798, -29.49126480027887, -29.49126480027887, -29.49126480027887, -32.937424719559246, -32.937424719559246, -32.937424719559246, -29.821784666196564, -29.821784666196564, -28.821784666196564, -24.338501156236642, -24.338501156236642, -24.338501156236642, -32.60049545446447, -32.60049545446447, -32.60049545446447, -31.384280235811495, -31.384280235811495, -31.384280235811495, -37.71680123945299, -37.71680123945299, -37.71680123945299, -37.7903536590925, -37.7903536590925, -37.7903536590925, -40.32660034427508, -40.32660034427508, -40.32660034427508, -37.168475227553074, -37.168475227553074, -35.668475227553074, -32.797928040646646, -32.297928040646646, -32.297928040646646, -30.33342678854952, -30.83342678854952, -30.83342678854952, -36.8398425566686, -36.8398425566686, -36.8398425566686, -27.00867167301761, -26.50867167301761, -27.00867167301761, -33.115718190379575, -33.115718190379575, -31.11571819037957, -32.386066427186265, -32.886066427186265, -32.886066427186265, -28.667694193346815, -30.66769419334681, -30.66769419334681, -30.60649256260468, -30.60649256260468, -30.60649256260468, -37.41643858394126, -37.41643858394126, -37.41643858394126, -40.11386763081682, -40.11386763081682, -39.11386763081682, -37.507315273345355, -38.507315273345355, -38.507315273345355, -29.193379017057204, -29.193379017057204, -29.193379017057204, -28.15308682261293, -29.15308682261293, -29.15308682261293, -36.24015670886619, -35.74015670886619, -35.74015670886619, -28.498288627154096, -27.998288627154096, -28.498288627154096, -33.222973845027, -32.222973845027, -31.722973845027003, -25.28852174778701, -25.28852174778701, -26.28852174778701, -30.346661440665454, -30.346661440665454, -30.346661440665454, -23.000995504283203, -22.5009955042832, -23.000995504283203, -39.65880049063216, -40.15880049063216, -40.65880049063216, -36.38814339433664, -36.88814339433664, -36.88814339433664, -40.27996440335428, -40.27996440335428, -37.77996440335427, -59.45531837070009, -59.45531837070009, -57.45531837070009, -28.076513230312187, -27.576513230312187, -28.076513230312187, -29.07606812777019, -29.07606812777019, -29.07606812777019, -29.171473781049112, -29.171473781049112, -29.171473781049112, -36.4873402220357, -36.4873402220357, -36.4873402220357, -38.56719100220835, -38.56719100220835, -38.56719100220835, -39.84802385686326, -39.84802385686326, -39.34802385686326, -41.899832442146895, -42.399832442146895, -40.399832442146895, -30.391347791784444, -29.891347791784444, -29.891347791784444, -33.15197118220577, -33.15197118220577, -33.15197118220577, -38.58580134504648, -38.58580134504648, -38.58580134504648, -35.35280746213019, -35.35280746213019, -33.85280746213019, -23.011865512459906, -23.011865512459906, -23.011865512459906, -30.253773701545423, -30.253773701545423, -30.253773701545423, -41.6036997551566, -40.1036997551566, -40.6036997551566, -31.472111434734217, -31.472111434734217, -31.472111434734217, -31.491883386305773, -31.491883386305773, -31.491883386305773, -33.37998134169567, -33.37998134169567, -33.37998134169567, -27.48878040147311, -27.48878040147311, -28.48878040147311, -35.6374486678419, -33.6374486678419, -35.6374486678419, -30.80978323694186, -29.30978323694186, -30.80978323694186, -31.392278816507734, -31.392278816507734, -29.892278816507734, -36.94555341122452, -36.94555341122452, -35.94555341122452, -33.643664087703414, -33.643664087703414, -33.643664087703414, -27.360106250697527, -27.360106250697527, -27.360106250697527, -35.49741706173496, -34.49741706173496, -35.49741706173496, -33.69415154326968, -33.69415154326968, -33.69415154326968, -40.27305574656538, -41.77305574656538, -41.77305574656538, -26.966219964180073, -26.466219964180073, -26.966219964180073, -25.17379362820171, -25.17379362820171, -24.67379362820171, -34.461947445112486, -34.461947445112486, -34.461947445112486, -42.756233480245, -42.756233480245, -42.756233480245, -30.32729240946714, -30.32729240946714, -29.32729240946714, -34.82258484272174, -34.32258484272174, -34.82258484272174, -43.529618599438905, -44.5296185994389, -44.5296185994389, -37.30202774640073, -37.30202774640073, -37.30202774640073, -38.3717890231332, -38.8717890231332, -38.8717890231332, -29.119587972028924, -29.119587972028924, -29.119587972028924, -30.388453645591902, -30.388453645591902, -30.388453645591902, -40.83973574645725, -40.83973574645725, -40.83973574645725, -38.36602002334678, -38.36602002334678, -38.36602002334678, -36.936281022090675, -37.436281022090675, -37.436281022090675, -27.799946321077016, -27.799946321077016, -27.799946321077016, -28.73721682141257, -28.73721682141257, -28.73721682141257, -29.654808075150875, -27.654808075150875, -29.654808075150875, -25.927273534459538, -26.427273534459538, -25.427273534459538, -32.22679563481687, -32.22679563481687, -32.22679563481687, -25.852774637648615, -26.352774637648615, -27.852774637648615, -32.42689628298651, -32.42689628298651, -32.42689628298651, -38.53603948146809, -38.53603948146809, -38.53603948146809, -28.746650236283546, -28.746650236283546, -28.746650236283546, -34.921200247248024, -34.921200247248024, -34.921200247248024, -27.76031384309294, -27.76031384309294, -27.76031384309294, -36.33675578461075, -36.33675578461075, -36.33675578461075, -26.3724518158393, -28.8724518158393, -28.8724518158393, -38.10432129725484, -38.10432129725484, -38.10432129725484, -36.12068067097972, -36.62068067097972, -36.62068067097972, -44.353088005809056, -44.353088005809056, -44.353088005809056, -24.79552754808776, -24.79552754808776, -24.79552754808776, -29.747252412215396, -29.247252412215396, -29.247252412215396, -46.80621832472323, -46.80621832472323, -46.80621832472323, -34.92273030123739, -34.92273030123739, -34.92273030123739, -32.987844939474854, -32.987844939474854, -32.487844939474854, -39.59794431259674, -38.597944312596745, -39.59794431259674, -21.647880287546975, -21.647880287546975, -21.647880287546975, -34.16082386033013, -34.16082386033013, -35.16082386033013, -32.547046796734364, -32.547046796734364, -32.547046796734364, -25.374992685096498, -25.374992685096498, -23.874992685096498, -39.52486260377181, -40.524862603771815, -40.524862603771815, -46.494772247575845, -46.494772247575845, -45.494772247575845, -31.200685403112765, -31.200685403112765, -31.200685403112765, -33.615086823805335, -33.115086823805335, -32.615086823805335, -28.548358335226276, -29.54835833522627, -29.54835833522627, -37.26825671288208, -37.26825671288208, -37.26825671288208, -24.220244511613647, -24.220244511613647, -24.220244511613647, -35.62955497826303, -35.62955497826303, -34.62955497826303, -38.73382591331356, -38.23382591331356, -37.23382591331356, -37.936930369365534, -37.936930369365534, -37.936930369365534, -39.95973332652203, -40.95973332652203, -40.95973332652203, -31.846794471271505, -31.846794471271505, -31.846794471271505, -41.43608010747353, -41.43608010747353, -40.93608010747353, -33.21907207235056, -34.21907207235056, -34.71907207235056, -31.791130992374324, -31.791130992374324, -31.791130992374324, -30.000719026605758, -30.000719026605758, -30.000719026605758, -35.759732288399015, -36.259732288399015, -35.75973228839902, -28.512772835848804, -28.512772835848804, -27.012772835848804, -32.48439463686364, -30.98439463686364, -32.48439463686364, -28.35002948436763, -28.35002948436763, -28.35002948436763, -41.56801015141503, -41.56801015141503, -41.068010151415024, -31.869550065224303, -31.869550065224303, -31.869550065224303, -26.50480041342551, -25.50480041342551, -26.50480041342551, -47.58037176504053, -47.58037176504053, -47.58037176504053, -40.10792318672139, -40.10792318672139, -39.60792318672139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31169361339737117, "mean_inference_ms": 1.2610291138696355, "mean_action_processing_ms": 0.0700271267400835, "mean_env_wait_ms": 0.5793245536615906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 1473.439, "sample_throughput": 2171.789, "load_time_ms": 0.156, "load_throughput": 20456901.082, "learn_time_ms": 786.693, "learn_throughput": 4067.661, "update_time_ms": 1.51}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 288.8644195556641, "policy_loss": -0.0036651089269433613, "vf_loss": 288.8833343505859, "vf_explained_var": -0.058386707305908205, "kl": 0.0056500945488067835, "entropy": 1.5259348273277282, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 96000, "num_steps_trained": 32000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1280, "training_iteration": 10, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-51", "timestamp": 1718736351, "time_this_iter_s": 1.5517489910125732, "time_total_s": 15.408865690231323, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 15.408865690231323, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.266666666666662, "ram_util_percent": 30.3}}
{"episode_reward_max": -72.21164334567146, "episode_reward_min": -150.37880234031417, "episode_reward_mean": -101.07954855150405, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -50.126267446771344}, "policy_reward_max": {"shared_policy": -23.837387035812057}, "policy_reward_mean": {"shared_policy": -33.693182850501344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.20456961484118, -111.53496062490865, -86.98380310301107, -93.4305303492821, -91.0652189998521, -102.14328427207961, -96.25256553597413, -89.39017770301975, -114.70942398424704, -104.6949770569584, -99.91548680726461, -97.73150641488965, -124.73981381703325, -93.40511663599942, -107.8620778725956, -122.9413554351214, -120.4019089246847, -113.42756631891577, -101.15402691926924, -103.65423699783297, -99.11483016470801, -100.53723335844039, -100.93332304930641, -91.0529848377324, -150.37880234031417, -114.2356192811042, -109.79962167077433, -90.86851366988749, -117.1397971313168, -144.0011952672924, -114.82180250514169, -92.97792122961904, -129.28122266081428, -92.37001778690586, -112.48301453435272, -84.060475909427, -73.68088598111973, -121.5586395489365, -75.36167051886305, -110.38847328299052, -115.96545549212532, -131.72058150284658, -85.76393148833633, -99.6423314028809, -113.20421639209675, -97.47454571032587, -96.78480526647418, -97.89891206032709, -111.46007339352006, -116.56092973853255, -106.60365286938324, -94.9266572523394, -100.49222698110992, -72.21164334567146, -107.18905382272206, -82.08949971845867, -97.13154580981288, -88.29946687223928, -88.00155210045821, -77.56640346703551, -99.1387450436403, -84.60853035823556, -90.15926011937378, -106.41076045573331, -99.07252520804605, -90.10824210126681, -105.18124502141153, -107.30469554059867, -73.51216110743616, -106.99864825566937, -88.23518591380297, -118.23140090163109, -82.74070479045695, -95.68209003323602, -86.45375226921173, -110.53991638285132, -100.47480819683642, -82.5146667706184, -89.30063502153783, -133.28269412143976, -84.0687368327463, -75.8478750240341, -123.19015154599522, -96.40192706561008, -93.42867153469666, -91.06626518814619, -103.46043805521253, -74.29132635786746, -94.80408398278608, -88.99483580201705, -106.9737718757861, -118.20880726140349, -82.96485181419496, -77.73750046056938, -114.48890682759469, -96.60296220042827, -107.85645728371884, -104.40617611019289, -87.68324571210454, -111.82986266696562, -105.2656404296491, -95.79322463541457, -97.16996765409391, -134.06073123247407, -109.00069374396102, -77.23025996910648, -73.9373191988278, -112.27450872020663, -77.24476080810561, -107.79654702148541, -101.3872171594609, -128.26699976214158, -120.06252224240733, -98.41173794533026, -122.82056065999541, -109.56920584810402, -93.4721745593159, -95.64254884846687, -107.64293441786968, -107.56261330543805], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-29.734856538280376, -29.734856538280376, -29.734856538280376, -37.34498687496955, -37.34498687496955, -36.84498687496955, -29.161267701003684, -28.661267701003684, -29.161267701003684, -31.31017678309404, -31.31017678309404, -30.81017678309404, -30.52173966661735, -30.02173966661735, -30.52173966661735, -34.04776142402655, -34.04776142402655, -34.04776142402655, -32.08418851199135, -32.08418851199135, -32.08418851199135, -29.963392567673257, -29.463392567673257, -29.963392567673257, -38.236474661415684, -38.236474661415684, -38.236474661415684, -34.73165901898613, -35.23165901898613, -34.73165901898612, -33.305162269088214, -33.305162269088214, -33.305162269088214, -32.5771688049632, -32.5771688049632, -32.5771688049632, -41.91327127234443, -41.91327127234443, -40.913271272344424, -31.1350388786665, -31.1350388786665, -31.1350388786665, -36.45402595753187, -34.95402595753187, -36.45402595753187, -39.64711847837382, -41.64711847837382, -41.64711847837382, -40.633969641561556, -39.633969641561556, -40.133969641561556, -37.14252210630523, -38.14252210630523, -38.14252210630523, -34.05134230642309, -34.05134230642309, -33.05134230642309, -35.21807899927766, -34.21807899927766, -34.21807899927766, -33.03827672156934, -33.03827672156934, -33.03827672156934, -32.845744452813484, -33.845744452813484, -33.845744452813484, -33.644441016435444, -33.644441016435444, -33.644441016435444, -30.350994945910806, -30.350994945910806, -30.350994945910806, -50.126267446771344, -50.126267446771344, -50.126267446771344, -36.74520642703475, -38.745206427034745, -38.745206427034745, -37.0998738902581, -37.0998738902581, -35.5998738902581, -30.289504556629137, -30.289504556629137, -30.289504556629137, -39.37993237710561, -40.37993237710561, -37.379932377105604, -48.00039842243082, -48.00039842243082, -48.00039842243082, -38.94060083504722, -38.94060083504722, -36.94060083504721, -30.99264040987303, -30.99264040987303, -30.99264040987303, -42.76040755360474, -43.26040755360474, -43.26040755360474, -30.790005928968625, -30.790005928968625, -30.790005928968625, -37.49433817811755, -37.49433817811755, -37.49433817811755, -27.02015863647568, -28.52015863647568, -28.52015863647568, -24.72696199370659, -24.72696199370659, -24.22696199370659, -40.51954651631218, -40.51954651631218, -40.51954651631218, -25.120556839621006, -25.120556839621006, -25.120556839621006, -36.79615776099684, -36.79615776099684, -36.79615776099684, -38.65515183070845, -38.65515183070845, -38.65515183070845, -43.24019383428224, -44.24019383428224, -44.24019383428224, -28.587977162778785, -28.587977162778785, -28.587977162778785, -33.547443800960316, -33.547443800960316, -32.54744380096031, -37.7347387973656, -37.7347387973656, -37.7347387973656, -32.658181903441964, -32.658181903441964, -32.158181903441964, -32.76160175549138, -32.26160175549138, -31.76160175549138, -32.96630402010902, -32.96630402010902, -31.96630402010902, -37.15335779784003, -37.15335779784003, -37.15335779784003, -38.853643246177484, -38.853643246177484, -38.853643246177484, -35.534550956461054, -35.534550956461054, -35.534550956461054, -31.975552417446487, -31.975552417446487, -30.975552417446487, -33.497408993703324, -33.497408993703324, -33.497408993703324, -24.070547781890497, -24.070547781890497, -24.070547781890497, -35.89635127424069, -35.89635127424069, -35.3963512742407, -27.363166572819566, -27.363166572819566, -27.363166572819566, -32.377181936604295, -32.377181936604295, -32.377181936604295, -29.433155624079777, -29.433155624079777, -29.433155624079777, -29.500517366819423, -30.500517366819423, -28.000517366819423, -26.355467822345158, -26.355467822345158, -24.855467822345158, -33.21291501454679, -33.21291501454679, -32.71291501454679, -27.369510119411846, -28.369510119411846, -28.869510119411846, -30.386420039791265, -30.886420039791265, -28.886420039791265, -35.80358681857778, -35.80358681857778, -34.80358681857778, -33.024175069348686, -33.024175069348686, -33.024175069348686, -29.702747367088946, -30.202747367088946, -30.202747367088946, -35.060415007137166, -35.060415007137166, -35.060415007137166, -35.10156518019956, -36.10156518019956, -36.10156518019956, -24.837387035812057, -23.837387035812057, -24.837387035812057, -35.999549418556455, -34.99954941855645, -35.999549418556455, -29.41172863793435, -29.41172863793435, -29.41172863793435, -39.41046696721038, -39.41046696721038, -39.41046696721038, -27.580234930152344, -27.580234930152344, -27.580234930152344, -32.22736334441204, -32.22736334441204, -31.227363344412037, -29.317917423070575, -27.817917423070572, -29.317917423070575, -36.84663879428375, -36.84663879428375, -36.84663879428375, -32.82493606561215, -34.32493606561215, -33.32493606561215, -27.838222256872804, -27.838222256872804, -26.838222256872804, -30.600211673845973, -28.10021167384597, -30.600211673845973, -45.09423137381326, -45.09423137381326, -43.09423137381326, -28.52291227758209, -27.02291227758209, -28.52291227758209, -25.44929167467803, -25.44929167467803, -24.94929167467803, -39.730050515331754, -41.730050515331754, -41.730050515331754, -32.133975688536694, -32.133975688536694, -32.133975688536694, -31.14289051156556, -31.14289051156556, -31.14289051156556, -30.35542172938205, -30.35542172938205, -30.35542172938205, -34.486812685070824, -34.486812685070824, -34.486812685070824, -24.43044211928915, -24.430442119289154, -25.430442119289154, -31.601361327595374, -31.601361327595374, -31.601361327595374, -30.331611934005704, -29.331611934005704, -29.331611934005704, -36.157923958595354, -36.157923958595354, -34.657923958595354, -39.40293575380113, -39.40293575380113, -39.40293575380113, -27.654950604731663, -27.654950604731663, -27.654950604731663, -25.57916682018978, -26.07916682018978, -26.07916682018978, -38.16296894253153, -38.16296894253153, -38.16296894253153, -31.367654066809422, -32.36765406680942, -32.86765406680942, -36.2854857612396, -36.2854857612396, -35.285485761239606, -35.13539203673098, -35.13539203673098, -34.13539203673097, -29.22774857070152, -29.22774857070152, -29.22774857070152, -37.27662088898856, -37.27662088898856, -37.27662088898856, -34.42188014321639, -35.92188014321639, -34.92188014321639, -32.43107487847152, -32.43107487847152, -30.931074878471517, -32.38998921803133, -32.38998921803133, -32.38998921803133, -44.85357707749134, -44.85357707749134, -44.353577077491344, -35.00023124798704, -37.50023124798703, -36.50023124798703, -25.743419989702183, -25.743419989702183, -25.743419989702183, -24.312439732942597, -24.812439732942597, -24.812439732942597, -36.42483624006886, -37.92483624006886, -37.92483624006886, -25.914920269368547, -25.414920269368547, -25.914920269368547, -36.2655156738285, -36.2655156738285, -35.2655156738285, -34.12907238648697, -33.12907238648697, -34.12907238648697, -43.25566658738051, -43.25566658738051, -41.7556665873805, -39.85417408080245, -40.35417408080245, -39.85417408080245, -32.97057931511008, -32.97057931511008, -32.47057931511008, -39.60685355333182, -41.60685355333182, -41.60685355333182, -36.52306861603468, -36.52306861603468, -36.52306861603468, -31.157391519771984, -31.157391519771984, -31.157391519771984, -31.880849616155643, -31.880849616155643, -31.880849616155643, -35.880978139289915, -35.880978139289915, -35.880978139289915, -36.020871101812695, -36.020871101812695, -35.520871101812695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3112677991542583, "mean_inference_ms": 1.260675567349599, "mean_action_processing_ms": 0.06995641924514921, "mean_env_wait_ms": 0.5787165183230106, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 35200, "timesteps_this_iter": 0, "agent_timesteps_total": 105600, "timers": {"sample_time_ms": 1544.574, "sample_throughput": 2071.769, "load_time_ms": 0.143, "load_throughput": 22392013.347, "learn_time_ms": 787.217, "learn_throughput": 4064.953, "update_time_ms": 1.42}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005000000000000001, "total_loss": 259.1774566650391, "policy_loss": -0.0018441874280339609, "vf_loss": 259.19439086914065, "vf_explained_var": -0.07072173357009888, "kl": 0.002145263952944543, "entropy": 1.5100795149803161, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 35200, "num_agent_steps_sampled": 105600, "num_steps_trained": 35200, "num_agent_steps_trained": 105600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1400, "training_iteration": 11, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-53", "timestamp": 1718736353, "time_this_iter_s": 1.555680513381958, "time_total_s": 16.96454620361328, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16.96454620361328, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.849999999999994, "ram_util_percent": 30.3}}
{"episode_reward_max": -67.08499183811497, "episode_reward_min": -138.3937415077361, "episode_reward_mean": -101.70577354117746, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -46.13124716924543}, "policy_reward_max": {"shared_policy": -21.861663946038316}, "policy_reward_mean": {"shared_policy": -33.901924513725824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.25649067409384, -85.37226294831987, -97.78207703477459, -84.25404276291317, -92.90463327594935, -96.88917661138301, -106.14147359591941, -100.62990674940787, -104.06110320136044, -81.2628276906923, -105.26312335075356, -91.64836225589265, -120.6960184610228, -76.11151913097346, -91.20551353153428, -93.05658783794915, -114.28950170776528, -108.91814512129362, -110.47787190402558, -107.12138086680619, -92.99642047023268, -129.07701241011, -95.65073232498082, -81.86558855373711, -107.29441303148923, -109.0979538710595, -85.85540486442119, -88.56408547303339, -89.3368899717701, -101.91429992272789, -71.49587293107871, -100.90068181878364, -129.71014174366806, -98.09819583760971, -110.56068748673441, -75.80046008695288, -96.07271571593833, -108.42512361472704, -82.63494946945455, -116.09166969144628, -101.6129769842062, -105.4109982883097, -134.16036503782576, -125.32196639773738, -109.7958374590955, -96.53992131863197, -108.96334035578106, -93.31434997286011, -109.70938024419549, -94.81857794219918, -95.15819713762926, -87.6136742868386, -85.9753090415914, -99.95845864412969, -86.31864143869474, -101.9886053468781, -97.5826274746712, -75.90349344598451, -111.27798481525188, -111.23227891970943, -67.08499183811497, -121.41887655861201, -117.37754537882562, -98.19544323703464, -76.79803328669765, -95.35071389166293, -93.49530729084698, -99.40729230169964, -108.81361591775413, -126.91422227692428, -132.22121599712648, -128.11525185511223, -86.02252715089011, -99.22898342451673, -137.73448202137854, -116.33723253868688, -96.15426523912821, -105.43924013559963, -103.42791304948535, -80.6324995837787, -86.5303157615692, -91.16428427953703, -97.87518253116725, -116.84993999586159, -113.17788814953622, -86.76935126776289, -105.3570733027996, -129.1988639489789, -127.97676792268976, -89.32307485775428, -79.79898312534861, -79.1294494215751, -104.73634676637147, -79.07257622257734, -102.05286714896737, -115.7533689616509, -100.65081730267649, -97.2565665708239, -98.63376633428477, -89.68455739044093, -112.59411701262508, -79.79862906169515, -117.04289948896574, -96.95923279686747, -125.41403458263581, -119.26236495691015, -79.27283597979131, -75.06367426468553, -79.0487679006832, -95.21578362506179, -109.95482009694145, -93.01694488542333, -138.3937415077361, -124.20865220054193, -103.10145857459486, -96.22149507717424, -87.3628585994355, -87.32101792984349, -109.6145709184655, -127.85659898953702, -92.29409333364052, -100.02568169017161, -123.84402866773567, -87.073194367469, -107.55849769348077, -100.31944058612301, -116.6876912543616, -87.71535063648703, -138.27313839063788, -127.63094849209227], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-43.75216355803128, -42.75216355803128, -43.75216355803128, -28.457420982773296, -28.457420982773296, -28.457420982773296, -33.42735901159153, -30.92735901159152, -33.42735901159153, -28.25134758763773, -28.25134758763773, -27.75134758763773, -31.301544425316457, -30.80154442531645, -30.801544425316457, -31.629725537127655, -32.629725537127655, -32.629725537127655, -35.547157865306446, -35.547157865306446, -35.047157865306446, -33.54330224980263, -33.54330224980263, -33.54330224980263, -34.35370106712014, -34.85370106712014, -34.85370106712014, -27.08760923023078, -27.08760923023078, -27.08760923023078, -35.254374450251206, -35.254374450251206, -34.754374450251206, -30.549454085297537, -30.549454085297537, -30.549454085297537, -40.232006153674256, -40.232006153674256, -40.232006153674256, -25.87050637699115, -24.370506376991145, -25.87050637699115, -30.735171177178096, -29.735171177178096, -30.735171177178096, -30.18552927931637, -31.68552927931637, -31.18552927931637, -38.09650056925511, -38.09650056925511, -38.09650056925511, -36.63938170709785, -36.63938170709785, -35.63938170709785, -36.82595730134186, -36.82595730134186, -36.82595730134186, -35.7071269556021, -35.7071269556021, -35.7071269556021, -31.165473490077567, -31.165473490077567, -30.665473490077567, -43.35900413670334, -42.35900413670334, -43.35900413670334, -32.38357744166027, -30.883577441660275, -32.38357744166027, -26.6218628512457, -27.1218628512457, -28.1218628512457, -35.76480434382974, -35.76480434382974, -35.76480434382974, -36.69931795701987, -35.69931795701988, -36.69931795701987, -29.118468288140395, -29.118468288140395, -27.618468288140395, -29.521361824344467, -29.521361824344467, -29.521361824344467, -30.112296657256703, -29.112296657256703, -30.112296657256703, -33.97143330757597, -33.97143330757597, -33.97143330757597, -23.165290977026235, -24.165290977026235, -24.165290977026235, -33.63356060626119, -33.63356060626119, -33.63356060626119, -43.236713914556006, -43.236713914556006, -43.236713914556006, -33.03273194586989, -33.03273194586989, -32.0327319458699, -37.35356249557814, -37.35356249557814, -35.85356249557813, -24.600153362317617, -25.600153362317617, -25.600153362317617, -32.024238571979424, -32.024238571979424, -32.024238571979424, -35.80837453824232, -36.30837453824232, -36.30837453824232, -27.711649823151507, -27.711649823151507, -27.211649823151507, -38.69722323048208, -38.69722323048208, -38.69722323048208, -35.03765899473539, -33.037658994735395, -33.53765899473539, -35.303666096103235, -34.803666096103235, -35.303666096103235, -45.053455012608566, -45.053455012608566, -44.053455012608566, -42.10732213257912, -42.10732213257912, -41.107322132579114, -36.765279153031834, -36.765279153031834, -36.265279153031834, -32.34664043954398, -31.84664043954398, -32.34664043954398, -35.9877801185937, -36.4877801185937, -36.4877801185937, -31.10478332428672, -31.10478332428672, -31.10478332428672, -35.903126748065134, -36.903126748065134, -36.903126748065134, -30.272859314066398, -31.772859314066398, -32.7728593140664, -31.71939904587642, -32.21939904587642, -31.219399045876422, -29.87122476227954, -29.37122476227954, -28.371224762279546, -28.491769680530492, -27.991769680530492, -29.491769680530492, -32.98615288137657, -33.48615288137657, -33.48615288137657, -28.7728804795649, -28.7728804795649, -28.7728804795649, -33.9962017822927, -33.9962017822927, -33.9962017822927, -31.860875824890403, -32.86087582489041, -32.86087582489041, -24.467831148661492, -25.467831148661492, -25.967831148661492, -37.75932827175062, -37.75932827175062, -35.75932827175062, -36.41075963990317, -37.41075963990316, -37.41075963990316, -22.361663946038316, -22.861663946038316, -21.861663946038316, -40.47295885287066, -40.47295885287066, -40.47295885287066, -40.125848459608555, -38.125848459608555, -39.12584845960856, -32.0651477456782, -32.5651477456782, -33.5651477456782, -25.59934442889919, -25.59934442889919, -25.59934442889919, -31.450237963887652, -31.950237963887652, -31.950237963887652, -31.165102430282335, -31.165102430282335, -31.165102430282335, -33.46909743389989, -32.46909743389989, -33.46909743389989, -36.27120530591803, -36.27120530591803, -36.27120530591803, -42.30474075897475, -42.30474075897475, -42.30474075897475, -44.24040533237551, -44.24040533237551, -43.74040533237551, -42.5384172850374, -42.0384172850374, -43.5384172850374, -28.674175716963383, -28.674175716963383, -28.674175716963383, -33.07632780817224, -33.07632780817224, -33.07632780817224, -45.91149400712616, -45.91149400712616, -45.91149400712616, -39.27907751289563, -38.27907751289563, -38.77907751289563, -32.05142174637607, -32.05142174637607, -32.05142174637607, -35.1464133785332, -35.1464133785332, -35.1464133785332, -34.47597101649514, -34.47597101649514, -34.47597101649514, -26.87749986125956, -26.87749986125956, -26.87749986125956, -28.176771920523066, -29.676771920523066, -28.676771920523066, -30.38809475984567, -30.38809475984567, -30.38809475984567, -32.62506084372242, -32.62506084372242, -32.62506084372242, -38.949979998620535, -38.949979998620535, -38.949979998620535, -37.892629383178736, -37.392629383178736, -37.892629383178736, -28.923117089254298, -28.923117089254298, -28.923117089254298, -35.11902443426655, -35.11902443426655, -35.11902443426655, -43.06628798299298, -43.06628798299298, -43.06628798299298, -43.15892264089659, -41.65892264089659, -43.15892264089659, -30.10769161925141, -29.10769161925141, -30.10769161925141, -27.4329943751162, -25.4329943751162, -26.9329943751162, -26.37648314052504, -26.37648314052504, -26.37648314052504, -34.9121155887905, -34.9121155887905, -34.9121155887905, -26.690858740859117, -27.190858740859117, -25.190858740859117, -34.017622382989124, -34.017622382989124, -34.017622382989124, -38.584456320550295, -39.084456320550295, -38.084456320550295, -33.550272434225484, -33.550272434225484, -33.550272434225484, -32.418855523607974, -32.418855523607974, -32.418855523607974, -32.87792211142827, -32.87792211142827, -32.87792211142827, -30.061519130146984, -30.061519130146984, -29.561519130146984, -37.19803900420837, -37.69803900420837, -37.69803900420837, -26.76620968723173, -26.76620968723173, -26.26620968723173, -39.3476331629886, -39.3476331629886, -38.3476331629886, -32.48641093228915, -32.48641093228915, -31.98641093228915, -41.47134486087861, -41.47134486087862, -42.47134486087861, -39.92078831897004, -39.42078831897004, -39.92078831897004, -26.42427865993044, -26.42427865993044, -26.42427865993044, -25.02122475489517, -25.02122475489517, -25.02122475489517, -26.682922633561073, -25.682922633561073, -26.682922633561073, -32.238594541687284, -31.23859454168728, -31.73859454168728, -36.651606698980494, -36.651606698980494, -36.651606698980494, -31.005648295141103, -31.005648295141103, -31.005648295141103, -46.13124716924543, -46.13124716924543, -46.13124716924543, -41.90288406684734, -40.40288406684734, -41.90288406684734, -34.36715285819829, -34.36715285819829, -34.36715285819829, -32.07383169239142, -32.07383169239142, -32.07383169239142, -29.120952866478486, -29.120952866478486, -29.120952866478486, -29.10700597661449, -29.10700597661449, -29.10700597661449, -35.87152363948853, -36.87152363948853, -36.87152363948853, -42.95219966317898, -41.95219966317898, -42.95219966317898, -30.764697777880176, -30.764697777880176, -30.764697777880176, -33.34189389672387, -33.34189389672387, -33.34189389672387, -41.94800955591183, -39.94800955591183, -41.94800955591183, -29.024398122489647, -29.024398122489647, -29.024398122489647, -36.01949923116024, -36.01949923116024, -35.51949923116024, -35.273146862041, -32.773146862041, -32.273146862041, -38.89589708478719, -38.89589708478719, -38.89589708478719, -29.405116878829006, -28.905116878829006, -29.405116878829006, -46.0910461302126, -46.0910461302126, -46.0910461302126, -42.21031616403077, -42.21031616403078, -43.21031616403077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31440332512531516, "mean_inference_ms": 1.2736574370114326, "mean_action_processing_ms": 0.07053808879181918, "mean_env_wait_ms": 0.5836399791452358, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 38400, "timesteps_this_iter": 0, "agent_timesteps_total": 115200, "timers": {"sample_time_ms": 1543.785, "sample_throughput": 2072.828, "load_time_ms": 0.144, "load_throughput": 22247261.396, "learn_time_ms": 785.552, "learn_throughput": 4073.567, "update_time_ms": 1.429}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005000000000000001, "total_loss": 221.68558654785156, "policy_loss": -0.002583858789778759, "vf_loss": 221.70318450927735, "vf_explained_var": -0.04688088893890381, "kl": 0.004133721847054256, "entropy": 1.5020191192626953, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 38400, "num_agent_steps_sampled": 115200, "num_steps_trained": 38400, "num_agent_steps_trained": 115200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1530, "training_iteration": 12, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-54", "timestamp": 1718736354, "time_this_iter_s": 1.5875539779663086, "time_total_s": 18.55210018157959, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219ba60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 18.55210018157959, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 43.4, "ram_util_percent": 30.35}}
{"episode_reward_max": -63.83301365775586, "episode_reward_min": -142.50019896875386, "episode_reward_mean": -98.1275893914595, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.26870500962916}, "policy_reward_max": {"shared_policy": -20.944337885918618}, "policy_reward_mean": {"shared_policy": -32.709196463819836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.95563983629488, -91.54337630634829, -87.0671686746086, -115.88306795805798, -105.35775961545147, -82.07456575538254, -103.85740633135251, -86.69602775381557, -115.93673270503194, -134.87604163878711, -99.08860355877438, -88.31352258026125, -110.35715261669057, -89.53447129091633, -86.07820140318103, -142.30611502888738, -97.45336889927113, -125.34547985534577, -71.40708964843479, -113.85405199089492, -120.20233496956706, -81.87846157696876, -111.51629964303548, -111.29561187772217, -102.3208196853892, -77.17894841035103, -98.96432746864009, -105.69304791213128, -91.94707902967504, -105.69189222952275, -98.17165928194575, -84.91858584266936, -112.98560744543504, -78.00172984150934, -110.01354836436066, -103.38861841044164, -101.12994689514056, -120.82744324721855, -79.51025166360422, -110.1991466389806, -79.1831908031598, -101.3706083076938, -89.13192159467245, -88.03185655783311, -95.30744988083849, -86.67407614528612, -92.18863090091537, -86.09195952085666, -89.5345074252833, -89.76904345670555, -94.68947225831694, -99.79062876794184, -98.86387798532306, -85.01423153168167, -124.76641291737779, -95.53156224110039, -84.49555624037781, -113.11601856696447, -95.55362491411469, -73.92583777513708, -92.80946347067963, -95.96527375104382, -103.40302798025834, -74.60703197737081, -82.16813621031781, -104.13152940868278, -81.45289937047569, -96.14235340011273, -116.94233292402478, -87.18362328955571, -76.51697075732483, -92.45885671457265, -87.12496935781172, -91.14096801434474, -95.14106106144688, -85.80491711160882, -87.56037518335003, -87.84343268677723, -63.83301365775586, -79.64289432023938, -87.74393347924789, -107.29086120637014, -69.62459020952018, -103.18926152398284, -142.50019896875386, -109.62328161810606, -93.68378400919876, -103.3050978590615, -123.16188743923297, -89.16302737202251, -95.80107343287334, -107.77099593848334, -91.16840308131721, -105.01519155171307, -108.59320491223714, -102.41123357181314, -118.09483640328155, -99.72224948934263, -112.09343028135197, -96.87280933014111, -112.76448634341031, -100.43246934609523, -94.87333486155366, -84.31109935403732, -92.46631274344838, -90.18268775760285, -90.91758581288988, -98.47953109352223, -82.37750925488211, -81.48954439701295, -101.06647235852263, -94.77838233930441, -121.92678154794665, -92.69683293609162, -104.13851364917323, -124.10896758745403, -125.72467599337908, -81.88436019077297, -88.90325520268053, -112.62904292471501, -87.09411622779668, -111.45727505167241, -111.68010256272159, -98.9166999237593, -129.9786440853773, -99.58812130518807, -80.6639484238907, -112.07525387361503, -117.32784462185737, -80.09861511987938], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-28.65187994543161, -28.65187994543161, -29.65187994543161, -29.847792102116085, -31.347792102116085, -30.347792102116085, -29.022389558202857, -29.022389558202857, -29.022389558202857, -39.1276893193527, -38.6276893193527, -38.12768931935269, -34.785919871817136, -35.285919871817136, -35.285919871817136, -27.191521918460843, -27.191521918460843, -27.691521918460843, -34.619135443784174, -34.119135443784174, -35.119135443784174, -28.898675917938515, -28.898675917938515, -28.898675917938515, -38.64557756834398, -38.64557756834398, -38.64557756834398, -44.958680546262364, -44.958680546262364, -44.958680546262364, -33.19620118625813, -33.19620118625813, -32.69620118625813, -29.437840860087064, -29.437840860087064, -29.437840860087064, -36.28571753889684, -37.28571753889684, -36.78571753889684, -29.511490430305432, -30.011490430305432, -30.011490430305432, -28.69273380106035, -28.69273380106035, -28.69273380106035, -46.26870500962916, -47.76870500962916, -48.26870500962916, -32.81778963309038, -32.81778963309038, -31.817789633090378, -41.44849328511526, -41.94849328511526, -41.94849328511526, -24.135696549478247, -23.135696549478244, -24.135696549478247, -38.45135066363168, -36.951350663631665, -38.45135066363168, -40.73411165652235, -40.73411165652235, -38.734111656522344, -26.62615385898959, -27.62615385898959, -27.62615385898959, -37.172099881011846, -37.172099881011846, -37.172099881011846, -36.76520395924073, -36.26520395924074, -38.26520395924073, -34.606939895129734, -33.10693989512973, -34.606939895129734, -26.39298280345033, -25.39298280345033, -25.39298280345033, -33.15477582288003, -32.65477582288003, -33.15477582288003, -37.397682637377095, -33.89768263737709, -34.39768263737709, -30.649026343225007, -30.649026343225007, -30.649026343225007, -35.23063074317425, -35.23063074317425, -35.23063074317425, -32.557219760648586, -33.057219760648586, -32.557219760648586, -28.306195280889806, -28.306195280889806, -28.306195280889806, -37.828535815144996, -35.828535815144996, -39.328535815144996, -26.000576613836444, -26.000576613836444, -26.000576613836444, -36.671182788120234, -36.671182788120234, -36.671182788120234, -34.462872803480536, -34.462872803480536, -34.462872803480536, -34.37664896504684, -34.37664896504684, -32.37664896504684, -40.2758144157395, -40.2758144157395, -40.2758144157395, -26.836750554534753, -26.836750554534753, -25.836750554534753, -36.399715546326874, -36.899715546326874, -36.899715546326874, -26.394396934386595, -26.394396934386595, -26.394396934386595, -33.790202769231286, -33.790202769231286, -33.790202769231286, -29.877307198224166, -29.377307198224166, -29.877307198224166, -29.34395218594437, -29.34395218594437, -29.34395218594437, -31.769149960279474, -31.769149960279474, -31.769149960279474, -29.55802538176205, -29.05802538176205, -28.05802538176205, -30.729543633638457, -30.729543633638457, -30.729543633638457, -29.030653173618898, -28.030653173618898, -29.030653173618898, -29.84483580842778, -29.84483580842778, -29.84483580842778, -29.923014485568526, -29.923014485568526, -29.923014485568526, -31.563157419439, -31.563157419439, -31.563157419439, -33.26354292264728, -33.26354292264728, -33.26354292264728, -33.12129266177434, -33.12129266177434, -32.62129266177434, -27.67141051056055, -28.67141051056055, -28.67141051056055, -42.0888043057926, -40.5888043057926, -42.0888043057926, -32.17718741370013, -31.17718741370013, -32.17718741370013, -28.165185413459287, -28.165185413459287, -28.165185413459287, -37.705339522321495, -37.705339522321495, -37.705339522321495, -31.851208304704898, -31.851208304704898, -31.851208304704898, -25.475279258379032, -22.975279258379032, -25.475279258379032, -30.93648782355988, -30.93648782355988, -30.93648782355988, -31.988424583681294, -31.988424583681294, -31.988424583681294, -34.63434266008613, -34.63434266008613, -34.13434266008614, -24.869010659123614, -24.869010659123614, -24.869010659123614, -27.722712070105914, -27.222712070105914, -27.222712070105917, -34.377176469560915, -34.877176469560915, -34.877176469560915, -27.150966456825223, -27.150966456825223, -27.150966456825223, -32.38078446670426, -32.38078446670426, -31.380784466704267, -39.31411097467491, -38.314110974674925, -39.31411097467491, -29.061207763185244, -29.061207763185244, -29.061207763185244, -25.338990252441597, -25.338990252441604, -25.838990252441604, -30.819618904857535, -30.819618904857535, -30.819618904857535, -29.708323119270595, -28.208323119270595, -29.208323119270595, -30.713656004781594, -29.713656004781594, -30.713656004781594, -31.713687020482276, -31.713687020482276, -31.713687020482276, -28.934972370536272, -27.934972370536272, -28.934972370536272, -29.186791727783337, -29.186791727783337, -29.186791727783337, -29.447810895592397, -28.947810895592397, -29.447810895592397, -21.444337885918618, -21.444337885918618, -20.944337885918618, -26.547631440079783, -26.547631440079783, -26.547631440079783, -29.247977826415966, -29.247977826415966, -29.247977826415966, -35.763620402123365, -35.763620402123365, -35.763620402123365, -23.20819673650674, -23.20819673650674, -23.20819673650674, -34.396420507994286, -34.396420507994286, -34.396420507994286, -47.50006632291796, -47.50006632291796, -47.50006632291796, -36.70776053936869, -36.20776053936869, -36.70776053936869, -31.227928003066275, -31.227928003066275, -31.227928003066275, -34.43503261968716, -34.43503261968716, -34.43503261968716, -41.553962479744314, -41.553962479744314, -40.053962479744314, -29.721009124007498, -29.721009124007498, -29.721009124007498, -31.933691144291114, -31.933691144291114, -31.933691144291114, -35.590331979494415, -36.090331979494415, -36.090331979494415, -30.3894676937724, -30.3894676937724, -30.3894676937724, -35.33839718390434, -34.33839718390434, -35.33839718390434, -35.53106830407907, -36.53106830407907, -36.53106830407907, -34.470411190604395, -34.470411190604395, -33.47041119060439, -38.69827880109382, -39.69827880109382, -39.69827880109382, -34.24074982978086, -31.240749829780864, -34.24074982978086, -38.031143427117314, -38.031143427117314, -36.03114342711731, -32.957603110047025, -31.457603110047025, -32.457603110047025, -37.58816211447011, -37.58816211447011, -37.58816211447011, -33.47748978203175, -33.47748978203175, -33.47748978203175, -31.791111620517874, -31.291111620517874, -31.791111620517874, -28.103699784679115, -28.103699784679115, -28.103699784679115, -30.82210424781615, -30.82210424781615, -30.82210424781615, -29.394229252534263, -30.394229252534263, -30.394229252534263, -30.30586193762998, -30.30586193762998, -30.30586193762998, -33.15984369784074, -33.15984369784074, -32.15984369784074, -27.459169751627357, -27.459169751627357, -27.459169751627357, -27.829848132337666, -27.329848132337666, -26.329848132337666, -34.35549078617422, -34.35549078617422, -32.35549078617422, -31.592794113101483, -31.592794113101483, -31.592794113101483, -40.642260515982194, -41.142260515982194, -40.142260515982194, -30.89894431203054, -30.89894431203054, -30.89894431203054, -34.879504549724416, -34.879504549724416, -34.379504549724416, -41.369655862484684, -41.369655862484684, -41.369655862484684, -41.241558664459696, -42.241558664459696, -42.241558664459696, -27.294786730257677, -27.294786730257677, -27.294786730257677, -29.301085067560198, -29.801085067560194, -29.801085067560194, -37.54301430823833, -37.54301430823833, -37.54301430823833, -28.6980387425989, -29.1980387425989, -29.1980387425989, -37.152425017224125, -37.152425017224125, -37.152425017224125, -37.226700854240526, -37.226700854240526, -37.226700854240526, -33.138899974586444, -32.638899974586444, -33.138899974586444, -43.65954802845909, -42.65954802845909, -43.65954802845909, -33.862707101729335, -32.862707101729335, -32.862707101729335, -26.721316141296885, -26.221316141296885, -27.721316141296885, -37.358417957871666, -37.358417957871666, -37.358417957871666, -39.10928154061912, -39.10928154061912, -39.10928154061912, -26.699538373293134, -26.699538373293134, -26.699538373293134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3148410848000106, "mean_inference_ms": 1.2747604438416864, "mean_action_processing_ms": 0.07057013462381104, "mean_env_wait_ms": 0.584243748285999, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 41600, "timesteps_this_iter": 0, "agent_timesteps_total": 124800, "timers": {"sample_time_ms": 1543.756, "sample_throughput": 2072.866, "load_time_ms": 0.141, "load_throughput": 22679575.532, "learn_time_ms": 784.884, "learn_throughput": 4077.035, "update_time_ms": 1.674}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005000000000000001, "total_loss": 156.98272247314452, "policy_loss": -0.0019134967242521838, "vf_loss": 156.99968872070312, "vf_explained_var": -0.07125985622406006, "kl": 0.004908439941032095, "entropy": 1.5050084590911865, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 41600, "num_agent_steps_sampled": 124800, "num_steps_trained": 41600, "num_agent_steps_trained": 124800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1660, "training_iteration": 13, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-56", "timestamp": 1718736356, "time_this_iter_s": 1.555128574371338, "time_total_s": 20.107228755950928, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20.107228755950928, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 39.5, "ram_util_percent": 30.3}}
{"episode_reward_max": -64.42339942536512, "episode_reward_min": -141.6129473350794, "episode_reward_mean": -98.83338782589904, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -47.2043157783598}, "policy_reward_max": {"shared_policy": -19.80779980845503}, "policy_reward_mean": {"shared_policy": -32.94446260863301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.48364827792118, -114.07702583425544, -78.68326340994518, -108.39814130495891, -84.2954326680104, -92.3884813511659, -82.247873221725, -83.55601505103448, -74.01160793434636, -69.78498375033094, -92.67377225371523, -84.92791276947793, -122.84834036041514, -94.43051225499539, -81.95072774521347, -129.28906978847016, -105.70299662281614, -96.64841391150296, -122.29320983626229, -109.14336144044685, -85.33201593893862, -114.21528327008443, -92.44711413636232, -105.41039826424985, -84.49424538174559, -76.38138265887561, -94.47604557708719, -83.67823796617492, -107.7242362190039, -80.07756862998865, -89.52672012312306, -110.28251442710942, -100.75674832099749, -138.35827388655977, -91.87150334747092, -102.30374193772869, -104.00022927170036, -85.45982292415553, -91.52143786282572, -109.29516892252478, -100.75918446213595, -85.74289186565555, -95.42498583231061, -98.3949399803876, -117.55807765375651, -90.02375240091644, -85.31392690365293, -116.5388483574387, -67.24939857438672, -112.049450544746, -90.64577830091744, -110.64317161060416, -90.3340899122384, -83.63722232419285, -124.80638507423576, -93.04905874440233, -140.412359256333, -114.742577109791, -131.76432615734842, -74.25207139491664, -126.65702256513305, -80.53575812846707, -90.36950372924771, -98.23318874897123, -91.2952931915951, -108.69670863519792, -94.15466129050773, -84.79773863147803, -102.85855601985618, -75.84687958104176, -110.08910993258314, -76.41245736508007, -88.06793689582034, -77.6836881709681, -88.84134491259533, -106.23475052693676, -98.94130207400197, -105.62699885039069, -110.98867481463748, -76.43311041634878, -72.29164433417773, -107.40344426576976, -130.92986444685084, -104.03430108007085, -123.55811763621577, -89.14357096836991, -82.82285554304146, -106.94537545123733, -103.88211860471932, -95.83891970057289, -92.75725440786273, -137.2160488895095, -108.94185479612229, -99.56273013232222, -141.6129473350794, -93.0830696524388, -67.42169856441654, -100.07261108854577, -89.16484752332701, -126.68645725353858, -86.32298525372093, -113.53966575798187, -111.49573663211973, -109.54107823183055, -97.49379246514421, -87.01725502693117, -64.42339942536512, -77.66750175295024, -79.65847462317748, -111.40015665042614, -94.55492100661183, -120.01695137266923, -114.91570169120634, -107.56358326214034, -107.08324585999543, -107.74499820780112, -118.30613146519623, -83.93554898542322, -85.03143774854881, -88.21753535856254, -100.58114147526234, -81.43565436549089, -90.44502401610855, -115.53720843009971, -83.16840098141334, -82.72561567646697, -107.94048062241903, -111.85749870084955, -133.84398858873678, -102.95091226309576], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-36.16121609264041, -35.16121609264041, -36.16121609264041, -39.02567527808517, -39.02567527808517, -36.02567527808516, -26.227754469981726, -26.227754469981726, -26.227754469981726, -35.799380434986276, -36.299380434986276, -36.299380434986276, -28.431810889336802, -27.931810889336802, -27.931810889336802, -30.462827117055298, -30.962827117055298, -30.962827117055298, -26.749291073908346, -26.749291073908346, -28.749291073908346, -27.852005017011482, -27.852005017011482, -27.852005017011482, -24.170535978115442, -24.670535978115442, -25.170535978115442, -22.928327916776986, -23.428327916776986, -23.428327916776986, -30.89125741790507, -30.89125741790507, -30.89125741790507, -28.642637589825974, -27.642637589825974, -28.642637589825974, -41.28278012013835, -41.28278012013835, -40.28278012013835, -31.143504084998458, -31.643504084998458, -31.643504084998458, -27.983575915071164, -26.983575915071164, -26.983575915071164, -43.763023262823374, -41.76302326282337, -43.763023262823374, -35.400998874272055, -35.400998874272055, -34.900998874272055, -31.549471303834306, -32.5494713038343, -32.5494713038343, -40.93106994542076, -41.43106994542076, -39.93106994542076, -36.21445381348229, -36.21445381348229, -36.71445381348229, -28.610671979646224, -28.610671979646224, -28.110671979646224, -37.571761090028104, -38.571761090028104, -38.071761090028104, -31.14903804545411, -31.14903804545411, -30.14903804545411, -35.97013275474997, -33.97013275474997, -35.47013275474997, -28.164748460581865, -28.164748460581865, -28.164748460581865, -25.79379421962521, -24.79379421962521, -25.79379421962521, -32.4920151923624, -31.492015192362402, -30.492015192362402, -28.55941265539165, -26.55941265539165, -28.55941265539165, -35.74141207300129, -35.74141207300129, -36.24141207300129, -27.692522876662863, -25.692522876662863, -26.692522876662863, -30.00890670770767, -30.00890670770767, -29.50890670770767, -37.094171475703135, -37.094171475703135, -36.094171475703135, -33.585582773665834, -33.585582773665834, -33.585582773665834, -45.78609129551992, -46.28609129551992, -46.28609129551992, -30.290501115823652, -30.790501115823652, -30.790501115823652, -34.267913979242905, -34.267913979242905, -33.767913979242905, -34.83340975723347, -34.83340975723347, -34.33340975723347, -28.653274308051838, -28.153274308051838, -28.653274308051838, -30.840479287608584, -30.840479287608584, -29.840479287608584, -36.431722974174946, -36.431722974174946, -36.431722974174946, -31.753061487378673, -35.25306148737867, -33.75306148737867, -28.914297288551854, -27.414297288551854, -29.414297288551854, -31.974995277436882, -31.974995277436882, -31.474995277436882, -30.96497999346251, -33.464979993462514, -33.964979993462514, -39.85269255125216, -39.35269255125216, -38.35269255125217, -28.841250800305467, -30.341250800305467, -30.841250800305467, -27.437975634550984, -28.937975634550984, -28.937975634550984, -36.51294945247955, -40.01294945247955, -40.01294945247955, -22.916466191462227, -22.916466191462227, -21.416466191462227, -38.01648351491531, -38.51648351491531, -35.51648351491531, -31.215259433639176, -28.215259433639176, -31.215259433639176, -36.88105720353472, -36.88105720353472, -36.88105720353472, -30.444696637412804, -30.444696637412804, -29.444696637412804, -27.8790741080643, -27.3790741080643, -28.3790741080643, -42.10212835807859, -41.60212835807858, -41.10212835807859, -30.683019581467452, -31.183019581467452, -31.183019581467452, -46.80411975211098, -46.80411975211098, -46.80411975211098, -39.41419236993035, -38.41419236993035, -36.91419236993035, -44.08810871911614, -44.08810871911614, -43.58810871911614, -25.08402379830556, -25.08402379830556, -24.08402379830556, -42.21900752171104, -42.21900752171104, -42.21900752171104, -27.011919376155696, -26.511919376155696, -27.011919376155696, -29.456501243082585, -30.456501243082585, -30.456501243082585, -32.91106291632373, -32.91106291632373, -32.41106291632373, -30.765097730531725, -30.765097730531725, -29.765097730531725, -35.89890287839931, -36.39890287839931, -36.39890287839931, -30.718220430169247, -31.718220430169247, -31.718220430169247, -28.09924621049268, -28.09924621049268, -28.59924621049268, -33.61951867328538, -34.11951867328538, -35.11951867328537, -25.78229319368059, -25.78229319368059, -24.28229319368059, -36.69636997752771, -36.69636997752771, -36.69636997752771, -25.470819121693353, -25.470819121693353, -25.470819121693353, -29.689312298606783, -28.689312298606783, -29.689312298606783, -25.39456272365601, -26.89456272365601, -25.39456272365601, -29.613781637531776, -29.613781637531776, -29.613781637531776, -36.07825017564559, -34.578250175645586, -35.57825017564559, -32.98043402466733, -32.98043402466733, -32.98043402466733, -35.375666283463566, -34.875666283463566, -35.375666283463566, -37.66289160487913, -36.66289160487913, -36.66289160487913, -25.811036805449586, -24.811036805449586, -25.811036805449586, -23.7638814447259, -24.2638814447259, -24.2638814447259, -35.46781475525658, -35.96781475525658, -35.96781475525658, -43.97662148228361, -43.97662148228361, -42.97662148228361, -34.34476702669029, -34.84476702669029, -34.84476702669029, -40.519372545405275, -41.01937254540527, -42.019372545405275, -30.047856989456655, -30.047856989456655, -29.047856989456655, -27.94095184768051, -27.94095184768051, -26.94095184768051, -35.981791817079106, -35.981791817079106, -34.981791817079106, -34.627372868239775, -34.627372868239775, -34.627372868239775, -31.279639900190947, -32.27963990019095, -32.27963990019095, -30.919084802620905, -30.919084802620905, -30.919084802620905, -45.07201629650316, -46.07201629650316, -46.07201629650316, -36.31395159870744, -36.31395159870744, -36.31395159870744, -33.18757671077409, -33.18757671077409, -33.18757671077409, -47.2043157783598, -47.2043157783598, -47.2043157783598, -31.52768988414626, -31.02768988414626, -30.527689884146252, -23.30723285480551, -22.30723285480551, -21.80723285480551, -33.69087036284858, -33.69087036284858, -32.69087036284858, -30.554949174442317, -28.054949174442317, -30.554949174442317, -44.06215241784618, -39.56215241784617, -43.06215241784618, -28.940995084573625, -28.440995084573625, -28.940995084573625, -38.17988858599395, -38.17988858599395, -37.17988858599395, -37.16524554403993, -38.16524554403993, -36.16524554403993, -37.18035941061016, -35.18035941061016, -37.18035941061016, -32.83126415504809, -31.831264155048093, -32.83126415504809, -29.00575167564371, -29.00575167564371, -29.00575167564371, -22.307799808455027, -22.307799808455027, -19.80779980845503, -25.38916725098342, -25.88916725098342, -26.38916725098342, -26.552824874392492, -26.552824874392492, -26.552824874392492, -37.13338555014206, -37.13338555014206, -37.13338555014206, -31.018307002203954, -31.518307002203954, -32.018307002203954, -40.005650457556406, -39.00565045755641, -41.005650457556406, -38.805233897068774, -38.805233897068774, -37.305233897068774, -35.18786108738012, -35.68786108738013, -36.68786108738013, -36.36108195333181, -35.36108195333181, -35.36108195333181, -35.41499940260037, -35.91499940260037, -36.41499940260037, -39.268710488398725, -39.768710488398725, -39.268710488398725, -28.311849661807734, -28.311849661807734, -27.311849661807734, -28.343812582849605, -28.343812582849605, -28.343812582849605, -29.405845119520862, -29.405845119520862, -29.405845119520862, -34.19371382508744, -32.193713825087436, -34.19371382508744, -26.811884788496965, -27.811884788496965, -26.811884788496965, -31.148341338702846, -29.648341338702846, -29.648341338702846, -38.512402810033244, -38.512402810033244, -38.512402810033244, -28.05613366047109, -28.05613366047109, -27.05613366047109, -27.575205225489, -27.575205225489, -27.575205225489, -35.98016020747302, -35.98016020747302, -35.98016020747302, -36.61916623361652, -38.11916623361652, -37.11916623361652, -44.11466286291227, -45.11466286291227, -44.61466286291227, -35.1503040876986, -32.6503040876986, -35.1503040876986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3131449102849945, "mean_inference_ms": 1.2683219767074394, "mean_action_processing_ms": 0.0701987033070158, "mean_env_wait_ms": 0.5816463167394438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 44800, "timesteps_this_iter": 0, "agent_timesteps_total": 134400, "timers": {"sample_time_ms": 1542.724, "sample_throughput": 2074.253, "load_time_ms": 0.142, "load_throughput": 22568980.663, "learn_time_ms": 786.74, "learn_throughput": 4067.418, "update_time_ms": 1.666}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005000000000000001, "total_loss": 132.77305068969727, "policy_loss": -0.003081326927679129, "vf_loss": 132.79122009277344, "vf_explained_var": -0.12481609582901002, "kl": 0.002822544711972408, "entropy": 1.508463704586029, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 44800, "num_agent_steps_sampled": 134400, "num_steps_trained": 44800, "num_agent_steps_trained": 134400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1790, "training_iteration": 14, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-57", "timestamp": 1718736357, "time_this_iter_s": 1.5003914833068848, "time_total_s": 21.607620239257812, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292526ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 21.607620239257812, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.900000000000002, "ram_util_percent": 30.333333333333332}}
{"episode_reward_max": -66.4500205367091, "episode_reward_min": -173.86706500738183, "episode_reward_mean": -99.65933878448956, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -57.95568833579394}, "policy_reward_max": {"shared_policy": -21.316673512236363}, "policy_reward_mean": {"shared_policy": -33.21977959482985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-91.66837559110515, -87.32753160313985, -97.23030682088368, -108.13827794062753, -73.0595978033811, -110.73850141754251, -76.5234805850322, -67.16633530692968, -132.53988477828665, -128.52328635207874, -80.6232784474231, -87.44166283892689, -78.65652966540732, -78.63535362213813, -143.78504923496465, -82.51447901520298, -109.78553734122987, -90.8735516601138, -98.0900762189596, -120.73350868226127, -93.2622591970041, -124.19802891102469, -103.62321886005327, -71.61992188314487, -74.2660870253508, -86.78234989682244, -101.39239882555523, -72.71669541949684, -116.92577304200893, -97.36605144605382, -116.06594258103965, -87.37113419826035, -78.45376525201341, -151.48096267940755, -116.20099350879444, -127.02588743998311, -119.13810046168864, -98.39369410670137, -94.42824067446688, -111.26477347687751, -117.5242709517993, -66.4500205367091, -117.95549496222742, -90.5848127808787, -121.39301088579309, -88.32161957107485, -113.33116382547473, -86.65068587151886, -96.2174166524715, -92.73258682089508, -88.90628842601997, -78.48218192540244, -107.51247468154372, -108.48530456231258, -101.09161358290496, -120.42230614796063, -96.95504680224181, -98.82939263288365, -94.68645152615494, -137.32073738715226, -104.35738789106098, -92.66346774119964, -81.74870423010033, -109.62624596191607, -83.33740640549506, -110.64194235034051, -101.05654473281439, -76.14521605106758, -106.67507810932729, -89.12931510695454, -90.57118602360381, -95.12451259245245, -82.47025246127178, -109.45176320273838, -76.41525776938926, -115.17759013174155, -121.16611183087434, -97.08590180074623, -81.95010448956181, -74.4055286806043, -84.29189370846667, -88.60783164860715, -104.03537879231831, -98.40065098957973, -105.68018284503891, -93.4881886453454, -101.37773150723818, -118.04310195611087, -101.49495761195867, -103.2246162094214, -103.13521793494559, -98.36831998489622, -112.55564503198467, -120.27503393028344, -95.19021781587901, -100.11055494994841, -106.51990958733683, -117.91155763763479, -122.30560379912949, -87.24796597259329, -121.18339578772299, -105.01716364334929, -78.66500738367239, -76.21168594837685, -111.35900498097848, -106.57212362631307, -83.40830810962893, -75.72359684153297, -115.19571830271788, -94.59542860702749, -173.86706500738183, -91.40848648274171, -101.43551851278653, -96.5439356193754, -76.31489718434385, -136.3835386983295, -76.42757986765785, -88.5568758482872, -70.62491060399678, -143.18306267661382, -115.20609164218281, -85.10708858185572, -117.73644159009397, -85.72088074306491, -126.01315080091811, -85.95921033492354, -78.17874759835455, -84.27191017272973, -93.94446292413963, -89.5509113957662], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-30.556125197035055, -30.556125197035055, -30.556125197035055, -29.109177201046617, -29.109177201046617, -29.109177201046617, -31.076768940294553, -33.07676894029455, -33.07676894029455, -36.04609264687584, -36.04609264687584, -36.04609264687584, -24.353199267793702, -24.353199267793702, -24.353199267793702, -36.57950047251417, -36.07950047251417, -38.07950047251417, -24.5078268616774, -26.0078268616774, -26.0078268616774, -22.0554451023099, -22.5554451023099, -22.5554451023099, -44.179961592762204, -44.179961592762204, -44.179961592762204, -44.00776211735958, -42.00776211735958, -42.50776211735958, -26.207759482474366, -27.207759482474366, -27.207759482474366, -29.480554279642313, -29.480554279642313, -28.480554279642313, -26.385509888469123, -26.385509888469123, -25.885509888469123, -26.211784540712713, -26.211784540712713, -26.211784540712713, -48.095016411654875, -48.095016411654875, -47.595016411654875, -27.83815967173433, -27.83815967173433, -26.83815967173433, -36.59517911374333, -36.59517911374333, -36.59517911374333, -31.957850553371273, -28.457850553371273, -30.457850553371273, -32.86335873965319, -32.86335873965319, -32.36335873965319, -40.74450289408708, -40.24450289408708, -39.74450289408707, -31.254086399001373, -30.754086399001373, -31.254086399001373, -41.39934297034155, -41.39934297034155, -41.39934297034155, -34.54107295335112, -34.54107295335112, -34.54107295335112, -24.039973961048283, -24.539973961048286, -23.039973961048286, -24.922029008450266, -24.922029008450266, -24.422029008450266, -29.260783298940805, -29.260783298940805, -28.260783298940805, -33.79746627518507, -33.79746627518507, -33.79746627518507, -24.23889847316563, -23.73889847316563, -24.73889847316563, -37.308591014002964, -39.808591014002964, -39.808591014002964, -32.45535048201794, -32.95535048201794, -31.955350482017938, -38.855314193679874, -38.355314193679874, -38.855314193679874, -29.123711399420117, -29.123711399420117, -29.123711399420117, -26.317921750671125, -25.817921750671125, -26.317921750671125, -50.493654226469204, -50.493654226469204, -50.493654226469204, -38.73366450293146, -38.73366450293146, -38.73366450293146, -43.17529581332769, -40.67529581332769, -43.17529581332769, -39.71270015389619, -39.71270015389619, -39.71270015389619, -32.79789803556714, -32.79789803556714, -32.79789803556714, -31.47608022482228, -31.47608022482228, -31.47608022482228, -37.421591158959146, -35.42159115895915, -38.42159115895915, -39.17475698393312, -39.17475698393312, -39.17475698393312, -22.816673512236363, -22.316673512236363, -21.316673512236363, -39.98516498740915, -39.98516498740915, -37.98516498740914, -29.19493759362624, -30.69493759362624, -30.69493759362624, -40.79767029526436, -39.79767029526436, -40.79767029526436, -29.27387319035829, -28.77387319035829, -30.27387319035829, -37.77705460849158, -37.77705460849158, -37.77705460849158, -27.550228623839597, -29.550228623839597, -29.550228623839597, -32.905805550823814, -31.405805550823814, -31.905805550823814, -31.4108622736317, -30.9108622736317, -30.4108622736317, -29.63542947533998, -29.63542947533998, -29.63542947533998, -26.99406064180081, -26.99406064180081, -24.49406064180081, -35.8374915605146, -35.8374915605146, -35.8374915605146, -36.1617681874375, -36.1617681874375, -36.1617681874375, -34.197204527634995, -32.697204527634995, -34.197204527634995, -40.14076871598689, -40.14076871598689, -40.14076871598689, -32.98501560074729, -32.98501560074729, -30.985015600747285, -32.94313087762789, -33.44313087762789, -32.44313087762789, -30.89548384205163, -31.89548384205163, -31.89548384205163, -45.44024579571742, -46.44024579571742, -45.44024579571742, -34.45246263035366, -34.45246263035366, -35.45246263035366, -29.72115591373321, -31.22115591373321, -31.72115591373321, -27.91623474336677, -27.91623474336677, -25.916234743366772, -37.20874865397204, -35.20874865397204, -37.20874865397204, -27.77913546849834, -27.77913546849834, -27.77913546849834, -37.04731411678018, -37.54731411678018, -36.04731411678018, -33.68551491093812, -33.68551491093812, -33.68551491093812, -25.38173868368918, -25.38173868368918, -25.38173868368918, -35.725026036442415, -35.225026036442415, -35.725026036442415, -29.709771702318157, -29.709771702318157, -29.709771702318157, -29.190395341201267, -30.690395341201267, -30.690395341201267, -31.04150419748414, -32.041504197484144, -32.041504197484144, -27.156750820423923, -27.656750820423923, -27.656750820423923, -36.81725440091278, -36.81725440091278, -35.81725440091278, -26.305085923129756, -25.805085923129756, -24.305085923129756, -38.72586337724718, -38.72586337724718, -37.72586337724718, -40.05537061029146, -40.55537061029146, -40.55537061029146, -32.528633933582064, -32.028633933582064, -32.528633933582064, -27.65003482985393, -27.65003482985393, -26.65003482985393, -24.801842893534747, -24.801842893534747, -24.801842893534747, -27.7639645694889, -28.7639645694889, -27.7639645694889, -29.535943882869056, -29.535943882869056, -29.535943882869056, -35.011792930772806, -35.011792930772806, -34.011792930772806, -32.80021699652657, -32.80021699652657, -32.80021699652657, -35.226727615012955, -35.226727615012955, -35.226727615012955, -30.662729548448464, -31.162729548448464, -31.662729548448464, -33.12591050241273, -33.62591050241273, -34.62591050241273, -39.514367318703634, -40.514367318703634, -38.014367318703634, -31.498319203986217, -34.99831920398622, -34.99831920398622, -35.40820540314049, -32.408205403140485, -35.40820540314049, -34.378405978315186, -34.378405978315186, -34.378405978315186, -33.12277332829874, -33.12277332829874, -32.12277332829874, -38.185215010661544, -38.185215010661544, -36.185215010661544, -40.59167797676113, -39.59167797676113, -40.09167797676113, -31.730072605293003, -31.730072605293003, -31.730072605293003, -33.53685164998281, -33.53685164998281, -33.03685164998281, -35.173303195778956, -35.173303195778956, -36.173303195778956, -40.30385254587828, -38.30385254587827, -39.30385254587827, -41.26853459970982, -41.26853459970982, -39.76853459970982, -29.082655324197773, -29.082655324197773, -29.082655324197773, -40.561131929241, -40.561131929241, -40.061131929241, -35.83905454778313, -35.83905454778313, -33.33905454778312, -26.5550024612241, -26.5550024612241, -25.5550024612241, -25.4038953161256, -25.4038953161256, -25.4038953161256, -37.11966832699283, -37.11966832699283, -37.11966832699283, -35.52404120877102, -35.52404120877102, -35.52404120877102, -28.302769369876295, -28.302769369876295, -26.8027693698763, -25.241198947177654, -25.241198947177654, -25.241198947177654, -39.065239434239274, -39.065239434239274, -37.06523943423928, -31.531809535675816, -31.531809535675816, -31.531809535675816, -57.95568833579394, -57.95568833579394, -57.95568833579394, -30.469495494247244, -30.469495494247244, -30.469495494247244, -34.478506170928846, -33.978506170928846, -32.978506170928846, -32.18131187312513, -32.18131187312513, -32.18131187312513, -26.104965728114617, -26.104965728114617, -24.104965728114617, -45.461179566109855, -45.461179566109855, -45.461179566109855, -25.475859955885927, -25.475859955885927, -25.475859955885927, -29.685625282762405, -29.685625282762405, -29.185625282762405, -23.041636867998918, -23.541636867998918, -24.041636867998918, -47.39435422553794, -47.89435422553794, -47.89435422553794, -38.73536388072759, -38.73536388072759, -37.73536388072759, -28.369029527285246, -28.369029527285246, -28.369029527285246, -38.91214719669798, -40.41214719669799, -38.41214719669799, -28.573626914354993, -28.573626914354993, -28.573626914354993, -42.337716933639385, -41.337716933639385, -42.337716933639385, -27.819736778307828, -29.319736778307828, -28.819736778307828, -26.22624919945152, -25.72624919945152, -26.22624919945152, -28.923970057576586, -26.923970057576586, -28.423970057576586, -31.31482097471319, -31.31482097471319, -31.31482097471319, -30.51697046525542, -28.51697046525542, -30.51697046525542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3145952071778056, "mean_inference_ms": 1.27563047498446, "mean_action_processing_ms": 0.07039675288487414, "mean_env_wait_ms": 0.5840972124897075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 1548.312, "sample_throughput": 2066.767, "load_time_ms": 0.141, "load_throughput": 22675743.876, "learn_time_ms": 785.061, "learn_throughput": 4076.115, "update_time_ms": 1.662}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 119.92849655151367, "policy_loss": -0.0015646039537774215, "vf_loss": 119.94510650634766, "vf_explained_var": -0.1571449637413025, "kl": 0.001934428135242007, "entropy": 1.5043382167816162, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 144000, "num_steps_trained": 48000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1920, "training_iteration": 15, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-45-59", "timestamp": 1718736359, "time_this_iter_s": 1.5636281967163086, "time_total_s": 23.17124843597412, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 23.17124843597412, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.7, "ram_util_percent": 30.3}}
{"episode_reward_max": -68.78800640918351, "episode_reward_min": -135.38345318983272, "episode_reward_mean": -99.42237624310067, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -45.62781772994423}, "policy_reward_max": {"shared_policy": -22.92933546972784}, "policy_reward_mean": {"shared_policy": -33.14079208103356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.08085089853842, -102.68433753711244, -97.9499985618264, -82.15192549803497, -95.58117143395603, -106.8817919312479, -102.74200895917609, -91.86365539722006, -106.05970454924989, -89.1614703830659, -75.20424442710272, -70.17788477785142, -82.6247036022289, -110.42333342141579, -123.98056314836593, -127.40266603702837, -105.28559161215222, -101.48083452727944, -110.35089712737266, -109.02734054454648, -82.80152218707563, -103.15543176331641, -95.92514593889487, -76.55611106496329, -87.57079777638702, -95.82525540071374, -109.02655145448738, -96.76443919274791, -119.28221387434444, -84.33407552370738, -108.37687382506914, -92.40742853110268, -103.65750090649391, -103.14805184761134, -102.10750823670489, -110.7540446680898, -86.01220049974219, -89.44383697268799, -96.26716938742385, -108.92004864680695, -90.64739095331848, -122.48783563816272, -104.1470898053459, -103.45703455028577, -120.70902343408132, -100.97231434069062, -103.43649383377824, -86.06745885541093, -96.04888877025162, -106.30759673808541, -87.0597037488697, -95.88997349624657, -80.52780370148696, -130.91241240885378, -102.79811915491246, -132.96600947717315, -84.39455550197893, -78.51273454626205, -96.59248135645494, -102.65252211818702, -91.42260819223664, -87.68396348808808, -81.77060279373661, -88.45616080843438, -99.00107230512148, -85.05399297607553, -108.75744367988487, -120.61617669178324, -74.64119992468467, -90.7279886115283, -68.78800640918351, -98.98974427702198, -110.52650178503652, -98.53879531717939, -128.53241811760836, -112.68086803346586, -91.85041583762404, -102.57325962658834, -101.8802711110759, -95.15601129000561, -102.78838262007325, -107.14277898745198, -105.40788164875971, -86.17084092157876, -81.00969909736936, -96.40638465291818, -77.46694114393769, -127.81326616690755, -106.77683836242979, -101.12438458976628, -86.72633012917771, -107.00567375185886, -80.17323913283344, -115.87912982536065, -96.76324932466379, -122.94954218732563, -87.19314752214231, -90.83748564748008, -123.75886311468885, -107.2862170412093, -81.69470322503054, -133.07838432132803, -103.8075581115925, -95.20240524480013, -109.33682116127848, -103.22710326385622, -135.38345318983272, -104.6736065936961, -95.35872114862866, -92.53482517964099, -91.62608575237914, -133.86868975591494, -88.15152603919925, -86.42662443004272, -85.18476955489712, -105.5832385595547, -79.93971050566829, -94.60209014928476, -80.2733157628659, -127.36511557531402], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-27.693616966179448, -28.693616966179448, -28.693616966179448, -34.061445845704164, -35.061445845704164, -33.561445845704164, -32.6499995206088, -32.6499995206088, -32.6499995206088, -27.050641832678334, -27.550641832678334, -27.550641832678334, -33.02705714465204, -30.52705714465204, -32.02705714465204, -35.627263977082606, -35.627263977082606, -35.627263977082606, -34.247336319725335, -34.247336319725335, -34.247336319725335, -30.454551799073354, -30.454551799073354, -30.954551799073354, -34.01990151641663, -35.51990151641663, -36.51990151641663, -29.887156794355278, -29.387156794355278, -29.887156794355278, -25.068081475700904, -25.068081475700904, -25.068081475700904, -23.392628259283807, -23.392628259283807, -23.392628259283807, -27.708234534076308, -27.208234534076308, -27.708234534076308, -36.8077778071386, -36.8077778071386, -36.8077778071386, -41.32685438278866, -41.32685438278866, -41.32685438278866, -41.967555345676125, -42.96755534567611, -42.46755534567611, -35.42853053738408, -35.42853053738408, -34.42853053738408, -34.160278175759835, -34.160278175759835, -33.160278175759835, -37.11696570912422, -36.11696570912422, -37.11696570912422, -36.34244684818218, -36.34244684818218, -36.34244684818218, -27.600507395691906, -27.600507395691906, -27.600507395691906, -33.885143921105474, -34.885143921105474, -34.385143921105474, -32.30838197963161, -31.308381979631612, -32.30838197963161, -26.01870368832108, -24.51870368832108, -26.01870368832108, -29.190265925462317, -29.190265925462317, -29.190265925462317, -31.94175180023792, -31.94175180023792, -31.94175180023792, -36.675517151495775, -35.675517151495775, -36.675517151495775, -32.254813064249284, -32.254813064249284, -32.254813064249284, -39.760737958114774, -39.760737958114774, -39.760737958114774, -27.111358507902477, -28.611358507902477, -28.611358507902477, -35.625624608356354, -36.125624608356354, -36.625624608356354, -31.13580951036757, -31.13580951036757, -30.13580951036757, -34.38583363549797, -34.88583363549797, -34.38583363549797, -34.716017282537116, -33.71601728253712, -34.716017282537116, -35.369169412234974, -34.369169412234974, -32.369169412234974, -36.91801488936327, -36.91801488936327, -36.91801488936327, -29.17073349991406, -27.67073349991406, -29.17073349991406, -29.98127899089601, -28.98127899089601, -30.48127899089601, -32.58905646247462, -32.58905646247462, -31.089056462474623, -36.306682882268966, -36.306682882268966, -36.306682882268966, -30.215796984439486, -30.215796984439486, -30.215796984439486, -41.32927854605422, -41.32927854605422, -39.82927854605422, -34.54902993511531, -34.54902993511531, -35.04902993511531, -35.15234485009525, -35.15234485009525, -33.15234485009525, -41.403007811360446, -39.903007811360446, -39.403007811360446, -33.65743811356357, -33.65743811356357, -33.65743811356357, -34.978831277926076, -33.478831277926076, -34.978831277926076, -28.689152951803678, -28.689152951803678, -28.689152951803678, -32.01629625675056, -32.01629625675056, -32.01629625675056, -35.435865579361796, -35.435865579361796, -35.435865579361796, -29.353234582956553, -29.353234582956553, -28.353234582956553, -31.62999116541554, -32.62999116541554, -31.62999116541554, -26.84260123382898, -26.84260123382898, -26.84260123382898, -44.470804136284585, -43.470804136284585, -42.970804136284585, -34.26603971830415, -34.26603971830415, -34.26603971830415, -44.65533649239103, -43.65533649239103, -44.65533649239103, -28.464851833992984, -28.464851833992984, -27.464851833992984, -26.1709115154207, -26.1709115154207, -26.1709115154207, -32.53082711881831, -32.53082711881831, -31.53082711881831, -34.38417403939565, -33.88417403939565, -34.38417403939565, -30.640869397412192, -30.140869397412192, -30.640869397412192, -29.561321162696025, -29.561321162696025, -28.561321162696025, -27.756867597912223, -27.756867597912223, -26.256867597912226, -29.15205360281146, -29.65205360281146, -29.65205360281146, -32.333690768373806, -33.333690768373806, -33.333690768373806, -27.68466432535849, -28.68466432535849, -28.68466432535849, -36.91914789329495, -36.41914789329495, -35.41914789329495, -40.70539223059442, -39.20539223059443, -40.70539223059442, -24.54706664156156, -25.04706664156156, -25.04706664156156, -30.40932953717609, -29.90932953717609, -30.40932953717609, -22.92933546972784, -22.92933546972784, -22.92933546972784, -33.66324809234066, -32.663248092340666, -32.66324809234066, -37.17550059501217, -37.17550059501217, -36.175500595012174, -32.679598439059795, -32.179598439059795, -33.679598439059795, -43.510806039202784, -41.510806039202784, -43.510806039202784, -38.39362267782196, -35.89362267782196, -38.39362267782196, -31.116805279208037, -31.116805279208037, -29.616805279208037, -34.191086542196146, -34.191086542196146, -34.191086542196146, -34.293423703691964, -33.293423703691964, -34.293423703691964, -29.385337096668557, -33.385337096668565, -32.38533709666855, -34.596127540024405, -34.596127540024405, -33.596127540024405, -35.38092632915065, -35.38092632915065, -36.38092632915065, -36.30262721625324, -35.80262721625324, -33.30262721625324, -29.39028030719294, -28.89028030719294, -27.89028030719294, -27.003233032456446, -27.003233032456446, -27.003233032456446, -32.8021282176394, -30.802128217639396, -32.8021282176394, -26.322313714645876, -24.822313714645883, -26.322313714645876, -43.43775538896918, -41.93775538896919, -42.43775538896918, -35.925612787476595, -34.925612787476595, -35.925612787476595, -34.0414615299221, -34.0414615299221, -33.0414615299221, -28.908776709725903, -28.908776709725903, -28.908776709725903, -36.00189125061962, -36.00189125061962, -35.00189125061962, -24.724413044277807, -27.724413044277803, -27.724413044277803, -38.62637660845353, -38.62637660845353, -38.62637660845353, -33.42108310822123, -31.421083108221236, -31.92108310822124, -40.983180729108554, -40.983180729108554, -40.983180729108554, -29.3977158407141, -28.3977158407141, -29.3977158407141, -31.1124952158267, -28.6124952158267, -31.1124952158267, -41.25295437156293, -41.75295437156293, -40.75295437156293, -35.76207234706978, -35.76207234706978, -35.76207234706978, -27.56490107501016, -27.56490107501016, -26.56490107501016, -44.19279477377598, -43.69279477377598, -45.19279477377598, -34.602519370530835, -34.602519370530835, -34.602519370530835, -31.90080174826671, -31.40080174826671, -31.90080174826671, -36.445607053759495, -36.445607053759495, -36.445607053759495, -34.74236775461873, -33.74236775461874, -34.74236775461873, -45.62781772994423, -45.62781772994423, -44.12781772994423, -35.724535531232036, -35.724535531232036, -33.224535531232036, -32.45290704954288, -30.45290704954288, -32.45290704954288, -29.511608393213677, -31.511608393213677, -31.511608393213677, -30.542028584126378, -30.542028584126378, -30.542028584126378, -45.28956325197167, -44.28956325197167, -44.28956325197167, -29.3838420130664, -29.3838420130664, -29.3838420130664, -28.975541476680903, -28.975541476680903, -28.475541476680903, -27.56158985163237, -29.06158985163237, -28.56158985163237, -35.861079519851565, -34.861079519851565, -34.861079519851565, -26.97990350188941, -25.979903501889414, -26.97990350188941, -32.367363383094926, -30.867363383094926, -31.367363383094926, -27.091105254288614, -26.091105254288614, -27.091105254288614, -42.62170519177135, -42.62170519177135, -42.12170519177135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3144962530167766, "mean_inference_ms": 1.2755711780258325, "mean_action_processing_ms": 0.07040412182501576, "mean_env_wait_ms": 0.5838186008533074, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 51200, "timesteps_this_iter": 0, "agent_timesteps_total": 153600, "timers": {"sample_time_ms": 1548.517, "sample_throughput": 2066.493, "load_time_ms": 0.14, "load_throughput": 22868926.223, "learn_time_ms": 788.459, "learn_throughput": 4058.552, "update_time_ms": 1.675}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 93.9736213684082, "policy_loss": -0.0017110346757689854, "vf_loss": 93.99030380249023, "vf_explained_var": -0.049888110160827635, "kl": 0.002796693386302429, "entropy": 1.4971020817756653, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 51200, "num_agent_steps_sampled": 153600, "num_steps_trained": 51200, "num_agent_steps_trained": 153600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2040, "training_iteration": 16, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-01", "timestamp": 1718736361, "time_this_iter_s": 1.5383410453796387, "time_total_s": 24.70958948135376, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219b940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 24.70958948135376, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.150000000000006, "ram_util_percent": 30.25}}
{"episode_reward_max": -69.06736746587757, "episode_reward_min": -159.08803940792504, "episode_reward_mean": -98.28030764694331, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -53.86267980264169}, "policy_reward_max": {"shared_policy": -23.02245582195917}, "policy_reward_mean": {"shared_policy": -32.76010254898111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.851948726577, -75.10545032422411, -94.78299127399256, -84.09097800467734, -117.2812990648848, -102.61343088348116, -81.44312503332571, -96.17319412317968, -79.82603845618459, -74.16872722991374, -105.81778330949999, -93.01815982073533, -105.30067465615578, -71.840932893136, -92.37999702915245, -112.70505754372377, -91.2851182238526, -94.2101038142903, -101.4905724998369, -106.90710910529643, -113.47155576352051, -94.23200167354561, -95.029527495689, -89.25995527704012, -80.55553372417178, -112.73843034589248, -118.18777339911382, -101.06452231630107, -84.56355978402296, -70.57423979703145, -82.72950893362062, -123.807475639027, -82.5683808422047, -110.19557536128383, -98.84398013290213, -80.53123396134451, -88.04876454374721, -106.44124059409853, -106.74261192632946, -69.06736746587757, -109.56545145146042, -84.22056856225598, -89.61854689709016, -103.23726060849897, -114.1616844943746, -105.59717009840374, -85.20545677241448, -89.17763383736656, -98.8530746468704, -95.70363353685667, -102.027027298458, -106.16299439672946, -86.68382274376715, -80.19138991475278, -102.5743470939975, -76.12492018605163, -112.23803553957443, -80.4031624152954, -114.21630831268733, -105.41049751224583, -76.2784255068033, -73.51901331015446, -102.82986288655788, -104.14450066186447, -159.08803940792504, -111.64102836246686, -121.98136239100701, -84.30049799988882, -99.68453396227878, -85.17630061891022, -103.42092541925844, -103.78315995619029, -111.16140203841404, -108.92227788358747, -132.5185097429668, -103.03083421007553, -110.04767732861518, -98.00870491538937, -107.3160345235518, -81.34422476823661, -77.43859118742297, -93.65571017851939, -95.63484027060862, -128.48656976554406, -88.81002049328673, -126.04868322994713, -100.40999282361679, -86.38186428120956, -105.08669499503127, -84.48417747880062, -84.11173167637199, -93.22344697930674, -83.31785854671492, -84.92727444577656, -71.08879062528486, -86.67050974827508, -79.16419439580669, -115.16553105280569, -91.02580950273712, -79.33384853695682, -109.34396652684717, -75.99145773127402, -80.62951076374368, -99.48732472655942, -76.55153820424034, -103.56809175260395, -113.78488005386586, -98.73463354857674, -142.65544193549093, -90.85377737186448, -79.13204709055857, -89.52269060625517, -105.25548343974657, -124.22709738300522, -100.05723627370797, -98.8113850988047, -83.24179273208537, -143.99458196502147, -83.64294003342611, -150.82187635020054, -104.86851008734651, -88.06751799542505, -119.63384485909646, -115.29285129875315, -98.19290955390423, -97.02477526680839, -116.39026149756377, -81.78508769720595, -101.10357877593334, -131.79053006251473], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-36.78398290885897, -35.283982908858974, -36.78398290885897, -25.201816774741367, -25.201816774741367, -24.701816774741367, -31.927663757997554, -31.427663757997554, -31.427663757997554, -28.030326001559118, -28.030326001559118, -28.030326001559118, -39.42709968829492, -38.92709968829492, -38.92709968829492, -34.70447696116039, -34.70447696116039, -33.204476961160395, -27.147708344441913, -27.147708344441913, -27.147708344441913, -31.391064707726564, -32.391064707726564, -32.391064707726564, -26.608679485394873, -26.608679485394873, -26.608679485394873, -24.722909076637904, -24.722909076637904, -24.722909076637904, -34.93926110316666, -35.43926110316666, -35.43926110316666, -30.672719940245106, -31.672719940245106, -30.672719940245106, -35.100224885385245, -35.100224885385245, -35.100224885385245, -23.946977631045325, -23.946977631045325, -23.946977631045325, -30.793332343050807, -30.793332343050807, -30.793332343050807, -37.56835251457461, -37.06835251457461, -38.06835251457461, -30.761706074617535, -29.761706074617535, -30.761706074617535, -31.570034604763432, -31.570034604763432, -31.070034604763432, -34.163524166612284, -34.163524166612284, -33.163524166612284, -35.63570303509881, -35.63570303509881, -35.63570303509881, -37.990518587840185, -37.990518587840185, -37.490518587840185, -31.410667224515162, -31.410667224515162, -31.410667224515162, -31.67650916522967, -31.67650916522967, -31.67650916522967, -30.419985092346717, -28.919985092346717, -29.919985092346717, -26.851844574723945, -26.851844574723945, -26.851844574723945, -37.74614344863083, -37.74614344863083, -37.24614344863083, -38.395924466371255, -39.89592446637124, -39.89592446637124, -34.02150743876701, -34.02150743876701, -33.02150743876701, -27.85451992800767, -27.85451992800767, -28.85451992800767, -23.191413265677138, -23.691413265677138, -23.691413265677138, -27.57650297787354, -27.57650297787354, -27.57650297787354, -41.602491879675654, -41.102491879675654, -41.102491879675654, -27.522793614068263, -26.52279361406827, -28.522793614068263, -36.73185845376125, -36.73185845376125, -36.73185845376125, -33.1146600443007, -32.6146600443007, -33.1146600443007, -26.177077987114828, -27.177077987114828, -27.177077987114828, -29.349588181249075, -29.349588181249075, -29.349588181249075, -35.48041353136617, -35.48041353136617, -35.48041353136617, -35.580870642109836, -35.580870642109836, -35.580870642109836, -23.02245582195917, -23.02245582195917, -23.02245582195917, -36.85515048382011, -35.85515048382012, -36.85515048382011, -27.07352285408533, -29.07352285408533, -28.07352285408533, -30.039515632363383, -29.53951563236338, -30.039515632363383, -34.745753536166326, -34.245753536166326, -34.245753536166326, -38.72056149812487, -37.72056149812487, -37.72056149812487, -34.53239003280124, -35.53239003280124, -35.53239003280124, -28.401818924138183, -28.401818924138183, -28.401818924138183, -29.725877945788827, -29.725877945788827, -29.725877945788827, -33.61769154895678, -32.61769154895678, -32.61769154895678, -30.901211178952234, -32.40121117895224, -32.40121117895224, -34.175675766152665, -33.675675766152665, -34.175675766152665, -35.88766479890981, -35.88766479890981, -34.38766479890981, -29.061274247922398, -28.561274247922398, -29.061274247922398, -26.897129971584246, -26.897129971584246, -26.397129971584246, -34.19144903133248, -34.19144903133248, -34.19144903133248, -25.708306728683894, -24.708306728683894, -25.708306728683894, -37.41267851319147, -37.41267851319147, -37.41267851319147, -27.134387471765127, -25.634387471765127, -27.634387471765127, -37.07210277089579, -39.07210277089579, -38.07210277089579, -34.47016583741529, -35.47016583741529, -35.47016583741529, -25.426141835601104, -25.426141835601104, -25.426141835601104, -24.50633777005148, -24.50633777005148, -24.50633777005148, -34.27662096218596, -34.27662096218596, -34.27662096218596, -34.048166887288176, -35.04816688728818, -35.04816688728818, -53.36267980264169, -53.86267980264169, -51.86267980264169, -36.88034278748898, -37.38034278748898, -37.38034278748898, -41.16045413033567, -41.16045413033567, -39.660454130335665, -28.60016599996296, -27.600165999962957, -28.10016599996296, -34.22817798742625, -32.22817798742626, -33.22817798742626, -28.3921002063034, -28.3921002063034, -28.3921002063034, -33.806975139752815, -34.806975139752815, -34.806975139752815, -33.92771998539674, -34.92771998539674, -34.92771998539674, -37.05380067947135, -37.05380067947135, -37.05380067947135, -36.307425961195854, -36.307425961195854, -36.307425961195854, -44.50616991432227, -44.50616991432227, -43.50616991432228, -33.34361140335851, -34.343611403358516, -35.343611403358516, -37.01589244287173, -37.01589244287173, -36.01589244287174, -33.16956830512978, -33.16956830512978, -31.66956830512978, -35.7720115078506, -35.7720115078506, -35.7720115078506, -27.114741589412194, -27.114741589412194, -27.114741589412194, -25.979530395807647, -25.479530395807647, -25.979530395807647, -30.55190339283981, -31.55190339283981, -31.55190339283981, -31.378280090202885, -32.378280090202885, -31.878280090202885, -41.49552325518133, -42.99552325518133, -43.99552325518133, -29.93667349776225, -29.93667349776225, -28.93667349776225, -41.34956107664904, -42.34956107664904, -42.34956107664904, -33.469997607872244, -33.469997607872244, -33.469997607872244, -29.1272880937365, -29.1272880937365, -28.1272880937365, -34.695564998343755, -35.195564998343755, -35.195564998343755, -28.161392492933555, -28.161392492933555, -28.161392492933555, -28.037243892123993, -28.037243892123993, -28.037243892123993, -31.5744823264356, -30.074482326435607, -31.5744823264356, -27.605952848904984, -28.605952848904984, -27.105952848904984, -28.309091481925503, -28.309091481925503, -28.309091481925503, -23.696263541761628, -23.696263541761628, -23.696263541761628, -28.890169916091693, -28.890169916091693, -28.890169916091693, -25.388064798602212, -26.38806479860221, -27.38806479860221, -38.38851035093521, -38.38851035093521, -38.38851035093521, -30.34193650091237, -30.34193650091237, -30.34193650091237, -26.44461617898562, -26.44461617898562, -26.44461617898562, -36.78132217561573, -36.78132217561573, -35.78132217561573, -25.330485910424677, -25.330485910424677, -25.330485910424677, -27.709836921247895, -26.209836921247895, -26.709836921247895, -33.162441575519814, -33.162441575519814, -33.162441575519814, -25.68384606808011, -25.18384606808011, -25.68384606808011, -32.52269725086797, -35.522697250867964, -35.522697250867964, -37.92829335128861, -37.92829335128861, -37.92829335128861, -32.91154451619226, -32.91154451619226, -32.91154451619226, -47.05181397849699, -47.55181397849699, -48.05181397849699, -28.951259123954816, -30.951259123954816, -30.951259123954816, -26.3773490301862, -26.3773490301862, -26.3773490301862, -29.507563535418388, -30.007563535418388, -30.007563535418388, -34.585161146582166, -35.085161146582166, -35.585161146582166, -41.575699127668415, -40.575699127668415, -42.07569912766843, -32.685745424569326, -33.685745424569326, -33.685745424569326, -32.93712836626824, -32.93712836626824, -32.93712836626824, -27.413930910695132, -28.413930910695132, -27.413930910695132, -47.998193988340525, -47.998193988340525, -47.998193988340525, -27.88098001114203, -27.88098001114203, -27.88098001114203, -50.773958783400175, -50.773958783400175, -49.273958783400175, -34.95617002911549, -34.95617002911549, -34.95617002911549, -29.35583933180837, -29.35583933180837, -29.35583933180837, -40.21128161969886, -40.21128161969886, -39.21128161969886, -38.59761709958437, -38.09761709958437, -38.59761709958437, -32.897636517968095, -32.397636517968095, -32.897636517968095, -32.841591755602785, -31.341591755602785, -32.841591755602785, -38.1300871658546, -39.1300871658546, -39.1300871658546, -27.26169589906864, -27.26169589906864, -27.26169589906864, -34.36785959197779, -32.36785959197779, -34.36785959197779, -43.59684335417161, -43.59684335417161, -44.59684335417161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3148890575751775, "mean_inference_ms": 1.2768962501143077, "mean_action_processing_ms": 0.07044202460674782, "mean_env_wait_ms": 0.5844903986937332, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 54400, "timesteps_this_iter": 0, "agent_timesteps_total": 163200, "timers": {"sample_time_ms": 1561.107, "sample_throughput": 2049.828, "load_time_ms": 0.143, "load_throughput": 22448189.998, "learn_time_ms": 790.768, "learn_throughput": 4046.697, "update_time_ms": 1.682}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 84.1592010498047, "policy_loss": -0.0025918960104463597, "vf_loss": 84.1768081665039, "vf_explained_var": -0.025756371021270753, "kl": 0.0051608908849627875, "entropy": 1.5014095187187195, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 54400, "num_agent_steps_sampled": 163200, "num_steps_trained": 54400, "num_agent_steps_trained": 163200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2170, "training_iteration": 17, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-02", "timestamp": 1718736362, "time_this_iter_s": 1.5509138107299805, "time_total_s": 26.26050329208374, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 26.26050329208374, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.7, "ram_util_percent": 30.3}}
{"episode_reward_max": -67.58006642879718, "episode_reward_min": -141.5405280373341, "episode_reward_mean": -101.01391167582686, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.01350934577803}, "policy_reward_max": {"shared_policy": -21.526688809599055}, "policy_reward_mean": {"shared_policy": -33.67130389194229}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.49315559360329, -107.82153431059545, -109.38837396024724, -70.8781439408375, -86.23674144423171, -103.54539167363119, -106.14014368734671, -92.44506329032687, -95.88591877198115, -116.45502304321096, -118.91124719734447, -106.32361175326164, -103.03644056945737, -125.84068359624713, -89.39315359968495, -102.50178963311508, -116.4641919409619, -122.29487745464975, -109.78636514263596, -94.47697703252294, -107.108454294176, -97.66188054454673, -96.19991977520013, -92.20618754487481, -110.13814426693568, -96.14688769522229, -90.62386288652026, -86.32500443432242, -89.26041179649256, -137.58292176743635, -107.17852747045542, -103.82002650879812, -120.3889633620236, -114.8042093121305, -98.24727043888345, -82.72767440661879, -111.6321899062193, -110.59086856611624, -119.64404231878028, -126.1238718763116, -114.7576734035285, -77.49243517895756, -78.21869438152423, -101.683272807892, -108.32216897799208, -98.37118092366521, -72.02138513820883, -90.28086512613062, -100.91192345438769, -124.7891841318971, -88.43152252116808, -122.70748136597066, -83.23885108036967, -93.8633054137318, -90.50539041506497, -83.0892851118372, -93.51399443961775, -103.27561239996727, -100.56440863410386, -113.38649312437359, -141.5405280373341, -97.20752841535628, -74.66078055480469, -85.25681558581398, -97.55436229387975, -112.84527493559648, -102.29879396447404, -99.60927529012527, -111.86679461405978, -90.57861189592893, -94.43223161081492, -106.75846495980734, -95.71448314902985, -103.14938769838602, -104.34709044319168, -94.72301241567686, -74.068495977128, -94.91840408052747, -109.17106000257571, -120.50676583573318, -106.26330115856169, -105.4405638647251, -82.50356035751058, -116.0987561464751, -114.53646977118788, -98.14130556333723, -113.59003183294652, -98.80758216440162, -94.6385600770727, -100.61368453242082, -84.12565331641434, -97.21231266570565, -95.5444089739313, -97.04923276740928, -119.31568033250703, -103.32762047973806, -100.42917088060821, -98.80590811732435, -97.29644363728849, -108.08311646610437, -106.40807128572524, -91.67381349659398, -82.8032834426366, -121.78166672855062, -77.81408445628139, -102.87741540906092, -93.39615324419556, -99.24899070768461, -90.79966902867318, -112.7048893599844, -130.8870619392511, -118.26449189004266, -126.23362685532217, -90.1174111325917, -109.5374752678352, -103.73966110185528, -96.37540497663537, -77.03490700195341, -76.41322327679002, -84.39837669539918, -110.90051979438466, -117.1281070831709, -89.40869084673223, -67.58006642879718, -89.7455442694085, -126.8772202694011, -82.95250252858786, -88.25230882902167, -113.60309299192225, -92.66398781473973], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.83105186453441, -33.83105186453441, -33.83105186453441, -35.94051143686515, -35.94051143686515, -35.94051143686515, -37.12945798674908, -35.12945798674908, -37.12945798674908, -23.9593813136125, -23.9593813136125, -22.9593813136125, -29.0789138147439, -28.0789138147439, -29.0789138147439, -34.51513055787706, -34.51513055787706, -34.51513055787706, -35.88004789578221, -34.88004789578221, -35.38004789578221, -29.48168776344228, -30.98168776344228, -31.98168776344228, -31.961972923993702, -31.961972923993702, -31.961972923993702, -39.65167434773698, -39.65167434773698, -37.151674347736986, -38.470415732448146, -39.470415732448146, -40.970415732448146, -35.441203917753874, -35.441203917753874, -35.441203917753874, -34.34548018981913, -34.34548018981913, -34.34548018981913, -42.44689453208238, -42.44689453208238, -40.94689453208238, -29.79771786656168, -29.79771786656168, -29.79771786656168, -33.50059654437168, -34.50059654437168, -34.50059654437168, -38.82139731365397, -38.82139731365397, -38.82139731365397, -41.09829248488326, -42.09829248488326, -39.09829248488325, -36.76212171421201, -36.76212171421201, -36.26212171421201, -31.49232567750766, -31.49232567750766, -31.49232567750766, -35.53615143139197, -35.536151431391964, -36.036151431391964, -32.553960181515585, -32.553960181515585, -32.553960181515585, -31.399973258400035, -32.89997325840003, -31.899973258400035, -31.068729181624946, -31.068729181624946, -30.068729181624946, -36.71271475564521, -36.71271475564521, -36.71271475564521, -32.04896256507411, -32.04896256507411, -32.04896256507411, -30.207954295506735, -30.207954295506735, -30.207954295506735, -28.77500147810746, -28.77500147810746, -28.77500147810746, -29.75347059883087, -29.75347059883087, -29.75347059883087, -44.19430725581215, -46.69430725581214, -46.69430725581214, -36.05950915681847, -36.05950915681847, -35.05950915681848, -34.60667550293269, -34.60667550293269, -34.60667550293269, -39.79632112067455, -40.29632112067455, -40.29632112067455, -37.26806977071016, -38.76806977071016, -38.76806977071016, -32.74909014629447, -32.74909014629447, -32.74909014629447, -27.575891468872943, -27.575891468872943, -27.575891468872943, -38.710729968739784, -35.71072996873978, -37.210729968739784, -36.86362285537209, -36.86362285537209, -36.86362285537209, -40.0480141062601, -39.548014106260105, -40.0480141062601, -41.041290625437185, -42.541290625437185, -42.541290625437185, -38.41922446784285, -38.41922446784285, -37.91922446784285, -25.830811726319205, -25.830811726319205, -25.830811726319205, -26.239564793841396, -26.239564793841396, -25.739564793841396, -32.22775760263064, -34.72775760263064, -34.72775760263064, -34.44072299266401, -36.94072299266401, -36.94072299266401, -32.957060307888405, -32.957060307888405, -32.457060307888405, -23.673795046069607, -23.673795046069607, -24.673795046069607, -30.093621708710206, -30.093621708710206, -30.093621708710206, -33.637307818129216, -33.637307818129216, -33.637307818129216, -41.76306137729907, -41.26306137729907, -41.76306137729907, -29.810507507056023, -28.810507507056023, -29.810507507056023, -39.902493788656884, -41.4024937886569, -41.4024937886569, -27.74628369345658, -27.74628369345658, -27.74628369345658, -31.6211018045773, -31.6211018045773, -30.6211018045773, -30.1684634716883, -30.1684634716883, -30.1684634716883, -28.029761703945738, -28.029761703945738, -27.029761703945734, -31.171331479872578, -31.171331479872578, -31.171331479872578, -34.59187079998908, -34.09187079998908, -34.59187079998908, -32.521469544701276, -34.021469544701276, -34.021469544701276, -37.962164374791186, -37.462164374791186, -37.962164374791186, -48.01350934577803, -45.51350934577804, -48.01350934577803, -32.402509471785415, -32.402509471785415, -32.402509471785415, -24.886926851601554, -24.886926851601554, -24.886926851601554, -28.58560519527135, -28.58560519527135, -28.08560519527135, -32.5181207646266, -32.5181207646266, -32.5181207646266, -37.11509164519882, -38.11509164519881, -37.61509164519882, -34.099597988158024, -34.099597988158024, -34.099597988158024, -33.20309176337507, -33.20309176337507, -33.20309176337507, -37.2889315380199, -37.2889315380199, -37.2889315380199, -30.526203965309634, -29.526203965309634, -30.526203965309634, -32.14407720360496, -30.644077203604954, -31.644077203604954, -35.58615498660246, -35.58615498660246, -35.58615498660246, -31.23816104967663, -31.73816104967663, -32.73816104967663, -34.383129232795326, -34.383129232795326, -34.383129232795326, -34.782363481063946, -34.782363481063946, -34.782363481063946, -31.57433747189229, -31.57433747189229, -31.57433747189229, -24.689498659042666, -24.689498659042666, -24.689498659042666, -32.639468026842486, -30.13946802684249, -32.139468026842486, -36.89035333419187, -36.89035333419187, -35.390353334191865, -40.33558861191106, -39.83558861191106, -40.33558861191106, -35.42110038618723, -35.42110038618723, -35.42110038618723, -35.31352128824172, -34.81352128824172, -35.31352128824172, -27.167853452503543, -27.667853452503543, -27.667853452503543, -38.699585382158354, -38.699585382158354, -38.699585382158354, -37.512156590395946, -38.51215659039595, -38.51215659039595, -32.71376852111241, -32.21376852111241, -33.21376852111241, -37.196677277648845, -38.19667727764884, -38.19667727764884, -32.26919405480054, -33.26919405480054, -33.26919405480054, -31.546186692357573, -31.546186692357573, -31.546186692357573, -33.5378948441403, -33.5378948441403, -33.5378948441403, -26.708551105471447, -28.708551105471447, -28.708551105471447, -32.404104221901875, -32.404104221901875, -32.404104221901875, -31.848136324643757, -31.848136324643757, -31.848136324643757, -31.68307758913645, -32.683077589136445, -32.683077589136445, -39.27189344416899, -40.27189344416899, -39.77189344416899, -34.442540159912674, -33.942540159912674, -34.942540159912674, -33.47639029353606, -33.47639029353606, -33.47639029353606, -32.935302705774774, -32.935302705774774, -32.935302705774774, -31.7654812124295, -32.7654812124295, -32.7654812124295, -36.194372155368136, -36.194372155368136, -35.694372155368136, -35.80269042857511, -35.80269042857511, -34.80269042857511, -30.724604498864668, -30.724604498864668, -30.224604498864668, -27.60109448087886, -27.60109448087886, -27.60109448087886, -40.26055557618354, -40.76055557618354, -40.76055557618354, -27.104694818760464, -26.604694818760464, -24.104694818760464, -34.292471803020305, -34.292471803020305, -34.292471803020305, -31.465384414731865, -30.46538441473187, -31.465384414731865, -32.41633023589486, -33.41633023589486, -33.41633023589486, -30.599889676224407, -29.599889676224407, -30.599889676224407, -38.23496311999484, -36.23496311999483, -38.23496311999484, -43.795687313083675, -43.795687313083675, -43.295687313083675, -39.42149729668088, -39.42149729668088, -39.42149729668088, -42.41120895177407, -41.41120895177407, -42.41120895177407, -30.039137044197254, -30.039137044197254, -30.039137044197254, -36.5124917559451, -36.5124917559451, -36.5124917559451, -34.9132203672851, -34.9132203672851, -33.9132203672851, -32.12513499221179, -32.12513499221179, -32.12513499221179, -25.511635667317805, -26.011635667317805, -25.511635667317805, -25.471074425596655, -25.471074425596655, -25.471074425596655, -28.96612556513306, -26.46612556513306, -28.96612556513306, -36.966839931461564, -36.966839931461564, -36.966839931461564, -38.376035694390296, -39.376035694390296, -39.376035694390296, -29.13623028224409, -30.13623028224409, -30.13623028224409, -22.526688809599058, -21.526688809599055, -23.526688809599058, -29.581848089802815, -29.581848089802815, -30.581848089802815, -41.95907342313369, -42.959073423133695, -41.95907342313369, -27.484167509529286, -27.984167509529286, -27.484167509529286, -29.417436276340553, -29.917436276340553, -28.917436276340553, -37.86769766397408, -37.86769766397408, -37.86769766397408, -30.88799593824655, -30.88799593824655, -30.88799593824655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3154663922906315, "mean_inference_ms": 1.277467617246141, "mean_action_processing_ms": 0.0705949218503677, "mean_env_wait_ms": 0.5852062945108493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 57600, "timesteps_this_iter": 0, "agent_timesteps_total": 172800, "timers": {"sample_time_ms": 1568.522, "sample_throughput": 2040.137, "load_time_ms": 0.147, "load_throughput": 21739184.969, "learn_time_ms": 790.989, "learn_throughput": 4045.567, "update_time_ms": 1.756}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005000000000000001, "total_loss": 82.13905487060546, "policy_loss": -0.002840141035538757, "vf_loss": 82.15679550170898, "vf_explained_var": -0.03917120695114136, "kl": 0.0033696619514804794, "entropy": 1.4904539585113525, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 57600, "num_agent_steps_sampled": 172800, "num_steps_trained": 57600, "num_agent_steps_trained": 172800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2300, "training_iteration": 18, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-04", "timestamp": 1718736364, "time_this_iter_s": 1.5376126766204834, "time_total_s": 27.798115968704224, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d13a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 27.798115968704224, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 31.366666666666664, "ram_util_percent": 30.3}}
{"episode_reward_max": -67.33334603412422, "episode_reward_min": -163.79743627959968, "episode_reward_mean": -98.69678640821216, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -54.93247875986656}, "policy_reward_max": {"shared_policy": -21.777782011374736}, "policy_reward_mean": {"shared_policy": -32.89892880273739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.72157904384581, -87.85640575608977, -111.48715483650746, -121.23087350436106, -127.90930810484123, -99.88307240934981, -82.77013104167925, -101.00637763240572, -104.95593179082536, -94.11398375936723, -86.93123130684447, -80.88361492086385, -107.64523940427978, -101.64888827754186, -96.85521235223455, -103.7482651627251, -109.89745810606513, -86.50166466033286, -105.8076037557745, -82.11484716318996, -67.33334603412422, -85.53776975400879, -163.79743627959968, -105.88956284357509, -71.52458808152817, -109.75876394290894, -103.96772115898071, -93.60694574111402, -98.91131894566267, -115.95766851383942, -113.9710100142106, -85.72386732737053, -93.41024454194496, -90.66119406015589, -101.6787779959717, -104.06163016835282, -87.56815218665311, -96.08689073482438, -90.05486738375399, -89.50509115958376, -122.81309729828826, -102.9994518016618, -97.94783094134215, -103.05945353146014, -74.82782909896638, -84.51740126049248, -85.30791882381665, -93.50889557130641, -112.80562589141134, -80.71393506376863, -79.9218054007956, -101.1513505803951, -108.75298302876234, -104.18873436838625, -88.40405503250771, -118.4162207666718, -75.7176887515324, -108.32923638974529, -99.32354275586314, -89.69087639109995, -95.10181032271305, -158.5010440735419, -127.33012555314701, -129.47464171170301, -85.50505098559901, -108.22186822815198, -75.00629642818545, -82.21722205263163, -87.3787100232076, -98.29916949374699, -82.23322345120974, -86.11078339536286, -120.28085999174749, -126.4053431457197, -91.20680269565312, -94.41888867033357, -85.49443188939287, -76.92882621867082, -89.70290028533712, -130.0017560284604, -106.9892546346194, -85.3505624456517, -87.93524210076113, -101.99365175336098, -73.33124027021137, -85.60930696825422, -99.81445056810637, -109.58531381322226, -75.91946754979841, -111.9406917114803, -70.7805039202738, -100.02797004371662, -75.9656797445924, -130.06791128768106, -89.255358823889, -116.82045979877726, -89.47584013250184, -108.03493757790967, -88.75713773659453, -99.0921437511481, -80.71574373874395, -75.45834182872544, -107.42945547446955, -148.9366707899225, -83.6470179987344, -108.87966660464629, -121.59499252520075, -82.52297410508625, -106.20831460559319, -105.99857513632867, -92.23839769562218, -91.07607509164795, -112.41570228372157, -99.0511619617987, -77.00474447906817, -82.67895406942468, -89.81603039722414, -94.96518735266004, -99.11733684469404, -94.3651151088705, -96.4355303303684, -90.86882360109558, -121.09967884783848, -126.01460087400928, -94.19607800330296, -109.364516797903, -75.6616914507722, -126.66646080481486, -126.03224633609213, -82.18164604657424], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-32.24052634794862, -32.24052634794862, -32.24052634794862, -29.285468585363255, -29.285468585363255, -29.285468585363255, -36.82905161216915, -37.32905161216915, -37.32905161216915, -39.743624501453674, -40.743624501453674, -40.743624501453674, -42.63643603494705, -42.63643603494705, -42.63643603494705, -33.961024136449936, -32.961024136449936, -32.961024136449936, -27.590043680559738, -27.590043680559738, -27.590043680559738, -33.66879254413524, -33.66879254413524, -33.66879254413524, -34.318643930275115, -35.318643930275115, -35.318643930275115, -31.87132791978909, -30.37132791978909, -31.87132791978909, -29.643743768948152, -28.643743768948152, -28.643743768948152, -27.46120497362128, -27.46120497362128, -25.96120497362128, -36.38174646809324, -36.38174646809324, -34.88174646809324, -35.04962942584731, -34.54962942584731, -32.0496294258473, -32.45173745074486, -31.95173745074486, -32.45173745074486, -34.91608838757502, -33.91608838757502, -34.91608838757502, -35.9658193686884, -36.9658193686884, -36.9658193686884, -28.16722155344429, -29.16722155344429, -29.16722155344429, -35.935867918591505, -33.935867918591505, -35.935867918591505, -25.871615721063307, -28.371615721063307, -27.871615721063307, -21.777782011374736, -22.777782011374736, -22.777782011374736, -28.179256584669602, -28.679256584669602, -28.679256584669602, -53.93247875986656, -54.93247875986656, -54.93247875986656, -35.46318761452505, -35.46318761452505, -34.96318761452504, -23.841529360509394, -23.841529360509394, -23.841529360509394, -35.252921314303, -37.252921314303, -37.252921314303, -34.82257371966025, -34.82257371966025, -34.32257371966025, -31.20231524703801, -31.20231524703801, -31.20231524703801, -32.97043964855422, -32.97043964855422, -32.97043964855422, -38.1525561712798, -38.652556171279784, -39.152556171279784, -38.323670004736876, -38.323670004736876, -37.323670004736876, -29.241289109123514, -27.241289109123517, -29.241289109123514, -31.136748180648304, -31.136748180648304, -31.136748180648304, -29.22039802005194, -30.72039802005194, -30.72039802005194, -34.392925998657205, -32.89292599865721, -34.392925998657205, -35.02054338945092, -35.02054338945092, -34.02054338945092, -29.02271739555104, -28.52271739555104, -30.02271739555104, -31.362296911608134, -32.362296911608134, -32.362296911608134, -29.184955794584646, -30.184955794584646, -30.684955794584646, -29.835030386527926, -29.835030386527926, -29.835030386527926, -40.93769909942943, -40.93769909942943, -40.93769909942943, -33.999817267220614, -34.499817267220614, -34.499817267220614, -32.9826103137807, -32.9826103137807, -31.982610313780697, -33.85315117715335, -34.85315117715334, -34.35315117715334, -24.275943032988813, -25.275943032988813, -25.275943032988813, -28.839133753497492, -27.839133753497492, -27.839133753497492, -28.435972941272208, -28.435972941272208, -28.435972941272208, -31.169631857102125, -31.169631857102125, -31.169631857102125, -37.6018752971371, -37.6018752971371, -37.6018752971371, -27.071311687922858, -26.571311687922858, -27.071311687922858, -26.807268466931866, -26.807268466931866, -26.307268466931866, -33.71711686013169, -33.71711686013169, -33.71711686013169, -36.75099434292078, -35.25099434292078, -36.75099434292078, -34.06291145612875, -35.062911456128745, -35.062911456128745, -29.468018344169238, -29.468018344169238, -29.468018344169238, -39.47207358889059, -39.47207358889059, -39.47207358889059, -25.739229583844153, -25.739229583844153, -24.239229583844153, -36.776412129915116, -34.776412129915116, -36.776412129915116, -33.44118091862101, -32.44118091862101, -33.44118091862101, -29.56362546369998, -30.06362546369998, -30.06362546369998, -31.70060344090435, -31.70060344090435, -31.70060344090435, -54.00034802451394, -52.00034802451394, -52.50034802451394, -42.610041851049004, -42.610041851049004, -42.110041851049004, -42.324880570567686, -43.824880570567686, -43.324880570567686, -28.668350328532995, -28.168350328532995, -28.668350328532995, -36.07395607605066, -36.07395607605066, -36.07395607605066, -25.50209880939516, -25.50209880939516, -24.00209880939516, -27.40574068421055, -27.40574068421055, -27.40574068421055, -29.292903341069195, -28.292903341069195, -29.792903341069195, -33.26638983124899, -31.766389831248986, -33.26638983124899, -27.57774115040326, -27.07774115040326, -27.57774115040326, -28.03692779845429, -29.53692779845429, -28.53692779845429, -38.76028666391585, -40.76028666391585, -40.76028666391585, -42.30178104857325, -41.80178104857325, -42.30178104857325, -29.402267565217716, -31.402267565217723, -30.402267565217723, -31.472962890111194, -31.472962890111194, -31.472962890111194, -28.8314772964643, -28.8314772964643, -27.8314772964643, -25.642942072890268, -25.642942072890268, -25.642942072890268, -29.900966761779056, -29.900966761779056, -29.900966761779056, -43.500585342820145, -43.000585342820145, -43.500585342820145, -35.329751544873155, -36.329751544873155, -35.329751544873155, -28.783520815217223, -28.783520815217223, -27.783520815217216, -29.311747366920375, -29.311747366920375, -29.311747366920375, -33.66455058445364, -34.16455058445364, -34.16455058445364, -24.443746756737138, -24.443746756737138, -24.443746756737138, -29.20310232275141, -29.20310232275141, -27.203102322751413, -33.2714835227021, -33.2714835227021, -33.2714835227021, -37.195104604407405, -35.19510460440741, -37.195104604407405, -25.306489183266134, -25.306489183266134, -25.306489183266134, -37.31356390382676, -37.31356390382676, -37.31356390382676, -23.926834640091283, -23.926834640091283, -22.926834640091283, -33.342656681238886, -33.342656681238886, -33.342656681238886, -25.488559914864123, -25.488559914864123, -24.988559914864123, -42.68930376256035, -43.68930376256035, -43.68930376256035, -29.085119607962994, -30.085119607962994, -30.085119607962994, -38.273486599592395, -39.273486599592395, -39.273486599592395, -29.158613377500597, -30.158613377500597, -30.158613377500597, -36.011645859303215, -36.011645859303215, -36.011645859303215, -29.752379245531525, -29.252379245531525, -29.752379245531525, -33.03071458371604, -33.03071458371604, -33.03071458371604, -27.238581246247996, -27.238581246247996, -26.238581246247996, -24.48611394290848, -25.48611394290848, -25.48611394290848, -35.80981849148985, -35.80981849148985, -35.80981849148985, -49.812223596640834, -49.812223596640834, -49.312223596640834, -27.88233933291145, -27.88233933291145, -27.88233933291145, -35.95988886821544, -36.45988886821544, -36.45988886821544, -41.031664175066936, -39.53166417506693, -41.031664175066936, -27.507658035028744, -27.507658035028744, -27.507658035028744, -35.06943820186437, -35.06943820186437, -36.06943820186437, -35.83285837877622, -35.83285837877622, -34.33285837877622, -30.746132565207393, -30.746132565207393, -30.746132565207393, -30.358691697215967, -30.358691697215967, -30.358691697215967, -37.471900761240526, -37.471900761240526, -37.471900761240526, -33.01705398726621, -33.01705398726621, -33.01705398726621, -25.668248159689398, -25.668248159689398, -25.668248159689398, -27.726318023141566, -27.226318023141566, -27.726318023141566, -29.938676799074702, -29.938676799074702, -29.938676799074702, -31.655062450886657, -31.655062450886657, -31.655062450886657, -33.37244561489802, -33.37244561489802, -32.37244561489802, -30.455038369623498, -31.955038369623498, -31.955038369623498, -32.31184344345614, -31.311843443456137, -32.81184344345614, -30.289607867031844, -30.289607867031844, -30.289607867031844, -40.53322628261283, -40.03322628261283, -40.53322628261283, -40.67153362466975, -42.671533624669756, -42.671533624669756, -31.398692667767655, -31.398692667767655, -31.398692667767655, -36.45483893263431, -36.45483893263431, -36.45483893263431, -25.22056381692406, -25.22056381692406, -25.22056381692406, -42.388820268271594, -41.888820268271594, -42.388820268271594, -41.344082112030705, -42.344082112030705, -42.344082112030705, -27.5605486821914, -26.5605486821914, -28.0605486821914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31434755304929674, "mean_inference_ms": 1.2723339797830604, "mean_action_processing_ms": 0.07037407590103589, "mean_env_wait_ms": 0.5831214280293934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 60800, "timesteps_this_iter": 0, "agent_timesteps_total": 182400, "timers": {"sample_time_ms": 1558.805, "sample_throughput": 2052.854, "load_time_ms": 0.146, "load_throughput": 21966894.926, "learn_time_ms": 789.147, "learn_throughput": 4055.014, "update_time_ms": 1.822}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005000000000000001, "total_loss": 82.65761108398438, "policy_loss": -0.0021399825810997975, "vf_loss": 82.67452468872071, "vf_explained_var": -0.04601621627807617, "kl": 0.003044050338540094, "entropy": 1.4773752808570861, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60800, "num_agent_steps_sampled": 182400, "num_steps_trained": 60800, "num_agent_steps_trained": 182400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2430, "training_iteration": 19, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-05", "timestamp": 1718736365, "time_this_iter_s": 1.4774625301361084, "time_total_s": 29.275578498840332, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 29.275578498840332, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.65, "ram_util_percent": 30.3}}
{"episode_reward_max": -71.08495718090369, "episode_reward_min": -144.79062475963596, "episode_reward_mean": -96.93404730750274, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -49.930208253212}, "policy_reward_max": {"shared_policy": -23.385525295733938}, "policy_reward_mean": {"shared_policy": -32.31134910250091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.76834073268485, -84.96817520635497, -88.52185378880897, -94.84209674604723, -102.9699932111878, -89.46691133699458, -88.29732870243134, -120.33019992441598, -93.30771521067662, -82.3874476278501, -127.33661754868511, -89.38756450776661, -97.94621761175915, -108.0299382804314, -110.16888185782163, -103.19005760491014, -73.3399321602434, -85.86594354644643, -99.1426211767639, -98.26306997463637, -111.93450162808661, -99.5364371944515, -77.85619652601575, -98.13910144294067, -79.97070460669761, -86.14468996952863, -90.15787588371417, -94.69804550014656, -118.46060429833767, -115.13489681438217, -98.98983574088084, -88.74290101665576, -80.14558446888739, -94.24510513368163, -118.98741847824303, -92.02408495191365, -78.31768751530254, -91.49095278536086, -83.42397299111843, -84.57736014398297, -116.12910891587475, -75.47812143318487, -101.57662723660782, -88.2908689838594, -81.69956695576678, -102.31885234438799, -96.06216738192447, -101.4171764827507, -90.33981269253938, -89.51971885138904, -93.45665662810248, -94.11066582015663, -88.36408577602934, -89.6703776154732, -84.08597139661302, -98.59761545021736, -105.76581388126814, -77.08592041072257, -92.24947887289889, -118.27942767980386, -87.75132924865343, -117.00592150429611, -88.86938107152801, -95.68042152443662, -100.11287402330674, -86.85984462776922, -76.96678411909856, -104.38622602868207, -88.25980781162662, -85.18157448215021, -91.48165389343642, -99.60494967882838, -99.22404391967717, -108.88925480638386, -96.3534875154459, -110.98625167236948, -101.77205884310591, -117.67364600572934, -104.03268159039611, -143.8950264114162, -78.897733247198, -109.59522424587963, -92.58162092039287, -115.56762998439325, -118.19336537429318, -94.54929995674401, -73.77233802598269, -123.28171958437203, -110.42690246867491, -86.3667050064847, -103.57916726298541, -74.16402974644596, -82.04344232002673, -127.96318192382267, -78.25435860538205, -89.8886962716599, -88.67677792471734, -108.8268817823415, -93.55237364288998, -95.16220221848427, -104.93856499042965, -72.15657588720184, -99.29804784975418, -100.19109393847923, -98.61454297284638, -85.87738486732336, -107.60514742270905, -96.55327473061745, -96.11086828239728, -80.75532660991479, -99.11379517881888, -79.44089890503773, -93.59953579982414, -108.32596219422841, -114.43739034504061, -92.70754884974005, -103.47061284439339, -85.82782188909468, -144.79062475963596, -93.07500272044004, -116.68878350300274, -71.08495718090369, -114.21512854140849, -83.5285661487064, -81.2608530924724, -86.53997275747355, -112.08897016687806, -135.3021371219085, -77.82178693086189, -121.66720554549009], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-29.92278024422828, -29.92278024422828, -28.92278024422828, -28.322725068784983, -28.322725068784983, -28.322725068784983, -29.507284596269663, -29.507284596269663, -29.507284596269663, -31.61403224868244, -31.61403224868244, -31.61403224868244, -34.323331070395916, -34.823331070395916, -33.823331070395916, -29.82230377899818, -29.82230377899818, -29.82230377899818, -29.432442900810447, -29.432442900810447, -29.432442900810447, -40.11006664147201, -40.11006664147201, -40.11006664147201, -30.43590507022555, -31.43590507022555, -31.43590507022555, -27.129149209283373, -28.129149209283373, -27.129149209283373, -42.445539182895025, -42.445539182895025, -42.445539182895025, -29.962521502588896, -29.962521502588896, -29.462521502588892, -32.648739203919725, -32.648739203919725, -32.648739203919725, -36.50997942681049, -35.00997942681049, -36.50997942681049, -37.389627285940534, -35.389627285940534, -37.389627285940534, -34.73001920163669, -34.73001920163669, -33.73001920163669, -24.61331072008114, -24.11331072008114, -24.61331072008114, -28.6219811821488, -28.6219811821488, -28.6219811821488, -33.047540392254625, -33.047540392254625, -33.047540392254625, -33.08768999154545, -32.08768999154545, -33.08768999154545, -37.31150054269555, -37.31150054269555, -37.31150054269555, -32.678812398150505, -33.178812398150505, -33.678812398150505, -26.11873217533858, -25.61873217533858, -26.11873217533858, -32.71303381431356, -32.71303381431356, -32.71303381431356, -26.656901535565865, -26.656901535565865, -26.656901535565865, -29.71489665650953, -29.71489665650953, -26.714896656509534, -30.052625294571385, -30.052625294571385, -30.052625294571385, -31.899348500048855, -31.899348500048855, -30.899348500048855, -39.486868099445914, -39.486868099445914, -39.486868099445914, -38.378298938127394, -38.378298938127394, -38.378298938127394, -32.99661191362694, -32.99661191362694, -32.99661191362694, -29.580967005551923, -29.580967005551923, -29.580967005551923, -27.215194822962467, -27.215194822962467, -25.715194822962467, -31.41503504456052, -31.41503504456052, -31.41503504456052, -39.995806159414364, -38.995806159414364, -39.995806159414364, -31.174694983971232, -31.174694983971232, -29.674694983971232, -25.77256250510083, -25.77256250510083, -26.77256250510083, -30.163650928453613, -30.663650928453613, -30.663650928453613, -27.807990997039518, -27.807990997039518, -27.807990997039518, -28.52578671466102, -27.52578671466102, -28.52578671466102, -38.70970297195825, -38.70970297195825, -38.70970297195825, -25.49270714439495, -25.49270714439495, -24.49270714439495, -33.52554241220262, -34.02554241220262, -34.02554241220262, -29.596956327953137, -30.096956327953137, -28.596956327953137, -27.233188985255595, -27.233188985255595, -27.233188985255595, -34.10628411479599, -34.10628411479599, -34.10628411479599, -32.02072246064148, -32.02072246064148, -32.02072246064148, -33.472392160916904, -33.472392160916904, -34.472392160916904, -30.113270897513125, -30.113270897513125, -30.113270897513125, -30.67323961712967, -29.67323961712967, -29.17323961712967, -30.152218876034155, -31.652218876034155, -31.652218876034155, -31.703555273385568, -31.703555273385568, -30.703555273385568, -29.45469525867644, -29.45469525867644, -29.45469525867644, -29.890125871824402, -29.890125871824402, -29.890125871824402, -27.028657132204334, -28.528657132204334, -28.528657132204334, -32.8658718167391, -32.8658718167391, -32.8658718167391, -33.92193796042271, -35.9219379604227, -35.9219379604227, -25.361973470240862, -25.861973470240862, -25.861973470240862, -31.2498262909663, -29.7498262909663, -31.2498262909663, -39.759809226601256, -39.759809226601256, -38.759809226601256, -29.250443082884452, -29.250443082884452, -29.250443082884452, -38.335307168098694, -39.3353071680987, -39.3353071680987, -30.289793690509363, -28.789793690509363, -29.789793690509363, -31.893473841478887, -31.893473841478887, -31.893473841478887, -33.37095800776891, -33.37095800776891, -33.37095800776891, -28.953281542589753, -29.453281542589753, -28.453281542589753, -25.822261373032838, -25.822261373032838, -25.322261373032838, -34.128742009560696, -35.128742009560696, -35.128742009560696, -29.253269270542226, -29.253269270542226, -29.753269270542226, -28.060524827383418, -28.560524827383418, -28.560524827383418, -30.8272179644788, -30.8272179644788, -29.8272179644788, -32.86831655960944, -33.36831655960944, -33.36831655960944, -33.07468130655906, -33.07468130655906, -33.07468130655906, -36.296418268794625, -36.296418268794625, -36.296418268794625, -32.11782917181529, -32.11782917181529, -32.11782917181529, -35.32875055745646, -37.82875055745645, -37.82875055745645, -33.25735294770197, -34.25735294770197, -34.25735294770197, -39.224548668576446, -39.224548668576446, -39.224548668576446, -34.34422719679872, -34.84422719679872, -34.84422719679872, -47.298342137138725, -48.298342137138725, -48.298342137138725, -26.299244415732677, -26.299244415732677, -26.299244415732677, -36.865074748626526, -35.865074748626526, -36.865074748626526, -31.027206973464278, -31.027206973464278, -30.527206973464278, -37.855876661464436, -38.855876661464436, -38.855876661464436, -39.39778845809771, -39.39778845809771, -39.39778845809771, -31.51643331891465, -31.51643331891465, -31.51643331891465, -24.590779341994228, -24.590779341994228, -24.590779341994228, -41.76057319479066, -41.26057319479066, -40.26057319479066, -36.808967489558285, -36.808967489558285, -36.808967489558285, -28.788901668828238, -28.788901668828238, -28.788901668828238, -34.693055754328476, -34.193055754328476, -34.693055754328476, -24.72134324881531, -24.72134324881531, -24.72134324881531, -27.6811474400089, -27.6811474400089, -26.6811474400089, -42.82106064127425, -42.82106064127425, -42.32106064127424, -26.08478620179401, -26.08478620179401, -26.08478620179401, -30.12956542388662, -30.12956542388662, -29.62956542388662, -29.558925974905772, -29.558925974905772, -29.558925974905772, -36.27562726078051, -36.27562726078051, -36.27562726078051, -31.184124547630006, -31.184124547630006, -31.184124547630006, -32.054067406161394, -31.054067406161398, -32.054067406161394, -35.47952166347654, -35.47952166347654, -33.97952166347654, -24.385525295733938, -23.385525295733938, -24.385525295733938, -33.09934928325137, -33.09934928325137, -33.09934928325137, -34.39703131282643, -31.39703131282643, -34.39703131282643, -32.87151432428213, -32.87151432428213, -32.87151432428213, -28.792461622441095, -28.292461622441095, -28.792461622441095, -35.868382474236334, -35.868382474236334, -35.868382474236334, -32.51775824353916, -31.51775824353917, -32.51775824353916, -32.53695609413241, -32.53695609413241, -31.036956094132403, -27.41844220330493, -27.41844220330493, -25.918442203304924, -31.704598392939623, -33.70459839293963, -33.70459839293963, -26.480299635012578, -26.480299635012578, -26.480299635012578, -31.199845266608044, -31.199845266608044, -31.199845266608044, -36.10865406474281, -36.10865406474281, -36.10865406474281, -37.47913011501355, -38.47913011501355, -38.47913011501355, -31.235849616580026, -30.235849616580026, -31.235849616580026, -32.49020428146446, -35.49020428146446, -35.49020428146446, -29.60927396303157, -27.60927396303157, -28.60927396303157, -44.930208253212, -49.930208253212, -49.930208253212, -31.358334240146686, -30.358334240146686, -31.358334240146686, -39.062927834334246, -38.562927834334246, -39.062927834334246, -23.694985726967897, -23.694985726967897, -23.694985726967897, -37.07170951380283, -38.07170951380283, -39.07170951380283, -27.509522049568783, -28.009522049568783, -28.009522049568783, -27.086951030824114, -27.086951030824114, -27.086951030824114, -28.846657585824513, -28.846657585824513, -28.846657585824513, -37.69632338895937, -36.69632338895937, -37.69632338895937, -45.26737904063618, -45.26737904063618, -44.76737904063618, -25.94059564362062, -25.94059564362062, -25.94059564362062, -40.389068515163366, -40.889068515163366, -40.389068515163366]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3187381146643576, "mean_inference_ms": 1.2900909582649684, "mean_action_processing_ms": 0.07124699534633869, "mean_env_wait_ms": 0.5901876119426817, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 64000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 1577.635, "sample_throughput": 2028.352, "load_time_ms": 0.147, "load_throughput": 21827570.011, "learn_time_ms": 801.56, "learn_throughput": 3992.214, "update_time_ms": 1.859}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 78.62966384887696, "policy_loss": -0.0026849767511982316, "vf_loss": 78.64710388183593, "vf_explained_var": -0.03256897926330567, "kl": 0.0033843774517483523, "entropy": 1.4753873229026795, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 192000, "num_steps_trained": 64000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2560, "training_iteration": 20, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-07", "timestamp": 1718736367, "time_this_iter_s": 1.8798911571502686, "time_total_s": 31.1554696559906, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219bdc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 31.1554696559906, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.9, "ram_util_percent": 30.3}}
{"episode_reward_max": -71.46887769112317, "episode_reward_min": -128.39549662173252, "episode_reward_mean": -98.0626371444524, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -43.63183220724417}, "policy_reward_max": {"shared_policy": -23.65629256370771}, "policy_reward_mean": {"shared_policy": -32.68754571481746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-87.19605448795389, -95.61153899576885, -122.27253256749371, -108.3787899355301, -105.83323721753406, -89.44389694644345, -126.59588278122894, -109.24458997174548, -105.29956505818099, -79.30876330584141, -94.86562427251275, -82.551023015987, -115.38925907305604, -100.24579454120783, -121.73937985274216, -96.09523506011345, -108.40727682807959, -84.84070928067575, -93.14812029681318, -71.46887769112317, -107.89402649334404, -115.22182232512426, -94.67315914296486, -80.24843595804842, -75.99525265629565, -92.06517564083676, -95.71299280007702, -103.86368378269174, -109.87138945289055, -97.00825605365611, -128.39549662173252, -91.62202622928703, -102.31638305267305, -118.64368994905207, -90.08580404268515, -100.87270181722914, -115.19973952187294, -85.88789519933248, -71.98436271133563, -91.54895771904656, -106.54838326887767, -100.75432979414487, -110.93543446450619, -93.48095180210322, -108.82560608294085, -112.3623519461176, -121.54337559570493, -115.48425265722533, -73.50466831521453, -95.73913638558221, -108.12577804830032, -106.7815667153307, -101.4159370128504, -109.35987216527379, -119.1563482604399, -82.72865220919829, -126.70077445512274, -100.74286156928346, -89.494352709331, -90.98664000119356, -96.47518116381544, -112.9592185167035, -98.47645197498083, -126.27472405744368, -92.41192717202941, -79.9814773492043, -76.2002944755774, -89.8541578503822, -81.52655859851242, -93.47730886142739, -80.25713780763535, -93.42493051222147, -91.93401707229788, -87.60885182341342, -81.22966799585687, -73.1916642436386, -95.34184942990845, -80.2992544591767, -101.35318225819185, -107.72837166584546, -93.36491384770767, -84.65414523042786, -106.63218293309069, -124.51954497405495, -90.01071797448354, -92.29308259561542, -73.2559356838481, -122.5679013756078, -84.68423190865076, -80.3544660056688, -74.05385731349504, -95.80319605294608, -101.4422737754371, -114.77662743280267, -116.20012679495076, -88.19648058058694, -113.95616056072352, -97.2031366018216, -87.06037101838086, -92.18105577068779, -110.79519035603532, -77.41162641949343, -121.73753121866946, -114.09316950232582, -91.13032573923792, -105.76522525014725, -87.09198043015334, -110.45219236784108, -93.13919097312493, -83.72799353111131, -127.1972467281908, -90.71465266513216, -99.39104706725769, -84.79340781360742, -95.75834523635503, -105.5150342891487, -82.20238829226908, -79.69827846027839, -96.39204674230065, -95.57427272340804], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-28.39868482931796, -29.39868482931796, -29.39868482931796, -32.537179665256275, -31.537179665256275, -31.537179665256275, -41.75751085583121, -39.25751085583121, -41.25751085583121, -35.459596645176674, -36.459596645176674, -36.459596645176674, -35.27774573917801, -35.27774573917801, -35.27774573917801, -29.481298982147795, -29.981298982147795, -29.981298982147795, -43.03196092707631, -41.03196092707631, -42.53196092707631, -36.41486332391514, -36.41486332391514, -36.41486332391514, -35.09985501939363, -35.09985501939363, -35.09985501939363, -26.436254435280468, -26.436254435280468, -26.436254435280468, -32.12187475750425, -31.12187475750425, -31.62187475750425, -26.183674338662325, -28.183674338662325, -28.183674338662325, -37.12975302435202, -39.12975302435201, -39.12975302435201, -33.08193151373594, -33.58193151373594, -33.58193151373594, -40.9131266175807, -39.91312661758071, -40.9131266175807, -32.198411686704475, -31.69841168670447, -32.198411686704475, -36.1357589426932, -36.1357589426932, -36.1357589426932, -28.28023642689188, -28.28023642689188, -28.28023642689188, -28.38270676560439, -32.38270676560438, -32.38270676560438, -24.15629256370771, -23.65629256370771, -23.65629256370771, -36.29800883111466, -35.298008831114664, -36.29800883111466, -38.573940775041414, -39.073940775041414, -37.573940775041414, -31.891053047654957, -32.39105304765496, -30.391053047654957, -26.74947865268279, -26.74947865268279, -26.74947865268279, -25.331750885431877, -25.331750885431877, -25.331750885431877, -30.85505854694558, -30.35505854694558, -30.85505854694558, -32.07099760002566, -31.070997600025663, -32.57099760002566, -34.28789459423057, -34.28789459423057, -35.28789459423057, -36.29046315096353, -36.79046315096353, -36.79046315096353, -31.33608535121871, -32.33608535121871, -33.33608535121871, -42.63183220724417, -43.63183220724417, -42.13183220724417, -31.04067540976234, -30.54067540976234, -30.04067540976234, -33.938794350890994, -34.438794350890994, -33.938794350890994, -39.54789664968405, -39.54789664968405, -39.54789664968405, -30.19526801422841, -29.69526801422841, -30.19526801422841, -33.957567272409705, -33.957567272409705, -32.957567272409705, -37.733246507291, -38.733246507291, -38.733246507291, -28.295965066444175, -28.295965066444175, -29.295965066444175, -23.994787570445215, -23.994787570445215, -23.994787570445215, -30.84965257301551, -29.84965257301551, -30.84965257301551, -35.51612775629255, -35.51612775629255, -35.51612775629255, -33.25144326471494, -33.75144326471494, -33.75144326471494, -37.97847815483538, -36.97847815483538, -35.97847815483538, -30.493650600701045, -31.493650600701045, -31.493650600701045, -36.77520202764696, -35.27520202764696, -36.77520202764696, -36.78745064870585, -38.28745064870585, -37.28745064870585, -40.18112519856834, -40.68112519856834, -40.68112519856834, -38.661417552408416, -38.661417552408416, -38.161417552408416, -25.00155610507153, -24.50155610507153, -24.00155610507153, -32.07971212852741, -31.57971212852741, -32.07971212852741, -36.70859268276676, -36.70859268276676, -34.70859268276676, -35.76052223844356, -35.76052223844356, -35.26052223844356, -34.13864567095014, -34.13864567095014, -33.13864567095014, -36.45329072175791, -36.45329072175791, -36.45329072175791, -40.21878275347995, -38.71878275347995, -40.21878275347995, -27.909550736399417, -26.909550736399417, -27.909550736399417, -41.900258151707604, -42.400258151707604, -42.400258151707604, -33.58095385642782, -33.58095385642782, -33.58095385642782, -29.498117569776994, -29.498117569776994, -30.498117569777, -30.828880000397852, -29.328880000397852, -30.828880000397852, -32.658393721271764, -32.658393721271764, -31.158393721271764, -38.81973950556784, -36.31973950556784, -37.81973950556784, -33.49215065832694, -33.49215065832694, -31.49215065832694, -41.591574685814535, -42.59157468581453, -42.09157468581453, -30.8039757240098, -30.8039757240098, -30.8039757240098, -25.827159116401447, -28.327159116401447, -25.827159116401447, -25.40009815852581, -24.90009815852581, -25.90009815852581, -31.61805261679408, -28.11805261679408, -30.11805261679408, -26.508852866170795, -27.50885286617079, -27.50885286617079, -29.492436287142457, -31.992436287142457, -31.992436287142457, -26.75237926921178, -26.75237926921178, -26.75237926921178, -31.141643504073823, -31.141643504073823, -31.141643504073823, -31.144672357432636, -30.644672357432636, -30.144672357432636, -29.536283941137807, -29.536283941137807, -28.536283941137807, -27.576555998618957, -26.076555998618957, -27.576555998618957, -24.397221414546195, -24.397221414546195, -24.397221414546195, -30.28061647663614, -31.78061647663614, -33.28061647663615, -26.09975148639224, -27.09975148639224, -27.09975148639224, -33.95106075273059, -33.45106075273059, -33.95106075273059, -35.9094572219485, -35.9094572219485, -35.9094572219485, -31.95497128256923, -31.45497128256923, -29.95497128256923, -28.71804841014262, -28.21804841014262, -27.71804841014262, -34.5440609776969, -36.044060977696894, -36.044060977696894, -41.50651499135163, -41.50651499135163, -41.50651499135163, -30.003572658161183, -30.003572658161183, -30.003572658161183, -30.764360865205145, -30.764360865205145, -30.764360865205145, -23.751978561282687, -25.25197856128269, -24.251978561282687, -39.85596712520259, -41.35596712520259, -41.35596712520259, -27.561410636216905, -28.561410636216905, -28.561410636216905, -26.618155335222923, -27.618155335222923, -26.118155335222923, -24.684619104498346, -24.684619104498346, -24.684619104498346, -32.601065350982005, -30.601065350982, -32.601065350982005, -34.4807579251457, -33.4807579251457, -33.48075792514571, -38.25887581093422, -38.25887581093422, -38.25887581093422, -38.73337559831695, -38.73337559831695, -38.73337559831695, -29.398826860195637, -29.398826860195637, -29.398826860195637, -37.318720186907846, -38.318720186907846, -38.318720186907846, -32.401045533940525, -32.401045533940525, -32.401045533940525, -29.186790339460284, -29.686790339460284, -28.186790339460284, -31.060351923562582, -30.560351923562582, -30.560351923562582, -36.93173011867843, -36.93173011867843, -36.93173011867843, -26.470542139831135, -25.47054213983114, -25.470542139831135, -40.745843739556506, -40.245843739556506, -40.745843739556506, -38.031056500775286, -38.031056500775286, -38.031056500775286, -30.71010857974597, -30.71010857974597, -29.71010857974597, -33.92174175004909, -35.92174175004909, -35.92174175004909, -29.030660143384456, -29.030660143384456, -29.030660143384456, -36.484064122613674, -36.98406412261367, -36.98406412261367, -31.046396991041654, -31.046396991041654, -31.046396991041654, -26.90933117703708, -27.40933117703708, -29.40933117703708, -42.56574890939694, -42.56574890939694, -42.06574890939694, -30.571550888377384, -30.571550888377384, -29.571550888377384, -32.46368235575255, -33.46368235575255, -33.46368235575255, -27.93113593786914, -27.93113593786914, -28.93113593786914, -31.919448412118335, -31.919448412118335, -31.919448412118335, -35.83834476304957, -34.83834476304957, -34.83834476304957, -27.06746276408969, -27.06746276408969, -28.06746276408969, -27.399426153426127, -24.899426153426127, -27.399426153426127, -31.630682247433548, -31.630682247433544, -33.13068224743354, -31.191424241136005, -32.191424241136005, -32.191424241136005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3216771670811021, "mean_inference_ms": 1.303362906679762, "mean_action_processing_ms": 0.0719352201981978, "mean_env_wait_ms": 0.5952876338893469, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 67200, "timesteps_this_iter": 0, "agent_timesteps_total": 201600, "timers": {"sample_time_ms": 1607.141, "sample_throughput": 1991.114, "load_time_ms": 0.146, "load_throughput": 21974087.754, "learn_time_ms": 802.009, "learn_throughput": 3989.98, "update_time_ms": 1.877}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005000000000000001, "total_loss": 84.34455718994141, "policy_loss": -0.003157937631282648, "vf_loss": 84.36239776611328, "vf_explained_var": -0.03927338123321533, "kl": 0.004710779286515576, "entropy": 1.4685888171195984, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67200, "num_agent_steps_sampled": 201600, "num_steps_trained": 67200, "num_agent_steps_trained": 201600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2680, "training_iteration": 21, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-09", "timestamp": 1718736369, "time_this_iter_s": 1.7297687530517578, "time_total_s": 32.88523840904236, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924634c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 32.88523840904236, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.53333333333334, "ram_util_percent": 30.233333333333334}}
{"episode_reward_max": -70.00631284844302, "episode_reward_min": -137.3923439544807, "episode_reward_mean": -95.82823672511404, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -46.376919278925264}, "policy_reward_max": {"shared_policy": -22.668770949481015}, "policy_reward_mean": {"shared_policy": -31.942745575038014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-100.22918826855265, -77.65338835636965, -71.8609532470973, -88.75846639514324, -91.84851031498151, -82.62357660429166, -91.76320992246664, -77.20512798263562, -117.13770949042832, -98.0127138811955, -96.33348908320488, -123.29670963856617, -105.35712841919732, -93.1535229923101, -93.88596607936508, -82.02766301987896, -105.52206246338788, -76.88321934140814, -79.76931865602577, -89.84219509367651, -86.88649353774795, -88.74268958155302, -100.5819973430909, -86.43859841498386, -102.11183247870382, -88.94791029468689, -102.82292998165615, -114.606446804011, -91.40705580846446, -92.16376510409918, -98.65430066169796, -114.76901093002164, -78.83144475522677, -102.0020567813555, -80.18880328602101, -106.10133520073231, -99.25747615012003, -103.81737899846937, -86.56325197285152, -99.4721019977562, -71.4672130778793, -111.47654478235509, -110.89142646844013, -106.8891643507061, -106.27045190347081, -87.2666048647856, -79.38267129955776, -136.66904657227323, -91.76157839846313, -117.86702517717707, -89.95016207951313, -97.30078833695522, -107.17082641420897, -103.75695055158184, -95.02874944864915, -107.53350304242403, -137.3923439544807, -93.53111829674584, -107.60908356358395, -85.43208758955292, -107.1980881605534, -111.00932646065984, -107.26720108422552, -88.22362055886916, -84.13436467818066, -97.27450637094205, -104.91676416854838, -77.51664675144958, -116.38314329499637, -88.28443845954406, -86.93588684190372, -97.87146028222503, -100.15338817368031, -103.91240646095297, -81.95569574349872, -98.81009787714831, -94.1855399889224, -95.48042756345289, -88.70746691595686, -91.9294085188058, -79.16792433095024, -92.83254400346249, -78.9450856474268, -75.77387158239883, -87.0977963696963, -82.96351436133183, -100.52744343770063, -102.99530978404636, -94.70399986784574, -103.9984583494896, -93.9179975380346, -97.25001854682247, -95.66486144395836, -93.03402782814693, -82.66772690252891, -70.00631284844302, -92.8587283472098, -114.80424203887605, -70.54389259702197, -119.19758795358587, -80.69515650987101, -74.93234430967561, -93.82662403338793, -90.58040066177414, -100.75523574222636, -92.66807067680436, -94.52723607980943, -135.63075783677567, -90.47164254680064, -95.22545156489683, -98.88078097760761, -83.76420488967487, -82.81176702036602, -121.35520786756065, -119.8878082609484, -84.49471075844743, -98.52995229204664, -76.88842400060214, -112.91546684074115, -133.9300525542131, -97.76118710166547, -92.89205154955819, -90.68870126208128, -89.21560077067197, -109.55177375172934, -93.24587466065671, -96.56156994014503, -81.74421893176934, -78.82302778224441, -101.13591145034506], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-31.90972942285089, -34.40972942285089, -33.90972942285089, -25.884462785456513, -25.884462785456513, -25.884462785456513, -24.120317749032427, -24.120317749032427, -23.620317749032427, -29.086155465047742, -31.086155465047742, -28.586155465047742, -30.949503438327188, -30.949503438327188, -29.949503438327188, -27.54119220143056, -27.54119220143056, -27.54119220143056, -31.421069974155525, -28.421069974155525, -31.921069974155525, -25.735042660878527, -25.735042660878527, -25.735042660878527, -39.04590316347608, -39.04590316347608, -39.04590316347608, -32.670904627065156, -32.670904627065156, -32.670904627065156, -32.11116302773497, -32.11116302773497, -32.11116302773497, -41.765569879522054, -41.265569879522054, -40.265569879522054, -35.1190428063991, -35.1190428063991, -35.1190428063991, -31.384507664103353, -31.384507664103353, -30.384507664103353, -31.295322026455025, -31.295322026455025, -31.295322026455025, -27.009221006626326, -27.509221006626326, -27.509221006626326, -34.84068748779596, -35.34068748779596, -35.34068748779596, -25.794406447136048, -24.794406447136048, -26.294406447136048, -26.25643955200857, -26.75643955200857, -26.75643955200857, -30.447398364558847, -30.447398364558847, -28.947398364558847, -29.128831179249318, -28.628831179249318, -29.128831179249318, -28.91422986051765, -29.91422986051765, -29.91422986051765, -33.527332447696985, -33.527332447696985, -33.527332447696985, -28.81286613832795, -28.81286613832795, -28.81286613832795, -34.37061082623461, -34.37061082623461, -33.37061082623461, -28.98263676489562, -29.98263676489562, -29.98263676489562, -33.274309993885375, -35.274309993885375, -34.274309993885375, -38.20214893467035, -38.20214893467035, -38.20214893467035, -29.802351936154814, -30.802351936154814, -30.802351936154814, -31.054588368033077, -30.054588368033077, -31.054588368033077, -32.884766887232665, -32.884766887232665, -32.884766887232665, -36.92300364334054, -38.92300364334056, -38.92300364334056, -25.61048158507559, -26.61048158507559, -26.61048158507559, -34.667352260451835, -34.667352260451835, -32.66735226045183, -26.896267762007014, -26.896267762007014, -26.396267762007014, -34.700445066910774, -35.700445066910774, -35.700445066910774, -33.08582538337334, -33.08582538337334, -33.08582538337334, -34.772459666156436, -34.272459666156436, -34.772459666156436, -28.854417324283844, -28.854417324283844, -28.854417324283844, -33.15736733258538, -33.15736733258538, -33.15736733258538, -24.155737692626435, -24.155737692626435, -23.155737692626438, -37.492181594118335, -36.49218159411834, -37.492181594118335, -37.46380882281338, -35.96380882281338, -37.46380882281338, -36.12972145023538, -36.62972145023538, -34.12972145023538, -35.42348396782362, -35.42348396782362, -35.42348396782362, -29.755534954928528, -27.755534954928528, -29.755534954928528, -26.627557099852552, -26.627557099852552, -26.127557099852552, -45.55634885742442, -45.55634885742442, -45.55634885742442, -29.920526132821067, -30.920526132821067, -30.920526132821067, -39.28900839239233, -39.28900839239233, -39.28900839239233, -29.65005402650439, -30.15005402650439, -30.15005402650439, -32.43359611231841, -32.43359611231841, -32.43359611231841, -35.723608804736315, -35.723608804736315, -35.723608804736315, -35.91898351719396, -35.91898351719396, -31.918983517193954, -31.67624981621641, -31.67624981621641, -31.67624981621641, -35.844501014141365, -35.844501014141365, -35.844501014141365, -46.1307813181602, -45.6307813181602, -45.6307813181602, -31.510372765581952, -31.510372765581952, -30.510372765581952, -34.703027854528, -36.703027854528, -36.203027854528, -28.81069586318432, -27.810695863184318, -28.81069586318432, -35.73269605351779, -35.73269605351779, -35.73269605351779, -37.003108820219936, -37.003108820219936, -37.003108820219936, -35.922400361408485, -35.922400361408485, -35.422400361408485, -29.907873519623045, -28.407873519623045, -29.907873519623045, -28.37812155939354, -27.87812155939354, -27.87812155939354, -32.09150212364736, -32.59150212364736, -32.59150212364736, -35.47225472284948, -34.47225472284947, -34.97225472284948, -25.505548917149863, -25.005548917149863, -27.005548917149863, -37.794381098332124, -39.294381098332124, -39.294381098332124, -29.76147948651467, -28.76147948651467, -29.76147948651467, -28.645295613967917, -29.145295613967917, -29.145295613967917, -33.12382009407502, -33.62382009407502, -31.123820094075022, -33.38446272456009, -33.38446272456009, -33.38446272456009, -34.970802153650986, -34.970802153650986, -33.970802153650986, -27.48523191449958, -26.98523191449958, -27.48523191449958, -33.270032625716105, -33.270032625716105, -32.270032625716105, -31.561846662974144, -31.061846662974144, -31.561846662974144, -31.826809187817624, -31.826809187817624, -31.826809187817624, -29.90248897198563, -29.90248897198563, -28.90248897198563, -30.809802839601932, -29.809802839601932, -31.309802839601932, -26.389308110316765, -26.389308110316765, -26.389308110316765, -31.444181334487503, -29.944181334487503, -31.444181334487503, -26.31502854914226, -26.31502854914226, -26.31502854914226, -25.25795719413294, -25.25795719413294, -25.25795719413294, -29.532598789898746, -28.032598789898746, -29.532598789898746, -27.654504787110614, -27.654504787110614, -27.654504787110614, -33.50914781256685, -33.50914781256685, -33.50914781256685, -34.331769928015454, -34.331769928015454, -34.331769928015454, -31.567999955948572, -31.567999955948572, -31.567999955948572, -34.66615278316319, -34.66615278316319, -34.66615278316319, -31.30599917934483, -31.30599917934483, -31.30599917934483, -32.58333951560749, -32.58333951560749, -32.08333951560749, -31.88828714798612, -31.88828714798612, -31.88828714798612, -31.0113426093823, -31.0113426093823, -31.0113426093823, -27.722575634176277, -27.222575634176277, -27.722575634176277, -23.668770949481015, -22.668770949481015, -23.668770949481015, -30.952909449069953, -30.952909449069953, -30.952909449069953, -38.26808067962534, -38.26808067962534, -38.26808067962534, -23.51463086567397, -23.51463086567397, -23.51463086567397, -40.232529317861946, -40.232529317861946, -38.73252931786194, -27.398385503290342, -25.898385503290342, -27.398385503290342, -24.97744810322521, -24.97744810322521, -24.97744810322521, -31.9422080111293, -29.9422080111293, -31.9422080111293, -28.860133553924705, -30.860133553924705, -30.860133553924705, -33.58507858074215, -33.58507858074215, -33.58507858074215, -30.889356892268133, -30.889356892268133, -30.889356892268133, -31.342412026603164, -30.842412026603164, -32.342412026603164, -46.376919278925264, -44.87691927892526, -44.376919278925264, -30.1572141822669, -30.1572141822669, -30.1572141822669, -31.075150521632263, -32.07515052163227, -32.07515052163227, -32.960260325869214, -32.960260325869214, -32.960260325869214, -26.58806829655831, -28.58806829655831, -28.58806829655831, -27.603922340122004, -27.603922340122004, -27.603922340122004, -40.61840262252021, -40.61840262252021, -40.11840262252021, -40.62926942031613, -40.62926942031613, -38.62926942031613, -28.164903586149133, -28.164903586149133, -28.164903586149133, -33.009984097348884, -33.009984097348884, -32.509984097348884, -25.62947466686738, -25.62947466686738, -25.62947466686738, -37.63848894691372, -37.63848894691372, -37.63848894691372, -44.31001751807101, -44.81001751807101, -44.81001751807101, -32.7537290338885, -32.7537290338885, -32.2537290338885, -31.29735051651941, -30.297350516519415, -31.29735051651941, -30.896233754027072, -30.896233754027072, -28.896233754027072, -28.738533590223998, -30.238533590223998, -30.238533590223998, -36.51725791724311, -36.51725791724311, -36.51725791724311, -31.24862488688557, -31.24862488688557, -30.74862488688557, -32.687189980048345, -31.687189980048345, -32.187189980048345, -27.414739643923102, -27.414739643923102, -26.914739643923102, -26.941009260748128, -24.941009260748135, -26.941009260748128, -34.04530381678168, -33.045303816781676, -34.04530381678168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32249401787637466, "mean_inference_ms": 1.3055049937957564, "mean_action_processing_ms": 0.07203299456437767, "mean_env_wait_ms": 0.5966321325931948, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 70400, "timesteps_this_iter": 0, "agent_timesteps_total": 211200, "timers": {"sample_time_ms": 1604.924, "sample_throughput": 1993.864, "load_time_ms": 0.143, "load_throughput": 22354718.188, "learn_time_ms": 802.689, "learn_throughput": 3986.6, "update_time_ms": 1.867}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 79.14019622802735, "policy_loss": -0.00318182340275962, "vf_loss": 79.15805587768554, "vf_explained_var": -0.05443216562271118, "kl": 0.005367236631096844, "entropy": 1.467439305782318, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 70400, "num_agent_steps_sampled": 211200, "num_steps_trained": 70400, "num_agent_steps_trained": 211200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2810, "training_iteration": 22, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-10", "timestamp": 1718736370, "time_this_iter_s": 1.566063642501831, "time_total_s": 34.45130205154419, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 34.45130205154419, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 42.349999999999994, "ram_util_percent": 30.35}}
{"episode_reward_max": -71.498533548314, "episode_reward_min": -143.03070161897315, "episode_reward_mean": -97.02815863328914, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.01023387299102}, "policy_reward_max": {"shared_policy": -23.580222033422164}, "policy_reward_mean": {"shared_policy": -32.34271954442971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.93462913991074, -94.76415704321897, -102.15117602725108, -99.03208516203367, -97.29413684658503, -113.92330990482999, -89.0737021329718, -98.0515522477119, -85.56927823302985, -115.47135265204533, -81.30182427507702, -106.5938219077601, -81.43492530389997, -84.48034391028881, -89.30222152989417, -97.70571515236475, -101.19797450192614, -92.87146835335479, -79.80234043718798, -104.11341437800186, -90.9191906011873, -115.46994409285097, -81.8182306078461, -118.95497244088332, -75.38666285772975, -84.68609783343663, -85.329222740365, -111.43624821323006, -82.25864152246625, -103.04940389690331, -99.84818232161669, -88.21669214587718, -79.90314146936448, -80.77937240679123, -104.98312088639936, -83.86780159814138, -85.45288585668266, -79.86707277816397, -88.6275252163098, -103.7017942855972, -72.63707998747789, -91.38338640240966, -71.498533548314, -97.17069655769234, -98.35360344048998, -83.12544433521599, -94.44929674335305, -135.29675552629126, -96.86773798462816, -110.36700911402392, -95.46593617756382, -99.15610592326384, -88.08135814131218, -107.49054025437101, -122.07693548600061, -88.62668286854372, -107.6503799281992, -86.75694151096718, -109.22004738277734, -84.9340182864043, -98.6570197795529, -110.97116494789209, -121.28924759407845, -117.64092003331648, -80.11857215456037, -93.50401423883937, -77.68501382085029, -100.4832831500654, -97.3272018390003, -88.48622826797086, -108.02899365487556, -93.70595278974166, -122.42785519934505, -143.03070161897315, -117.94000014919395, -140.57271677514538, -87.41725232246017, -88.54870532595191, -85.60983162618592, -80.35171317928938, -94.40665853430701, -104.52527598122691, -73.5347718795907, -74.3293540165286, -106.80166862747751, -83.78607560746167, -79.57014606202898, -81.37234961819989, -80.58503093802469, -102.81889844871854, -87.88774703334542, -97.79178767009023, -102.34118619138559, -94.61406635929512, -123.33773477184445, -83.94185247107238, -85.78017144849369, -114.82369934004106, -119.45129588859213, -122.31816147828711, -76.00728905918595, -89.95202103010857, -96.37487359093583, -126.07058951042116, -82.67264844411591, -123.23740700698384, -99.11187278427296, -84.95381343303421, -113.45230028340316, -106.88614318584, -72.74066610026654, -96.98360297964733, -100.52202747454824, -85.39458957792885, -119.9960162554636, -100.7981947117237, -99.64001566880894, -96.54099051942389, -126.68422792971666, -92.77819704809917, -96.96742458268528, -89.30386440814154, -92.76600063022275, -90.5099874447129, -77.52715726364056, -107.95048010862156, -87.91680705942159, -100.07447010088895, -107.27992304614695, -85.51857774539182], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-40.64487637997026, -38.64487637997026, -40.64487637997026, -30.921385681073012, -31.921385681073012, -31.921385681073012, -34.050392009083694, -34.050392009083694, -34.050392009083694, -33.51069505401123, -33.51069505401123, -32.01069505401122, -31.93137894886165, -32.93137894886165, -32.43137894886165, -38.14110330161003, -37.64110330161002, -38.14110330161003, -29.024567377657284, -30.024567377657284, -30.024567377657284, -33.35051741590396, -33.35051741590396, -31.350517415903955, -28.52309274434329, -28.52309274434329, -28.52309274434329, -38.82378421734844, -38.82378421734844, -37.82378421734844, -27.600608091692326, -26.100608091692326, -27.600608091692326, -35.531273969253355, -35.531273969253355, -35.531273969253355, -27.64497510129999, -27.64497510129999, -26.14497510129999, -27.493447970096266, -28.493447970096263, -28.493447970096263, -29.767407176631394, -29.767407176631394, -29.767407176631394, -32.568571717454915, -32.568571717454915, -32.568571717454915, -33.732658167308735, -33.732658167308735, -33.732658167308735, -29.62382278445159, -31.62382278445159, -31.62382278445159, -26.600780145729345, -26.600780145729345, -26.600780145729345, -35.03780479266727, -34.03780479266727, -35.03780479266727, -30.306396867062425, -30.806396867062425, -29.806396867062425, -37.823314697617015, -38.823314697617015, -38.823314697617015, -27.272743535948717, -27.272743535948717, -27.272743535948717, -39.65165748029446, -39.65165748029446, -39.65165748029446, -25.128887619243272, -25.128887619243272, -25.128887619243272, -28.228699277812222, -28.228699277812222, -28.228699277812222, -28.776407580121663, -27.776407580121663, -28.776407580121663, -37.14541607107666, -37.14541607107666, -37.14541607107666, -27.75288050748877, -26.75288050748877, -27.75288050748877, -35.01646796563445, -33.01646796563445, -35.01646796563445, -33.28272744053889, -33.28272744053889, -33.28272744053889, -29.405564048625727, -29.405564048625727, -29.405564048625727, -26.967713823121507, -25.967713823121507, -26.967713823121507, -26.426457468930405, -26.926457468930405, -27.426457468930405, -34.99437362879977, -34.99437362879977, -34.99437362879977, -28.455933866047122, -28.455933866047122, -26.955933866047122, -28.48429528556087, -28.48429528556087, -28.48429528556087, -25.955690926054654, -26.955690926054654, -26.955690926054654, -28.875841738769946, -29.875841738769946, -29.875841738769946, -34.40059809519906, -34.90059809519906, -34.40059809519906, -24.379026662492617, -23.879026662492617, -24.379026662492617, -30.461128800803206, -30.461128800803206, -30.461128800803206, -23.83284451610467, -23.83284451610467, -23.83284451610467, -32.05689885256412, -32.55689885256412, -32.55689885256412, -31.617867813496662, -33.11786781349666, -33.61786781349666, -27.875148111738678, -27.375148111738675, -27.875148111738678, -31.149765581117684, -30.649765581117684, -32.649765581117684, -44.43225184209709, -44.93225184209709, -45.93225184209709, -32.6225793282094, -31.622579328209397, -32.6225793282094, -37.289003038007976, -35.789003038007976, -37.289003038007976, -32.48864539252127, -32.48864539252127, -30.48864539252127, -33.38536864108795, -32.38536864108795, -33.38536864108795, -29.360452713770727, -29.360452713770727, -29.360452713770727, -35.83018008479035, -35.83018008479035, -35.83018008479035, -41.858978495333524, -39.858978495333524, -40.358978495333524, -29.542227622847896, -29.542227622847896, -29.542227622847896, -33.21679330939973, -36.71679330939974, -37.71679330939974, -28.75231383698905, -28.75231383698905, -29.25231383698905, -36.7400157942591, -35.7400157942591, -36.7400157942591, -28.311339428801443, -28.311339428801443, -28.311339428801443, -33.21900659318429, -32.2190065931843, -33.21900659318429, -37.3237216492974, -37.3237216492974, -36.3237216492974, -41.09641586469282, -40.09641586469282, -40.09641586469282, -39.38030667777214, -38.88030667777214, -39.38030667777214, -27.039524051520104, -26.039524051520107, -27.039524051520104, -31.1680047462798, -31.1680047462798, -31.1680047462798, -26.89500460695008, -25.89500460695008, -24.89500460695008, -33.82776105002183, -32.82776105002183, -33.82776105002183, -32.10906727966677, -32.10906727966677, -33.10906727966677, -29.99540942265696, -29.99540942265696, -28.49540942265696, -35.342997884958535, -36.34299788495854, -36.34299788495854, -31.401984263247233, -31.401984263247233, -30.901984263247233, -41.14261839978169, -40.14261839978169, -41.14261839978169, -47.01023387299102, -48.01023387299102, -48.01023387299102, -39.81333338306467, -38.313333383064666, -39.81333338306467, -46.857572258381765, -46.857572258381765, -46.857572258381765, -29.139084107486717, -29.139084107486717, -29.139084107486717, -29.51623510865064, -29.51623510865064, -29.51623510865064, -29.20327720872866, -27.20327720872866, -29.20327720872866, -26.783904393096456, -26.783904393096456, -26.783904393096456, -30.468886178102345, -31.968886178102345, -31.968886178102345, -35.34175866040897, -35.34175866040897, -33.84175866040896, -24.51159062653024, -24.51159062653024, -24.51159062653024, -24.77645133884286, -24.77645133884286, -24.77645133884286, -34.600556209159166, -36.100556209159166, -36.100556209159166, -27.928691869153887, -27.928691869153887, -27.928691869153887, -26.523382020676326, -26.523382020676326, -26.523382020676326, -27.124116539399985, -27.124116539399985, -27.124116539399985, -27.19501031267489, -25.695010312674896, -27.69501031267489, -34.439632816239495, -33.939632816239495, -34.439632816239495, -29.29591567778181, -29.29591567778181, -29.29591567778181, -32.59726255669675, -32.59726255669675, -32.59726255669675, -34.11372873046188, -34.11372873046188, -34.11372873046188, -30.038022119765028, -32.03802211976503, -32.53802211976503, -41.11257825728152, -41.11257825728152, -41.11257825728152, -28.48061749035746, -26.98061749035746, -28.48061749035746, -29.593390482831246, -26.593390482831246, -29.593390482831246, -38.27456644668035, -38.27456644668035, -38.27456644668035, -40.3170986295307, -39.3170986295307, -39.8170986295307, -39.10605382609569, -41.60605382609569, -41.60605382609569, -25.335763019728653, -25.335763019728653, -25.335763019728653, -29.984007010036176, -29.984007010036176, -29.984007010036176, -32.124957863645285, -32.124957863645285, -32.124957863645285, -41.35686317014038, -42.35686317014038, -42.35686317014038, -27.557549481371947, -27.557549481371947, -27.557549481371947, -41.412469002327946, -40.412469002327946, -41.412469002327946, -33.03729092809098, -33.03729092809098, -33.03729092809098, -28.651271144344733, -27.651271144344733, -28.651271144344733, -37.81743342780106, -37.81743342780106, -37.81743342780106, -33.295381061946664, -36.79538106194666, -36.79538106194666, -23.580222033422164, -24.580222033422164, -24.580222033422164, -32.66120099321577, -32.66120099321577, -31.66120099321577, -33.50734249151609, -33.50734249151609, -33.50734249151609, -28.464863192642962, -28.464863192642962, -28.464863192642962, -39.99867208515454, -39.99867208515454, -39.99867208515454, -33.59939823724124, -33.59939823724124, -33.59939823724124, -33.880005222936326, -32.880005222936326, -32.880005222936326, -32.18033017314131, -32.18033017314131, -32.18033017314131, -42.72807597657223, -42.72807597657223, -41.22807597657223, -29.75939901603304, -32.25939901603304, -30.759399016033043, -32.655808194228435, -32.655808194228435, -31.655808194228438, -29.934621469380478, -30.934621469380478, -28.434621469380478, -30.922000210074245, -30.922000210074245, -30.922000210074245, -30.003329148237643, -30.003329148237643, -30.503329148237643, -26.00905242121354, -26.50905242121354, -25.00905242121354, -35.98349336954052, -35.98349336954052, -35.98349336954052, -29.80560235314052, -28.30560235314052, -29.80560235314052, -33.35815670029634, -33.35815670029634, -33.35815670029634, -37.09330768204897, -36.59330768204897, -33.59330768204898, -27.50619258179726, -28.506192581797258, -29.50619258179726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3209858513318914, "mean_inference_ms": 1.2986263136001501, "mean_action_processing_ms": 0.07164904870767987, "mean_env_wait_ms": 0.5937989064815042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 73600, "timesteps_this_iter": 0, "agent_timesteps_total": 220800, "timers": {"sample_time_ms": 1596.001, "sample_throughput": 2005.011, "load_time_ms": 0.143, "load_throughput": 22433182.016, "learn_time_ms": 802.515, "learn_throughput": 3987.466, "update_time_ms": 1.61}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005000000000000001, "total_loss": 81.4203598022461, "policy_loss": -0.0024643991514652795, "vf_loss": 81.43739776611328, "vf_explained_var": -0.06320643424987793, "kl": 0.003449281686517125, "entropy": 1.4575734734535217, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 73600, "num_agent_steps_sampled": 220800, "num_steps_trained": 73600, "num_agent_steps_trained": 220800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2940, "training_iteration": 23, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-12", "timestamp": 1718736372, "time_this_iter_s": 1.455930233001709, "time_total_s": 35.9072322845459, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 35.9072322845459, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.85, "ram_util_percent": 30.3}}
{"episode_reward_max": -63.13748139055095, "episode_reward_min": -139.02969202641498, "episode_reward_mean": -96.83156571062098, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.009897342138295}, "policy_reward_max": {"shared_policy": -20.937819921790407}, "policy_reward_mean": {"shared_policy": -32.27718857020699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.13038140716684, -100.41165508182644, -74.44890152939426, -91.95466950156235, -102.98563357870769, -107.8436985152453, -116.48999660241437, -89.74148581260076, -103.54769869122848, -85.55194252482633, -97.5597539453936, -84.97876906155655, -77.5795156933238, -107.35806393246736, -111.80793882786715, -114.12598819109982, -89.30550893457428, -97.68881664330333, -90.75492765922846, -95.28015293433845, -102.7863180874061, -76.75498031721126, -80.57114872866947, -74.00784059432674, -97.75334405471017, -90.45482631773898, -111.8670213002593, -100.13234401024124, -98.73031644205354, -95.02762438394095, -98.3035265170772, -87.6264886626219, -117.41249149011882, -105.18536847037875, -79.8201671078999, -137.35758277378892, -91.46203266074441, -107.40000555110522, -100.99121647770075, -74.4471894041786, -94.60965809761069, -78.98758615645446, -139.02969202641498, -121.9557545619335, -120.65327821068632, -92.05368535456819, -98.1529887201116, -74.54365097151036, -119.42451042887204, -110.12875196786362, -100.03496892403457, -80.87831200357822, -68.42540343098983, -87.09805451439117, -100.41149929786253, -105.3638895966909, -95.32296219116841, -105.12685898462838, -89.0479879425687, -108.83677440966501, -104.09499180849693, -117.06386810142607, -74.20178569581273, -103.78588438679658, -106.0708135991964, -113.45815515645762, -79.90905606292299, -119.81672491122724, -90.85528986800821, -80.23929030271385, -89.56856223029344, -98.68039862012517, -77.59936724096265, -76.24575724443444, -92.5971124087603, -115.46776480830225, -127.4522551746214, -101.98342125906733, -110.31681667288058, -68.56373598534688, -108.35209031885209, -94.77003218595127, -81.54148530239449, -117.07842270524667, -106.2896298853613, -78.3198933322946, -117.15594411875635, -91.36068999907087, -106.02148937130791, -81.17285329937269, -88.0194860042036, -86.27395825025518, -75.38884377832223, -91.05521572008122, -100.9773016944081, -98.29426049169321, -87.9816843286604, -115.71194034859157, -88.11747393314195, -109.90897125298919, -97.3272399355943, -82.42507179452414, -81.97293332299343, -101.3918984543844, -85.01311610940962, -78.20597059802968, -131.48237335173414, -88.37326296014226, -94.77889506617807, -76.43300634711669, -91.50751777905941, -101.63637910656185, -99.60197239667413, -103.80026649904914, -114.17029209173594, -112.87832343254873, -81.0483813288303, -85.2146980898429, -110.965964986969, -91.24799263881779, -91.86578520495183, -91.9616152245006, -102.06110595094843, -64.81345976537122, -63.13748139055095, -131.79310287819038, -98.70091140771339, -115.73035512526586, -110.67086499631138, -69.40698607601843], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-35.37679380238893, -36.87679380238893, -36.87679380238893, -33.47055169394217, -33.47055169394217, -33.47055169394217, -24.816300509798094, -24.816300509798094, -24.816300509798094, -30.6515565005208, -30.6515565005208, -30.6515565005208, -34.49521119290256, -33.99521119290256, -34.49521119290256, -34.2812328384151, -36.7812328384151, -36.7812328384151, -39.329998867471474, -39.329998867471474, -37.829998867471474, -29.913828604200244, -29.913828604200244, -29.913828604200244, -34.51589956374282, -34.51589956374282, -34.51589956374282, -28.85064750827542, -27.85064750827542, -28.85064750827542, -32.68658464846453, -31.686584648464528, -33.18658464846453, -28.492923020518834, -27.992923020518834, -28.492923020518834, -27.02650523110793, -27.02650523110793, -23.52650523110793, -36.11935464415579, -35.11935464415579, -36.11935464415579, -37.43597960928904, -36.93597960928904, -37.43597960928904, -37.37532939703328, -38.37532939703327, -38.37532939703327, -29.76850297819142, -29.76850297819142, -29.76850297819142, -33.0629388811011, -33.0629388811011, -31.5629388811011, -30.251642553076145, -29.251642553076138, -31.251642553076145, -31.76005097811282, -31.76005097811282, -31.76005097811282, -34.76210602913539, -34.76210602913539, -33.26210602913539, -25.251660105737095, -25.251660105737095, -26.2516601057371, -27.0237162428898, -26.5237162428898, -27.0237162428898, -24.669280198108904, -25.169280198108904, -24.169280198108904, -31.584448018236735, -33.084448018236735, -33.084448018236735, -30.484942105913, -30.484942105913, -29.484942105913, -36.455673766753094, -37.455673766753094, -37.955673766753094, -33.37744800341373, -33.37744800341373, -33.37744800341373, -32.57677214735118, -33.07677214735118, -33.07677214735118, -30.675874794646973, -32.17587479464697, -32.17587479464697, -33.267842172359074, -33.267842172359074, -31.767842172359074, -28.70882955420732, -29.20882955420732, -29.70882955420732, -40.47083049670628, -38.47083049670628, -38.47083049670628, -36.228456156792895, -33.72845615679289, -35.228456156792895, -27.44005570263329, -26.94005570263329, -25.44005570263329, -46.119194257929635, -45.119194257929635, -46.119194257929635, -31.320677553581472, -31.320677553581472, -28.820677553581472, -35.133335183701725, -35.633335183701725, -36.633335183701725, -32.997072159233575, -33.99707215923358, -33.99707215923358, -24.81572980139288, -24.81572980139288, -24.81572980139288, -30.536552699203565, -32.03655269920357, -32.03655269920357, -26.662528718818162, -25.662528718818162, -26.662528718818162, -45.009897342138295, -46.009897342138295, -48.009897342138295, -40.65191818731117, -40.65191818731117, -40.65191818731117, -40.38442607022879, -39.88442607022879, -40.38442607022879, -30.684561784856054, -30.684561784856054, -30.684561784856054, -33.0509962400372, -33.0509962400372, -32.0509962400372, -24.181216990503454, -25.181216990503454, -25.181216990503454, -39.808170142957344, -39.808170142957344, -39.808170142957344, -36.70958398928786, -36.70958398928786, -36.70958398928786, -33.51165630801153, -33.01165630801154, -33.51165630801153, -27.292770667859394, -26.292770667859394, -27.292770667859394, -22.80846781032993, -22.80846781032993, -22.80846781032993, -29.03268483813038, -29.03268483813038, -29.03268483813038, -33.80383309928752, -33.80383309928752, -32.80383309928752, -35.78796319889697, -34.78796319889697, -34.78796319889697, -32.44098739705615, -30.440987397056144, -32.44098739705615, -35.208952994876135, -34.708952994876135, -35.208952994876135, -28.34932931418956, -30.349329314189564, -30.349329314189564, -36.27892480322171, -36.27892480322171, -36.27892480322171, -34.03166393616568, -35.03166393616568, -35.03166393616568, -39.021289367142025, -39.021289367142025, -39.021289367142025, -24.73392856527091, -24.233928565270908, -25.23392856527091, -34.59529479559887, -34.59529479559887, -34.59529479559887, -36.023604533065495, -35.0236045330655, -35.0236045330655, -37.819385052152526, -37.819385052152526, -37.819385052152526, -26.303018687641, -27.303018687641, -26.303018687641, -39.27224163707575, -40.27224163707575, -40.27224163707575, -29.618429956002736, -30.618429956002736, -30.618429956002736, -26.746430100904615, -26.746430100904615, -26.746430100904615, -29.856187410097824, -29.856187410097824, -29.856187410097824, -33.06013287337504, -32.56013287337504, -33.06013287337504, -24.699789080320876, -26.199789080320876, -26.699789080320876, -25.2485857481448, -25.7485857481448, -25.2485857481448, -30.365704136253434, -30.865704136253434, -31.365704136253434, -39.489254936100764, -38.489254936100764, -37.489254936100764, -42.65075172487379, -42.15075172487379, -42.65075172487379, -33.99447375302245, -33.99447375302245, -33.99447375302245, -36.938938890960166, -36.938938890960166, -36.438938890960166, -22.85457866178231, -22.85457866178231, -22.85457866178231, -36.284030106284014, -35.784030106284014, -36.284030106284014, -31.423344061983766, -32.42334406198377, -30.923344061983766, -27.347161767464836, -26.847161767464833, -27.347161767464836, -40.19280756841557, -39.19280756841556, -37.69280756841557, -35.5965432951204, -35.5965432951204, -35.0965432951204, -26.106631110764862, -26.106631110764862, -26.106631110764862, -39.21864803958546, -38.21864803958546, -39.71864803958546, -30.45356333302363, -30.45356333302363, -30.45356333302363, -34.67382979043597, -35.67382979043597, -35.67382979043597, -27.057617766457557, -27.057617766457557, -27.057617766457557, -28.839828668067845, -29.339828668067845, -29.839828668067845, -29.591319416751734, -28.091319416751734, -28.59131941675173, -25.129614592774075, -25.129614592774075, -25.129614592774075, -29.351738573360436, -30.351738573360436, -31.351738573360436, -33.99243389813602, -33.49243389813603, -33.49243389813603, -32.0980868305644, -33.0980868305644, -33.0980868305644, -28.660561442886777, -29.160561442886777, -30.160561442886777, -35.57064678286387, -40.07064678286387, -40.07064678286387, -29.705824644380662, -29.705824644380662, -28.705824644380655, -36.96965708432971, -35.96965708432972, -36.96965708432971, -31.775746645198122, -32.77574664519812, -32.77574664519812, -27.475023931508012, -27.475023931508012, -27.475023931508012, -28.824311107664464, -25.824311107664464, -27.324311107664464, -33.797299484794785, -33.797299484794785, -33.797299484794785, -28.67103870313654, -27.67103870313654, -28.67103870313654, -25.735323532676553, -26.235323532676553, -26.235323532676553, -44.32745778391138, -44.32745778391138, -42.82745778391138, -29.791087653380742, -30.291087653380742, -28.291087653380742, -30.59296502205936, -32.09296502205936, -32.09296502205936, -25.1443354490389, -26.144335449038902, -25.144335449038902, -30.502505926353155, -30.502505926353155, -30.502505926353155, -32.878793035520616, -34.37879303552062, -34.37879303552062, -33.700657465558045, -33.700657465558045, -32.200657465558045, -33.60008883301638, -34.60008883301638, -35.60008883301638, -38.05676403057864, -38.05676403057864, -38.05676403057864, -36.626107810849575, -38.12610781084959, -38.12610781084959, -26.682793776276768, -27.182793776276768, -27.182793776276768, -29.238232696614304, -28.238232696614304, -27.738232696614304, -36.321988328989626, -37.321988328989626, -37.321988328989626, -30.082664212939253, -30.582664212939253, -30.582664212939253, -30.621928401650603, -30.621928401650603, -30.621928401650603, -31.320538408166883, -29.32053840816688, -31.320538408166883, -34.52036865031615, -33.02036865031615, -34.52036865031615, -21.937819921790407, -21.937819921790407, -20.937819921790407, -21.045827130183657, -21.045827130183657, -21.045827130183657, -42.597700959396754, -44.597700959396754, -44.597700959396754, -31.73363713590445, -33.73363713590444, -33.23363713590444, -38.5767850417553, -38.5767850417553, -38.5767850417553, -36.05695499877047, -37.05695499877047, -37.55695499877047, -23.802328692006142, -23.802328692006142, -21.802328692006142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31996282061753273, "mean_inference_ms": 1.2941693657466697, "mean_action_processing_ms": 0.07138711650954171, "mean_env_wait_ms": 0.5918255480545415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 76800, "timesteps_this_iter": 0, "agent_timesteps_total": 230400, "timers": {"sample_time_ms": 1594.895, "sample_throughput": 2006.402, "load_time_ms": 0.139, "load_throughput": 23077325.997, "learn_time_ms": 801.512, "learn_throughput": 3992.455, "update_time_ms": 1.613}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 77.32650985717774, "policy_loss": -0.002814966139616448, "vf_loss": 77.34380645751953, "vf_explained_var": -0.038354551792144774, "kl": 0.0035352500854101744, "entropy": 1.4480264902114868, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76800, "num_agent_steps_sampled": 230400, "num_steps_trained": 76800, "num_agent_steps_trained": 230400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3070, "training_iteration": 24, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-13", "timestamp": 1718736373, "time_this_iter_s": 1.489903211593628, "time_total_s": 37.397135496139526, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 37.397135496139526, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 36.85, "ram_util_percent": 30.3}}
{"episode_reward_max": -69.47404876280363, "episode_reward_min": -132.42822613570027, "episode_reward_mean": -94.94692308834168, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -44.809408711900105}, "policy_reward_max": {"shared_policy": -21.991349587601213}, "policy_reward_mean": {"shared_policy": -31.648974362780557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.67694556966794, -79.56143182299823, -78.35971830381736, -92.47154836555936, -69.65708993208511, -101.59464174124143, -88.65798070835825, -88.25938443885994, -90.04065895929426, -123.20437444823459, -95.816583403507, -84.14589694126245, -113.0371653884713, -93.5997359086005, -96.93597063060339, -115.70759285345673, -98.2078213589983, -83.23182433036725, -78.91149858317438, -102.13319585591739, -94.87452651898163, -109.46519505435177, -132.42822613570027, -82.8629610193792, -83.18071344202563, -116.4557551602989, -89.83417721655675, -80.66006595093842, -102.9502154462675, -76.60226977855892, -83.96144992643602, -88.44211495740564, -73.2928147375115, -86.55055125559676, -93.70776595653352, -111.71881283156682, -90.05616780629727, -87.12365574709322, -92.37843621740788, -92.87711439166293, -88.52904234055518, -89.25590696319021, -94.042183837396, -87.30951436864353, -115.49058726629039, -105.28820116394947, -95.101526433606, -90.95243075488102, -115.38185601343389, -75.82026971034354, -72.04004565047418, -76.76151708417956, -80.03556043699079, -116.63456764545654, -74.90950407729102, -88.69604353024522, -92.18149035771941, -107.11734576724409, -84.12014973208267, -114.15260979530602, -108.7057354353343, -78.30994760145944, -112.30254832678891, -90.38384657673294, -94.97447240280691, -71.21183391895748, -103.4927855315731, -83.98834745533576, -123.12976767313704, -115.09086561283777, -109.51108777139595, -99.32214138528113, -92.4907437379505, -78.0572150210694, -91.35437890983044, -84.69571909285689, -80.42204793112684, -93.40577913330718, -93.71880582596312, -99.78858870187642, -114.83538767324242, -94.49837878566417, -87.48711497218049, -94.55217299489743, -121.48820012122457, -87.09548225117476, -104.0154129575876, -69.47404876280363, -90.88856083378485, -87.42972495441118, -96.79058759696866, -97.8185597208991, -82.62436894702985, -92.63967402278575, -101.09695854475407, -114.36243210389317, -97.17417740485216, -103.83160638998442, -80.02786173130315, -89.6561748900162, -90.93734872196806, -121.60351460115108, -75.97383249023706, -113.22768781553299, -89.4552677430221, -111.24489736881571, -132.39329504364005, -117.64769993187265, -118.7282292087166, -94.75920364979763, -102.61524886431118, -71.43568661673935, -104.16068845854521, -82.73159738583556, -82.16952469155417, -103.12444539864713, -87.41145012420783, -97.57435625969626, -110.35879777487342, -89.0818799285138, -98.55152203274966, -123.00706530660965, -108.1488140518448, -97.38584999226026, -71.22263373500743, -85.16735926990327, -85.10336592059986, -86.3030448254207, -91.33931126153692, -101.63843728140253], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-27.058981856555977, -27.058981856555977, -25.558981856555977, -26.52047727433273, -26.52047727433273, -26.52047727433273, -25.45323943460579, -26.45323943460579, -26.45323943460579, -30.823849455186426, -30.823849455186426, -30.823849455186426, -23.219029977361714, -23.219029977361714, -23.219029977361714, -33.864880580413804, -33.864880580413804, -33.864880580413804, -29.719326902786104, -29.719326902786104, -29.219326902786104, -28.41979481295332, -29.91979481295332, -29.91979481295332, -30.846886319764764, -28.346886319764764, -30.846886319764764, -39.73479148274488, -41.73479148274488, -41.73479148274488, -32.27219446783569, -31.27219446783569, -32.27219446783569, -28.048632313754148, -28.048632313754148, -28.048632313754148, -38.34572179615713, -37.345721796157115, -37.345721796157115, -31.033245302866824, -31.533245302866824, -31.033245302866824, -32.64532354353447, -31.645323543534467, -32.64532354353447, -38.569197617818936, -38.569197617818936, -38.569197617818936, -32.90260711966611, -32.40260711966611, -32.90260711966611, -27.743941443455753, -27.743941443455753, -27.743941443455753, -26.30383286105815, -26.30383286105815, -26.30383286105815, -34.7110652853058, -33.7110652853058, -33.7110652853058, -31.624842172993866, -31.624842172993866, -31.624842172993866, -36.48839835145058, -37.98839835145058, -34.98839835145058, -44.809408711900105, -42.809408711900105, -44.809408711900105, -27.62098700645972, -27.62098700645972, -27.62098700645972, -27.72690448067521, -27.72690448067521, -27.72690448067521, -37.81858505343297, -39.31858505343297, -39.31858505343297, -29.944725738852274, -29.944725738852274, -29.944725738852274, -26.8866886503128, -26.8866886503128, -26.8866886503128, -34.48340514875585, -34.48340514875585, -33.98340514875585, -26.700756592852983, -25.700756592852983, -24.200756592852983, -27.987149975478662, -27.987149975478662, -27.987149975478662, -28.81403831913523, -29.814038319135225, -29.814038319135225, -24.93093824583718, -23.93093824583718, -24.43093824583718, -29.18351708519892, -28.18351708519892, -29.18351708519892, -30.735921985511155, -31.235921985511155, -31.735921985511155, -37.239604277188946, -36.739604277188946, -37.739604277188946, -30.01872260209909, -30.01872260209909, -30.01872260209909, -29.0412185823644, -29.0412185823644, -29.0412185823644, -30.79281207246929, -30.79281207246929, -30.79281207246929, -30.95903813055429, -30.95903813055429, -30.95903813055429, -29.509680780185047, -29.509680780185047, -29.509680780185047, -29.91863565439675, -29.91863565439675, -29.41863565439675, -31.34739461246534, -31.34739461246534, -31.34739461246534, -28.436504789547843, -29.436504789547843, -29.436504789547843, -37.496862422096804, -38.996862422096804, -38.996862422096804, -34.429400387983186, -35.42940038798318, -35.42940038798318, -32.36717547786868, -32.36717547786868, -30.367175477868685, -30.650810251627025, -30.650810251627025, -29.650810251627025, -38.46061867114464, -38.46061867114464, -38.46061867114464, -25.44008990344783, -25.44008990344783, -24.94008990344783, -24.18001521682473, -24.18001521682473, -23.68001521682473, -26.587172361393176, -23.587172361393176, -26.587172361393176, -27.011853478996926, -26.011853478996926, -27.011853478996926, -38.378189215152176, -38.878189215152176, -39.378189215152176, -25.30316802576367, -24.30316802576367, -25.30316802576367, -29.565347843415093, -29.565347843415093, -29.565347843415093, -30.39383011923979, -30.89383011923979, -30.89383011923979, -35.03911525574804, -36.03911525574803, -36.03911525574803, -27.70671657736088, -27.706716577360872, -28.70671657736088, -38.05086993176868, -38.05086993176868, -38.05086993176868, -35.235245145111456, -36.735245145111456, -36.735245145111456, -26.103315867153146, -26.103315867153146, -26.103315867153146, -37.10084944226298, -37.600849442262984, -37.600849442262984, -28.794615525577644, -30.794615525577644, -30.794615525577644, -31.82482413426895, -31.82482413426895, -31.32482413426895, -23.903944639652487, -23.403944639652487, -23.903944639652487, -34.99759517719104, -33.49759517719104, -34.99759517719104, -26.99611581844526, -27.99611581844526, -28.99611581844526, -40.04325589104565, -41.54325589104565, -41.54325589104565, -35.53028853761255, -40.03028853761255, -39.53028853761255, -36.50369592379865, -36.50369592379865, -36.50369592379865, -33.77404712842707, -31.774047128427068, -33.77404712842707, -30.49691457931683, -31.49691457931683, -30.49691457931683, -26.019071673689783, -26.019071673689783, -26.019071673689783, -29.451459636610128, -30.951459636610128, -30.951459636610128, -28.231906364285624, -28.231906364285624, -28.231906364285624, -26.140682643708974, -27.14068264370897, -27.14068264370897, -31.135259711102385, -31.135259711102385, -31.135259711102385, -31.07293527532105, -31.07293527532105, -31.57293527532105, -33.42952956729217, -33.42952956729217, -32.92952956729217, -37.945129224414124, -40.445129224414124, -36.445129224414124, -31.832792928554714, -30.832792928554714, -31.832792928554714, -29.16237165739349, -29.16237165739349, -29.16237165739349, -31.517390998299167, -31.517390998299167, -31.517390998299167, -41.662733373741574, -39.662733373741574, -40.16273337374157, -29.031827417058246, -29.031827417058246, -29.031827417058246, -32.67180431919586, -35.67180431919586, -35.67180431919586, -21.991349587601213, -23.991349587601213, -23.49134958760121, -30.296186944594954, -30.296186944594954, -30.296186944594954, -29.143241651470394, -29.143241651470394, -29.143241651470394, -32.430195865656216, -32.430195865656216, -31.930195865656216, -32.93951990696635, -31.93951990696635, -32.93951990696635, -27.70812298234326, -27.20812298234326, -27.70812298234326, -30.87989134092857, -30.87989134092857, -30.87989134092857, -35.698986181584694, -32.6989861815847, -32.698986181584694, -38.78747736796437, -37.78747736796437, -37.78747736796437, -32.391392468284046, -32.391392468284046, -32.391392468284046, -34.610535463328134, -34.610535463328134, -34.610535463328134, -27.009287243767723, -27.009287243767723, -26.009287243767723, -29.8853916300054, -29.8853916300054, -29.8853916300054, -30.812449573989372, -29.312449573989372, -30.812449573989372, -41.20117153371704, -39.20117153371704, -41.20117153371704, -25.65794416341234, -25.65794416341234, -24.65794416341234, -37.742562605177675, -37.742562605177675, -37.742562605177675, -28.818422581007372, -30.318422581007372, -30.318422581007372, -36.08163245627191, -37.08163245627191, -38.08163245627191, -42.797765014546684, -44.797765014546684, -44.797765014546684, -39.38256664395755, -39.38256664395755, -38.88256664395755, -38.909409736238864, -39.909409736238864, -39.909409736238864, -31.58640121659924, -31.58640121659924, -31.58640121659924, -35.205082954770425, -32.205082954770425, -35.205082954770425, -23.47856220557978, -23.978562205579777, -23.978562205579777, -34.3868961528484, -35.3868961528484, -34.3868961528484, -27.577199128611866, -27.577199128611866, -27.577199128611866, -28.223174897184734, -26.723174897184734, -27.223174897184734, -33.87481513288239, -34.37481513288239, -34.87481513288239, -29.30381670806927, -29.30381670806927, -28.80381670806927, -32.85811875323208, -31.85811875323208, -32.85811875323208, -36.95293259162451, -35.45293259162451, -37.95293259162451, -29.69395997617128, -29.69395997617128, -29.69395997617128, -32.51717401091651, -33.51717401091651, -32.51717401091651, -42.00235510220322, -39.50235510220322, -41.50235510220322, -37.0496046839483, -34.0496046839483, -37.0496046839483, -32.46194999742008, -32.46194999742008, -32.46194999742008, -23.74087791166914, -23.74087791166914, -23.74087791166914, -28.389119756634415, -28.389119756634415, -28.389119756634415, -28.36778864019998, -28.36778864019998, -28.36778864019998, -29.267681608473584, -27.767681608473584, -29.267681608473584, -28.446437087178964, -31.446437087178964, -31.446437087178964, -33.546145760467496, -34.54614576046749, -33.546145760467496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.319588728181095, "mean_inference_ms": 1.2934191795218484, "mean_action_processing_ms": 0.07131796690124734, "mean_env_wait_ms": 0.5915909316476891, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 1588.257, "sample_throughput": 2014.787, "load_time_ms": 0.139, "load_throughput": 23065428.424, "learn_time_ms": 803.366, "learn_throughput": 3983.24, "update_time_ms": 1.628}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005000000000000001, "total_loss": 72.05327987670898, "policy_loss": -0.0026922419142986877, "vf_loss": 72.07042007446289, "vf_explained_var": -0.023278367519378663, "kl": 0.0034587021853611176, "entropy": 1.4448924779891967, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 240000, "num_steps_trained": 80000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3200, "training_iteration": 25, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-15", "timestamp": 1718736375, "time_this_iter_s": 1.526601791381836, "time_total_s": 38.92373728752136, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924638b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38.92373728752136, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.700000000000003, "ram_util_percent": 30.3}}
{"episode_reward_max": -70.48064181715938, "episode_reward_min": -150.5417297501447, "episode_reward_mean": -97.45368300311135, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -51.680576583381594}, "policy_reward_max": {"shared_policy": -23.112423652731067}, "policy_reward_mean": {"shared_policy": -32.484561001037115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.70894306611878, -95.57080583476514, -86.26844907467982, -112.87850816928517, -87.32482074799982, -93.03693685646353, -78.214930077509, -84.331433914566, -81.6939497653222, -83.49723038024317, -98.27631093376775, -134.00713556865583, -104.46596930834573, -107.8782746271482, -85.22403443225541, -97.72161780774842, -90.13784369926236, -112.35170766362964, -91.57977296934666, -99.93885280041263, -130.6918373303537, -78.87894658309769, -94.53731029549479, -113.73068602025735, -72.33727095819322, -91.3816885219828, -104.65063421033754, -109.1572922103391, -79.81081293215138, -105.47251376215503, -139.78108743874552, -73.53832145885433, -107.42979077482748, -86.19947639328589, -89.12888905844878, -95.79029498070689, -92.32979732631638, -99.0958073984468, -105.2543441110649, -106.5390200598107, -109.71530409982424, -80.45528433097071, -82.98959020339021, -82.00673943329521, -121.4046668969507, -122.2668451817212, -86.01960368797519, -82.2104521828194, -110.75173675059665, -89.84709553405422, -83.50664983722008, -121.09653386016222, -99.04569305191639, -81.11421830808618, -101.62635390173992, -86.68494223623942, -91.75750079357437, -118.93446580456788, -121.89249522305576, -81.82138404872062, -79.91074463951853, -94.52710006060879, -89.26743022971347, -77.5618158216437, -89.37267568183057, -90.72392700991892, -112.82498185849578, -121.7722083249914, -70.48064181715938, -86.82868884465843, -84.80784394883433, -97.60372870555723, -113.10358948562889, -90.75154777328092, -89.00615933798625, -103.82191297315669, -108.2945571844016, -87.40306318595452, -81.28489002633184, -118.99873143405568, -92.57795740070858, -88.34234672259521, -101.44677998682167, -115.3699111367489, -70.74099852511117, -109.73275237793881, -93.11615205385374, -90.32311233167673, -106.99226814156066, -92.74245933312231, -149.0864465321797, -78.73294029003031, -101.38690580055437, -104.44603452094951, -79.97382503559159, -111.30655785035631, -72.61954172822801, -104.53743233663633, -107.84959694372846, -83.06804617975965, -88.2754120946238, -114.99463414392089, -78.97477372826073, -101.63834299533129, -98.89049366882516, -83.66335931654127, -76.39456790432382, -95.65008915136484, -108.72593003967104, -81.28163431718636, -150.5417297501447, -95.18146093689708, -97.23840010157653, -93.06071344295519, -102.18527411541623, -104.90716189208828, -149.42002577924342, -94.49067468529896, -81.68823430017322, -99.50983954836428], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-32.56964768870626, -33.56964768870626, -33.56964768870626, -31.52360194492172, -32.023601944921715, -32.023601944921715, -28.922816358226623, -28.422816358226623, -28.922816358226623, -38.45950272309504, -38.45950272309504, -35.95950272309505, -28.77494024933326, -29.27494024933326, -29.27494024933326, -31.51231228548788, -30.01231228548788, -31.51231228548788, -26.23831002583632, -25.73831002583632, -26.23831002583632, -28.443811304855338, -27.943811304855338, -27.943811304855345, -27.897983255107384, -25.897983255107384, -27.897983255107384, -27.4990767934144, -27.9990767934144, -27.9990767934144, -32.09210364458923, -33.09210364458923, -33.09210364458923, -44.002378522885316, -45.002378522885316, -45.002378522885316, -35.32198976944857, -33.82198976944858, -35.32198976944857, -34.62609154238275, -36.626091542382746, -36.626091542382746, -28.40801147741849, -28.40801147741849, -28.40801147741849, -32.57387260258281, -32.57387260258281, -32.57387260258281, -30.045947899754115, -30.045947899754115, -30.045947899754115, -35.950569221209875, -38.450569221209875, -37.950569221209875, -30.6932576564489, -30.6932576564489, -30.1932576564489, -33.31295093347088, -33.31295093347088, -33.31295093347088, -42.89727911011792, -43.89727911011792, -43.89727911011792, -25.792982194365884, -26.292982194365884, -26.792982194365884, -31.67910343183159, -31.17910343183159, -31.67910343183159, -37.24356200675245, -37.74356200675245, -38.74356200675245, -24.612423652731067, -23.112423652731067, -24.612423652731067, -30.46056284066094, -30.46056284066094, -30.46056284066094, -35.05021140344585, -33.55021140344584, -36.05021140344585, -35.05243073677968, -37.05243073677968, -37.05243073677968, -26.270270977383788, -26.770270977383788, -26.770270977383788, -35.157504587385, -35.157504587385, -35.157504587385, -46.76036247958186, -46.26036247958186, -46.76036247958186, -25.012773819618097, -25.012773819618097, -23.512773819618097, -35.80993025827583, -35.80993025827583, -35.80993025827583, -29.066492131095302, -29.066492131095302, -28.066492131095302, -28.876296352816283, -29.376296352816283, -30.876296352816283, -30.59676499356898, -32.596764993568975, -32.596764993568975, -30.776599108772103, -30.776599108772103, -30.776599108772103, -33.03193579948226, -33.03193579948226, -33.03193579948226, -35.41811470368828, -34.41811470368828, -35.41811470368828, -36.34634001993691, -33.84634001993691, -36.34634001993691, -36.57176803327475, -36.57176803327475, -36.57176803327475, -27.151761443656895, -27.151761443656895, -26.151761443656888, -27.82986340113009, -27.82986340113009, -27.32986340113009, -26.335579811098405, -27.8355798110984, -27.8355798110984, -40.46822229898355, -40.46822229898355, -40.46822229898355, -39.75561506057372, -40.75561506057372, -41.75561506057372, -28.839867895991734, -28.839867895991734, -28.339867895991734, -26.73681739427311, -27.73681739427311, -27.73681739427311, -37.91724558353222, -34.917245583532214, -37.91724558353222, -30.449031844684725, -30.449031844684725, -28.949031844684725, -28.16888327907336, -28.16888327907336, -27.16888327907336, -40.365511286720725, -40.365511286720725, -40.365511286720725, -33.3485643506388, -32.3485643506388, -33.3485643506388, -27.204739436028728, -26.704739436028728, -27.204739436028728, -34.042117967246625, -34.042117967246625, -33.54211796724662, -29.06164741207982, -28.56164741207982, -29.06164741207982, -31.085833597858134, -29.585833597858134, -31.085833597858134, -39.644821934855955, -39.644821934855955, -39.644821934855955, -40.29749840768527, -40.297498407685275, -41.297498407685275, -27.440461349573543, -27.440461349573543, -26.940461349573543, -26.636914879839484, -26.636914879839484, -26.636914879839484, -31.842366686869575, -31.842366686869575, -30.842366686869575, -30.42247674323782, -30.42247674323782, -28.42247674323782, -25.52060527388123, -26.02060527388123, -26.02060527388123, -29.79089189394352, -29.79089189394352, -29.79089189394352, -30.07464233663964, -30.07464233663964, -30.57464233663964, -37.774993952831935, -37.274993952831935, -37.77499395283194, -41.590736108330454, -41.590736108330454, -38.590736108330454, -23.66021393905313, -23.66021393905313, -23.16021393905313, -28.942896281552812, -28.942896281552812, -28.942896281552812, -27.269281316278096, -28.769281316278096, -28.769281316278096, -32.867909568519075, -32.867909568519075, -31.867909568519075, -37.70119649520963, -37.70119649520963, -37.70119649520963, -29.917182591093642, -30.417182591093642, -30.417182591093642, -29.668719779328736, -29.668719779328736, -29.668719779328736, -34.94063765771892, -34.94063765771892, -33.94063765771892, -36.09818572813385, -36.09818572813385, -36.09818572813385, -29.96768772865149, -28.96768772865149, -28.46768772865149, -27.09496334211061, -27.09496334211061, -27.09496334211061, -39.66624381135188, -39.66624381135188, -39.66624381135188, -31.5259858002362, -30.5259858002362, -30.5259858002362, -28.614115574198394, -29.614115574198394, -30.114115574198394, -32.98225999560722, -34.48225999560722, -33.98225999560722, -38.623303712249665, -38.123303712249665, -38.623303712249665, -23.580332841703722, -23.580332841703722, -23.580332841703722, -36.5775841259796, -36.5775841259796, -36.5775841259796, -31.705384017951246, -31.705384017951246, -29.705384017951246, -30.107704110558917, -30.107704110558917, -30.107704110558917, -36.16408938052023, -35.16408938052024, -35.66408938052023, -30.91415311104078, -30.91415311104078, -30.91415311104078, -48.695482177393195, -50.1954821773932, -50.1954821773932, -25.910980096676766, -26.410980096676766, -26.410980096676766, -33.79563526685148, -33.79563526685148, -33.79563526685148, -34.148678173649834, -35.148678173649834, -35.148678173649834, -26.32460834519719, -26.82460834519719, -26.82460834519719, -36.102185950118766, -37.602185950118766, -37.602185950118766, -24.206513909409342, -24.206513909409342, -24.206513909409342, -34.845810778878786, -34.845810778878786, -34.845810778878786, -36.28319898124282, -35.28319898124282, -36.28319898124282, -26.356015393253216, -28.35601539325322, -28.35601539325322, -28.758470698207912, -29.758470698207912, -29.758470698207912, -38.164878047973644, -38.164878047973644, -38.664878047973644, -26.32492457608691, -26.32492457608691, -26.32492457608691, -35.04611433177708, -32.04611433177708, -34.54611433177708, -33.296831222941734, -33.296831222941734, -32.296831222941734, -27.88778643884709, -27.88778643884709, -27.88778643884709, -25.63152263477461, -25.63152263477461, -25.13152263477461, -31.883363050454935, -31.883363050454935, -31.883363050454935, -36.408643346557, -36.408643346557, -35.908643346557, -26.927211439062127, -27.427211439062127, -26.927211439062127, -47.68057658338159, -51.680576583381594, -51.180576583381594, -31.727153645632345, -31.727153645632345, -31.727153645632345, -31.57946670052551, -32.579466700525515, -33.079466700525515, -30.353571147651753, -31.353571147651753, -31.353571147651753, -34.89509137180541, -32.39509137180541, -34.89509137180541, -34.96905396402941, -34.96905396402941, -34.96905396402941, -47.806675259747784, -50.806675259747784, -50.806675259747784, -31.996891561766308, -31.996891561766308, -30.496891561766308, -27.729411433391082, -27.729411433391082, -26.229411433391082, -32.503279849454785, -33.503279849454785, -33.503279849454785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.318800266968661, "mean_inference_ms": 1.290750454830559, "mean_action_processing_ms": 0.07117239848135641, "mean_env_wait_ms": 0.591041052976117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 83200, "timesteps_this_iter": 0, "agent_timesteps_total": 249600, "timers": {"sample_time_ms": 1587.489, "sample_throughput": 2015.761, "load_time_ms": 0.138, "load_throughput": 23180954.75, "learn_time_ms": 801.871, "learn_throughput": 3990.669, "update_time_ms": 1.615}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 84.9999900817871, "policy_loss": -0.0027324698946128213, "vf_loss": 85.01716995239258, "vf_explained_var": -0.017503690719604493, "kl": 0.005322945016613592, "entropy": 1.4446282505989074, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 83200, "num_agent_steps_sampled": 249600, "num_steps_trained": 83200, "num_agent_steps_trained": 249600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3320, "training_iteration": 26, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-16", "timestamp": 1718736376, "time_this_iter_s": 1.4967925548553467, "time_total_s": 40.42052984237671, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 40.42052984237671, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 39.3, "ram_util_percent": 30.3}}
{"episode_reward_max": -62.79955218710214, "episode_reward_min": -142.8063560399934, "episode_reward_mean": -96.31272865936246, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -47.83814454498934}, "policy_reward_max": {"shared_policy": -20.099850729034042}, "policy_reward_mean": {"shared_policy": -32.10424288645415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.01566271368696, -92.14528021558702, -81.69916317692297, -140.0144336349681, -100.77627678890191, -91.23721766326894, -74.95212571496315, -88.07690483007461, -98.06891809389438, -102.41203105722566, -95.91533679651292, -110.00719905560157, -63.88011451190603, -142.8063560399934, -113.16942900580369, -89.74116085046481, -87.6498177670922, -95.72800250313618, -94.62376010050826, -102.99878953086552, -101.0428165948371, -81.3408038906993, -121.28972451615351, -102.68484671451856, -101.87464682996523, -102.95269458966735, -95.2791776998073, -91.90107549439328, -103.70231585275249, -81.15166170389561, -75.4793829438506, -120.0010072867954, -100.4426711927751, -103.86690982162935, -116.374258626558, -98.0605433812217, -91.06819336634041, -92.2886191666966, -125.39647416490921, -105.54866509563554, -101.13539521809298, -95.2218223984557, -90.86824831246115, -107.01382655281616, -82.21982698066121, -104.562706533989, -88.3325699529714, -103.73115624927327, -68.68690305402662, -79.68915537605051, -91.88420098724193, -85.38336894301506, -91.18344969109522, -103.76586097071149, -92.95140571207936, -92.92565256709513, -77.47036831742967, -87.24757454079045, -102.27809080795396, -109.27992535275781, -77.65450915939951, -123.34106486478174, -87.24598654850683, -62.79955218710214, -103.90815040268632, -64.96517204346873, -133.92833752910968, -101.20303504028746, -72.0634805159723, -94.61134515429373, -85.60212157155716, -105.97451949337649, -80.59730696703961, -78.28273886856464, -88.5618144595058, -99.76724184250412, -123.40958598898976, -106.85286709471943, -93.62264506621938, -100.7200322879649, -113.34310216383616, -90.47186501187876, -98.8264577102377, -99.19357083490894, -127.59148528381373, -95.2145148577857, -85.86311872792682, -94.79554304699022, -83.06565156446763, -105.5844612112884, -100.66305310365082, -76.89594892741313, -128.0100465406338, -86.38327821859254, -92.9121696388596, -71.9856904062802, -87.99799833529367, -93.98424711966462, -89.5471304580549, -97.41418980585064, -106.01120098679043, -95.63201834071164, -112.72748933848314, -101.1433752163355, -82.85128180872759, -92.99484582362571, -75.6175621203744, -113.0009186859871, -90.49345541245049, -97.20835064577142, -90.7572771359226, -77.62943409644481, -97.6165921869649, -127.17994515711273, -111.79644830875071, -105.58836621136817, -93.59383826965919, -101.93011090897522, -82.9496706557536, -73.07621946873896, -93.80055242392513, -89.77937923511294, -118.32388592193331, -91.81966428870747, -85.36425012213348, -106.38581431993498, -124.41085529229022, -72.22387558118045, -111.25849469113336, -89.13854550489579], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-23.338554237895657, -23.338554237895657, -23.338554237895657, -30.715093405195695, -30.715093405195695, -30.715093405195695, -26.566387725641007, -27.566387725641007, -27.566387725641007, -47.83814454498934, -46.33814454498934, -45.83814454498934, -33.92542559630062, -33.92542559630062, -32.92542559630062, -30.07907255442298, -30.57907255442298, -30.57907255442298, -25.31737523832106, -25.81737523832106, -23.817375238321056, -29.025634943358202, -29.525634943358202, -29.525634943358202, -32.68963936463143, -32.68963936463143, -32.68963936463143, -34.13734368574187, -34.13734368574187, -34.13734368574187, -31.97177893217098, -31.97177893217098, -31.97177893217098, -36.00239968520052, -37.002399685200515, -37.002399685200515, -21.293371503968675, -21.293371503968675, -21.293371503968675, -47.26878534666446, -47.76878534666446, -47.76878534666446, -37.723143001934574, -37.723143001934574, -37.723143001934574, -29.913720283488267, -29.913720283488267, -29.913720283488267, -29.54993925569743, -29.54993925569743, -28.549939255697424, -32.40933416771205, -30.909334167712053, -32.40933416771205, -31.874586700169438, -31.374586700169438, -31.374586700169438, -33.33292984362181, -34.83292984362181, -34.83292984362181, -33.680938864945716, -33.680938864945716, -33.680938864945716, -27.446934630233123, -27.446934630233123, -26.446934630233123, -39.7632415053845, -40.7632415053845, -40.7632415053845, -34.228282238172845, -34.228282238172845, -34.228282238172845, -34.62488227665508, -33.62488227665508, -33.62488227665508, -34.31756486322245, -34.31756486322245, -34.31756486322245, -31.759725899935773, -30.759725899935773, -32.75972589993577, -30.633691831464432, -30.633691831464432, -30.633691831464432, -34.56743861758416, -34.56743861758416, -34.56743861758416, -27.050553901298517, -27.050553901298517, -27.050553901298517, -25.15979431461686, -25.15979431461686, -25.15979431461686, -41.66700242893179, -39.66700242893179, -38.66700242893179, -33.81422373092506, -32.81422373092505, -33.81422373092506, -34.12230327387644, -35.12230327387644, -34.62230327387644, -38.12475287551933, -38.62475287551933, -39.62475287551933, -33.35351446040722, -31.85351446040722, -32.85351446040722, -30.356064455446795, -30.356064455446795, -30.356064455446795, -29.92953972223221, -31.42953972223221, -30.92953972223221, -41.79882472163643, -41.79882472163643, -41.79882472163643, -34.51622169854518, -35.51622169854519, -35.51622169854519, -33.0451317393643, -34.0451317393643, -34.0451317393643, -31.740607466151864, -31.740607466151864, -31.740607466151864, -29.62274943748705, -30.62274943748705, -30.62274943748705, -36.00460885093874, -36.00460885093874, -35.00460885093874, -26.739942326887085, -27.739942326887085, -27.739942326887085, -34.187568844662984, -35.18756884466298, -35.18756884466298, -29.444189984323796, -29.444189984323796, -29.444189984323796, -35.41038541642444, -35.41038541642444, -32.91038541642444, -22.56230101800885, -23.06230101800885, -23.06230101800885, -24.89638512535018, -27.39638512535018, -27.39638512535018, -30.628066995747282, -30.628066995747282, -30.628066995747282, -27.794456314338362, -28.794456314338362, -28.794456314338362, -30.727816563698433, -29.727816563698433, -30.727816563698433, -33.58862032357048, -34.58862032357048, -35.58862032357048, -30.983801904026453, -30.983801904026453, -30.983801904026453, -31.308550855698368, -30.308550855698368, -31.308550855698368, -25.823456105809882, -25.823456105809882, -25.823456105809882, -29.415858180263477, -28.415858180263477, -29.415858180263477, -33.92603026931798, -33.92603026931798, -34.42603026931798, -36.4266417842526, -36.4266417842526, -36.4266417842526, -25.551503053133178, -26.051503053133178, -26.051503053133178, -39.78035495492724, -41.78035495492724, -41.78035495492724, -28.748662182835623, -29.248662182835623, -29.248662182835623, -20.099850729034042, -21.099850729034046, -21.599850729034046, -35.636050134228775, -35.636050134228775, -32.636050134228775, -22.32172401448958, -20.82172401448958, -21.821724014489583, -44.30944584303658, -44.80944584303658, -44.80944584303658, -33.73434501342918, -33.73434501342918, -33.73434501342918, -23.68782683865743, -24.18782683865743, -24.18782683865743, -31.03711505143125, -32.03711505143125, -31.53711505143125, -28.20070719051906, -28.70070719051906, -28.70070719051906, -35.824839831125495, -34.324839831125495, -35.824839831125495, -27.032435655679866, -27.032435655679866, -26.532435655679866, -26.094246289521546, -26.094246289521546, -26.094246289521546, -29.52060481983527, -29.52060481983527, -29.52060481983527, -32.92241394750137, -33.42241394750137, -33.42241394750137, -41.13652866299659, -41.13652866299659, -41.13652866299659, -36.61762236490649, -33.61762236490649, -36.61762236490649, -31.20754835540644, -31.20754835540644, -31.20754835540644, -34.40667742932165, -31.90667742932164, -34.40667742932165, -37.447700721278736, -37.947700721278736, -37.947700721278736, -30.157288337292915, -30.157288337292915, -30.157288337292915, -32.442152570079244, -33.442152570079244, -32.942152570079244, -33.064523611636304, -34.064523611636304, -32.064523611636304, -42.19716176127124, -42.69716176127123, -42.69716176127123, -32.23817161926188, -30.738171619261877, -32.23817161926188, -27.28770624264226, -29.28770624264226, -29.28770624264226, -31.59851434899675, -31.59851434899675, -31.59851434899675, -28.021883854822544, -28.021883854822544, -27.021883854822544, -34.19482040376279, -35.69482040376278, -35.69482040376278, -32.55435103455028, -34.05435103455028, -34.05435103455028, -25.631982975804387, -25.631982975804387, -25.631982975804387, -42.670015513544605, -42.670015513544605, -42.670015513544605, -28.461092739530848, -28.961092739530848, -28.961092739530848, -30.970723212953185, -30.970723212953185, -30.970723212953185, -23.995230135426723, -23.995230135426723, -23.995230135426723, -29.665999445097874, -29.665999445097874, -28.665999445097874, -28.328082373221516, -32.82808237322152, -32.82808237322152, -30.51571015268495, -28.51571015268495, -30.51571015268495, -32.638063268616875, -32.638063268616875, -32.138063268616875, -35.33706699559678, -35.33706699559678, -35.33706699559678, -31.87733944690388, -31.87733944690388, -31.87733944690388, -37.742496446161034, -37.742496446161034, -37.242496446161034, -34.04779173877849, -33.04779173877849, -34.04779173877849, -27.950427269575865, -28.450427269575865, -26.450427269575865, -30.831615274541896, -30.831615274541896, -31.331615274541896, -24.539187373458116, -25.539187373458116, -25.539187373458116, -37.833639561995696, -37.833639561995696, -37.333639561995696, -29.83115180415019, -30.33115180415019, -30.33115180415019, -32.402783548590484, -32.402783548590484, -32.402783548590484, -30.252425711974194, -30.252425711974194, -30.252425711974194, -25.876478032148288, -25.876478032148288, -25.876478032148288, -32.53886406232163, -32.53886406232163, -32.53886406232163, -42.39331505237091, -42.39331505237091, -42.39331505237091, -37.765482769583556, -37.765482769583556, -36.26548276958356, -35.69612207045605, -35.69612207045605, -34.19612207045605, -31.197946089886408, -31.197946089886408, -31.197946089886408, -34.310036969658434, -34.310036969658434, -33.310036969658434, -28.149890218584503, -28.149890218584503, -26.649890218584506, -24.358739822912977, -24.858739822912977, -23.858739822912977, -31.266850807975054, -31.266850807975054, -31.266850807975054, -28.92645974503764, -30.42645974503764, -30.42645974503764, -39.10796197397779, -39.60796197397779, -39.60796197397779, -30.606554762902505, -30.606554762902505, -30.606554762902505, -29.621416707377833, -29.621416707377833, -26.121416707377826, -36.62860477331165, -35.62860477331165, -34.12860477331166, -41.47028509743009, -41.47028509743009, -41.47028509743009, -24.074625193726813, -24.074625193726813, -24.074625193726813, -37.08616489704447, -37.08616489704447, -37.08616489704447, -29.712848501631942, -29.712848501631942, -29.712848501631942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3176271908537903, "mean_inference_ms": 1.285585023341197, "mean_action_processing_ms": 0.07089953250926949, "mean_env_wait_ms": 0.5888905380075969, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 86400, "timesteps_this_iter": 0, "agent_timesteps_total": 259200, "timers": {"sample_time_ms": 1577.036, "sample_throughput": 2029.123, "load_time_ms": 0.135, "load_throughput": 23730149.929, "learn_time_ms": 798.146, "learn_throughput": 4009.293, "update_time_ms": 1.597}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 77.86662445068359, "policy_loss": -0.0047269520580302425, "vf_loss": 77.88578872680664, "vf_explained_var": 0.0008604347705841065, "kl": 0.006640389425385912, "entropy": 1.4437102913856505, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 86400, "num_agent_steps_sampled": 259200, "num_steps_trained": 86400, "num_agent_steps_trained": 259200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3450, "training_iteration": 27, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-18", "timestamp": 1718736378, "time_this_iter_s": 1.4248523712158203, "time_total_s": 41.84538221359253, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d14c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 41.84538221359253, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 34.95, "ram_util_percent": 30.3}}
{"episode_reward_max": -68.1460080767317, "episode_reward_min": -134.75016531788833, "episode_reward_mean": -98.24713607045024, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -45.416721772629444}, "policy_reward_max": {"shared_policy": -21.715336025577244}, "policy_reward_mean": {"shared_policy": -32.749045356816744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.36504693795098, -116.40679039121235, -83.15686986015743, -93.23916515063091, -124.55329247138782, -78.07119944856392, -90.71844920790706, -84.3668564191428, -97.63737336555387, -88.99230260016859, -129.52174914510147, -103.03491206023355, -79.40953584000994, -91.25477339713964, -109.7549004285725, -116.14475642283743, -101.98572998804298, -93.82430175106973, -72.98404679740722, -90.57003674925804, -100.56445005120345, -79.00148965837771, -104.04097589955035, -100.21208566479439, -89.19938469022922, -92.25433804428616, -81.63999659098214, -119.71774430117827, -79.12122773825017, -103.3198274057736, -83.28944513500429, -112.09676909479828, -88.50507938377775, -134.75016531788833, -103.66227902020226, -75.77078193608153, -100.57075882021402, -124.99565796249831, -86.26047906417185, -95.09416158014844, -105.20246519027123, -109.63420686122609, -85.45988224404867, -85.55603651224666, -107.26379908182852, -99.70634090047166, -90.78427723370827, -92.71545539650407, -121.10084978335729, -114.45855831949021, -94.70207244154552, -86.57811522394677, -99.69426335668734, -97.78614916902269, -109.83911445762097, -90.27845584617516, -96.49548064888056, -112.44771070920017, -93.88121510747865, -78.84163035080253, -90.07206180893083, -89.53618178274769, -77.0264822959419, -99.17545248179984, -103.71582514409427, -100.48720397282497, -108.23004244401362, -91.04112585540572, -105.76108592086898, -77.70475736353497, -115.65731353198389, -95.14750717288766, -102.65913374081488, -95.35214477061008, -107.44848887757962, -102.285422584946, -109.74398444489535, -116.9505568532193, -95.66150570308272, -87.61392518257449, -84.9204985135535, -104.6496704157618, -115.80682336835629, -114.74241685594852, -114.1906679195396, -81.75767314803, -122.24484568736032, -102.99472018494997, -97.09947554103302, -85.86784525889824, -68.1460080767317, -102.72912322906164, -113.83871650365836, -95.28130282740182, -118.49422651458408, -81.70211188478204, -81.62464817689863, -115.20616623353402, -97.03226031326248, -125.52559473036962, -90.40662644013184, -109.91923539836885, -97.17668250256301, -93.58721579714759, -107.72571540802333, -68.9579785305107, -83.31044645127302, -117.04218040316564, -84.55379825484728, -79.64293182426225, -90.19405166935715, -78.92068236670347, -110.00151930432325, -105.62997697411593, -89.96544960433431, -88.8815887144387, -92.65069929418115, -132.22223024022853, -94.42951524801143, -72.73683455726449, -80.3869744422203, -130.05502759989037, -102.93713123534008, -75.56490354634407, -105.9193436371095, -102.5225406690749, -80.60928413921432, -131.32640252369194, -112.18361203040006, -86.05684840924904], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-36.455015645983636, -36.455015645983636, -36.455015645983636, -39.30226346373747, -38.30226346373747, -38.80226346373747, -27.218956620052477, -28.218956620052477, -27.718956620052477, -31.07972171687699, -31.07972171687699, -31.07972171687699, -42.51776415712928, -40.51776415712928, -41.51776415712928, -26.023733149521306, -26.023733149521306, -26.023733149521306, -31.40614973596905, -28.90614973596905, -30.40614973596905, -28.122285473047633, -28.122285473047633, -28.122285473047633, -32.545791121851295, -32.545791121851295, -32.545791121851295, -30.164100866722862, -30.164100866722862, -28.664100866722862, -43.00724971503379, -42.50724971503379, -44.00724971503379, -34.51163735341118, -34.01163735341118, -34.51163735341118, -26.46984528000329, -26.46984528000329, -26.46984528000329, -30.75159113237987, -29.75159113237987, -30.75159113237987, -36.58496680952418, -36.58496680952418, -36.58496680952418, -38.71491880761247, -38.71491880761247, -38.71491880761247, -33.49524332934765, -33.99524332934765, -34.49524332934765, -31.274767250356565, -31.274767250356565, -31.274767250356565, -24.49468226580241, -23.99468226580241, -24.49468226580241, -30.190012249752666, -30.190012249752666, -30.190012249752666, -33.52148335040113, -33.52148335040113, -33.52148335040113, -26.3338298861259, -26.3338298861259, -26.3338298861259, -34.34699196651679, -34.846991966516796, -34.846991966516796, -33.404028554931465, -33.404028554931465, -33.404028554931465, -28.399794896743046, -30.399794896743046, -30.399794896743046, -30.751446014762028, -30.751446014762028, -30.751446014762028, -27.54666553032737, -27.54666553032737, -26.54666553032737, -40.07258143372608, -40.07258143372608, -39.57258143372609, -26.37374257941672, -26.37374257941672, -26.37374257941672, -34.60660913525784, -35.10660913525784, -33.60660913525784, -27.763148378334748, -27.763148378334748, -27.763148378334748, -38.36558969826609, -35.36558969826609, -38.36558969826609, -30.001693127925904, -28.501693127925904, -30.001693127925904, -45.416721772629444, -45.416721772629444, -43.916721772629444, -32.55409300673408, -35.55409300673408, -35.55409300673408, -24.923593978693855, -25.423593978693855, -25.423593978693855, -32.85691960673802, -33.85691960673803, -33.85691960673803, -41.665219320832755, -41.665219320832755, -41.665219320832755, -29.420159688057264, -29.420159688057264, -27.420159688057264, -32.03138719338282, -31.031387193382823, -32.03138719338282, -35.23415506342375, -35.23415506342375, -34.734155063423756, -36.211402287075366, -36.211402287075366, -37.211402287075366, -28.48662741468289, -28.48662741468289, -28.48662741468289, -28.518678837415557, -28.518678837415557, -28.518678837415557, -35.92126636060951, -35.92126636060951, -35.42126636060951, -32.90211363349055, -33.40211363349055, -33.40211363349055, -30.261425744569426, -30.261425744569426, -30.261425744569426, -31.238485132168023, -30.238485132168027, -31.238485132168023, -41.03361659445247, -39.53361659445247, -40.53361659445247, -39.31951943983006, -36.31951943983006, -38.81951943983006, -31.567357480515188, -31.567357480515188, -31.567357480515188, -28.85937174131559, -28.85937174131559, -28.85937174131559, -32.89808778556244, -33.398087785562446, -33.398087785562446, -32.76204972300758, -33.76204972300758, -31.262049723007582, -37.61303815254033, -37.11303815254033, -35.11303815254033, -29.7594852820584, -30.2594852820584, -30.2594852820584, -32.8318268829602, -31.8318268829602, -31.8318268829602, -37.48257023640005, -37.48257023640005, -37.48257023640005, -30.960405035826227, -30.960405035826227, -31.960405035826227, -26.28054345026753, -26.28054345026753, -26.28054345026753, -30.35735393631028, -29.35735393631028, -30.35735393631028, -29.84539392758256, -29.84539392758256, -29.84539392758256, -25.675494098647302, -25.675494098647302, -25.675494098647302, -33.05848416059993, -33.05848416059993, -33.05848416059993, -35.23860838136478, -33.23860838136478, -35.23860838136478, -34.32906799094167, -32.32906799094166, -33.82906799094167, -35.41001414800454, -36.41001414800454, -36.41001414800454, -30.347041951801906, -30.347041951801906, -30.347041951801906, -33.58702864028968, -36.08702864028968, -36.08702864028968, -25.90158578784498, -25.90158578784498, -25.90158578784498, -38.552437843994625, -38.552437843994625, -38.552437843994625, -31.71583572429588, -31.21583572429588, -32.21583572429588, -32.553044580271624, -35.053044580271624, -35.053044580271624, -31.784048256870047, -31.784048256870047, -31.784048256870047, -35.816162959193235, -35.816162959193235, -35.816162959193235, -34.09514086164868, -34.09514086164868, -34.09514086164868, -36.581328148298454, -36.581328148298454, -36.581328148298454, -38.98351895107312, -38.98351895107312, -38.98351895107312, -30.72050190102757, -32.220501901027575, -32.720501901027575, -29.70464172752482, -28.20464172752482, -29.70464172752482, -28.306832837851164, -28.306832837851164, -28.306832837851164, -34.8832234719206, -34.8832234719206, -34.8832234719206, -38.76894112278544, -38.26894112278544, -38.76894112278544, -38.24747228531617, -38.24747228531617, -38.24747228531617, -38.39688930651321, -38.39688930651321, -37.39688930651321, -27.252557716010028, -27.252557716010028, -27.252557716010028, -40.74828189578674, -40.74828189578674, -40.74828189578674, -34.498240061649966, -33.998240061649966, -34.498240061649966, -32.36649184701103, -32.36649184701103, -32.36649184701103, -28.622615086299408, -28.622615086299408, -28.622615086299408, -23.215336025577244, -23.215336025577244, -21.715336025577244, -34.24304107635389, -33.74304107635389, -34.74304107635389, -38.94623883455279, -35.94623883455279, -38.94623883455279, -31.76043427580061, -31.76043427580061, -31.76043427580061, -39.49807550486136, -39.49807550486136, -39.49807550486136, -27.234037294927337, -27.234037294927337, -27.234037294927337, -27.208216058966205, -27.208216058966205, -27.208216058966205, -38.402055411178004, -38.402055411178004, -38.402055411178004, -33.01075343775414, -33.01075343775414, -31.01075343775414, -43.00853157678985, -39.50853157678985, -43.00853157678985, -30.635542146710627, -30.635542146710627, -29.135542146710627, -37.63974513278962, -36.63974513278962, -35.63974513278962, -32.725560834187654, -32.725560834187654, -31.725560834187654, -31.695738599049168, -30.195738599049168, -31.695738599049168, -35.90857180267445, -36.40857180267445, -35.40857180267445, -22.985992843503574, -22.985992843503574, -22.985992843503574, -28.103482150424334, -27.103482150424334, -28.103482150424334, -39.01406013438855, -39.01406013438855, -39.01406013438855, -28.184599418282435, -28.184599418282435, -28.184599418282435, -26.880977274754102, -25.380977274754102, -27.380977274754102, -29.73135055645238, -30.23135055645238, -30.23135055645238, -26.306894122234482, -26.306894122234482, -26.306894122234482, -36.6671731014411, -36.6671731014411, -36.6671731014411, -36.70999232470534, -34.70999232470533, -34.20999232470533, -29.988483201444758, -29.988483201444758, -29.988483201444758, -29.627196238146258, -29.627196238146258, -29.627196238146258, -30.88356643139372, -30.88356643139372, -30.88356643139372, -43.40741008007617, -43.90741008007617, -44.90741008007617, -29.64317174933714, -32.64317174933714, -32.14317174933714, -23.912278185754836, -24.412278185754836, -24.412278185754836, -26.795658147406762, -26.795658147406762, -26.795658147406762, -42.68500919996346, -43.18500919996346, -44.18500919996345, -35.14571041178004, -32.64571041178004, -35.14571041178004, -25.188301182114696, -25.188301182114696, -25.188301182114696, -35.3064478790365, -35.3064478790365, -35.3064478790365, -33.507513556358305, -34.507513556358305, -34.507513556358305, -26.869761379738097, -26.869761379738097, -26.869761379738097, -43.77546750789732, -43.77546750789732, -43.77546750789732, -37.39453734346669, -37.39453734346669, -37.39453734346669, -28.685616136416332, -28.685616136416332, -28.685616136416332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3165303323833209, "mean_inference_ms": 1.2806173733682615, "mean_action_processing_ms": 0.07062155997403272, "mean_env_wait_ms": 0.5868879097299029, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 89600, "timesteps_this_iter": 0, "agent_timesteps_total": 268800, "timers": {"sample_time_ms": 1566.022, "sample_throughput": 2043.395, "load_time_ms": 0.13, "load_throughput": 24654248.347, "learn_time_ms": 798.276, "learn_throughput": 4008.64, "update_time_ms": 1.537}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 78.25344161987304, "policy_loss": -0.0027918223363037065, "vf_loss": 78.27054061889649, "vf_explained_var": -0.016824829578399658, "kl": 0.00589925494900242, "entropy": 1.4306010723114013, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 89600, "num_agent_steps_sampled": 268800, "num_steps_trained": 89600, "num_agent_steps_trained": 268800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3580, "training_iteration": 28, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-19", "timestamp": 1718736379, "time_this_iter_s": 1.4650251865386963, "time_total_s": 43.310407400131226, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924404c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 43.310407400131226, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.9, "ram_util_percent": 30.3}}
{"episode_reward_max": -66.96496051273868, "episode_reward_min": -145.87638949993723, "episode_reward_mean": -95.46701571239727, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.62546316664573}, "policy_reward_max": {"shared_policy": -21.82165350424624}, "policy_reward_mean": {"shared_policy": -31.822338570799086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-81.16105509345088, -108.42712689474708, -80.46551050234665, -89.52545093250377, -78.14551987379419, -107.25426801153812, -95.02405877814343, -90.08114814982822, -116.79664678720474, -92.44627132054697, -95.66449672451749, -91.52480832567458, -93.61794461884442, -86.971948544116, -94.21422818305093, -81.46086224263135, -90.92687456216001, -84.07591241182686, -82.59900479216421, -84.2654824674128, -81.45872306607883, -103.12483189111987, -133.27476628430102, -130.6965167300016, -103.06205764145497, -93.85561767611742, -74.09302522972168, -75.24973116210892, -83.51111416110739, -84.71386424832566, -112.7808697303878, -82.62484362738013, -108.93569202816225, -93.14818648538919, -79.17249447394936, -109.17926563269909, -109.50861941210574, -83.68408462350192, -91.81957147281004, -90.62173095274461, -77.67877793836792, -125.3059818450939, -103.08313359623402, -89.24578840038347, -86.733355919544, -82.18074642975274, -104.23805961812388, -87.17293732918986, -87.53820674682291, -102.91764902594124, -102.2756238889745, -94.78053938796457, -104.68754501651313, -68.48384644019627, -86.48160262672812, -94.57593677884171, -120.9298671863399, -80.11230006432487, -135.19811032977788, -84.35713565777749, -89.15753874786783, -109.13590902968545, -76.21729568255978, -79.77511591067068, -74.18786237771894, -93.14857071982985, -145.87638949993723, -110.18485837286606, -97.4388976942081, -94.63751957962728, -108.70103056022725, -97.84468041651026, -111.16771409648214, -78.57684505212862, -99.2290481890276, -84.23101034831284, -109.26131592684521, -109.29881282008054, -83.82058158982817, -100.11997316006243, -78.28867702827837, -115.37259216154027, -75.92438481324844, -91.3880535505816, -75.88353006544229, -78.19925086304416, -90.64160665206833, -66.96496051273868, -109.25406666855154, -97.16561034109661, -117.48738467020965, -123.26299137192561, -93.64243232806109, -103.2327763499873, -88.39937230043543, -84.87475407515855, -93.98018003737181, -136.60010614924963, -83.49769808034577, -85.62604838300304, -72.79138359202159, -75.09947281566669, -106.25926629306035, -73.71870284342101, -97.43469289054917, -92.59478976017166, -98.3472034149812, -94.20728953335613, -97.59096679251608, -96.77837103361558, -96.64237244842856, -105.8613096319819, -85.56691712646084, -91.04819174498006, -86.36044730023103, -123.95196439495847, -94.63581731382153, -116.42816933678323, -104.97075961177904, -86.7023033100772, -126.08755731048426, -82.61745624581128, -107.62535994167783, -86.87607426324033, -80.87335072671551, -109.5838937359055, -131.5484209085188, -76.90961316752173, -117.47771328857894, -85.28339568465144], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-27.0536850311503, -27.0536850311503, -27.0536850311503, -36.309042298249025, -35.809042298249025, -36.309042298249025, -26.821836834115533, -26.821836834115533, -26.821836834115533, -29.841816977501214, -29.841816977501214, -29.841816977501214, -26.048506624598083, -26.048506624598083, -26.048506624598083, -35.75142267051271, -35.25142267051271, -36.2514226705127, -31.674686259381136, -31.674686259381136, -31.674686259381136, -30.52704938327608, -30.52704938327608, -29.02704938327608, -39.265548929068245, -39.265548929068245, -38.265548929068245, -30.815423773515654, -30.815423773515654, -30.815423773515654, -32.2214989081725, -30.7214989081725, -32.7214989081725, -30.67493610855821, -30.174936108558203, -30.67493610855821, -31.705981539614804, -31.705981539614804, -30.205981539614804, -29.15731618137202, -28.65731618137202, -29.15731618137202, -30.90474272768366, -31.90474272768366, -31.40474272768366, -25.48695408087711, -27.98695408087711, -27.98695408087711, -30.475624854053326, -29.975624854053326, -30.475624854053326, -28.025304137275644, -28.025304137275644, -28.025304137275644, -27.533001597388086, -27.533001597388086, -27.533001597388086, -28.088494155804273, -28.088494155804273, -28.088494155804273, -27.15290768869294, -27.15290768869294, -27.15290768869294, -34.5416106303733, -34.0416106303733, -34.5416106303733, -44.424922094767, -44.424922094767, -44.424922094767, -44.06550557666717, -42.56550557666717, -44.06550557666717, -34.35401921381832, -34.35401921381832, -34.35401921381832, -31.28520589203913, -31.78520589203913, -30.78520589203913, -24.86434174324057, -24.36434174324057, -24.86434174324057, -25.41657705403632, -25.41657705403632, -24.41657705403632, -27.83703805370247, -27.83703805370247, -27.83703805370247, -28.404621416108576, -28.404621416108576, -27.904621416108576, -37.59362324346259, -37.59362324346259, -37.59362324346259, -27.708281209126714, -27.208281209126714, -27.708281209126714, -37.14523067605409, -34.645230676054084, -37.14523067605409, -31.04939549512973, -31.04939549512973, -31.04939549512973, -26.39083149131643, -26.39083149131643, -26.39083149131643, -36.39308854423303, -36.39308854423303, -36.39308854423303, -36.836206470701896, -36.836206470701896, -35.836206470701896, -27.89469487450066, -27.89469487450066, -27.89469487450066, -30.939857157603342, -30.939857157603342, -29.939857157603342, -30.20724365091486, -30.20724365091486, -30.20724365091486, -26.059592646122653, -25.559592646122653, -26.059592646122653, -40.601993948364665, -43.101993948364665, -41.601993948364665, -34.36104453207799, -34.36104453207799, -34.36104453207799, -29.74859613346116, -29.74859613346116, -29.74859613346116, -29.411118639848016, -28.911118639848016, -28.41111863984802, -26.726915476584267, -27.726915476584267, -27.726915476584267, -34.41268653937464, -34.91268653937465, -34.91268653937465, -28.39097910972996, -29.39097910972996, -29.39097910972996, -28.846068915607635, -28.846068915607635, -29.846068915607635, -34.30588300864709, -34.30588300864709, -34.30588300864709, -34.425207962991486, -34.425207962991486, -33.425207962991486, -31.593513129321504, -31.593513129321504, -31.593513129321504, -34.895848338837695, -34.895848338837695, -34.895848338837695, -22.827948813398763, -22.827948813398763, -22.827948813398763, -28.82720087557606, -28.82720087557606, -28.82720087557606, -31.525312259613884, -31.525312259613884, -31.525312259613884, -41.80995572877996, -37.30995572877997, -41.80995572877996, -25.870766688108283, -27.870766688108283, -26.370766688108283, -44.06603677659261, -45.56603677659261, -45.56603677659261, -27.285711885925828, -28.785711885925828, -28.285711885925828, -29.719179582622598, -29.219179582622598, -30.219179582622598, -36.87863634322846, -36.87863634322846, -35.37863634322846, -25.40576522751993, -25.40576522751993, -25.40576522751993, -26.591705303556886, -26.591705303556886, -26.591705303556886, -24.562620792572975, -25.562620792572975, -24.062620792572975, -30.882856906609934, -30.382856906609934, -31.882856906609934, -48.62546316664573, -48.62546316664573, -48.62546316664573, -36.7282861242887, -36.7282861242887, -36.7282861242887, -33.31296589806935, -31.81296589806935, -32.31296589806935, -32.54583985987576, -29.04583985987576, -33.04583985987576, -34.90034352007576, -36.90034352007576, -36.90034352007576, -32.614893472170074, -32.614893472170074, -32.614893472170074, -37.05590469882738, -37.05590469882738, -37.05590469882738, -26.192281684042882, -26.192281684042882, -26.192281684042882, -33.57634939634253, -32.57634939634253, -33.07634939634253, -27.410336782770955, -28.410336782770955, -28.410336782770955, -36.587105308948395, -36.587105308948395, -36.087105308948395, -36.932937606693486, -36.932937606693486, -35.43293760669349, -28.273527196609425, -27.273527196609425, -28.273527196609425, -33.70665772002083, -33.70665772002083, -32.70665772002082, -26.76289234275946, -25.76289234275946, -25.762892342759457, -38.45753072051342, -38.45753072051342, -38.45753072051342, -25.641461604416147, -24.641461604416147, -25.641461604416147, -30.462684516860524, -30.462684516860524, -30.462684516860524, -25.294510021814098, -25.294510021814098, -25.294510021814098, -26.066416954348057, -26.066416954348057, -26.066416954348057, -29.713868884022762, -30.21386888402276, -30.71386888402276, -22.82165350424624, -21.82165350424624, -22.32165350424624, -35.4180222228505, -37.4180222228505, -36.4180222228505, -32.55520344703218, -32.05520344703218, -32.55520344703218, -39.49579489006988, -39.49579489006988, -38.49579489006988, -40.42099712397521, -41.42099712397521, -41.42099712397521, -30.547477442687033, -31.547477442687033, -31.547477442687033, -34.91092544999578, -33.41092544999578, -34.91092544999578, -29.466457433478464, -29.466457433478464, -29.466457433478464, -28.29158469171952, -27.29158469171952, -29.29158469171952, -32.16006001245728, -32.16006001245728, -29.660060012457276, -45.8667020497499, -45.8667020497499, -44.8667020497499, -27.832566026781905, -27.832566026781905, -27.832566026781905, -28.542016127667694, -28.542016127667694, -28.542016127667694, -24.26379453067386, -24.26379453067386, -24.26379453067386, -25.36649093855556, -24.366490938555557, -25.36649093855556, -35.419755431020114, -35.419755431020114, -35.419755431020114, -25.072900947806993, -24.572900947806993, -24.072900947806993, -32.478230963516374, -32.478230963516374, -32.478230963516374, -31.364929920057232, -30.864929920057232, -30.364929920057232, -31.782401138327078, -33.282401138327074, -33.282401138327074, -31.402429844452044, -31.402429844452044, -31.402429844452044, -32.53032226417204, -32.53032226417204, -32.53032226417204, -31.259457011205193, -33.25945701120519, -32.25945701120519, -33.04745748280953, -33.04745748280953, -30.54745748280953, -36.12043654399397, -33.62043654399397, -36.12043654399397, -28.522305708820298, -28.522305708820298, -28.522305708820298, -29.34939724832667, -30.34939724832667, -31.34939724832667, -28.95348243341036, -28.45348243341036, -28.95348243341036, -40.9839881316528, -41.4839881316528, -41.4839881316528, -31.54527243794052, -31.54527243794052, -31.54527243794052, -39.47605644559439, -37.47605644559439, -39.47605644559439, -34.99025320392634, -34.99025320392634, -34.99025320392634, -29.73410110335908, -27.23410110335908, -29.73410110335908, -41.69585243682806, -42.19585243682806, -42.19585243682806, -28.039152081937104, -26.539152081937104, -28.039152081937104, -35.87511998055928, -35.87511998055928, -35.87511998055928, -28.79202475441343, -29.29202475441343, -28.79202475441343, -27.12445024223851, -26.62445024223851, -27.12445024223851, -36.52796457863518, -36.52796457863518, -36.52796457863518, -44.182806969506274, -43.182806969506274, -44.182806969506274, -25.636537722507256, -25.636537722507256, -25.636537722507256, -39.15923776285966, -39.15923776285966, -39.15923776285966, -28.76113189488381, -27.76113189488381, -28.76113189488381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31544964396482195, "mean_inference_ms": 1.2757769818835676, "mean_action_processing_ms": 0.07035245464839963, "mean_env_wait_ms": 0.5849035530431481, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 92800, "timesteps_this_iter": 0, "agent_timesteps_total": 278400, "timers": {"sample_time_ms": 1563.887, "sample_throughput": 2046.184, "load_time_ms": 0.129, "load_throughput": 24772559.616, "learn_time_ms": 794.742, "learn_throughput": 4026.463, "update_time_ms": 1.494}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 73.89904327392578, "policy_loss": -0.003071857385880605, "vf_loss": 73.91652221679688, "vf_explained_var": -0.018877089023590088, "kl": 0.006503440074817413, "entropy": 1.4408642649650574, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 92800, "num_agent_steps_sampled": 278400, "num_steps_trained": 92800, "num_agent_steps_trained": 278400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3710, "training_iteration": 29, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-21", "timestamp": 1718736381, "time_this_iter_s": 1.4211318492889404, "time_total_s": 44.731539249420166, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924dee50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 44.731539249420166, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 36.35, "ram_util_percent": 30.35}}
{"episode_reward_max": -66.89809750450678, "episode_reward_min": -134.8680542415274, "episode_reward_mean": -96.23538752826408, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -45.78935141384251}, "policy_reward_max": {"shared_policy": -22.29936583483559}, "policy_reward_mean": {"shared_policy": -32.078462509421364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-117.0891572539406, -106.54132406877015, -89.01565664530763, -108.46326253371656, -104.01540710805286, -87.57935584657724, -75.86245355768007, -92.79116931442384, -85.90817332200965, -112.74624616478654, -89.55499354521292, -100.1667616145235, -90.70587618622731, -90.02580877803543, -95.8302805202092, -83.97755723088787, -118.20436808660975, -95.09683829851525, -97.0538092445156, -86.26058454805741, -76.15629508027982, -134.8680542415274, -88.16241570984216, -101.48846101493467, -97.9065202667028, -87.34435836911554, -87.07450840495082, -98.93839488425827, -93.09495971154284, -95.95915139635045, -106.31976455413567, -102.88049008623295, -78.25590914851774, -74.59370262523336, -85.60598079546861, -90.76025332852862, -93.11904051479698, -89.2536819962957, -78.13730605545956, -88.7875259138491, -112.35066385260612, -114.26520163948219, -68.84643680919639, -115.42113622895546, -88.99310071070508, -86.04954356544553, -89.43051628711885, -111.46891800627952, -93.99702722030884, -85.11320747752487, -118.0007824855922, -107.11146124162639, -103.5918542099289, -117.69285241869005, -96.89361059755306, -100.42117643843333, -109.7635840861613, -81.48068072177561, -95.75866359321535, -100.94310072660139, -89.34984248784953, -83.19532119604622, -88.89324044957031, -86.66805959289646, -114.47187020811934, -118.5297434629892, -95.5283418424856, -100.20396073723352, -112.62979642467197, -89.61556782817553, -89.3466912850483, -114.05002650655727, -106.02663954597168, -81.18825599817237, -92.16462737084257, -124.7193778505325, -81.94326190238293, -81.05929116754086, -91.4042582666386, -88.14469202467657, -92.71968810918362, -111.05301891994868, -104.45109845367476, -94.12896647592204, -88.34325637856357, -129.15114505265268, -111.65678411963316, -82.79056826750974, -95.1128696072148, -90.05566985243307, -72.15469644894085, -76.75288817289656, -110.95585811264857, -122.56869390482231, -108.70655948271393, -104.07767492963403, -85.33188485438373, -80.3116192328159, -93.30268415858102, -84.31743531946651, -84.43251479369657, -108.23080867795721, -107.439395779198, -82.20545686514598, -85.92803912001737, -83.60146185751705, -81.89165717604251, -117.69057804204319, -121.82358963686042, -86.17457593882929, -105.10354560620661, -108.21945021156456, -95.14826201951111, -85.10595851094983, -108.78372355929781, -123.17969735231235, -125.70660302466588, -109.03484223792508, -92.21935415183682, -104.39314400775665, -88.22264470425344, -82.55766751967137, -91.58141808519072, -115.43060443232471, -107.33911028777224, -82.04945262356463, -66.89809750450678, -74.34048349702653, -73.52868506287008, -72.07425410249262], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-38.696385751313535, -39.696385751313535, -38.696385751313535, -35.51377468959003, -35.51377468959003, -35.51377468959003, -30.33855221510252, -29.33855221510252, -29.33855221510252, -36.1544208445722, -36.1544208445722, -36.1544208445722, -35.505135702684306, -33.005135702684306, -35.505135702684306, -28.193118615525766, -30.193118615525766, -29.193118615525766, -25.620817852560027, -24.620817852560027, -25.620817852560027, -30.930389771474648, -30.930389771474648, -30.930389771474648, -28.636057774003202, -28.636057774003202, -28.636057774003202, -35.91541538826216, -38.415415388262154, -38.415415388262154, -30.518331181737672, -28.518331181737672, -30.518331181737672, -33.88892053817451, -33.88892053817451, -32.38892053817451, -30.90195872874242, -30.90195872874242, -28.90195872874242, -30.008602926011836, -30.008602926011836, -30.008602926011836, -31.943426840069748, -31.943426840069748, -31.943426840069748, -27.9925190769626, -27.9925190769626, -27.9925190769626, -39.73478936220326, -38.73478936220326, -39.73478936220326, -31.698946099505097, -31.698946099505097, -31.698946099505097, -32.851269748171845, -31.351269748171845, -32.851269748171845, -28.086861516019134, -28.586861516019134, -29.586861516019134, -26.05209836009328, -24.05209836009328, -26.05209836009328, -44.789351413842525, -45.78935141384251, -44.28935141384251, -29.387471903280726, -29.387471903280726, -29.387471903280726, -33.82948700497825, -33.82948700497825, -33.82948700497825, -32.63550675556759, -32.63550675556759, -32.63550675556759, -30.114786123038513, -28.114786123038513, -29.114786123038513, -29.858169468316948, -28.358169468316948, -28.858169468316948, -32.97946496141941, -32.97946496141941, -32.97946496141941, -30.364986570514272, -31.364986570514272, -31.364986570514272, -30.986383798783493, -32.48638379878349, -32.48638379878349, -35.6065881847119, -35.6065881847119, -35.1065881847119, -34.126830028744315, -34.626830028744315, -34.126830028744315, -26.085303049505903, -26.085303049505903, -26.085303049505903, -24.19790087507777, -25.197900875077774, -25.197900875077774, -28.86866026515619, -28.86866026515619, -27.86866026515619, -30.253417776176203, -30.253417776176203, -30.253417776176203, -31.039680171598977, -31.039680171598977, -31.039680171598977, -29.08456066543191, -29.58456066543191, -30.58456066543191, -24.379102018486527, -26.879102018486527, -26.879102018486527, -29.595841971283026, -29.595841971283026, -29.595841971283026, -37.783554617535366, -37.783554617535366, -36.783554617535366, -38.08840054649407, -38.08840054649407, -38.08840054649407, -22.615478936398798, -23.115478936398798, -23.115478936398798, -38.47371207631851, -38.47371207631851, -38.47371207631851, -28.664366903568354, -30.164366903568354, -30.164366903568354, -28.683181188481853, -28.683181188481853, -28.683181188481853, -30.143505429039614, -29.143505429039614, -30.143505429039614, -37.15630600209319, -37.15630600209319, -37.15630600209319, -31.33234240676962, -31.33234240676962, -31.33234240676962, -28.37106915917495, -28.37106915917495, -28.37106915917495, -39.333594161864085, -39.333594161864085, -39.333594161864085, -35.703820413875434, -35.703820413875434, -35.703820413875434, -34.53061806997631, -34.53061806997631, -34.53061806997631, -39.39761747289669, -38.89761747289669, -39.39761747289669, -31.964536865851002, -31.964536865851002, -32.964536865851, -33.97372547947779, -33.97372547947779, -32.47372547947779, -36.921194695387086, -35.421194695387086, -37.421194695387086, -26.66022690725855, -27.66022690725855, -27.16022690725855, -31.586221197738457, -32.08622119773846, -32.08622119773846, -33.647700242200486, -33.647700242200486, -33.647700242200486, -29.283280829283186, -29.783280829283186, -30.283280829283186, -26.731773732015423, -28.231773732015423, -28.231773732015423, -29.964413483190103, -28.964413483190096, -29.964413483190103, -29.22268653096548, -29.22268653096548, -28.22268653096548, -36.49062340270646, -38.99062340270646, -38.99062340270646, -39.509914487663096, -39.509914487663096, -39.509914487663096, -29.509447280828528, -33.00944728082853, -33.00944728082853, -33.90132024574448, -32.40132024574448, -33.90132024574448, -37.70993214155732, -37.20993214155732, -37.70993214155732, -29.871855942725144, -29.871855942725144, -29.871855942725144, -29.782230428349436, -28.782230428349436, -30.782230428349436, -39.18334216885239, -37.683342168852406, -37.183342168852406, -34.34221318199055, -35.84221318199055, -35.84221318199055, -26.062751999390812, -27.562751999390812, -27.562751999390812, -30.221542456947535, -30.721542456947535, -31.221542456947535, -41.57312595017752, -41.57312595017752, -41.57312595017752, -27.314420634127647, -27.314420634127647, -27.314420634127647, -27.019763722513634, -27.019763722513634, -27.019763722513634, -30.134752755546177, -30.634752755546177, -30.634752755546177, -29.38156400822551, -29.38156400822551, -29.38156400822551, -30.573229369727873, -31.073229369727873, -31.073229369727873, -37.51767297331623, -36.01767297331624, -37.51767297331623, -34.8170328178916, -34.8170328178916, -34.8170328178916, -31.37632215864069, -31.37632215864069, -31.37632215864069, -29.447752126187847, -29.447752126187847, -29.447752126187847, -43.38371501755088, -43.38371501755088, -42.38371501755088, -37.21892803987771, -37.21892803987771, -37.21892803987771, -28.263522755836597, -26.763522755836597, -27.763522755836597, -32.03762320240494, -32.03762320240494, -31.037623202404934, -29.185223284144374, -30.185223284144374, -30.685223284144374, -24.05156548298029, -24.05156548298029, -24.05156548298029, -25.584296057632194, -25.584296057632194, -25.584296057632194, -37.48528603754955, -37.48528603754955, -35.98528603754955, -40.85623130160747, -40.85623130160747, -40.85623130160747, -36.235519827571316, -36.235519827571316, -36.235519827571316, -34.85922497654466, -34.35922497654466, -34.85922497654466, -28.443961618127926, -28.443961618127926, -28.443961618127926, -26.770539744271954, -26.770539744271954, -26.770539744271954, -30.93422805286034, -30.93422805286034, -31.43422805286034, -27.77247843982215, -27.77247843982215, -28.77247843982215, -28.144171597898858, -28.144171597898858, -28.144171597898858, -35.91026955931907, -36.91026955931907, -35.41026955931907, -35.81313192639931, -35.81313192639931, -35.81313192639931, -27.568485621715322, -27.068485621715322, -27.568485621715322, -28.64267970667248, -28.64267970667248, -28.64267970667248, -27.867153952505692, -27.867153952505692, -27.867153952505692, -27.297219058680845, -27.297219058680845, -27.297219058680845, -39.23019268068106, -39.23019268068106, -39.23019268068106, -40.77452987895345, -40.77452987895345, -40.27452987895345, -28.724858646276417, -28.724858646276417, -28.724858646276417, -35.86784853540222, -34.36784853540221, -34.86784853540222, -36.073150070521535, -36.073150070521535, -36.073150070521535, -31.716087339837035, -31.716087339837035, -31.716087339837035, -29.03531950364993, -28.03531950364993, -28.03531950364993, -35.76124118643259, -35.76124118643259, -37.26124118643259, -40.726565784104146, -41.22656578410413, -41.22656578410413, -42.40220100822198, -40.90220100822198, -42.40220100822198, -36.34494741264168, -36.34494741264168, -36.34494741264168, -30.739784717278926, -30.739784717278926, -30.739784717278926, -33.4643813359189, -35.4643813359189, -35.4643813359189, -29.40754823475114, -29.40754823475114, -29.40754823475114, -27.852555839890456, -27.852555839890456, -26.852555839890456, -30.527139361730235, -30.527139361730235, -30.527139361730235, -38.6435348107749, -38.1435348107749, -38.6435348107749, -35.77970342925742, -35.77970342925742, -35.77970342925742, -27.34981754118822, -27.34981754118822, -27.34981754118822, -22.29936583483559, -22.29936583483559, -22.29936583483559, -22.780161165675494, -25.780161165675494, -25.780161165675494, -25.009561687623354, -24.509561687623354, -24.009561687623357, -24.02475136749754, -24.02475136749754, -24.02475136749754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31397166618169964, "mean_inference_ms": 1.2706410349712882, "mean_action_processing_ms": 0.07006268788844196, "mean_env_wait_ms": 0.5828219321280417, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 1533.47, "sample_throughput": 2086.771, "load_time_ms": 0.128, "load_throughput": 24989336.809, "learn_time_ms": 777.662, "learn_throughput": 4114.899, "update_time_ms": 1.468}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 74.52284088134766, "policy_loss": -0.0036276660676812732, "vf_loss": 74.5410545349121, "vf_explained_var": -0.02384002208709717, "kl": 0.005698879894000514, "entropy": 1.4588055253028869, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 288000, "num_steps_trained": 96000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3840, "training_iteration": 30, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-22", "timestamp": 1718736382, "time_this_iter_s": 1.4444844722747803, "time_total_s": 46.176023721694946, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 46.176023721694946, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 34.45, "ram_util_percent": 30.3}}
{"episode_reward_max": -71.16238643138395, "episode_reward_min": -145.8266043749203, "episode_reward_mean": -98.213434973804, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -48.60886812497342}, "policy_reward_max": {"shared_policy": -23.33809061545787}, "policy_reward_mean": {"shared_policy": -32.73781165793467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-80.4461187586337, -88.19737000952439, -110.60297033558278, -95.65643399388652, -78.6002446812762, -127.49851862223721, -95.43327675147798, -75.81916488272542, -71.16238643138395, -91.36339883684803, -110.1627832605644, -77.175546385691, -97.38856545080803, -82.53765191934252, -102.07817650132004, -95.96957490030212, -98.66223383951146, -103.58255987862407, -101.857747445309, -89.50379654639333, -79.9393194370389, -111.78656769356289, -132.54293622457573, -84.37588252514436, -94.97564409394448, -89.41345415987345, -92.20832100336004, -89.7864307439729, -101.61637539742655, -93.46604707264133, -101.61207410319436, -99.59527408442676, -112.82584112851038, -90.99517796250615, -122.47869361668283, -119.06186075685169, -72.87056566354049, -89.76714385972788, -105.15863906400017, -104.66492312808373, -94.92412829921736, -87.48256732689137, -117.16385186464815, -91.90653034587234, -91.55368240372685, -98.36951439489668, -86.40045820660902, -110.08667141933316, -85.25294864611953, -95.63328450897396, -92.41698675727193, -95.95822868961314, -109.18433688330929, -98.26280544496291, -104.04932794895234, -101.35059972776924, -89.22054947821904, -91.7710374502643, -91.94879970887915, -108.15831092470751, -80.15052608529288, -128.44807447013514, -114.92521867884112, -124.85516952018995, -129.0555375538615, -91.7647042520261, -86.25764931291863, -115.29323131507175, -124.38159442230301, -122.44785922346969, -85.01435251719602, -85.15822001970018, -90.91240924803301, -94.54316103354672, -79.64073631427321, -92.82756462799547, -114.56098830944165, -85.2365295533574, -72.01427184637356, -103.96600074453896, -114.86333611964876, -106.69203073846603, -103.44010795028898, -108.30278245796522, -97.65024893131184, -109.38846766532568, -145.8266043749203, -79.84710610339968, -103.81755492726157, -126.5700224138445, -100.10770619736898, -93.45832914434358, -85.46336399900261, -99.44013928377755, -99.59320092094582, -90.8668472118644, -112.37940122197578, -99.94659999595173, -80.99215396726457, -80.78153234115725, -92.3190864673962, -103.71984255278034, -107.9000626184289, -80.06640603132387, -80.65624910167946, -73.44030578869855, -118.42100387650214, -83.10352593728372, -76.05139849084118, -114.2989333367521, -83.28320856549917, -77.92377127842028, -103.16338055889958, -81.8802179613631, -105.30332985256418, -107.31599601874126, -94.26375077721772, -126.51227700782759, -118.32860829219075, -92.84519574667671], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-26.815372919544576, -26.815372919544576, -26.815372919544576, -29.399123336508143, -29.399123336508143, -29.399123336508143, -37.534323445194225, -35.534323445194225, -37.534323445194225, -31.88547799796218, -31.88547799796218, -31.88547799796218, -26.533414893758746, -25.533414893758746, -26.533414893758746, -42.4995062074124, -42.4995062074124, -42.4995062074124, -31.811092250492646, -31.811092250492646, -31.811092250492646, -25.273054960908468, -25.273054960908468, -25.273054960908468, -23.887462143794657, -23.387462143794657, -23.887462143794657, -30.95446627894934, -30.95446627894934, -29.45446627894934, -36.72092775352147, -36.72092775352147, -36.72092775352147, -25.72518212856366, -25.72518212856366, -25.72518212856366, -32.79618848360267, -32.29618848360267, -32.29618848360267, -27.679217306447498, -27.679217306447498, -27.179217306447498, -34.02605883377334, -34.02605883377334, -34.02605883377334, -31.989858300100703, -31.989858300100703, -31.989858300100703, -32.887411279837146, -32.887411279837146, -32.887411279837146, -35.02751995954134, -34.52751995954134, -34.02751995954134, -34.95258248176968, -34.95258248176968, -31.95258248176969, -30.16793218213109, -29.16793218213109, -30.16793218213109, -26.646439812346294, -26.646439812346294, -26.646439812346294, -37.26218923118762, -37.26218923118762, -37.26218923118762, -43.8476454081919, -44.3476454081919, -44.3476454081919, -28.125294175048136, -28.125294175048136, -28.125294175048136, -31.658548031314837, -31.658548031314837, -31.658548031314837, -29.804484719957806, -29.804484719957806, -29.804484719957806, -30.902773667786683, -30.902773667786683, -30.402773667786683, -30.595476914657624, -30.595476914657624, -28.595476914657628, -33.8721251324755, -33.8721251324755, -33.8721251324755, -31.15534902421377, -31.15534902421377, -31.15534902421377, -34.370691367731474, -32.870691367731474, -34.370691367731474, -32.19842469480893, -33.69842469480893, -33.69842469480893, -38.10861370950345, -36.60861370950345, -38.10861370950345, -30.498392654168725, -30.498392654168725, -29.998392654168725, -41.32623120556094, -41.32623120556094, -39.82623120556094, -40.35395358561723, -38.353953585617234, -40.35395358561723, -24.62352188784684, -24.62352188784684, -23.62352188784684, -30.589047953242606, -30.589047953242606, -28.589047953242606, -35.719546354666726, -34.219546354666726, -35.219546354666726, -34.88830770936122, -34.88830770936122, -34.88830770936122, -31.641376099739105, -31.641376099739105, -31.641376099739105, -29.160855775630445, -29.160855775630445, -29.160855775630445, -39.55461728821604, -39.55461728821604, -38.054617288216036, -30.802176781957435, -30.802176781957435, -30.302176781957435, -30.51789413457562, -30.51789413457562, -30.51789413457562, -32.7898381316322, -32.7898381316322, -32.7898381316322, -29.63348606886968, -29.63348606886968, -27.13348606886968, -37.028890473111055, -37.028890473111055, -36.028890473111055, -29.084316215373164, -27.084316215373164, -29.084316215373164, -31.877761502991348, -31.877761502991348, -31.877761502991348, -31.305662252423986, -29.805662252423986, -31.305662252423986, -32.15274289653772, -32.15274289653772, -31.652742896537717, -36.72811229443641, -35.72811229443641, -36.72811229443641, -32.75426848165432, -32.75426848165432, -32.75426848165432, -35.3497759829841, -33.3497759829841, -35.3497759829841, -32.78353324258973, -34.28353324258973, -34.28353324258973, -29.906849826073014, -29.906849826073014, -29.406849826073014, -30.59034581675477, -30.59034581675477, -30.59034581675477, -31.48293323629308, -31.48293323629308, -28.98293323629308, -36.052770308235836, -36.052770308235836, -36.052770308235836, -26.716842028430957, -26.716842028430957, -26.716842028430957, -42.81602482337838, -42.81602482337838, -42.81602482337838, -38.47507289294702, -38.47507289294702, -37.97507289294703, -41.61838984006328, -41.61838984006328, -41.61838984006328, -42.68517918462048, -43.18517918462048, -43.18517918462048, -28.92156808400871, -31.42156808400871, -31.42156808400871, -28.752549770972887, -28.752549770972887, -28.752549770972887, -38.43107710502392, -38.43107710502392, -38.43107710502392, -41.960531474101, -40.460531474101, -41.960531474101, -40.81595307448989, -40.81595307448989, -40.81595307448989, -28.67145083906535, -27.67145083906535, -28.67145083906535, -28.719406673233387, -28.719406673233387, -27.719406673233387, -30.63746974934433, -30.63746974934433, -29.63746974934433, -31.514387011182215, -31.514387011182215, -31.514387011182215, -26.546912104757737, -26.546912104757737, -26.546912104757737, -30.94252154266516, -30.94252154266516, -30.94252154266516, -38.35366276981387, -37.85366276981387, -38.35366276981387, -28.41217651778579, -28.41217651778579, -28.41217651778579, -24.33809061545787, -23.33809061545787, -24.33809061545787, -32.98866691484632, -35.48866691484632, -35.48866691484632, -38.28777870654958, -38.28777870654958, -38.28777870654958, -35.730676912822, -35.730676912822, -35.230676912822, -34.48003598342967, -34.48003598342967, -34.48003598342967, -36.100927485988386, -36.100927485988386, -36.100927485988386, -32.55008297710394, -32.55008297710394, -32.55008297710394, -36.462822555108566, -36.462822555108566, -36.462822555108566, -48.60886812497342, -48.60886812497342, -48.60886812497342, -26.615702034466565, -26.615702034466565, -26.615702034466565, -34.605851642420525, -34.605851642420525, -34.605851642420525, -42.52334080461484, -41.52334080461483, -42.52334080461484, -33.36923539912303, -33.36923539912303, -33.36923539912303, -31.152776381447868, -31.152776381447868, -31.152776381447868, -28.48778799966755, -28.48778799966755, -28.48778799966755, -33.14671309459251, -33.14671309459251, -33.14671309459251, -32.86440030698194, -33.36440030698194, -33.36440030698194, -30.622282403954802, -30.622282403954802, -29.622282403954802, -36.79313374065859, -37.79313374065858, -37.79313374065858, -33.31553333198391, -33.31553333198391, -33.31553333198391, -26.99738465575486, -26.99738465575486, -26.99738465575486, -26.92717744705242, -26.92717744705242, -26.92717744705242, -30.93969548913205, -30.43969548913205, -30.93969548913205, -34.90661418426012, -34.90661418426012, -33.90661418426012, -35.9666875394763, -35.9666875394763, -35.9666875394763, -26.688802010441282, -26.688802010441282, -26.688802010441282, -27.05208303389315, -26.55208303389315, -27.05208303389315, -25.14676859623285, -24.64676859623285, -23.64676859623285, -40.640334625500714, -40.640334625500714, -37.140334625500714, -27.701175312427907, -27.701175312427907, -27.701175312427907, -25.350466163613717, -25.350466163613717, -25.350466163613717, -38.099644445584, -38.099644445584, -38.099644445584, -28.927736188499736, -26.427736188499736, -27.927736188499736, -26.30792375947342, -26.30792375947342, -25.307923759473418, -34.88779351963318, -34.88779351963318, -33.387793519633185, -27.293405987121016, -27.293405987121016, -27.293405987121016, -35.43444328418807, -35.43444328418807, -34.43444328418806, -36.43866533958043, -35.43866533958043, -35.43866533958043, -31.087916925739233, -31.587916925739233, -31.587916925739233, -41.670759002609174, -42.670759002609174, -42.170759002609174, -38.109536097396905, -40.109536097396905, -40.109536097396905, -30.948398582225575, -30.948398582225575, -30.948398582225575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3138358428850491, "mean_inference_ms": 1.2708364697596608, "mean_action_processing_ms": 0.07010524449071125, "mean_env_wait_ms": 0.5830258758855604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 99200, "timesteps_this_iter": 0, "agent_timesteps_total": 297600, "timers": {"sample_time_ms": 1500.61, "sample_throughput": 2132.466, "load_time_ms": 0.128, "load_throughput": 25007961.245, "learn_time_ms": 772.436, "learn_throughput": 4142.738, "update_time_ms": 1.441}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 83.73821258544922, "policy_loss": -0.0025914245920721337, "vf_loss": 83.75517044067382, "vf_explained_var": -0.01988910436630249, "kl": 0.005279512315490972, "entropy": 1.4365188121795653, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 99200, "num_agent_steps_sampled": 297600, "num_steps_trained": 99200, "num_agent_steps_trained": 297600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3960, "training_iteration": 31, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-24", "timestamp": 1718736384, "time_this_iter_s": 1.5197455883026123, "time_total_s": 47.69576930999756, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 47.69576930999756, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 40.0, "ram_util_percent": 30.3}}
{"episode_reward_max": -68.48351405610808, "episode_reward_min": -139.78150353753642, "episode_reward_mean": -99.4692066370929, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -46.760501179178775}, "policy_reward_max": {"shared_policy": -22.19946702758149}, "policy_reward_mean": {"shared_policy": -33.15640221236429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.0407533342103, -132.40987235767818, -123.35395133089331, -82.7937068442143, -115.10523164831866, -84.46656960751315, -110.30742444138242, -89.16769732570276, -103.43971913818642, -128.57180326008165, -76.50711655927589, -101.62799199300598, -102.8621067769897, -93.70284018881483, -121.61417506584269, -86.06646884539235, -130.83165589361676, -102.29318046262625, -91.07751347070189, -124.62258854527944, -83.67008883664244, -87.34490224874732, -91.53926126713164, -76.68140411281189, -121.23968296668885, -84.74969645278411, -102.91154192239456, -104.0603120439731, -101.9252561591717, -107.99367088901253, -106.34630835785704, -84.39720140348328, -103.03113276390552, -88.90017909383185, -101.34554541252993, -139.78150353753642, -103.61508698189877, -99.00074718888462, -111.496472349721, -100.96775437496552, -106.31199274168901, -117.51044782668403, -103.99978926606232, -77.99873085129147, -109.16055478966763, -86.73564709590674, -88.6174676627056, -102.64774687477531, -103.66292771819123, -100.51133250119277, -96.30963361502002, -100.60102156959567, -83.23089130966764, -89.68434183295616, -82.00448402458325, -78.93996744463198, -82.01357085159671, -84.61862357420662, -128.32726283765948, -102.13432566592776, -68.59840108274446, -100.74153778855043, -92.17404794735876, -106.42202614375617, -87.08749937419475, -112.33498172793853, -85.74605886386267, -100.13066024467408, -99.75530343743924, -102.64634304824412, -86.61781180846134, -114.22133633808643, -128.25106797175076, -124.53112521858507, -89.98750125924302, -90.26312634984747, -89.49030420006211, -91.57592064169945, -104.21975970406267, -102.44257435210834, -92.5917182014368, -101.3418006611462, -74.71648676048568, -89.22485818068674, -120.50462596235849, -83.4114972770294, -77.57752152149456, -110.94076681445978, -86.39628200278551, -93.25362785971726, -98.25775829657418, -83.84374989878974, -72.16570846656104, -128.02071658856525, -97.0815737915283, -106.75647586398105, -97.65885667156982, -115.61508564033072, -97.57280365967485, -81.39776138109399, -101.73091493285166, -123.49537508288232, -111.62808673174031, -110.48548126154627, -112.34701651396882, -85.91000972228879, -112.81561153850106, -106.74923225903069, -86.83994130951946, -105.96489241189492, -102.98170690744269, -110.24399395196323, -115.54244564259565, -89.4533456177177, -68.48351405610808, -101.65264306625036, -138.41401850812207, -79.3188634517314, -96.01840524873177, -88.25516495541189, -128.4151792600458, -115.24073562758542, -90.68589287499461, -109.47416674105237, -83.90113170534445, -79.72276188853306, -84.32897875438624, -83.29169989858993, -96.01119033881274, -117.14652405178151], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-27.51358444473675, -27.01358444473675, -27.51358444473675, -44.136624119226035, -44.136624119226035, -44.136624119226035, -41.11798377696444, -41.11798377696444, -41.11798377696444, -26.931235614738103, -27.431235614738103, -28.431235614738103, -38.368410549439545, -38.368410549439545, -38.368410549439545, -28.488856535837705, -27.488856535837705, -28.488856535837705, -36.76914148046081, -36.76914148046081, -36.76914148046081, -29.722565775234248, -29.722565775234248, -29.722565775234248, -34.8132397127288, -33.8132397127288, -34.8132397127288, -42.85726775336053, -42.85726775336053, -42.85726775336053, -25.5023721864253, -25.5023721864253, -25.5023721864253, -33.875997331002004, -33.875997331002004, -33.875997331002004, -34.28736892566325, -34.28736892566325, -34.28736892566325, -31.23428006293826, -31.23428006293826, -31.23428006293826, -40.87139168861426, -39.87139168861426, -40.87139168861426, -28.68882294846412, -28.68882294846412, -28.68882294846412, -43.77721863120556, -43.77721863120556, -43.27721863120556, -34.097726820875394, -34.097726820875394, -34.097726820875394, -30.192504490233972, -31.192504490233972, -29.692504490233972, -40.540862848426485, -42.0408628484265, -42.0408628484265, -27.89002961221412, -27.89002961221412, -27.89002961221412, -28.11496741624909, -29.61496741624909, -29.61496741624909, -30.679753755710564, -30.679753755710564, -30.179753755710564, -25.560468037603965, -25.560468037603965, -25.560468037603965, -39.913227655562935, -40.413227655562935, -40.913227655562935, -28.41656548426137, -27.91656548426137, -28.41656548426137, -34.47051397413152, -33.97051397413152, -34.47051397413152, -35.18677068132437, -33.68677068132437, -35.18677068132437, -34.80841871972387, -32.808418719723875, -34.30841871972387, -36.66455696300418, -36.16455696300418, -35.16455696300418, -35.448769452619004, -35.448769452619004, -35.448769452619004, -28.29906713449442, -27.79906713449442, -28.29906713449442, -34.67704425463515, -34.67704425463515, -33.67704425463515, -29.633393031277276, -29.633393031277276, -29.633393031277276, -33.78184847084329, -33.78184847084329, -33.78184847084329, -46.760501179178775, -46.760501179178775, -46.260501179178775, -34.70502899396623, -34.70502899396623, -34.20502899396623, -33.000249062961565, -33.000249062961565, -33.000249062961565, -37.332157449906965, -37.832157449906965, -36.332157449906965, -33.82258479165515, -33.82258479165515, -33.32258479165515, -35.43733091389634, -35.43733091389634, -35.43733091389634, -39.50348260889467, -38.50348260889467, -39.50348260889467, -34.66659642202075, -34.66659642202075, -34.66659642202075, -25.99957695043049, -25.99957695043049, -25.99957695043049, -36.38685159655588, -36.38685159655588, -36.38685159655588, -28.911882365302247, -28.911882365302247, -28.911882365302247, -29.705822554235215, -29.205822554235215, -29.705822554235215, -34.215915624925124, -34.215915624925124, -34.215915624925124, -34.22097590606374, -34.72097590606374, -34.72097590606374, -33.50377750039758, -33.50377750039758, -33.50377750039758, -32.43654453834001, -31.43654453834001, -32.43654453834001, -33.53367385653189, -33.53367385653189, -33.53367385653189, -27.743630436555893, -27.743630436555893, -27.743630436555893, -29.894780610985393, -29.894780610985393, -29.894780610985393, -27.501494674861092, -27.001494674861092, -27.501494674861092, -26.646655814877334, -26.646655814877334, -25.64665581487733, -28.004523617198885, -26.004523617198885, -28.004523617198885, -28.206207858068858, -28.206207858068858, -28.206207858068858, -43.27575427921981, -41.77575427921981, -43.27575427921981, -34.044775221975904, -34.044775221975904, -34.044775221975904, -23.19946702758149, -22.19946702758149, -23.19946702758149, -33.58051259618348, -33.58051259618348, -33.58051259618348, -30.724682649119597, -30.724682649119597, -30.724682649119597, -36.30734204791871, -35.30734204791871, -34.80734204791871, -29.029166458064914, -29.029166458064914, -29.029166458064914, -37.444993909312835, -37.444993909312835, -37.444993909312835, -28.58201962128757, -28.58201962128757, -28.58201962128757, -33.37688674822469, -33.37688674822469, -33.37688674822469, -33.251767812479756, -33.251767812479756, -33.251767812479756, -33.54878101608138, -34.54878101608138, -34.54878101608138, -27.539270602820444, -29.539270602820444, -29.539270602820444, -38.07377877936214, -38.07377877936214, -38.07377877936214, -42.75035599058363, -42.75035599058363, -42.75035599058363, -42.34370840619501, -41.34370840619501, -40.84370840619501, -30.16250041974767, -30.16250041974767, -29.66250041974767, -30.087708783282494, -30.087708783282494, -30.087708783282494, -30.496768066687377, -30.496768066687377, -28.496768066687377, -31.358640213899797, -31.358640213899797, -28.858640213899797, -34.739919901354234, -34.739919901354234, -34.739919901354234, -33.98085811736944, -34.48085811736944, -33.98085811736944, -30.8639060671456, -30.8639060671456, -30.8639060671456, -33.11393355371541, -34.11393355371541, -34.11393355371541, -25.23882892016191, -25.23882892016191, -24.23882892016191, -29.741619393562246, -29.741619393562246, -29.741619393562246, -40.16820865411948, -40.16820865411948, -40.16820865411948, -27.803832425676454, -27.803832425676454, -27.803832425676454, -25.19250717383153, -26.19250717383153, -26.19250717383153, -36.980255604819895, -36.980255604819895, -36.980255604819895, -28.798760667595197, -28.798760667595197, -28.798760667595197, -30.917875953239097, -30.917875953239097, -31.417875953239097, -32.752586098858075, -32.752586098858075, -32.752586098858075, -27.94791663292991, -27.94791663292991, -27.94791663292991, -25.221902822187033, -24.221902822187033, -22.721902822187033, -43.50690552952177, -41.00690552952177, -43.50690552952177, -32.69385793050943, -32.69385793050943, -31.693857930509434, -35.585491954660355, -35.585491954660355, -35.585491954660355, -32.71961889052327, -32.21961889052327, -32.71961889052327, -38.705028546776894, -38.205028546776894, -38.705028546776894, -32.52426788655828, -32.52426788655828, -32.52426788655828, -26.799253793697975, -26.79925379369798, -27.79925379369798, -33.91030497761723, -33.91030497761723, -33.91030497761723, -41.16512502762744, -41.16512502762744, -41.16512502762744, -37.70936224391345, -37.70936224391345, -36.20936224391345, -36.49516042051542, -36.99516042051542, -36.99516042051542, -37.94900550465625, -36.44900550465625, -37.94900550465625, -28.63666990742959, -28.63666990742959, -28.63666990742959, -37.77187051283367, -37.77187051283367, -37.27187051283367, -35.58307741967691, -35.58307741967691, -35.58307741967691, -29.113313769839813, -29.113313769839813, -28.613313769839813, -35.321630803964986, -35.321630803964986, -35.321630803964986, -34.66056896914756, -33.66056896914756, -34.66056896914756, -37.74799798398772, -38.24799798398772, -34.24799798398772, -38.84748188086521, -38.84748188086521, -37.84748188086521, -29.81778187257255, -29.81778187257255, -29.81778187257255, -22.82783801870269, -22.82783801870269, -22.82783801870269, -33.88421435541678, -33.88421435541678, -33.88421435541678, -46.13800616937402, -46.13800616937402, -46.13800616937402, -26.77295448391048, -26.77295448391048, -25.77295448391048, -32.17280174957723, -31.672801749577232, -32.17280174957723, -30.085054985137305, -28.085054985137305, -30.085054985137305, -42.80505975334859, -42.30505975334859, -43.305059753348594, -38.41357854252848, -38.41357854252848, -38.41357854252848, -30.228630958331518, -30.228630958331518, -30.228630958331518, -36.82472224701743, -36.32472224701743, -36.32472224701743, -27.967043901781505, -27.967043901781505, -27.967043901781505, -26.740920629510992, -26.240920629510992, -26.740920629510992, -28.109659584795413, -28.109659584795413, -28.109659584795413, -27.76389996619665, -27.76389996619665, -27.76389996619665, -32.00373011293756, -32.00373011293756, -32.00373011293756, -39.048841350593825, -39.048841350593825, -39.048841350593825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31427825385385066, "mean_inference_ms": 1.2731877775725857, "mean_action_processing_ms": 0.07022958564963172, "mean_env_wait_ms": 0.5839170439729187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 102400, "timesteps_this_iter": 0, "agent_timesteps_total": 307200, "timers": {"sample_time_ms": 1494.792, "sample_throughput": 2140.767, "load_time_ms": 0.129, "load_throughput": 24827548.65, "learn_time_ms": 770.374, "learn_throughput": 4153.828, "update_time_ms": 1.433}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 84.67428817749024, "policy_loss": -0.0021422085128336545, "vf_loss": 84.69053344726562, "vf_explained_var": -0.01955884099006653, "kl": 0.005734277401472183, "entropy": 1.4105140924453736, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 102400, "num_agent_steps_sampled": 307200, "num_steps_trained": 102400, "num_agent_steps_trained": 307200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4090, "training_iteration": 32, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-25", "timestamp": 1718736385, "time_this_iter_s": 1.5413308143615723, "time_total_s": 49.23710012435913, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924400d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 49.23710012435913, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 42.55, "ram_util_percent": 30.3}}
{"episode_reward_max": -67.15825670502333, "episode_reward_min": -150.47267915736836, "episode_reward_mean": -97.07073342136637, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -52.15755971912283}, "policy_reward_max": {"shared_policy": -21.052752235007777}, "policy_reward_mean": {"shared_policy": -32.35691114045545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.1771245423617, -98.72735013005811, -98.38494911139377, -76.34170886540282, -90.75624320379403, -114.50294871314844, -110.28365109243579, -93.79860611645952, -115.70550707117626, -93.70056412605295, -83.91712503293851, -98.75918020816162, -94.74088142618139, -132.46970513445058, -92.72151597578814, -78.10407952821137, -94.48558846886229, -106.95162398116511, -92.15672696098112, -113.60545010967232, -106.72189324724954, -95.60612881515372, -70.9262690028296, -86.46538674246325, -81.75650437455265, -80.84903234767197, -98.84635427643258, -111.3990635524767, -102.69511081394648, -84.90946608345492, -94.81524399710446, -97.1884228112024, -77.02097891172755, -69.2170453054437, -101.93547337017247, -101.24073797685341, -96.06564168095882, -77.89751728006387, -80.6381148010382, -101.29189227733866, -91.74876582746226, -103.64606229291509, -91.58149307162456, -81.6845419462536, -94.39081862876473, -98.87518356993132, -74.96738632992817, -105.59806815852082, -96.08137485673069, -87.53773382560496, -116.73517925453173, -72.01087365902106, -113.08470621755717, -96.2037482497362, -88.82065318422042, -90.26849735761968, -97.59233741002754, -95.1037405240004, -72.69807811412541, -67.15825670502333, -89.96027130999806, -96.96828669192377, -113.80422898695221, -98.74516247897478, -86.46637533649145, -76.39211399461958, -91.72688462574021, -103.01068581192945, -92.07864909707419, -85.58964418469635, -117.64167640578303, -108.29405850227701, -122.06038562814945, -90.83215194526672, -97.39382199812202, -150.47267915736836, -79.24353938904356, -97.98123175498904, -107.17870196184953, -84.56350719326723, -87.84269107431939, -83.73086230846017, -105.77968173792411, -112.1037106548847, -130.18036256328048, -86.55801129499706, -109.70506740751026, -129.7393753552619, -92.105824490462, -104.36639820976016, -92.08256968280297, -97.33273742448382, -104.04972668742066, -85.40253766249808, -98.54384651382361, -91.10567810166819, -107.61138171806431, -85.86779923000147, -125.84248229142491, -115.25145901870694, -107.41935699631225, -88.49240193465438, -113.56079312421664, -91.42215070228669, -83.43403228617521, -100.37184759283419, -96.92855611461786, -90.20664605668145, -124.11222956799644, -75.61672976547665, -94.10647817460655, -89.55058162149587, -74.31286723483909, -118.99508866359476, -102.32681165924649, -120.53747288941554, -105.55254873897259, -85.34017509508348, -97.54474489646974, -112.17691103831983, -91.76930081528582, -118.66133438767503, -100.48196169147164, -79.40972978913078, -80.99468613060692, -103.37099588001149, -106.27806439345098, -84.27950021697069, -121.30906776962853, -90.46171301739885], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.72570818078726, -33.72570818078726, -33.72570818078726, -31.57578337668602, -33.57578337668602, -33.57578337668602, -32.79498303713127, -32.79498303713127, -32.79498303713127, -25.447236288467604, -25.447236288467604, -25.447236288467604, -30.252081067931357, -30.252081067931357, -30.252081067931357, -38.16764957104951, -38.16764957104951, -38.16764957104951, -35.92788369747857, -37.42788369747857, -36.92788369747857, -31.766202038819877, -30.266202038819877, -31.766202038819877, -38.23516902372543, -39.23516902372543, -38.23516902372543, -31.233521375350964, -31.233521375350964, -31.233521375350964, -27.639041677646194, -28.139041677646194, -28.139041677646194, -33.25306006938721, -33.25306006938721, -32.25306006938721, -30.413627142060466, -31.41362714206047, -32.91362714206047, -44.48990171148352, -43.48990171148352, -44.48990171148352, -30.907171991929363, -30.907171991929363, -30.907171991929363, -26.3680265094038, -26.3680265094038, -25.3680265094038, -31.161862822954095, -31.161862822954095, -32.16186282295409, -35.65054132705504, -35.65054132705504, -35.65054132705504, -29.385575653660347, -31.385575653660347, -31.385575653660347, -37.36848336989077, -38.36848336989077, -37.86848336989077, -35.573964415749856, -35.573964415749856, -35.573964415749856, -32.86870960505123, -31.368709605051226, -31.368709605051226, -21.30875633427653, -24.308756334276524, -25.308756334276524, -28.98846224748774, -28.98846224748774, -28.48846224748774, -27.252168124850886, -27.252168124850886, -27.252168124850886, -26.94967744922399, -26.94967744922399, -26.94967744922399, -32.94878475881085, -32.94878475881085, -32.94878475881085, -37.633021184158906, -37.633021184158906, -36.133021184158906, -33.2317036046488, -34.7317036046488, -34.7317036046488, -28.80315536115166, -28.80315536115166, -27.30315536115166, -30.93841466570148, -31.93841466570148, -31.93841466570148, -33.06280760373415, -31.56280760373415, -32.56280760373415, -26.006992970575865, -25.006992970575865, -26.006992970575865, -23.239015101814584, -22.739015101814584, -23.239015101814584, -34.14515779005749, -33.64515779005749, -34.14515779005749, -33.913579325617796, -33.413579325617796, -33.913579325617796, -32.52188056031959, -32.52188056031959, -31.02188056031959, -26.799172426687953, -26.299172426687953, -24.799172426687953, -26.87937160034607, -26.87937160034607, -26.87937160034607, -33.763964092446216, -33.763964092446216, -33.763964092446216, -30.582921942487403, -30.582921942487403, -30.582921942487403, -34.54868743097168, -34.54868743097168, -34.54868743097168, -30.5271643572082, -30.5271643572082, -30.5271643572082, -27.22818064875121, -27.22818064875121, -27.22818064875121, -31.463606209588235, -31.463606209588235, -31.463606209588235, -32.29172785664378, -33.29172785664378, -33.29172785664378, -24.989128776642712, -24.989128776642712, -24.989128776642712, -35.53268938617362, -34.53268938617362, -35.53268938617362, -29.52712495224356, -33.527124952243554, -33.027124952243554, -29.179244608535004, -29.179244608535004, -29.179244608535004, -38.91172641817726, -38.91172641817726, -38.91172641817726, -24.670291219673683, -24.670291219673683, -22.670291219673683, -37.36156873918574, -37.86156873918574, -37.86156873918574, -32.23458274991208, -32.23458274991208, -31.73458274991208, -29.606884394740153, -29.606884394740153, -29.606884394740153, -30.089499119206568, -30.089499119206568, -30.089499119206568, -32.53077913667583, -32.53077913667583, -32.53077913667583, -31.70124684133347, -31.70124684133347, -31.70124684133347, -24.23269270470848, -24.23269270470848, -24.23269270470848, -21.052752235007777, -23.052752235007777, -23.052752235007777, -30.32009043666603, -30.32009043666603, -29.32009043666603, -32.65609556397455, -32.65609556397455, -31.656095563974553, -37.26807632898404, -38.26807632898404, -38.26807632898404, -31.915054159658258, -33.41505415965826, -33.41505415965826, -28.822125112163825, -28.822125112163825, -28.822125112163825, -24.79737133153985, -25.79737133153985, -25.79737133153985, -29.575628208580074, -31.075628208580074, -31.075628208580074, -34.83689527064313, -33.33689527064313, -34.83689527064313, -31.192883032358075, -31.192883032358075, -29.692883032358075, -28.696548061565423, -28.196548061565423, -28.696548061565423, -39.21389213526101, -39.21389213526101, -39.21389213526101, -36.09801950075899, -36.09801950075899, -36.09801950075899, -40.68679520938314, -40.68679520938314, -40.68679520938314, -30.277383981755555, -30.277383981755555, -30.277383981755555, -32.797940666040674, -32.797940666040674, -31.79794066604067, -52.15755971912283, -49.65755971912283, -48.65755971912283, -26.41451312968118, -26.41451312968118, -26.41451312968118, -32.99374391832969, -32.99374391832969, -31.99374391832969, -36.059567320616495, -36.059567320616495, -35.059567320616495, -28.18783573108904, -28.18783573108904, -28.18783573108904, -29.280897024773136, -29.280897024773136, -29.280897024773136, -27.91028743615337, -27.91028743615337, -27.91028743615337, -35.09322724597472, -36.09322724597472, -34.59322724597472, -38.36790355162823, -37.36790355162823, -36.36790355162823, -44.56012085442681, -41.06012085442681, -44.56012085442681, -28.85267043166569, -28.85267043166569, -28.85267043166569, -37.068355802503426, -37.068355802503426, -35.568355802503426, -43.24645845175396, -43.24645845175396, -43.24645845175396, -30.868608163487327, -30.868608163487327, -30.368608163487327, -34.78879940325337, -34.78879940325337, -34.78879940325337, -30.694189894267662, -30.694189894267662, -30.694189894267662, -32.44424580816128, -32.44424580816128, -32.44424580816128, -34.683242229140234, -34.683242229140234, -34.683242229140234, -29.13417922083269, -29.13417922083269, -27.13417922083269, -33.3479488379412, -33.3479488379412, -31.847948837941196, -30.03522603388937, -30.53522603388937, -30.53522603388937, -35.20379390602145, -36.20379390602145, -36.20379390602145, -27.955933076667147, -28.955933076667147, -28.955933076667147, -42.28082743047498, -42.28082743047498, -41.28082743047498, -38.91715300623565, -38.91715300623565, -37.41715300623565, -35.8064523321041, -35.8064523321041, -35.8064523321041, -28.497467311551475, -29.997467311551475, -29.997467311551475, -37.8535977080722, -37.8535977080722, -37.8535977080722, -29.307383567428875, -31.807383567428875, -30.30738356742887, -27.81134409539171, -27.81134409539171, -27.81134409539171, -33.45728253094473, -33.45728253094473, -33.45728253094473, -32.80951870487262, -32.80951870487262, -31.30951870487262, -30.56888201889381, -30.56888201889381, -29.06888201889381, -41.03740985599881, -41.53740985599881, -41.53740985599881, -24.872243255158903, -25.372243255158903, -25.372243255158903, -31.035492724868867, -32.03549272486887, -31.035492724868867, -30.183527207165266, -29.183527207165266, -30.183527207165266, -24.937622411613045, -24.937622411613045, -24.437622411613045, -39.66502955453155, -39.66502955453155, -39.66502955453155, -33.77560388641551, -34.27560388641551, -34.27560388641551, -40.17915762980519, -40.17915762980519, -40.17915762980519, -35.18418291299087, -35.18418291299087, -35.18418291299087, -28.446725031694488, -28.446725031694488, -28.446725031694488, -32.514914965489936, -32.514914965489936, -32.514914965489936, -37.22563701277328, -37.725637012773284, -37.22563701277328, -30.589766938428603, -30.589766938428603, -30.589766938428603, -39.553778129224995, -39.553778129224995, -39.553778129224995, -32.49398723049053, -33.99398723049053, -33.99398723049053, -26.46990992971025, -26.46990992971025, -26.46990992971025, -27.331562043535627, -26.331562043535627, -27.331562043535627, -34.62366529333718, -34.62366529333718, -34.12366529333718, -35.42602146448363, -35.42602146448363, -35.42602146448363, -27.593166738990213, -28.593166738990213, -28.093166738990213, -40.76968925654284, -40.76968925654284, -39.76968925654284, -29.153904339132936, -30.653904339132932, -30.653904339132932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.313535918228645, "mean_inference_ms": 1.2700516440947165, "mean_action_processing_ms": 0.07004869016956712, "mean_env_wait_ms": 0.5826753915772835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 105600, "timesteps_this_iter": 0, "agent_timesteps_total": 316800, "timers": {"sample_time_ms": 1493.141, "sample_throughput": 2143.133, "load_time_ms": 0.129, "load_throughput": 24892011.869, "learn_time_ms": 772.992, "learn_throughput": 4139.756, "update_time_ms": 1.455}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005000000000000001, "total_loss": 78.42418746948242, "policy_loss": -0.002633156712399831, "vf_loss": 78.44079208374023, "vf_explained_var": -0.0428794264793396, "kl": 0.004491312782406898, "entropy": 1.3969488739967346, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105600, "num_agent_steps_sampled": 316800, "num_steps_trained": 105600, "num_agent_steps_trained": 316800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4220, "training_iteration": 33, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-27", "timestamp": 1718736387, "time_this_iter_s": 1.4866588115692139, "time_total_s": 50.723758935928345, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292440ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 50.723758935928345, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.8, "ram_util_percent": 30.366666666666664}}
{"episode_reward_max": -65.75950771577024, "episode_reward_min": -144.64392659718118, "episode_reward_mean": -97.78652807632884, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -49.214642199060364}, "policy_reward_max": {"shared_policy": -21.91983590525674}, "policy_reward_mean": {"shared_policy": -32.595509358776276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.70896392954462, -101.50302806028411, -87.47032119638014, -109.63800255605175, -101.57559921706496, -76.44195157756988, -88.9833018179684, -121.55719348220278, -91.05651677995378, -90.98831244827556, -117.0695150255841, -144.64392659718118, -73.53754652417699, -103.08899133093908, -92.7466919015773, -135.33552537499062, -125.71398647443755, -77.68637173907372, -98.06689223330106, -67.20898598361958, -109.08429814988854, -106.39429401516936, -80.65770531834924, -81.1792834514548, -102.54334175176545, -106.86849725354894, -88.87606311756812, -133.4450027973576, -108.24724138966168, -80.92079622704334, -108.09167609286291, -84.51928692684557, -96.45451205031947, -105.04267584762505, -93.4496569803284, -113.22680146813319, -79.0919990858878, -91.43544055558662, -107.4490562910803, -96.03024709097228, -92.46633906597764, -83.74634129810849, -101.12724461754313, -132.80145465678302, -119.70274976659815, -94.2354457863118, -103.07592452704536, -95.61037910341064, -94.49277766868853, -102.47561034382979, -104.97305890600558, -89.98356911022078, -101.69235053294553, -94.61665371895243, -76.03247027350888, -100.29431282434997, -107.02074347816306, -84.45712456207832, -100.47348786752144, -93.3088316445767, -112.86248684489641, -88.7094770497213, -122.51733394243254, -107.9799862029846, -120.70885295007098, -110.85764657553004, -111.55332695247408, -78.70867020235684, -96.72708542806318, -94.33941592880294, -110.42550660142622, -88.26342404724399, -102.12297827033215, -101.59614518370938, -83.28431882759764, -103.08340655145292, -86.45530716547454, -102.85688340106225, -111.62001392969918, -96.66962429366627, -101.87597317368682, -89.33231018066257, -88.36696658042973, -120.38508900430185, -129.27404426353058, -83.23215905607043, -104.29310346514936, -92.83839693493991, -93.40008393223252, -96.21141622336678, -90.74738691871737, -65.75950771577024, -81.05528551639736, -70.65795774492493, -87.10616025504795, -86.3481229200169, -107.65501535995311, -100.59360828665514, -109.47530812470815, -79.07112908589029, -100.86210449234532, -78.89639280547338, -85.324121667792, -101.52913122273813, -77.70920813230443, -109.6358486506838, -81.01348747271463, -97.85778957674295, -78.62075244040834, -113.98452157862448, -89.14060227632997, -116.29949818321231, -107.08156113412223, -109.7085397952814, -92.61624071628457, -111.35963418712075, -98.55424718876439, -78.40129785948224, -113.40326532756134, -84.54144762233516, -123.96014216040535, -85.02019240518386, -84.3149306590253, -79.47158780244848, -102.64166832828606, -69.3388512364263, -90.02277336606154, -100.01634651148574, -114.13886403915699, -91.14631612825278], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-29.40298797651488, -29.40298797651488, -27.90298797651488, -33.83434268676136, -33.83434268676136, -33.83434268676136, -29.15677373212672, -29.15677373212672, -29.15677373212672, -35.879334185350594, -36.879334185350594, -36.879334185350594, -34.19186640568831, -33.19186640568831, -34.19186640568831, -25.480650525856618, -25.480650525856618, -25.480650525856618, -29.661100605989464, -29.661100605989464, -29.661100605989464, -39.85239782740092, -39.85239782740093, -41.85239782740092, -30.352172259984602, -30.352172259984602, -30.352172259984602, -29.662770816091857, -30.662770816091857, -30.662770816091857, -39.0231716751947, -39.0231716751947, -39.0231716751947, -46.21464219906036, -49.214642199060364, -49.214642199060364, -24.512515508058996, -24.512515508058996, -24.512515508058996, -34.36299711031306, -34.36299711031306, -34.36299711031306, -30.915563967192437, -30.915563967192437, -30.915563967192437, -45.44517512499688, -44.44517512499688, -45.44517512499688, -42.40466215814586, -42.40466215814586, -40.90466215814586, -25.89545724635791, -25.89545724635791, -25.89545724635791, -32.68896407776701, -32.68896407776701, -32.68896407776701, -22.569661994539853, -22.569661994539853, -22.069661994539853, -36.36143271662953, -36.36143271662953, -36.36143271662953, -35.6314313383898, -35.1314313383898, -35.6314313383898, -27.38590177278308, -27.38590177278308, -25.88590177278308, -27.05976115048494, -27.05976115048494, -27.05976115048494, -34.51444725058848, -34.51444725058848, -33.51444725058848, -35.95616575118299, -35.95616575118299, -34.95616575118299, -29.62535437252269, -29.62535437252269, -29.62535437252269, -45.31500093245255, -45.31500093245255, -42.81500093245254, -35.91574712988723, -35.41574712988723, -36.91574712988723, -26.64026540901443, -26.64026540901443, -27.64026540901443, -36.53055869762099, -36.03055869762098, -35.53055869762098, -28.17309564228186, -28.17309564228186, -28.17309564228186, -32.151504016773146, -32.151504016773146, -32.151504016773146, -35.01422528254168, -35.51422528254168, -34.51422528254168, -31.149885660109472, -31.149885660109472, -31.149885660109472, -37.74226715604441, -37.74226715604441, -37.74226715604441, -26.530666361962606, -26.530666361962606, -26.03066636196261, -30.478480185195565, -30.478480185195565, -30.478480185195565, -36.31635209702678, -36.31635209702678, -34.81635209702678, -31.343415696990753, -32.34341569699075, -32.34341569699075, -30.988779688659204, -30.988779688659204, -30.488779688659204, -27.248780432702844, -28.24878043270284, -28.24878043270284, -33.70908153918105, -33.70908153918105, -33.70908153918105, -44.93381821892768, -44.93381821892768, -42.933818218927684, -39.234249922199346, -40.234249922199346, -40.234249922199346, -31.411815262103946, -31.411815262103946, -31.411815262103946, -34.35864150901512, -34.35864150901512, -34.35864150901512, -31.870126367803525, -31.870126367803525, -31.870126367803525, -33.33092588956285, -33.33092588956285, -27.830925889562856, -34.82520344794325, -33.82520344794325, -33.82520344794325, -34.32435296866853, -35.32435296866853, -35.32435296866853, -30.3278563700736, -29.827856370073604, -29.827856370073604, -33.89745017764852, -33.89745017764852, -33.89745017764852, -30.8722179063175, -31.8722179063175, -31.8722179063175, -25.510823424502956, -25.510823424502956, -25.010823424502956, -33.43143760811665, -33.43143760811665, -33.43143760811665, -36.006914492721016, -35.006914492721016, -36.006914492721016, -29.319041520692753, -28.819041520692753, -26.319041520692757, -33.49116262250715, -33.49116262250715, -33.49116262250715, -32.60294388152557, -31.10294388152556, -29.60294388152557, -37.95416228163214, -36.95416228163214, -37.95416228163214, -29.56982568324043, -29.069825683240424, -30.069825683240424, -41.50577798081086, -40.00577798081087, -41.00577798081087, -36.4933287343282, -36.4933287343282, -34.9933287343282, -40.23628431669033, -40.23628431669033, -40.23628431669033, -36.28588219184337, -37.28588219184337, -37.28588219184337, -37.684442317491346, -36.184442317491346, -37.684442317491346, -26.06955673411897, -26.06955673411897, -26.56955673411897, -32.24236180935438, -32.24236180935438, -32.24236180935438, -31.446471976267656, -31.446471976267656, -31.446471976267656, -36.808502200475395, -36.808502200475395, -36.808502200475395, -30.587808015747964, -30.587808015747964, -27.087808015747967, -34.040992756777385, -34.040992756777385, -34.040992756777385, -34.03204839456977, -33.53204839456977, -34.03204839456977, -28.09477294253254, -28.09477294253254, -27.09477294253254, -34.36113551715099, -34.36113551715099, -34.36113551715099, -28.151769055158166, -28.651769055158166, -29.651769055158166, -32.61896113368743, -35.11896113368742, -35.11896113368742, -37.70667130989971, -37.70667130989971, -36.206671309899704, -32.556541431222094, -31.556541431222094, -32.556541431222094, -33.958657724562265, -33.958657724562265, -33.958657724562265, -29.77743672688752, -29.77743672688752, -29.77743672688752, -29.455655526809913, -29.455655526809913, -29.455655526809913, -40.12836300143396, -40.12836300143396, -40.12836300143396, -43.42468142117686, -43.42468142117686, -42.42468142117686, -27.744053018690128, -27.744053018690128, -27.744053018690128, -34.09770115504978, -35.09770115504978, -35.09770115504978, -31.446132311646668, -31.446132311646668, -29.946132311646668, -31.133361310744167, -31.133361310744167, -31.133361310744167, -31.403805407788965, -32.403805407788965, -32.403805407788965, -30.249128972905797, -30.249128972905797, -30.249128972905797, -21.91983590525674, -21.91983590525674, -21.91983590525674, -26.68509517213245, -27.18509517213245, -27.18509517213245, -23.552652581641624, -23.552652581641624, -23.552652581641624, -29.035386751682676, -29.035386751682676, -29.035386751682676, -27.78270764000562, -29.28270764000562, -29.28270764000562, -35.885005119984356, -35.885005119984356, -35.885005119984356, -34.531202762218385, -34.531202762218385, -31.53120276221839, -36.49176937490269, -36.49176937490269, -36.49176937490269, -26.690376361963427, -27.190376361963427, -25.190376361963427, -33.620701497448444, -33.620701497448444, -33.620701497448444, -26.46546426849113, -25.965464268491125, -26.46546426849113, -27.77470722259732, -28.77470722259732, -28.77470722259732, -33.84304374091268, -33.84304374091268, -33.84304374091268, -26.40306937743479, -26.40306937743479, -24.90306937743479, -36.04528288356125, -37.04528288356125, -36.54528288356125, -27.004495824238187, -27.004495824238187, -27.004495824238187, -32.61926319224765, -32.61926319224765, -32.61926319224765, -26.20691748013612, -26.20691748013612, -26.20691748013612, -37.99484052620816, -37.99484052620816, -37.99484052620816, -29.71353409210999, -29.71353409210999, -29.71353409210999, -37.766499394404086, -39.266499394404086, -39.266499394404086, -36.02718704470742, -36.02718704470742, -35.02718704470742, -37.402846598427104, -34.9028465984271, -37.402846598427104, -30.87208023876153, -30.87208023876153, -30.87208023876153, -37.619878062373566, -37.619878062373566, -36.11987806237357, -33.35141572958813, -33.35141572958813, -31.851415729588133, -26.133765953160736, -26.133765953160736, -26.133765953160736, -38.30108844252045, -36.80108844252045, -38.30108844252045, -28.18048254077839, -28.18048254077839, -28.18048254077839, -41.32004738680177, -41.32004738680177, -41.32004738680177, -28.673397468394636, -28.673397468394636, -27.67339746839463, -28.10497688634176, -28.10497688634176, -28.10497688634176, -26.490529267482838, -26.490529267482838, -26.490529267482838, -34.8805561094287, -34.8805561094287, -32.8805561094287, -23.112950412142094, -23.112950412142094, -23.112950412142094, -30.007591122020518, -30.007591122020518, -30.007591122020518, -33.33878217049523, -33.33878217049523, -33.33878217049523, -38.21295467971899, -38.21295467971899, -37.71295467971899, -30.382105376084237, -30.382105376084237, -30.382105376084237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31421129103805107, "mean_inference_ms": 1.2725387904894023, "mean_action_processing_ms": 0.0702640237029056, "mean_env_wait_ms": 0.583909991120341, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 108800, "timesteps_this_iter": 0, "agent_timesteps_total": 326400, "timers": {"sample_time_ms": 1504.316, "sample_throughput": 2127.213, "load_time_ms": 0.129, "load_throughput": 24772559.616, "learn_time_ms": 777.634, "learn_throughput": 4115.048, "update_time_ms": 1.47}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 78.1169937133789, "policy_loss": -0.002349261909354716, "vf_loss": 78.13336563110352, "vf_explained_var": -0.03293983936309815, "kl": 0.004339241327540944, "entropy": 1.4021174430847168, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108800, "num_agent_steps_sampled": 326400, "num_steps_trained": 108800, "num_agent_steps_trained": 326400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4350, "training_iteration": 34, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-28", "timestamp": 1718736388, "time_this_iter_s": 1.6218669414520264, "time_total_s": 52.34562587738037, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 52.34562587738037, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 40.15, "ram_util_percent": 30.35}}
{"episode_reward_max": -65.5858102690614, "episode_reward_min": -126.9286272089067, "episode_reward_mean": -96.53010152493373, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -42.80954240296889}, "policy_reward_max": {"shared_policy": -21.861936756353806}, "policy_reward_mean": {"shared_policy": -32.17670050831124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.88298042712138, -86.80355341693013, -124.62617275898975, -111.96945700513682, -118.08483950986268, -65.5858102690614, -79.90134768804373, -79.78540390759059, -120.69552735925274, -121.99494878195979, -105.43037061138496, -118.81457032467094, -111.13104584949488, -77.82959447799178, -91.35379092298663, -112.29407285479604, -92.75420888675507, -126.9286272089067, -90.30882927245533, -93.55212544276743, -74.369195276639, -111.55878246753609, -87.22496682712803, -113.45167295381695, -94.20277147446237, -92.55968945037262, -119.24783911912402, -98.98102235056294, -107.201932271706, -91.27953815228466, -101.93606187183106, -100.79314285898573, -114.7692812362198, -97.86894258645579, -113.98565645317858, -99.43788310434032, -115.8034182753354, -96.35555062153759, -92.5887263849826, -125.7712176721939, -92.73517435354209, -85.65704397003455, -82.29380253595082, -73.07163929728951, -97.56678676692049, -93.20373429772584, -96.33847247336101, -100.08363979907476, -70.02620688113805, -100.12173167815405, -104.5845260207972, -80.25572017344872, -88.9736682489659, -101.24658297777201, -98.87641894297764, -99.65282069984988, -75.75258138996374, -81.80390219289467, -72.36757687056651, -105.34366838739555, -86.28990893215155, -92.938049421842, -123.40010502010367, -99.2460633228071, -77.48461905849372, -81.13025337550891, -108.56226520111049, -103.65537856050258, -81.22475050175636, -96.3438486068923, -125.39953243403676, -91.00328852131364, -102.42637600527101, -99.20553459404587, -93.92336597997489, -96.39884562915522, -112.4992400066702, -96.31440233566497, -98.87648937204592, -90.14921261896818, -93.46155575924665, -107.14085402905619, -83.59412678572052, -76.54113681130532, -84.1584037652371, -81.40918889752591, -110.99773070492313, -87.96089760583111, -89.93775724484064, -97.56780380371376, -80.06357473211752, -95.98267655083407, -79.32849956043002, -81.44593212324442, -94.24494588077259, -70.02361047325941, -93.01566588366767, -111.53043468926427, -84.41012329269479, -104.30481328594587, -114.69285373375678, -92.12686439778939, -126.43687653373883, -86.45565078535678, -124.04354451362514, -123.58989133127592, -104.01125468562422, -83.52997079080214, -88.78741373196613, -94.53352114924444, -105.47213467177218, -77.53061766508824, -94.0505700283155, -103.28040295399093, -86.4184455801164, -99.79637006589009, -96.18393140062565, -114.40441101985589, -94.13252252588578, -96.78991505447885, -93.26937418384063, -79.1498311560367, -103.68661280253397, -86.67896184945324, -85.04935819351323, -100.89229829336024, -100.4318630623503, -80.40671085053947, -83.8432966743672, -101.57620083556876], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-28.29432680904046, -28.29432680904046, -28.29432680904046, -28.934517805643384, -27.434517805643388, -30.434517805643384, -41.54205758632993, -41.54205758632993, -41.54205758632993, -36.323152335045584, -37.82315233504558, -37.82315233504558, -39.528279836620904, -39.528279836620904, -39.028279836620904, -21.861936756353806, -21.861936756353806, -21.861936756353806, -26.633782562681237, -26.633782562681237, -26.633782562681237, -26.595134635863555, -26.595134635863555, -26.595134635863555, -40.56517578641757, -40.56517578641757, -39.56517578641757, -40.6649829273199, -40.6649829273199, -40.6649829273199, -35.14345687046165, -35.14345687046165, -35.14345687046165, -39.27152344155695, -39.77152344155695, -39.77152344155695, -36.7103486164983, -37.2103486164983, -37.2103486164983, -25.94319815933062, -25.94319815933062, -25.94319815933062, -30.45126364099557, -30.45126364099557, -30.45126364099557, -37.431357618265345, -37.431357618265345, -37.431357618265345, -30.584736295585017, -31.084736295585017, -31.084736295585017, -42.80954240296889, -42.80954240296889, -41.30954240296889, -30.102943090818428, -30.102943090818428, -30.102943090818428, -31.184041814255828, -31.184041814255828, -31.184041814255828, -24.78973175887966, -24.78973175887966, -24.78973175887966, -37.51959415584535, -36.51959415584535, -37.51959415584535, -29.074988942376006, -29.074988942376006, -29.074988942376006, -37.81722431793901, -37.81722431793901, -37.81722431793901, -31.567590491487454, -31.567590491487454, -31.067590491487454, -31.353229816790886, -31.353229816790886, -29.853229816790886, -40.082613039708015, -39.082613039708015, -40.082613039708015, -31.993674116854308, -33.49367411685431, -33.49367411685431, -35.900644090568655, -35.400644090568655, -35.900644090568655, -30.926512717428214, -30.926512717428214, -29.426512717428214, -33.31202062394366, -34.31202062394366, -34.31202062394366, -33.59771428632856, -33.59771428632856, -33.59771428632856, -38.25642707873995, -38.25642707873995, -38.25642707873995, -31.95631419548525, -32.95631419548525, -32.95631419548525, -37.99521881772618, -37.99521881772618, -37.99521881772618, -32.479294368113415, -33.479294368113415, -33.479294368113415, -38.76780609177852, -38.26780609177851, -38.76780609177852, -32.28518354051255, -32.28518354051255, -31.78518354051255, -30.862908794994194, -30.862908794994194, -30.862908794994194, -42.09040589073129, -41.09040589073129, -42.59040589073129, -30.911724784514014, -30.911724784514014, -30.911724784514014, -28.55234799001152, -28.55234799001152, -28.55234799001152, -27.431267511983602, -27.431267511983602, -27.431267511983602, -24.52387976576316, -24.52387976576316, -24.02387976576316, -33.18892892230683, -33.18892892230683, -31.188928922306822, -31.067911432575276, -31.067911432575276, -31.067911432575276, -32.11282415778701, -32.11282415778701, -32.11282415778701, -34.02787993302493, -34.02787993302493, -32.02787993302492, -24.008735627046022, -23.008735627046022, -23.008735627046022, -33.37391055938466, -33.37391055938466, -33.37391055938466, -33.52817534026574, -35.52817534026574, -35.52817534026574, -26.085240057816222, -27.085240057816222, -27.085240057816222, -29.824556082988646, -29.824556082988646, -29.324556082988646, -33.748860992590664, -33.748860992590664, -33.748860992590664, -32.95880631432589, -32.95880631432589, -32.95880631432589, -33.217606899949956, -33.217606899949956, -33.217606899949956, -25.250860463321224, -25.250860463321224, -25.250860463321224, -26.267967397631555, -27.76796739763155, -27.76796739763155, -24.12252562352215, -24.12252562352215, -24.12252562352215, -34.781222795798506, -35.281222795798506, -35.281222795798506, -28.763302977383862, -28.763302977383862, -28.763302977383862, -31.14601647394734, -31.14601647394734, -30.64601647394734, -40.80003500670122, -41.30003500670122, -41.30003500670122, -33.08202110760235, -33.08202110760235, -33.08202110760235, -25.828206352831245, -25.328206352831245, -26.328206352831245, -27.043417791836315, -27.043417791836315, -27.043417791836315, -36.187421733703495, -36.187421733703495, -36.187421733703495, -34.551792853500885, -34.551792853500885, -34.551792853500885, -27.074916833918778, -27.074916833918778, -27.074916833918778, -32.44794953563074, -32.44794953563074, -31.447949535630745, -41.7998441446789, -41.7998441446789, -41.7998441446789, -30.834429507104534, -29.334429507104534, -30.834429507104534, -33.975458668423684, -33.975458668423684, -34.475458668423684, -32.56851153134862, -33.56851153134862, -33.06851153134862, -31.4744553266583, -30.9744553266583, -31.4744553266583, -32.132948543051725, -32.132948543051725, -32.132948543051725, -38.4997466688901, -38.4997466688901, -35.49974666889009, -32.10480077855497, -32.10480077855497, -32.10480077855497, -33.45882979068198, -32.95882979068198, -32.45882979068198, -30.049737539656064, -30.049737539656064, -30.049737539656064, -31.153851919748874, -31.153851919748874, -31.153851919748874, -35.713618009685376, -35.713618009685376, -35.713618009685376, -27.864708928573503, -27.864708928573503, -27.864708928573503, -25.18037893710176, -25.68037893710176, -25.68037893710176, -28.052801255079036, -28.052801255079036, -28.052801255079036, -27.136396299175274, -27.136396299175274, -27.136396299175274, -37.4992435683077, -35.9992435683077, -37.4992435683077, -29.320299201943715, -29.320299201943715, -29.320299201943715, -29.97925241494689, -29.97925241494689, -29.97925241494689, -32.522601267904584, -32.522601267904584, -32.522601267904584, -27.354524910705848, -25.354524910705848, -27.354524910705848, -31.994225516944702, -31.994225516944702, -31.994225516944702, -26.942833186810027, -25.442833186810027, -26.942833186810027, -27.14864404108147, -27.14864404108147, -27.14864404108147, -31.41498196025755, -31.41498196025755, -31.41498196025755, -23.341203491086457, -23.341203491086457, -23.341203491086457, -31.005221961222578, -31.005221961222578, -31.005221961222578, -37.17681156308807, -37.17681156308807, -37.17681156308807, -28.1367077642316, -28.1367077642316, -28.1367077642316, -32.76827109531528, -35.76827109531528, -35.76827109531528, -38.39761791125229, -37.89761791125229, -38.39761791125229, -30.70895479926313, -30.70895479926313, -30.70895479926313, -42.1456255112463, -42.1456255112463, -42.1456255112463, -28.151883595118925, -29.151883595118925, -29.151883595118925, -41.68118150454173, -41.68118150454173, -40.68118150454173, -41.52996377709195, -40.52996377709195, -41.52996377709195, -34.83708489520807, -34.33708489520807, -34.83708489520807, -28.17665693026737, -27.67665693026737, -27.67665693026737, -29.595804577322035, -29.595804577322035, -29.595804577322035, -31.51117371641481, -31.51117371641481, -31.51117371641481, -35.15737822392404, -35.15737822392404, -35.15737822392404, -26.010205888362755, -26.010205888362755, -25.510205888362755, -32.01685667610518, -30.016856676105178, -32.01685667610518, -34.426800984663664, -34.426800984663664, -34.426800984663664, -28.806148526705464, -28.806148526705464, -28.806148526705464, -33.26545668863006, -33.26545668863006, -33.26545668863006, -32.56131046687523, -31.061310466875227, -32.56131046687523, -38.30147033995196, -38.30147033995196, -37.80147033995196, -31.7108408419619, -31.7108408419619, -30.7108408419619, -32.26330501815963, -32.26330501815963, -32.26330501815963, -31.08979139461353, -31.08979139461353, -31.08979139461353, -26.049943718678914, -26.549943718678914, -26.549943718678914, -35.22887093417798, -33.22887093417798, -35.22887093417798, -29.22632061648442, -28.226320616484422, -29.22632061648442, -28.349786064504414, -28.349786064504414, -28.349786064504414, -33.630766097786754, -33.630766097786754, -33.630766097786754, -33.64395435411674, -33.64395435411674, -33.14395435411674, -26.802236950179832, -26.802236950179832, -26.802236950179832, -27.947765558122402, -27.947765558122402, -27.947765558122402, -33.858733611856266, -33.858733611856266, -33.858733611856266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3155909716130452, "mean_inference_ms": 1.277986561312291, "mean_action_processing_ms": 0.0705078620696087, "mean_env_wait_ms": 0.5857002116794958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 112000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"sample_time_ms": 1518.52, "sample_throughput": 2107.315, "load_time_ms": 0.128, "load_throughput": 25003302.534, "learn_time_ms": 775.852, "learn_throughput": 4124.499, "update_time_ms": 1.485}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 73.86159133911133, "policy_loss": -0.003161562572660248, "vf_loss": 73.8786407470703, "vf_explained_var": -0.021603870391845702, "kl": 0.00693709237587622, "entropy": 1.388848114013672, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112000, "num_agent_steps_sampled": 336000, "num_steps_trained": 112000, "num_agent_steps_trained": 336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4480, "training_iteration": 35, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-30", "timestamp": 1718736390, "time_this_iter_s": 1.6012835502624512, "time_total_s": 53.94690942764282, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 53.94690942764282, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 44.45, "ram_util_percent": 30.3}}
{"episode_reward_max": -63.84441294610918, "episode_reward_min": -137.67636857822683, "episode_reward_mean": -95.8522496174147, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -45.892122859408936}, "policy_reward_max": {"shared_policy": -21.281470982036392}, "policy_reward_mean": {"shared_policy": -31.950749872471572}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-97.75902415189974, -90.96027117414101, -81.23023708479359, -84.53557359941692, -94.77528871235326, -120.16484548140329, -87.00223460783668, -93.06243792943293, -92.7897026995642, -95.80523763542736, -107.1158015438733, -93.84668256373836, -106.88807115253373, -108.03562532947468, -96.2969050975162, -91.35459331847278, -110.60324055392495, -107.25706940186055, -89.97848302791049, -88.70459637090694, -134.7033961082783, -96.74172275146906, -84.78298820424523, -109.12268162582971, -114.15336462050068, -67.99604109914274, -105.68725103773384, -71.56189280060697, -89.06420638908618, -78.97258874044687, -131.2055482484916, -78.7323721556165, -102.30020480323695, -122.60963408251294, -87.32946532988029, -88.78310912067508, -88.45329832955791, -100.58636961807638, -117.52463728393323, -78.74547267566975, -87.81251279618944, -74.76275949201779, -107.92817708933661, -108.33210648705453, -128.17537395785627, -102.52238456495614, -83.4431613497407, -88.45664657071367, -113.2457940114398, -96.09196579902658, -107.6042650635186, -89.56924054432963, -82.14471046752486, -103.62784088331146, -89.29769323852534, -75.99725397167413, -90.73828108516538, -101.96208326335342, -87.82397726446607, -91.4049969452958, -89.80016630995989, -88.19957067265123, -82.88473591319318, -95.33387452199973, -88.85088586773017, -79.60529365779288, -96.71957033044114, -106.36575060854827, -63.84441294610918, -89.28309684818585, -92.67834833539351, -89.28951158092748, -97.88008180197546, -91.05550358457212, -86.36380697639152, -107.6886788018854, -104.93791754194669, -85.13148399734928, -82.69936271637259, -102.13340424534155, -99.66619415401618, -105.40343917736185, -106.12522090915986, -91.3838707484759, -79.97188439770035, -118.37367683192267, -109.22564560340646, -124.38530100924716, -92.71597210878942, -137.67636857822683, -106.09499547753545, -93.41575114856396, -66.49141680806744, -99.32295845468015, -102.98947066443866, -91.5520495563077, -78.15569109979941, -127.05078246305706, -80.74798351596102, -114.40106495168034, -74.92958630083636, -106.03030799046734, -105.44084601737242, -82.06064525003589, -102.22621532044482, -109.05866851953947, -100.11712422667509, -96.14097928271197, -90.83337494227713, -115.13375861772141, -103.00511124245699, -94.14559939632674, -92.38389223654087, -78.49907377954133, -75.67667762603843, -81.95050848373721, -83.75765249171826, -81.05887333462468, -102.20250760993822, -83.55996519662837], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-32.58634138396661, -32.58634138396661, -32.58634138396661, -30.320090391380333, -30.320090391380333, -30.320090391380333, -27.076745694931184, -27.076745694931184, -27.076745694931184, -28.178524533138983, -28.178524533138983, -28.178524533138983, -31.591762904117754, -31.591762904117754, -31.591762904117754, -39.054948493801085, -40.554948493801085, -40.554948493801085, -29.000744869278922, -29.000744869278922, -29.000744869278922, -30.020812643144314, -31.520812643144307, -31.520812643144307, -29.763234233188097, -31.263234233188097, -31.763234233188097, -31.935079211809107, -31.935079211809107, -31.935079211809107, -35.705267181291106, -35.705267181291106, -35.705267181291106, -31.282227521246142, -31.282227521246142, -31.282227521246142, -35.62935705084458, -35.62935705084458, -35.62935705084458, -36.0118751098249, -36.0118751098249, -36.0118751098249, -32.09896836583876, -32.09896836583876, -32.09896836583876, -30.61819777282425, -30.61819777282425, -30.11819777282425, -37.20108018464165, -37.20108018464165, -36.20108018464165, -35.419023133953516, -35.919023133953516, -35.919023133953516, -29.99282767597015, -29.99282767597015, -29.99282767597015, -30.401532123635658, -27.901532123635658, -30.401532123635658, -45.40113203609273, -43.90113203609274, -45.40113203609273, -32.24724091715636, -32.24724091715636, -32.24724091715636, -28.26099606808175, -28.26099606808175, -28.26099606808175, -36.3742272086099, -36.3742272086099, -36.3742272086099, -37.21778820683357, -37.71778820683357, -39.21778820683357, -22.332013699714256, -22.832013699714253, -22.832013699714253, -37.229083679244646, -33.22908367924464, -35.229083679244646, -23.853964266869003, -23.853964266869003, -23.853964266869003, -30.021402129695396, -30.021402129695396, -29.021402129695396, -26.324196246815625, -26.324196246815625, -26.324196246815625, -44.06851608283051, -43.06851608283051, -44.06851608283051, -27.74412405187216, -24.74412405187216, -26.24412405187216, -34.10006826774562, -34.10006826774562, -34.10006826774562, -40.86987802750431, -40.86987802750431, -40.86987802750431, -29.109821776626756, -29.109821776626756, -29.109821776626756, -28.927703040225023, -29.927703040225023, -29.927703040225023, -30.31776610985263, -27.81776610985263, -30.31776610985263, -34.5287898726921, -31.5287898726921, -34.5287898726921, -39.174879094644396, -39.174879094644396, -39.174879094644396, -26.248490891889908, -26.248490891889908, -26.248490891889908, -29.770837598729837, -28.270837598729837, -29.770837598729837, -24.9209198306726, -24.9209198306726, -24.9209198306726, -36.476059029778845, -36.476059029778845, -34.976059029778845, -36.11070216235148, -36.11070216235148, -36.11070216235148, -43.0584579859521, -43.05845798595211, -42.0584579859521, -34.17412818831874, -34.17412818831874, -34.17412818831874, -27.814387116580225, -27.814387116580225, -27.814387116580225, -29.485548856904565, -29.485548856904565, -29.485548856904565, -37.581931337146585, -37.581931337146585, -38.081931337146585, -32.363988599675515, -32.363988599675515, -31.36398859967552, -36.534755021172856, -36.534755021172856, -34.534755021172856, -29.85641351477655, -29.85641351477655, -29.85641351477655, -27.381570155841615, -27.381570155841615, -27.381570155841615, -34.54261362777049, -35.04261362777049, -34.04261362777049, -29.76589774617511, -29.76589774617511, -29.76589774617511, -26.165751323891357, -23.665751323891357, -26.165751323891357, -30.412760361721777, -29.912760361721777, -30.412760361721777, -34.82069442111781, -32.32069442111781, -34.82069442111781, -28.941325754822024, -29.441325754822024, -29.441325754822024, -30.46833231509861, -30.46833231509861, -30.46833231509861, -29.933388769986628, -29.933388769986628, -29.933388769986628, -29.56652355755039, -29.56652355755039, -29.06652355755039, -26.9615786377311, -27.9615786377311, -27.9615786377311, -31.777958173999888, -31.777958173999888, -31.777958173999888, -29.78362862257673, -29.78362862257673, -29.28362862257673, -26.868431219264295, -26.368431219264295, -26.368431219264295, -32.07319011014705, -32.57319011014705, -32.07319011014705, -36.12191686951607, -35.12191686951607, -35.12191686951607, -21.281470982036392, -21.281470982036392, -21.281470982036392, -29.761032282728614, -29.761032282728614, -29.761032282728614, -30.55944944513118, -31.05944944513118, -31.05944944513118, -29.763170526975813, -29.763170526975813, -29.763170526975813, -32.793360600658474, -32.293360600658474, -32.793360600658474, -30.351834528190714, -30.351834528190714, -30.351834528190714, -28.787935658797174, -28.287935658797167, -29.287935658797174, -36.06289293396181, -36.06289293396181, -35.56289293396181, -34.97930584731556, -34.97930584731556, -34.97930584731556, -28.377161332449734, -28.377161332449734, -28.377161332449734, -27.56645423879087, -27.56645423879087, -27.56645423879087, -34.711134748447165, -34.711134748447165, -32.711134748447165, -33.22206471800539, -33.22206471800539, -33.22206471800539, -35.30114639245394, -35.30114639245394, -34.80114639245394, -35.875073636386595, -35.875073636386595, -34.375073636386595, -30.461290249491963, -30.461290249491963, -30.461290249491963, -26.32396146590013, -27.32396146590013, -26.32396146590013, -39.12455894397422, -39.62455894397422, -39.62455894397422, -36.40854853446882, -36.40854853446882, -36.40854853446882, -41.795100336415715, -40.795100336415715, -41.795100336415715, -30.905324036263128, -30.905324036263128, -30.905324036263128, -45.892122859408936, -45.892122859408936, -45.892122859408936, -35.36499849251184, -35.86499849251184, -34.86499849251184, -31.471917049521316, -30.471917049521316, -31.471917049521316, -22.16380560268915, -22.16380560268915, -22.16380560268915, -32.44098615156004, -33.44098615156004, -33.44098615156004, -34.66315688814622, -33.66315688814622, -34.66315688814622, -30.68401651876924, -30.68401651876924, -30.18401651876924, -26.051897033266474, -26.051897033266474, -26.051897033266474, -42.35026082101902, -42.35026082101902, -42.35026082101902, -27.249327838653677, -26.749327838653677, -26.749327838653677, -36.467021650560106, -38.967021650560106, -38.967021650560106, -24.97652876694545, -24.97652876694545, -24.97652876694545, -35.67676933015576, -35.67676933015576, -34.67676933015576, -34.4802820057908, -35.9802820057908, -34.9802820057908, -27.35354841667864, -27.35354841667864, -27.35354841667864, -34.07540510681492, -34.07540510681492, -34.07540510681492, -36.51955617317986, -36.51955617317986, -36.01955617317986, -33.539041408891684, -33.539041408891684, -33.039041408891684, -32.04699309423732, -32.54699309423732, -31.546993094237322, -30.111124980759026, -30.611124980759026, -30.111124980759026, -38.377919539240466, -38.377919539240466, -38.377919539240466, -34.335037080819, -34.335037080819, -34.335037080819, -30.381866465442258, -31.881866465442258, -31.881866465442258, -30.461297412180294, -30.961297412180294, -30.961297412180294, -26.166357926513772, -26.166357926513772, -26.166357926513772, -25.225559208679478, -25.225559208679478, -25.225559208679478, -27.316836161245703, -27.316836161245703, -27.316836161245703, -27.919217497239433, -27.919217497239433, -27.919217497239433, -27.019624444874875, -27.019624444874875, -27.019624444874875, -33.40083586997943, -34.40083586997943, -34.40083586997943, -27.519988398876144, -28.019988398876144, -28.019988398876144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3144780046337027, "mean_inference_ms": 1.273861519941263, "mean_action_processing_ms": 0.07028655452908725, "mean_env_wait_ms": 0.5839811618435083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 115200, "timesteps_this_iter": 0, "agent_timesteps_total": 345600, "timers": {"sample_time_ms": 1512.153, "sample_throughput": 2116.188, "load_time_ms": 0.128, "load_throughput": 24947533.086, "learn_time_ms": 772.856, "learn_throughput": 4140.489, "update_time_ms": 1.484}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 82.25674591064453, "policy_loss": -0.0022046001522103343, "vf_loss": 82.27293243408204, "vf_explained_var": -0.01276308298110962, "kl": 0.005670284955906657, "entropy": 1.3982667207717896, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 115200, "num_agent_steps_sampled": 345600, "num_steps_trained": 115200, "num_agent_steps_trained": 345600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4600, "training_iteration": 36, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-32", "timestamp": 1718736392, "time_this_iter_s": 1.4220223426818848, "time_total_s": 55.36893177032471, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219bd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 55.36893177032471, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 36.25, "ram_util_percent": 30.3}}
{"episode_reward_max": -59.41226375386997, "episode_reward_min": -151.98679963290502, "episode_reward_mean": -98.48495345390268, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -51.19696019343982}, "policy_reward_max": {"shared_policy": -19.470754584623332}, "policy_reward_mean": {"shared_policy": -32.82831781796755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.5436369027922, -81.99398941743011, -120.6511323482557, -98.76939315809747, -72.07785525441888, -99.99511396214463, -108.87466492232929, -101.42844392420633, -130.37315603077093, -125.96843906884071, -91.46636783580637, -89.71060895606425, -98.90061900770966, -122.39732894219183, -102.92385967607328, -103.10932377387378, -85.31851118441776, -113.02614113131861, -107.94732055312691, -83.89979803633729, -80.31575119303369, -86.17057688749313, -82.60409603082795, -105.93946771738608, -88.42182510049918, -92.3623447315631, -102.81865157493958, -80.19584574460085, -128.52117419297258, -81.36429858505069, -75.66005745099153, -151.5908805803195, -109.20283932989928, -82.65619844683785, -95.96450268363844, -92.01091797026841, -116.14142230620932, -104.43107243309828, -124.79627351953684, -110.32078260576739, -72.80407979350916, -91.50054079894574, -124.18715804388967, -107.85865988705183, -85.15909059429971, -89.24005633922467, -98.31078719886658, -110.72546333391188, -99.43261096315811, -81.53492188265635, -87.4200394916782, -110.07206820688205, -103.63001449808831, -94.59311653719102, -79.6902938833919, -98.85835234167384, -88.3529189382414, -73.12851924046451, -98.76230032313131, -117.83341453380937, -74.66759942235815, -70.41406282230646, -87.10341493057525, -112.2801860455561, -77.02668208403337, -116.73305240896933, -83.91070768951894, -90.0932082188246, -97.25901583735835, -98.21840915171094, -83.70484214699258, -85.74303691305022, -100.49441412053257, -114.83681131012659, -118.39329676596137, -89.57413869625691, -104.24327826497408, -90.14452978171029, -91.30850862163766, -100.79214204829263, -91.29140478518306, -82.72828568064169, -99.35016645310847, -85.30518984009736, -121.35193181850043, -151.98679963290502, -97.67689227007476, -90.03052765892917, -107.70049403677167, -99.07421218829542, -85.96500061996285, -93.05753949907779, -107.48956324520704, -81.09067807159899, -103.54562555590847, -87.50733979667996, -100.16796660266687, -106.6656047160537, -130.95610573639286, -121.90563265201925, -84.09165191994191, -90.03268591627501, -108.86485798292135, -113.55029544463996, -109.99413438270365, -75.09345470621764, -97.5136685931869, -102.80547166328734, -138.15994530394107, -59.41226375386997, -113.46654572916428, -96.88037343932095, -78.48333255582546, -94.44617596632773, -92.84911272697424, -86.84488703709373, -79.06902237891677, -96.83549513505531, -97.34024114414828, -84.58692164126825, -80.34322821815968, -86.5135590180616, -97.1574823409925, -87.89409660024307, -97.93681526449359, -107.31190267692081, -133.27534446148258, -106.5643087876124, -145.3974806386739, -98.58180543759948], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-28.34787896759739, -29.34787896759739, -28.84787896759739, -27.66466313914337, -26.66466313914337, -27.66466313914337, -40.21704411608522, -40.21704411608522, -40.21704411608522, -32.923131052699134, -32.923131052699134, -32.923131052699134, -24.525951751472967, -23.525951751472967, -24.025951751472967, -33.33170465404823, -33.33170465404823, -33.33170465404823, -35.62488830744308, -36.62488830744307, -36.62488830744307, -34.64281464140211, -32.142814641402104, -34.64281464140211, -41.45771867692364, -44.45771867692364, -44.45771867692364, -41.322813022946896, -40.822813022946896, -43.822813022946896, -31.32212261193546, -28.82212261193546, -31.32212261193546, -30.23686965202142, -29.23686965202142, -30.23686965202142, -33.133539669236555, -33.133539669236555, -32.633539669236555, -40.79910964739725, -40.79910964739725, -40.79910964739725, -34.307953225357736, -34.307953225357736, -34.307953225357736, -34.36977459129127, -34.36977459129127, -34.36977459129127, -28.439503728139247, -28.439503728139247, -28.439503728139247, -37.67538037710623, -37.67538037710623, -37.67538037710623, -35.982440184375626, -35.982440184375626, -35.982440184375626, -27.966599345445765, -27.966599345445765, -27.966599345445765, -26.93858373101124, -26.43858373101124, -26.93858373101124, -28.72352562916437, -28.72352562916437, -28.72352562916437, -27.534698676942632, -27.534698676942632, -27.534698676942632, -35.31315590579535, -35.31315590579535, -35.31315590579535, -29.473941700166392, -30.973941700166392, -27.973941700166392, -30.95411491052106, -30.45411491052106, -30.95411491052106, -32.60621719164652, -35.106217191646515, -35.106217191646515, -26.898615248200276, -26.898615248200276, -26.398615248200276, -42.50705806432419, -43.00705806432419, -43.00705806432419, -25.788099528350234, -27.788099528350234, -27.788099528350234, -26.386685816997183, -26.386685816997183, -22.886685816997183, -51.19696019343982, -51.19696019343982, -49.19696019343982, -36.067613109966416, -36.567613109966416, -36.567613109966416, -27.55206614894593, -27.55206614894593, -27.55206614894593, -31.821500894546162, -32.82150089454616, -31.321500894546162, -30.67030599008949, -30.67030599008949, -30.67030599008949, -39.04714076873644, -39.04714076873644, -38.04714076873644, -34.81035747769943, -34.81035747769943, -34.81035747769943, -41.432091173178925, -41.932091173178925, -41.43209117317893, -36.77359420192244, -36.77359420192244, -36.77359420192244, -24.26802659783638, -24.26802659783638, -24.26802659783638, -31.333513599648565, -31.333513599648565, -28.833513599648565, -41.06238601462989, -41.56238601462989, -41.56238601462989, -35.952886629017236, -35.952886629017236, -35.952886629017236, -28.386363531433233, -28.386363531433233, -28.386363531433233, -29.91335211307487, -29.91335211307487, -29.41335211307487, -32.77026239962217, -32.77026239962217, -32.77026239962217, -36.90848777797063, -36.90848777797063, -36.90848777797063, -33.14420365438604, -33.14420365438604, -33.14420365438604, -27.511640627552097, -27.511640627552097, -26.511640627552097, -29.806679830559418, -29.806679830559418, -27.806679830559418, -36.69068940229401, -36.69068940229401, -36.69068940229401, -35.37667149936274, -35.37667149936274, -32.87667149936274, -31.197705512396993, -31.697705512396993, -31.697705512396993, -26.230097961130628, -27.230097961130628, -26.230097961130628, -32.95278411389126, -32.95278411389126, -32.95278411389126, -29.450972979413805, -29.450972979413805, -29.450972979413805, -24.542839746821503, -24.042839746821503, -24.542839746821503, -31.92076677437711, -33.42076677437711, -33.42076677437711, -40.44447151126979, -36.944471511269796, -40.44447151126979, -24.555866474119398, -25.055866474119398, -25.055866474119398, -22.804687607435476, -23.804687607435476, -23.804687607435476, -29.367804976858423, -29.367804976858423, -28.367804976858423, -36.760062015185376, -37.760062015185376, -37.760062015185376, -25.842227361344456, -25.342227361344456, -25.842227361344456, -39.077684136323086, -39.077684136323086, -38.577684136323086, -27.97023589650633, -27.97023589650633, -27.97023589650633, -30.364402739608188, -30.364402739608188, -29.364402739608188, -31.753005279119474, -32.75300527911947, -32.75300527911947, -32.739469717236986, -32.739469717236986, -32.739469717236986, -27.90161404899752, -27.90161404899752, -27.90161404899752, -27.58101230435008, -29.08101230435008, -29.08101230435008, -33.498138040177544, -33.498138040177544, -33.498138040177544, -38.27893710337554, -38.27893710337554, -38.27893710337554, -39.464432255320474, -39.464432255320474, -39.464432255320474, -29.858046232085627, -29.858046232085627, -29.858046232085627, -33.247759421658024, -35.24775942165803, -35.74775942165803, -30.54817659390343, -28.54817659390343, -31.04817659390343, -30.43616954054589, -30.43616954054589, -30.43616954054589, -33.597380682764225, -33.597380682764225, -33.597380682764225, -31.597134928394336, -28.097134928394336, -31.597134928394336, -27.57609522688058, -27.57609522688058, -27.57609522688058, -33.116722151036164, -33.116722151036164, -33.116722151036164, -28.935063280032434, -28.935063280032434, -27.435063280032434, -41.11731060616682, -40.11731060616681, -40.11731060616682, -50.662266544301715, -50.662266544301715, -50.662266544301715, -33.058964090024915, -33.058964090024915, -31.558964090024915, -30.01017588630973, -30.01017588630973, -30.01017588630973, -35.90016467892392, -35.90016467892392, -35.90016467892392, -32.19140406276512, -33.19140406276512, -33.69140406276512, -28.655000206654286, -28.655000206654286, -28.655000206654286, -31.019179833025937, -31.019179833025937, -31.019179833025937, -35.829854415069015, -35.829854415069015, -35.829854415069015, -27.696892690532987, -25.696892690532987, -27.696892690532987, -34.51520851863616, -34.51520851863616, -34.51520851863616, -28.502446598893304, -29.502446598893304, -29.502446598893304, -33.389322200888955, -33.389322200888955, -33.389322200888955, -35.88853490535123, -35.88853490535123, -34.88853490535123, -43.9853685787976, -43.9853685787976, -42.9853685787976, -40.801877550673076, -40.801877550673076, -40.301877550673076, -28.030550639980646, -28.030550639980646, -28.030550639980646, -30.010895305425002, -30.010895305425002, -30.010895305425002, -36.28828599430712, -36.28828599430712, -36.28828599430712, -38.51676514821334, -36.51676514821334, -38.51676514821334, -36.49804479423455, -37.498044794234545, -35.998044794234545, -24.531151568739215, -25.031151568739215, -25.531151568739215, -31.83788953106231, -33.33788953106231, -32.33788953106231, -34.26849055442913, -34.26849055442913, -34.26849055442913, -44.719981767980386, -46.719981767980386, -46.719981767980386, -19.970754584623332, -19.470754584623332, -19.970754584623332, -36.82218190972139, -38.32218190972139, -38.32218190972139, -33.62679114644032, -29.62679114644032, -33.62679114644032, -26.327777518608503, -25.827777518608503, -26.327777518608503, -32.14872532210923, -32.14872532210923, -30.148725322109232, -31.11637090899141, -31.11637090899141, -30.61637090899141, -29.114962345697904, -28.614962345697904, -29.114962345697904, -26.356340792972244, -26.356340792972244, -26.356340792972244, -32.27849837835177, -32.27849837835177, -32.27849837835177, -31.78008038138278, -33.28008038138278, -32.28008038138278, -28.19564054708943, -28.19564054708943, -28.19564054708943, -26.11440940605322, -27.114409406053223, -27.114409406053223, -29.33785300602051, -29.33785300602051, -27.83785300602051, -32.21916078033083, -32.71916078033083, -32.21916078033083, -28.964698866747703, -28.964698866747703, -29.964698866747703, -31.64560508816454, -33.145605088164544, -33.145605088164544, -36.603967558973615, -34.10396755897361, -36.603967558973615, -44.59178148716085, -44.09178148716085, -44.59178148716085, -35.688102929204135, -35.688102929204135, -35.188102929204135, -48.96582687955801, -48.96582687955801, -47.46582687955801, -32.86060181253318, -32.86060181253318, -32.86060181253318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3141699605632015, "mean_inference_ms": 1.272203483127297, "mean_action_processing_ms": 0.07020109318547249, "mean_env_wait_ms": 0.5833561562795151, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 118400, "timesteps_this_iter": 0, "agent_timesteps_total": 355200, "timers": {"sample_time_ms": 1513.082, "sample_throughput": 2114.889, "load_time_ms": 0.131, "load_throughput": 24469959.526, "learn_time_ms": 777.168, "learn_throughput": 4117.512, "update_time_ms": 1.497}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005000000000000001, "total_loss": 82.3835350036621, "policy_loss": -0.0027113697657478396, "vf_loss": 82.40009765625, "vf_explained_var": -0.023049962520599366, "kl": 0.004050903024245489, "entropy": 1.3852773547172545, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 118400, "num_agent_steps_sampled": 355200, "num_steps_trained": 118400, "num_agent_steps_trained": 355200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4730, "training_iteration": 37, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-33", "timestamp": 1718736393, "time_this_iter_s": 1.5047056674957275, "time_total_s": 56.873637437820435, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924404c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 56.873637437820435, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 36.95, "ram_util_percent": 30.3}}
{"episode_reward_max": -63.37797788177329, "episode_reward_min": -131.17211609846973, "episode_reward_mean": -96.48967264112049, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -43.92017939491031}, "policy_reward_max": {"shared_policy": -21.125992627257748}, "policy_reward_mean": {"shared_policy": -32.163224213706826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.10231204435779, -74.3022979367771, -69.26585351736625, -83.93196590607806, -101.41950407732561, -84.4583223844762, -99.04794076708296, -93.254504618045, -109.37562128510781, -84.75618830222291, -94.15178490709863, -92.50925740612354, -90.1777342997643, -77.52469345551059, -117.65469908719929, -118.72010263091391, -70.24017753625503, -77.93084794206607, -100.22430223504912, -117.29939036168118, -80.60618714417643, -128.48580483748106, -93.99195644008913, -108.34423574439643, -113.49580654654956, -94.78665486180542, -85.94882184765358, -111.99264959769383, -106.65620192606372, -95.65007792636999, -79.79268845944675, -104.78226378944518, -85.84265106855224, -120.79038813936974, -86.83813888879857, -104.68479053290142, -76.25210961184905, -108.06461270008442, -108.64171813457604, -70.36677283699079, -90.86938632732591, -86.02871281467088, -101.55477814965613, -98.40420316575342, -113.07189361941846, -104.49846671428726, -92.7320187749167, -80.93234751578522, -105.7308756054107, -91.12951132001683, -116.37141266869423, -87.06847544026745, -86.5185974809433, -88.45658856621255, -110.03130268328482, -117.44798863093692, -63.37797788177329, -105.02977439903304, -89.22967913797265, -99.31591373463307, -97.36055005354883, -92.49708780415025, -78.72794859744747, -77.25773770564275, -95.04656250444296, -82.97160820697886, -89.70420347934642, -104.17681816106936, -90.27266651217418, -114.94540510298413, -82.39835512192221, -108.78501826856329, -116.3569910640585, -108.48906708068743, -68.1070861326078, -80.30875845597481, -95.31809190199293, -89.08317663115093, -106.73957275312117, -112.62774291663072, -94.31789339305378, -89.33223106196189, -89.42292346756695, -88.59883533851654, -109.35025154961394, -93.77617748159031, -108.17596169423284, -74.05800821445858, -95.1222730988452, -131.17211609846973, -100.46981033967019, -130.260538184731, -102.44307385693567, -72.82944218827875, -116.52232300916168, -91.1344544922984, -93.45171913010358, -78.86857317855042, -83.66265719756093, -82.59328986059043, -99.28541282125333, -94.12123854510881, -99.85528505458686, -88.25350930660127, -86.96933749464921, -73.78912286856259, -111.9707245733327, -108.09125487587183, -75.15202487983021, -103.16771165917383, -87.90569227482777, -108.25943317954645, -91.0046155906349, -79.54278379233591, -87.65636891577174, -115.4240293740664, -102.91429436455529, -119.04819711050105, -86.64158152694145, -86.99764421937383, -106.98448040805158, -105.87286625095737, -112.1917086174964, -108.59257909327056, -97.27585685236406, -104.90672045624842, -121.031073512868, -104.3829777028658, -79.552012039611, -127.91796832793156], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-34.03410401478595, -34.03410401478595, -34.03410401478595, -24.934099312259036, -24.934099312259036, -24.434099312259036, -23.088617839122076, -23.088617839122076, -23.088617839122076, -28.810655302026003, -28.810655302026003, -26.310655302026003, -33.806501359108545, -33.806501359108545, -33.806501359108545, -28.152774128158715, -28.152774128158715, -28.152774128158715, -33.01598025569432, -33.01598025569432, -33.01598025569432, -31.918168206015025, -31.918168206015025, -29.418168206015025, -37.12520709503593, -35.12520709503593, -37.12520709503593, -28.252062767407633, -28.252062767407633, -28.252062767407633, -31.717261635699554, -30.717261635699554, -31.717261635699554, -31.503085802041177, -31.503085802041177, -29.503085802041177, -30.225911433254762, -30.225911433254762, -29.725911433254762, -26.50823115183687, -25.00823115183687, -26.00823115183687, -38.55156636239978, -40.05156636239978, -39.05156636239978, -40.07336754363797, -38.57336754363797, -40.07336754363797, -23.913392512085014, -23.913392512085014, -22.413392512085014, -25.643615980688658, -26.143615980688658, -26.143615980688658, -33.908100745016384, -33.908100745016384, -32.40810074501638, -39.43313012056039, -38.43313012056039, -39.43313012056039, -26.8687290480588, -26.8687290480588, -26.8687290480588, -43.495268279160356, -41.495268279160356, -43.495268279160356, -32.330652146696366, -32.330652146696366, -29.330652146696366, -36.11474524813214, -36.11474524813214, -36.11474524813214, -38.49860218218319, -36.99860218218319, -37.99860218218319, -32.095551620601775, -32.095551620601775, -30.595551620601775, -28.316273949217827, -28.81627394921783, -28.81627394921783, -37.33088319923127, -37.33088319923127, -37.33088319923127, -35.55206730868791, -35.55206730868791, -35.55206730868791, -32.21669264212332, -32.21669264212332, -31.21669264212332, -26.597562819815593, -26.597562819815593, -26.597562819815593, -33.92742126314837, -35.427421263148375, -35.427421263148375, -28.61421702285076, -28.61421702285076, -28.61421702285076, -40.596796046456596, -40.096796046456596, -40.096796046456596, -27.612712962932825, -29.612712962932825, -29.612712962932825, -35.061596844300446, -34.561596844300446, -35.061596844300446, -25.41736987061637, -25.41736987061637, -25.41736987061637, -36.0215375666948, -36.0215375666948, -36.0215375666948, -36.38057271152535, -35.88057271152535, -36.38057271152535, -23.78892427899694, -23.78892427899694, -22.78892427899694, -30.956462109108628, -30.956462109108628, -28.956462109108628, -28.842904271556964, -28.842904271556964, -28.342904271556964, -34.01825938321871, -34.01825938321871, -33.51825938321871, -32.80140105525115, -32.80140105525115, -32.80140105525115, -38.02396453980616, -37.02396453980616, -38.02396453980616, -34.99948890476243, -33.99948890476243, -35.49948890476244, -30.910672924972218, -30.910672924972218, -30.910672924972218, -26.977449171928384, -26.977449171928384, -26.977449171928384, -35.24362520180357, -35.24362520180357, -35.24362520180357, -30.376503773338925, -30.376503773338925, -30.376503773338925, -38.79047088956475, -38.79047088956475, -38.79047088956475, -29.022825146755814, -29.022825146755814, -29.022825146755814, -28.83953249364775, -28.83953249364775, -28.83953249364775, -29.985529522070845, -28.485529522070845, -29.985529522070845, -36.01043422776162, -37.01043422776162, -37.01043422776162, -39.14932954364566, -39.14932954364566, -39.14932954364566, -21.125992627257748, -21.125992627257748, -21.125992627257748, -35.009924799677684, -35.009924799677684, -35.009924799677684, -29.74322637932419, -29.24322637932419, -30.24322637932419, -33.105304578211026, -33.105304578211026, -33.105304578211026, -32.45351668451628, -32.45351668451628, -32.45351668451628, -31.332362601383416, -31.332362601383416, -29.83236260138341, -26.242649532482492, -26.242649532482492, -26.242649532482492, -26.252579235214256, -26.252579235214256, -24.752579235214256, -31.682187501480975, -31.682187501480975, -31.682187501480975, -27.657202735659624, -27.657202735659624, -27.657202735659624, -29.90140115978212, -29.90140115978212, -29.90140115978212, -34.89227272035643, -34.89227272035643, -34.39227272035643, -30.090888837391383, -30.090888837391383, -30.090888837391383, -38.31513503432805, -38.31513503432805, -38.31513503432805, -27.466118373974066, -27.466118373974066, -27.466118373974066, -35.261672756187764, -37.761672756187764, -35.761672756187764, -39.61899702135283, -39.11899702135283, -37.61899702135283, -36.163022360229135, -36.163022360229135, -36.163022360229135, -22.702362044202612, -22.702362044202612, -22.702362044202612, -26.769586151991625, -26.769586151991625, -26.769586151991625, -32.272697300664326, -30.272697300664326, -32.772697300664326, -30.19439221038364, -30.19439221038364, -28.69439221038364, -35.579857584373684, -35.579857584373684, -35.579857584373684, -37.54258097221025, -37.54258097221025, -37.54258097221025, -31.439297797684578, -31.439297797684578, -31.439297797684578, -30.777410353987303, -30.277410353987303, -28.277410353987303, -29.80764115585568, -29.80764115585568, -29.80764115585568, -29.53294511283887, -29.53294511283887, -29.53294511283887, -36.616750516538, -36.616750516538, -36.116750516538, -31.258725827196795, -31.258725827196795, -31.258725827196795, -36.058653898077594, -36.058653898077594, -36.058653898077594, -23.352669404819515, -25.35266940481952, -25.35266940481952, -31.87409103294838, -31.37409103294838, -31.87409103294838, -43.890705366156574, -43.890705366156574, -43.390705366156574, -33.48993677989006, -33.48993677989006, -33.48993677989006, -43.92017939491031, -43.92017939491031, -42.42017939491031, -34.14769128564522, -34.14769128564522, -34.14769128564522, -24.276480729426236, -24.276480729426236, -24.276480729426236, -38.84077433638724, -38.84077433638724, -38.84077433638724, -30.544818164099464, -30.044818164099464, -30.544818164099464, -31.9839063767012, -31.9839063767012, -29.4839063767012, -26.28952439285014, -26.28952439285014, -26.28952439285014, -27.88755239918697, -27.88755239918697, -27.88755239918697, -27.53109662019681, -27.53109662019681, -27.53109662019681, -33.42847094041776, -32.42847094041776, -33.42847094041776, -31.707079515036295, -31.707079515036295, -30.707079515036295, -32.618428351528955, -33.618428351528955, -33.618428351528955, -29.41783643553375, -29.41783643553375, -29.41783643553375, -28.98977916488308, -28.98977916488308, -28.98977916488308, -24.59637428952087, -24.096374289520867, -25.09637428952087, -36.65690819111091, -37.65690819111091, -37.65690819111091, -36.03041829195725, -36.03041829195725, -36.03041829195725, -25.050674959943393, -25.050674959943393, -25.050674959943393, -34.55590388639126, -34.05590388639126, -34.55590388639126, -29.635230758275917, -28.635230758275917, -29.635230758275917, -36.08647772651546, -36.08647772651546, -36.08647772651546, -30.334871863544937, -30.334871863544937, -30.334871863544937, -26.514261264111973, -26.514261264111973, -26.514261264111973, -29.218789638590607, -29.218789638590607, -29.218789638590607, -38.47467645802214, -38.47467645802214, -38.47467645802214, -32.97143145485175, -34.97143145485175, -34.97143145485175, -39.682732370167024, -39.182732370167024, -40.182732370167024, -29.380527175647142, -27.88052717564715, -29.380527175647142, -28.999214739791277, -28.999214739791277, -28.999214739791277, -35.66149346935055, -35.66149346935055, -35.66149346935055, -34.29095541698576, -35.790955416985746, -35.790955416985746, -37.39723620583214, -37.39723620583214, -37.39723620583214, -36.197526364423524, -36.197526364423524, -36.197526364423524, -32.425285617454676, -32.425285617454676, -32.425285617454676, -35.13557348541613, -34.63557348541613, -35.13557348541613, -41.01035783762266, -41.01035783762266, -39.01035783762265, -34.79432590095527, -34.79432590095527, -34.79432590095527, -26.017337346536983, -27.017337346536983, -26.517337346536983, -42.63932277597718, -42.63932277597718, -42.63932277597718]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3135368488952621, "mean_inference_ms": 1.268907564171207, "mean_action_processing_ms": 0.0700193000029953, "mean_env_wait_ms": 0.5820633559112887, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 121600, "timesteps_this_iter": 0, "agent_timesteps_total": 364800, "timers": {"sample_time_ms": 1518.596, "sample_throughput": 2107.21, "load_time_ms": 0.131, "load_throughput": 24474421.59, "learn_time_ms": 779.925, "learn_throughput": 4102.959, "update_time_ms": 1.474}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 75.28532180786132, "policy_loss": -0.0037777474567604608, "vf_loss": 75.30264587402344, "vf_explained_var": -0.00931352972984314, "kl": 0.006273407241002839, "entropy": 1.354382538795471, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 121600, "num_agent_steps_sampled": 364800, "num_steps_trained": 121600, "num_agent_steps_trained": 364800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4860, "training_iteration": 38, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-35", "timestamp": 1718736395, "time_this_iter_s": 1.5047855377197266, "time_total_s": 58.37842297554016, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 58.37842297554016, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.233333333333334, "ram_util_percent": 30.366666666666664}}
{"episode_reward_max": -66.14090333842816, "episode_reward_min": -142.40714524524589, "episode_reward_mean": -98.0000013959546, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -47.635715081748614}, "policy_reward_max": {"shared_policy": -22.046967779476063}, "policy_reward_mean": {"shared_policy": -32.666667131984866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.076297954121, -97.14654346186911, -80.14776391528035, -87.56120573209434, -98.50261561354246, -115.05386288588895, -111.81206867465872, -89.0811618083928, -95.92613532632453, -89.14751432539406, -86.06710952165648, -84.05890188804399, -109.0016863378272, -77.59543245036923, -113.2042853746356, -89.00937793863541, -74.2317653415678, -95.1010916449018, -106.31044873522497, -101.43633197538846, -137.8473985654281, -142.40714524524589, -74.83851051038296, -104.40241532109636, -107.75562329210044, -99.52557935026691, -105.7560895998013, -106.92966983659574, -86.10363502893891, -103.64801823057903, -82.20973036106348, -83.15585479793805, -82.46394223521136, -81.39887483315349, -104.97959743755938, -102.34620893231705, -97.69288991337116, -70.97073595217262, -95.9019107673593, -93.51466799419782, -83.82839399750523, -97.73177652631892, -108.21958566003585, -108.97420982261617, -130.83014936751815, -98.57685140960209, -106.63908763295889, -125.53402156622316, -106.74807428729328, -100.12776757119418, -94.83349217736806, -110.76395427910983, -106.52524438114033, -80.06207762361028, -105.09565156945779, -131.9473167032447, -125.69584565710426, -112.3938545370813, -93.1185606950574, -133.20771968560976, -110.91619015334771, -98.25148823717353, -74.33029909094357, -80.23116050052809, -104.97071630087973, -79.0770380120572, -86.09870431918088, -88.22665997834386, -98.8634632114731, -111.65690675255922, -73.7211629650005, -90.83040540074919, -93.50908224569758, -92.73852798773713, -107.53529118420003, -81.89444883119677, -99.19981083104244, -78.37980758875479, -101.92295149360086, -79.74747027209152, -90.02124144174151, -99.84061510623374, -69.15765074814868, -66.14090333842816, -112.73306158145388, -117.98138793762006, -105.52415439639464, -97.01184522657677, -108.34183570778823, -110.8285611886959, -107.4173181243964, -114.19334244089451, -86.59164627643797, -102.06362106316715, -76.13969643335004, -89.0972407893457, -84.08432966137802, -97.23801099476377, -111.47720368465878, -87.62094541161639, -72.39054562227632, -82.86791849181763, -85.72998638998875, -104.8872811326225, -106.21696169305709, -105.88489585747588, -102.99167391791833, -104.48806319677882, -96.30143859897315, -105.60660826118149, -91.59218469139194, -95.10923436938269, -107.13043363047466, -107.36138603310695, -84.34409659336781, -92.23377298164577, -96.7652597067451, -96.33365717948536, -88.17446030493889, -100.95363753173206, -111.32151169142712, -103.08502794673116, -84.39163706147856, -86.91741124302676, -100.381947534756, -110.62714510657061, -96.64804481122773, -92.52817635104056, -95.72367264652233, -109.2321797266599], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-43.858765984707034, -43.858765984707034, -43.358765984707034, -32.38218115395637, -32.38218115395637, -32.38218115395637, -26.71592130509345, -26.71592130509345, -26.71592130509345, -29.18706857736478, -29.18706857736478, -29.18706857736478, -32.16753853784749, -33.16753853784749, -33.16753853784749, -38.517954295296306, -38.017954295296306, -38.517954295296306, -38.27068955821959, -35.27068955821958, -38.27068955821959, -29.693720602797615, -29.693720602797615, -29.693720602797615, -32.30871177544149, -32.30871177544149, -31.308711775441488, -30.049171441798002, -29.549171441798002, -29.549171441798002, -28.3557031738855, -28.3557031738855, -29.3557031738855, -28.019633962681347, -28.019633962681347, -28.019633962681347, -36.33389544594238, -36.33389544594238, -36.33389544594238, -25.865144150123054, -25.865144150123054, -25.865144150123054, -37.73476179154519, -37.73476179154519, -37.73476179154519, -30.33645931287848, -28.33645931287848, -30.33645931287848, -23.41058844718926, -25.41058844718926, -25.41058844718926, -31.033697214967276, -32.033697214967276, -32.033697214967276, -35.43681624507498, -35.43681624507498, -35.43681624507498, -33.81211065846281, -33.81211065846281, -33.81211065846281, -45.28246618847603, -46.28246618847603, -46.28246618847603, -47.635715081748614, -47.135715081748614, -47.635715081748614, -25.279503503460994, -24.279503503460994, -25.279503503460994, -34.800805107032105, -34.800805107032105, -34.800805107032105, -34.91854109736683, -36.41854109736683, -36.41854109736683, -33.341859783422315, -32.841859783422315, -33.341859783422315, -34.58536319993377, -35.58536319993377, -35.58536319993377, -35.64322327886524, -35.64322327886524, -35.64322327886524, -28.701211676312987, -28.701211676312987, -28.701211676312987, -33.88267274352634, -34.88267274352634, -34.88267274352634, -26.736576787021157, -27.736576787021157, -27.736576787021157, -28.218618265979355, -26.718618265979355, -28.218618265979355, -27.48798074507046, -27.48798074507046, -27.48798074507046, -27.46629161105117, -26.46629161105117, -27.46629161105117, -34.99319914585312, -34.99319914585312, -34.99319914585312, -34.44873631077234, -33.44873631077234, -34.44873631077234, -32.56429663779038, -32.56429663779038, -32.56429663779038, -23.656911984057523, -23.656911984057523, -23.656911984057523, -31.967303589119776, -31.967303589119776, -31.967303589119776, -30.504889331399305, -32.004889331399305, -31.004889331399305, -28.109464665835077, -28.109464665835077, -27.609464665835077, -32.57725884210628, -32.07725884210628, -33.07725884210628, -36.073195220011954, -36.073195220011954, -36.073195220011954, -36.324736607538725, -36.324736607538725, -36.324736607538725, -43.61004978917269, -43.61004978917269, -43.61004978917269, -32.858950469867395, -32.858950469867395, -32.858950469867395, -35.546362544319635, -35.546362544319635, -35.546362544319635, -41.84467385540771, -41.84467385540771, -41.84467385540771, -36.582691429097764, -33.582691429097764, -36.582691429097764, -33.375922523731376, -33.375922523731376, -33.375922523731376, -29.94449739245602, -32.44449739245602, -32.44449739245602, -36.9213180930366, -36.9213180930366, -36.9213180930366, -35.508414793713435, -35.508414793713435, -35.508414793713435, -26.354025874536752, -26.854025874536752, -26.854025874536752, -35.03188385648594, -35.03188385648594, -35.03188385648594, -43.98243890108155, -43.98243890108155, -43.98243890108155, -42.56528188570144, -42.56528188570144, -40.565281885701445, -37.4646181790271, -37.4646181790271, -37.4646181790271, -32.039520231685806, -30.039520231685803, -31.039520231685803, -44.40257322853655, -44.40257322853655, -44.40257322853655, -37.4720633844492, -35.9720633844492, -37.4720633844492, -32.750496079057854, -32.750496079057854, -32.750496079057854, -24.94343303031453, -24.44343303031453, -24.94343303031453, -26.910386833509346, -26.410386833509346, -26.910386833509346, -34.990238766959905, -35.490238766959905, -34.49023876695989, -26.85901267068573, -25.359012670685733, -26.85901267068573, -28.699568106393638, -28.699568106393638, -28.699568106393638, -29.40888665944796, -29.40888665944796, -29.40888665944796, -32.95448773715769, -32.95448773715769, -32.95448773715769, -37.3856355841864, -37.3856355841864, -36.8856355841864, -24.573720988333505, -24.573720988333505, -24.573720988333505, -30.61013513358306, -29.61013513358306, -30.61013513358306, -31.169694081899166, -31.169694081899166, -31.169694081899166, -30.912842662579045, -30.912842662579045, -30.912842662579045, -35.845097061400004, -35.845097061400004, -35.845097061400004, -27.29814961039892, -27.29814961039892, -27.29814961039892, -32.73327027701414, -33.23327027701415, -33.23327027701415, -26.126602529584943, -26.126602529584943, -26.126602529584943, -33.97431716453361, -33.97431716453361, -33.97431716453361, -26.582490090697185, -26.582490090697185, -26.582490090697185, -30.007080480580505, -30.007080480580505, -30.007080480580505, -33.78020503541124, -33.78020503541124, -32.280205035411235, -22.885883582716236, -23.385883582716236, -22.885883582716236, -22.046967779476063, -22.046967779476063, -22.046967779476063, -37.24435386048464, -37.74435386048464, -37.74435386048464, -38.32712931254001, -39.82712931254001, -39.82712931254001, -33.841384798798195, -35.841384798798195, -35.841384798798195, -32.337281742192275, -32.337281742192275, -32.337281742192275, -36.28061190259609, -35.78061190259609, -36.28061190259609, -36.942853729565286, -36.942853729565286, -36.942853729565286, -35.9724393747988, -35.9724393747988, -35.4724393747988, -38.39778081363147, -38.39778081363147, -37.39778081363147, -28.863882092145968, -28.863882092145968, -28.863882092145968, -34.354540354389044, -33.854540354389044, -33.854540354389044, -25.213232144450007, -25.713232144450007, -25.213232144450007, -29.865746929781903, -29.365746929781903, -29.865746929781903, -28.028109887126007, -28.028109887126007, -28.028109887126007, -32.41267033158792, -32.41267033158792, -32.41267033158792, -37.15906789488627, -37.15906789488627, -37.15906789488627, -29.206981803872125, -29.206981803872125, -29.206981803872125, -24.13018187409213, -24.13018187409213, -24.13018187409213, -27.455972830605884, -27.955972830605884, -27.455972830605884, -28.576662129996258, -28.576662129996258, -28.576662129996258, -35.12909371087415, -34.62909371087415, -35.12909371087415, -35.73898723101903, -34.73898723101903, -35.73898723101903, -35.294965285825285, -35.294965285825285, -35.294965285825285, -34.33055797263942, -34.33055797263942, -34.33055797263942, -34.82935439892625, -34.32935439892625, -35.32935439892624, -32.26714619965774, -31.767146199657734, -32.26714619965774, -34.868869420393814, -35.368869420393814, -35.368869420393814, -30.530728230463982, -30.530728230463982, -30.530728230463982, -31.703078123127607, -31.703078123127607, -31.703078123127607, -36.043477876824895, -35.043477876824895, -36.043477876824895, -35.787128677702356, -35.787128677702356, -35.787128677702356, -28.114698864455953, -28.114698864455953, -28.114698864455953, -30.744590993881925, -30.744590993881925, -30.744590993881925, -32.25508656891504, -32.25508656891504, -32.25508656891504, -33.11121905982843, -33.11121905982843, -30.111219059828432, -29.391486768312962, -29.391486768312962, -29.391486768312962, -33.484545843910716, -33.484545843910716, -33.984545843910716, -37.107170563809035, -37.107170563809035, -37.107170563809035, -35.195009315577046, -32.695009315577046, -35.195009315577046, -28.13054568715954, -28.13054568715954, -28.13054568715954, -29.30580374767559, -28.305803747675593, -29.30580374767559, -33.46064917825203, -33.46064917825203, -33.46064917825203, -36.87571503552354, -36.87571503552354, -36.87571503552354, -32.21601493707591, -32.21601493707591, -32.21601493707591, -30.842725450346865, -30.842725450346865, -30.842725450346865, -31.90789088217412, -31.90789088217412, -31.90789088217412, -36.57739324221996, -36.57739324221996, -36.07739324221996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3135291250763906, "mean_inference_ms": 1.2688154230972828, "mean_action_processing_ms": 0.07001271128281983, "mean_env_wait_ms": 0.5820120978876907, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 124800, "timesteps_this_iter": 0, "agent_timesteps_total": 374400, "timers": {"sample_time_ms": 1528.569, "sample_throughput": 2093.462, "load_time_ms": 0.132, "load_throughput": 24152911.283, "learn_time_ms": 783.719, "learn_throughput": 4083.094, "update_time_ms": 1.506}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 74.54298782348633, "policy_loss": -0.0027562899656283337, "vf_loss": 74.55907135009765, "vf_explained_var": -0.003901958465576172, "kl": 0.0057866327730717645, "entropy": 1.332862949371338, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124800, "num_agent_steps_sampled": 374400, "num_steps_trained": 124800, "num_agent_steps_trained": 374400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4990, "training_iteration": 39, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-36", "timestamp": 1718736396, "time_this_iter_s": 1.5260300636291504, "time_total_s": 59.90445303916931, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 59.90445303916931, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 39.2, "ram_util_percent": 30.3}}
{"episode_reward_max": -67.26682991002195, "episode_reward_min": -156.6242978195464, "episode_reward_mean": -98.01917502935858, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -52.37476593984879}, "policy_reward_max": {"shared_policy": -21.422276636673978}, "policy_reward_mean": {"shared_policy": -32.67305834311952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-95.89921542757457, -101.9448888886816, -96.61142277775377, -91.03558808688523, -96.24771957110522, -86.86534138808601, -100.91927304659737, -97.34729388319215, -93.91326046661412, -96.09256389043809, -109.62025901050106, -106.84439659869712, -113.64091867060738, -79.88387757939073, -156.6242978195464, -85.94590271247114, -87.92704516175185, -82.36270693941306, -85.60333897742453, -69.82540496620608, -73.90663000998626, -85.24095287722872, -94.94878958881334, -87.34987641445584, -95.08873324692044, -97.94491599749625, -107.64117667596518, -95.65692322828845, -103.77962140170985, -97.95113465726011, -121.3283224943687, -97.30218697021232, -72.57367257512922, -77.76228762407993, -104.4474508334309, -88.78541988579379, -79.30954621688042, -78.27267657529994, -97.750168341674, -100.65995387560666, -67.26682991002195, -112.14778729718167, -104.96726177344166, -88.91406554328445, -89.83187629598267, -93.66244664217191, -145.3595453472624, -107.83189791684859, -112.98540022622342, -120.58192354777374, -67.67056541248938, -111.7837172842072, -123.02169140700624, -107.570155033703, -91.33112946295545, -96.49257106298114, -90.04313283095145, -79.00903545820593, -103.87133735370541, -100.22826900944088, -87.80375086774539, -115.88437814420139, -105.8865194533492, -87.87729359063977, -83.03147261094453, -105.39955489792851, -83.9188740698719, -101.7498901725399, -105.22062002285307, -101.18600842115447, -83.21769777231137, -84.80602843327607, -105.85801769095819, -102.04919412502592, -94.74200413395972, -82.44021106013821, -81.51123660656252, -78.62124763431738, -82.97279510654718, -82.17353463638105, -82.91600122054385, -116.50408798320417, -107.15324980643267, -93.82365648346926, -104.4612067816726, -131.7136802206276, -77.57550132143787, -77.80529036245494, -103.09205835751334, -97.26792932230421, -112.00988134861106, -83.37912755001328, -85.71061005395804, -112.28385883009453, -88.73966816189026, -100.64669193879728, -86.0424373515054, -119.45188235293242, -84.98236205549237, -103.88503155662141, -105.77841766496263, -94.33104656244076, -111.77081650729848, -76.82971441656684, -92.7135250296578, -98.76155461812405, -86.30355867630212, -116.00515656458631, -92.83569777756672, -77.82265655564085, -103.87558328525381, -116.08261616108823, -96.44731132995341, -87.66202306756179, -93.15159904011321, -98.00560633000605, -118.30148194559075, -134.2239569899744, -118.33013287310655, -110.69678243858995, -81.98388443405138, -127.17618082922371, -89.86601327823301, -127.50425720702623, -84.50095997605655, -115.85252579053738, -117.70335692515505, -97.53274467776293, -102.95145368160499, -134.27180250291994], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-31.966405142524867, -31.966405142524867, -31.966405142524867, -34.48162962956053, -32.98162962956053, -34.48162962956053, -32.703807592584575, -31.203807592584578, -32.703807592584575, -30.345196028961748, -30.345196028961748, -30.345196028961748, -32.08257319036842, -32.08257319036842, -32.08257319036842, -28.955113796028638, -28.955113796028638, -28.955113796028638, -33.639757682199125, -33.639757682199125, -33.639757682199125, -32.44909796106407, -32.44909796106407, -32.44909796106407, -31.304420155538054, -31.304420155538054, -31.304420155538054, -32.030854630146045, -32.030854630146045, -32.030854630146045, -36.540086336833674, -36.540086336833674, -36.540086336833674, -36.781465532899034, -35.281465532899034, -34.781465532899034, -37.88030622353579, -37.88030622353579, -37.88030622353579, -25.96129252646357, -27.46129252646357, -26.46129252646357, -52.37476593984879, -51.87476593984879, -52.37476593984879, -28.6486342374904, -28.6486342374904, -28.6486342374904, -29.309015053917282, -29.309015053917282, -29.309015053917282, -27.787568979804355, -26.787568979804355, -27.787568979804355, -28.20111299247486, -28.70111299247486, -28.70111299247486, -23.27513498873538, -23.27513498873538, -23.27513498873538, -24.63554333666209, -24.63554333666209, -24.63554333666209, -28.41365095907625, -28.41365095907625, -28.41365095907625, -31.982929862937763, -31.982929862937763, -30.982929862937763, -29.11662547148529, -29.11662547148529, -29.11662547148529, -31.029577748973477, -31.529577748973477, -32.52957774897347, -32.648305332498744, -32.648305332498744, -32.648305332498744, -36.5470588919884, -34.54705889198839, -36.5470588919884, -31.885641076096146, -31.885641076096146, -31.885641076096146, -35.09320713390328, -35.09320713390328, -33.59320713390328, -32.650378219086704, -32.650378219086704, -32.650378219086704, -40.7761074981229, -39.7761074981229, -40.7761074981229, -33.100728990070756, -33.100728990070756, -31.100728990070756, -24.357890858376408, -23.857890858376408, -24.357890858376408, -25.920762541359984, -25.920762541359984, -25.920762541359984, -34.81581694447696, -34.81581694447696, -34.81581694447696, -29.59513996193126, -29.59513996193126, -29.59513996193126, -26.436515405626828, -26.436515405626828, -26.436515405626828, -26.090892191766642, -26.090892191766642, -26.090892191766642, -31.916722780557997, -32.916722780558, -32.916722780558, -33.55331795853556, -33.55331795853556, -33.55331795853556, -21.422276636673978, -22.922276636673978, -22.922276636673978, -37.38259576572722, -37.38259576572722, -37.38259576572722, -35.155753924480535, -34.65575392448054, -35.155753924480535, -29.971355181094797, -28.971355181094797, -29.971355181094797, -29.94395876532756, -29.94395876532756, -29.94395876532756, -29.554148880723993, -32.054148880724, -32.054148880724, -48.45318178242083, -48.45318178242083, -48.45318178242083, -35.94396597228287, -35.94396597228287, -35.94396597228287, -37.661800075407804, -37.661800075407804, -37.661800075407804, -37.86064118259129, -41.360641182591294, -41.360641182591294, -22.556855137496452, -22.556855137496452, -22.556855137496452, -35.59457242806907, -38.09457242806907, -38.09457242806907, -41.34056380233542, -41.34056380233542, -40.34056380233542, -35.85671834456767, -35.85671834456767, -35.85671834456767, -30.443709820985177, -30.443709820985177, -30.443709820985177, -32.4975236876604, -31.497523687660394, -32.4975236876604, -30.014377610317155, -30.014377610317155, -30.014377610317155, -26.336345152735333, -26.336345152735333, -26.336345152735333, -34.62377911790182, -34.62377911790182, -34.62377911790182, -33.40942300314694, -33.40942300314694, -33.40942300314694, -29.43458362258179, -29.43458362258179, -28.93458362258179, -38.794792714733795, -38.294792714733795, -38.794792714733795, -35.29550648444974, -35.29550648444974, -35.29550648444974, -29.29243119687992, -29.29243119687992, -29.29243119687992, -27.677157536981518, -27.677157536981518, -27.677157536981518, -35.29985163264286, -34.79985163264286, -35.29985163264286, -27.972958023290623, -27.972958023290623, -27.972958023290623, -33.91663005751329, -33.91663005751329, -33.91663005751329, -35.073540007617694, -35.073540007617694, -35.073540007617694, -33.72866947371817, -33.72866947371817, -33.72866947371817, -27.739232590770452, -27.739232590770452, -27.739232590770452, -28.26867614442537, -28.26867614442537, -28.26867614442537, -35.28600589698608, -35.28600589698608, -35.28600589698608, -34.516398041675295, -34.516398041675295, -33.016398041675295, -31.580668044653223, -31.580668044653223, -31.580668044653223, -27.646737020046075, -27.146737020046075, -27.646737020046075, -27.17041220218753, -27.17041220218753, -27.17041220218753, -26.207082544772444, -26.207082544772444, -26.207082544772444, -27.990931702182404, -27.990931702182404, -26.990931702182404, -27.391178212127027, -27.391178212127027, -27.391178212127027, -27.638667073514604, -27.638667073514604, -27.638667073514604, -39.00136266106807, -39.00136266106807, -38.50136266106807, -35.717749935477556, -35.717749935477556, -35.717749935477556, -31.27455216115642, -31.27455216115642, -31.27455216115642, -34.487068927224215, -34.987068927224215, -34.987068927224215, -44.07122674020918, -44.07122674020918, -43.57122674020918, -25.525167107145954, -26.025167107145954, -26.025167107145954, -25.935096787484994, -25.935096787484994, -25.935096787484994, -34.36401945250448, -34.36401945250448, -34.36401945250448, -31.42264310743475, -32.92264310743475, -32.92264310743475, -37.16996044953699, -37.66996044953699, -37.16996044953699, -27.79304251667109, -27.79304251667109, -27.79304251667109, -28.57020335131933, -28.57020335131933, -28.57020335131933, -37.42795294336484, -37.42795294336484, -37.42795294336484, -29.579889387296756, -29.579889387296756, -29.579889387296756, -33.548897312932425, -33.548897312932425, -33.548897312932425, -29.84747911716846, -29.34747911716846, -26.84747911716846, -39.81729411764413, -39.81729411764413, -39.81729411764413, -28.994120685164116, -28.994120685164116, -26.994120685164116, -34.628343852207145, -34.628343852207145, -34.628343852207145, -35.926139221654196, -35.926139221654196, -33.926139221654196, -31.443682187480235, -31.443682187480235, -31.443682187480235, -37.256938835766185, -37.256938835766185, -37.256938835766185, -26.109904805522277, -24.609904805522277, -26.109904805522277, -30.90450834321925, -30.90450834321925, -30.90450834321925, -33.42051820604133, -33.42051820604133, -31.920518206041336, -28.767852892100713, -28.767852892100713, -28.767852892100713, -38.83505218819545, -38.33505218819545, -38.83505218819545, -31.778565925855567, -29.278565925855567, -31.778565925855567, -25.94088551854695, -25.94088551854695, -25.94088551854695, -34.2918610950846, -34.791861095084606, -34.791861095084606, -38.694205387029434, -38.694205387029434, -38.694205387029434, -32.149103776651124, -32.149103776651124, -32.149103776651124, -29.22067435585392, -29.22067435585392, -29.22067435585392, -31.21719968003772, -30.71719968003772, -31.21719968003772, -32.668535443335344, -32.668535443335344, -32.668535443335344, -40.10049398186355, -38.10049398186356, -40.10049398186355, -44.74131899665813, -44.74131899665813, -44.74131899665813, -39.77671095770219, -39.77671095770219, -38.77671095770219, -36.565594146196624, -37.065594146196624, -37.065594146196624, -27.661294811350444, -27.661294811350444, -26.661294811350444, -41.72539360974125, -42.72539360974125, -42.72539360974125, -29.955337759410998, -29.955337759410998, -29.955337759410998, -42.8347524023421, -41.8347524023421, -42.8347524023421, -28.333653325352188, -28.333653325352188, -27.833653325352188, -37.95084193017915, -38.95084193017915, -38.95084193017915, -39.23445230838503, -39.23445230838503, -39.23445230838503, -32.51091489258765, -32.51091489258765, -32.51091489258765, -34.31715122720166, -34.81715122720166, -33.81715122720166, -44.75726750097329, -44.75726750097329, -44.75726750097329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3141925536266631, "mean_inference_ms": 1.2715060080823355, "mean_action_processing_ms": 0.07012937694925338, "mean_env_wait_ms": 0.5830345167963591, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 128000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 1546.672, "sample_throughput": 2068.958, "load_time_ms": 0.133, "load_throughput": 24057667.682, "learn_time_ms": 791.104, "learn_throughput": 4044.983, "update_time_ms": 1.492}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 79.1524154663086, "policy_loss": -0.003135093774685327, "vf_loss": 79.16885223388672, "vf_explained_var": -0.030799221992492676, "kl": 0.0064568583878666375, "entropy": 1.330494999885559, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 384000, "num_steps_trained": 128000, "num_agent_steps_trained": 384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5120, "training_iteration": 40, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-38", "timestamp": 1718736398, "time_this_iter_s": 1.6574528217315674, "time_total_s": 61.56190586090088, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 61.56190586090088, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 41.5, "ram_util_percent": 30.35}}
{"episode_reward_max": -65.11055430033541, "episode_reward_min": -141.45134610637587, "episode_reward_mean": -96.88418682951783, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -47.81711536879196}, "policy_reward_max": {"shared_policy": -21.70351810011181}, "policy_reward_mean": {"shared_policy": -32.294728943172615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.10308939806858, -85.55058375334973, -104.87104624818961, -93.77762996431878, -87.75010130839223, -105.4287194709909, -79.51746545504344, -76.66113390625158, -82.54411505161738, -86.89216642064548, -98.53184321825483, -86.05808713630259, -101.6123110940775, -71.29719320058616, -83.27281511521723, -76.09345910915928, -92.57038975923749, -99.38030520758834, -112.31577152001606, -69.33428697977848, -106.97201702552088, -91.3917229408891, -84.94531484518521, -102.51875820351715, -76.89112897681223, -76.2610483680546, -71.19888397515011, -115.15024267646423, -104.87946708495868, -105.66694760254117, -85.83235770078385, -114.82148340953059, -105.06422633352999, -97.11939141201123, -65.11055430033541, -105.5410851797779, -86.0797041808926, -91.3218132196327, -116.64982933345941, -108.09025282392871, -112.01538316350567, -101.30715740943666, -98.10273243603, -74.22968191714538, -81.57174005419684, -106.33755178510148, -120.62144583098996, -100.42398086494994, -79.14144015091176, -140.69125855054514, -86.11809348371659, -80.6868284101332, -93.05054676938538, -123.51684191715155, -90.43142314580174, -89.86270900290874, -109.86462118508219, -76.60316757322055, -107.38600482491626, -118.66058377344541, -99.3018159443004, -100.79068877144998, -130.58902466898022, -97.50914304808121, -91.24605126168198, -92.06107047388625, -100.7822370922275, -125.71451883799789, -130.274138908774, -70.42647082070772, -97.02787744968306, -108.72204810868415, -101.85349425196114, -90.62779350106412, -92.47498744002, -78.91123352247885, -108.93962869009847, -80.7869041842654, -105.18290941831675, -113.01170252512675, -83.32179492448027, -100.59882978259131, -111.04510088577071, -88.04193389920378, -129.76357083197138, -89.41376852763594, -99.86617365810395, -141.45134610637587, -117.27772760241562, -92.13447778250946, -100.65106435876174, -90.39834611845588, -115.00105614032151, -107.6419655703962, -93.0427315459137, -87.81530620141928, -101.1767529189169, -88.75468297380364, -85.631380398285, -99.55040056845003, -116.67874261012244, -89.63402498980747, -104.32510824107474, -70.71026536988278, -86.58507156739897, -96.13012422751402, -102.26704159583572, -89.51295765970131, -71.06323137726622, -105.70289985380847, -80.97801647239623, -86.85554240492266, -110.00177096884507, -85.16894484172948, -113.99634235374133, -98.41275242451164, -91.51473235566682, -129.76314233647227, -99.15983123965461, -91.13779177758448], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-24.034363132689524, -24.034363132689524, -24.034363132689524, -28.183527917783238, -28.683527917783238, -28.683527917783238, -34.9570154160632, -34.9570154160632, -34.9570154160632, -30.92587665477293, -31.42587665477293, -31.42587665477293, -30.083367102797386, -27.583367102797382, -30.083367102797386, -35.14290649033032, -35.14290649033032, -35.14290649033032, -26.5058218183478, -26.5058218183478, -26.5058218183478, -25.887044635417197, -25.887044635417197, -24.887044635417197, -27.514705017205802, -27.514705017205802, -27.514705017205802, -29.130722140215145, -29.130722140215145, -28.630722140215145, -33.34394773941828, -31.843947739418283, -33.34394773941828, -28.35269571210088, -28.85269571210088, -28.85269571210088, -34.20410369802584, -34.20410369802584, -33.20410369802584, -23.765731066862056, -23.765731066862056, -23.765731066862056, -27.42427170507241, -27.92427170507241, -27.92427170507241, -25.364486369719785, -25.364486369719785, -25.364486369719785, -30.856796586412496, -30.856796586412496, -30.856796586412496, -33.4601017358628, -33.4601017358628, -32.4601017358628, -37.438590506672014, -37.438590506672014, -37.438590506672014, -23.444762326592816, -23.444762326592816, -22.444762326592816, -35.82400567517364, -35.82400567517364, -35.32400567517364, -30.46390764696304, -30.46390764696304, -30.46390764696304, -28.31510494839508, -28.31510494839508, -28.31510494839508, -33.50625273450569, -34.50625273450569, -34.50625273450569, -25.96370965893742, -24.96370965893742, -25.96370965893742, -25.420349456018215, -25.420349456018215, -25.420349456018215, -23.399627991716688, -23.899627991716688, -23.899627991716688, -38.38341422548808, -38.38341422548808, -38.38341422548808, -35.79315569498621, -34.29315569498621, -34.79315569498621, -35.3889825341804, -35.3889825341804, -34.8889825341804, -28.61078590026129, -28.61078590026129, -28.61078590026129, -38.273827803176836, -38.273827803176836, -38.273827803176836, -35.02140877784334, -35.02140877784334, -35.02140877784334, -32.37313047067042, -32.37313047067042, -32.37313047067042, -21.70351810011181, -21.70351810011181, -21.70351810011181, -35.680361726592636, -34.180361726592636, -35.680361726592636, -29.02656806029753, -28.02656806029753, -29.02656806029753, -30.44060440654423, -30.44060440654423, -30.44060440654423, -39.216609777819784, -39.216609777819784, -38.216609777819784, -35.36341760797623, -36.36341760797623, -36.36341760797623, -37.671794387835206, -37.671794387835206, -36.671794387835206, -33.93571913647891, -33.43571913647891, -33.93571913647891, -32.86757747867667, -32.86757747867667, -32.36757747867667, -24.743227305715134, -24.743227305715134, -24.743227305715134, -27.19058001806559, -27.19058001806559, -27.19058001806559, -35.94585059503383, -35.94585059503383, -34.44585059503383, -40.20714861032999, -40.20714861032999, -40.20714861032999, -33.641326954983306, -33.641326954983306, -33.141326954983306, -26.380480050303923, -26.380480050303923, -26.380480050303923, -46.23041951684838, -46.73041951684838, -47.73041951684838, -28.70603116123887, -28.70603116123887, -28.70603116123887, -27.062276136711063, -27.062276136711063, -26.562276136711063, -31.01684892312847, -31.01684892312847, -31.01684892312847, -41.17228063905053, -41.17228063905053, -41.17228063905053, -29.810474381933894, -30.310474381933894, -30.310474381933894, -30.287569667636223, -30.287569667636223, -29.287569667636223, -36.621540395027395, -36.621540395027395, -36.621540395027395, -25.70105585774018, -25.20105585774018, -25.70105585774018, -35.795334941638735, -35.795334941638735, -35.795334941638735, -39.55352792448181, -39.55352792448181, -39.55352792448181, -33.10060531476682, -33.10060531476682, -33.10060531476682, -34.26356292381666, -33.26356292381666, -33.26356292381666, -43.52967488966009, -43.52967488966009, -43.52967488966009, -32.50304768269373, -32.50304768269373, -32.50304768269373, -30.415350420560696, -30.415350420560696, -30.415350420560696, -30.020356824628752, -31.520356824628752, -30.520356824628752, -33.59407903074254, -33.59407903074254, -33.59407903074254, -41.904839612665945, -41.904839612665945, -41.904839612665945, -43.75804630292465, -43.75804630292465, -42.758046302924654, -23.475490273569257, -23.475490273569257, -23.475490273569257, -32.342625816561004, -32.342625816561004, -32.342625816561004, -37.240682702894716, -37.240682702894716, -34.240682702894716, -33.9511647506537, -33.9511647506537, -33.9511647506537, -30.37593116702136, -30.37593116702136, -29.87593116702136, -30.82499581334001, -30.82499581334001, -30.82499581334001, -26.30374450749295, -26.30374450749295, -26.30374450749295, -35.646542896699486, -36.64654289669949, -36.64654289669949, -27.095634728088477, -26.595634728088477, -27.095634728088477, -35.06096980610559, -35.06096980610559, -35.06096980610559, -38.003900841708926, -38.003900841708926, -37.00390084170892, -27.773931641493423, -27.773931641493423, -27.773931641493423, -33.3662765941971, -34.86627659419711, -32.36627659419711, -37.01503362859023, -37.01503362859023, -37.01503362859023, -29.34731129973461, -29.34731129973461, -29.34731129973461, -43.254523610657145, -43.254523610657145, -43.254523610657145, -29.804589509211983, -29.804589509211983, -29.804589509211983, -32.62205788603464, -33.62205788603464, -33.62205788603464, -47.81711536879196, -47.81711536879196, -45.81711536879196, -39.092575867471886, -39.092575867471886, -39.092575867471886, -30.71149259416983, -30.71149259416983, -30.71149259416983, -33.71702145292059, -33.21702145292059, -33.71702145292059, -30.1327820394853, -30.1327820394853, -30.1327820394853, -38.500352046773834, -38.000352046773834, -38.500352046773834, -35.88065519013205, -35.88065519013205, -35.88065519013205, -31.014243848637882, -31.014243848637882, -31.014243848637882, -29.271768733806447, -29.271768733806447, -29.271768733806447, -33.72558430630567, -33.72558430630567, -33.72558430630567, -29.58489432460121, -29.58489432460121, -29.58489432460121, -28.877126799428325, -28.877126799428325, -27.877126799428325, -33.18346685615003, -33.18346685615003, -33.18346685615003, -38.5595808700408, -39.0595808700408, -39.0595808700408, -29.878008329935827, -29.878008329935827, -29.878008329935827, -34.441702747024934, -34.941702747024934, -34.941702747024934, -22.903421789960905, -23.903421789960905, -23.903421789960905, -28.861690522466333, -28.861690522466333, -28.861690522466333, -32.04337474250467, -32.04337474250467, -32.04337474250467, -34.08901386527858, -34.08901386527858, -34.08901386527858, -29.837652553233763, -29.837652553233763, -29.837652553233763, -24.021077125755404, -24.021077125755404, -23.021077125755404, -35.90096661793615, -34.90096661793615, -34.90096661793615, -27.326005490798746, -26.326005490798746, -27.326005490798746, -28.951847468307573, -28.951847468307573, -28.951847468307573, -36.3339236562817, -36.8339236562817, -36.8339236562817, -28.389648280576473, -28.389648280576473, -28.389648280576473, -37.99878078458044, -37.99878078458044, -37.99878078458044, -32.804250808170565, -32.804250808170565, -32.804250808170565, -30.504910785222282, -30.504910785222282, -30.504910785222282, -43.25438077882412, -43.25438077882412, -43.25438077882412, -33.053277079884836, -33.053277079884836, -33.053277079884836, -30.379263925861494, -30.379263925861494, -30.379263925861494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3136227856085037, "mean_inference_ms": 1.2697321477709322, "mean_action_processing_ms": 0.07002562813693072, "mean_env_wait_ms": 0.5822306007848681, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 131200, "timesteps_this_iter": 0, "agent_timesteps_total": 393600, "timers": {"sample_time_ms": 1549.843, "sample_throughput": 2064.725, "load_time_ms": 0.133, "load_throughput": 24087890.883, "learn_time_ms": 791.475, "learn_throughput": 4043.084, "update_time_ms": 1.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005000000000000001, "total_loss": 82.78772811889648, "policy_loss": -0.0030035046747265426, "vf_loss": 82.80398101806641, "vf_explained_var": 0.0023191094398498533, "kl": 0.004516473213994954, "entropy": 1.3250506520271301, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 131200, "num_agent_steps_sampled": 393600, "num_steps_trained": 131200, "num_agent_steps_trained": 393600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5240, "training_iteration": 41, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-39", "timestamp": 1718736399, "time_this_iter_s": 1.4825010299682617, "time_total_s": 63.04440689086914, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219baf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 63.04440689086914, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 36.7, "ram_util_percent": 30.4}}
{"episode_reward_max": -64.54134774034706, "episode_reward_min": -147.81442952579104, "episode_reward_mean": -96.87452197118613, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -49.77147650859704}, "policy_reward_max": {"shared_policy": -20.51378258011569}, "policy_reward_mean": {"shared_policy": -32.29150732372871}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.38224235657572, -76.67116041471824, -99.86868123021938, -71.34177411376848, -126.08153147778113, -89.44759517774487, -83.90420965611044, -102.11413616136542, -97.07281034496835, -106.35512939865365, -76.35756059326751, -91.68982854858724, -111.20381540206083, -106.88057273014596, -105.90266200718037, -84.2559032844199, -90.68046499916292, -116.98819312310866, -74.0072170761664, -110.63623428996837, -84.68170351152501, -114.29278379629679, -126.76817250752978, -95.2377733035051, -99.254109984022, -69.49683972645114, -95.91329909323221, -93.44061667433041, -116.14353585786105, -80.83790761507925, -112.10887071631355, -111.42080689540772, -116.13219527242317, -93.64662957926487, -96.6605547341556, -120.5683154194624, -84.80363250399905, -100.93381744169676, -67.86820278554602, -141.54145143557, -103.70175378972522, -79.77621746376057, -85.2855743456526, -98.28641651402653, -84.6295056514342, -90.72969544383994, -117.61234595171577, -94.04357233884068, -83.82200067390005, -100.47020290586173, -72.32084583548907, -100.84702168233983, -106.95810380806856, -84.64809512198273, -77.3630393115342, -93.1928862672844, -115.592714621893, -111.67832989518091, -79.43606152160658, -74.13559041315119, -103.5005491344557, -112.03388231539273, -109.46816379465538, -84.7736488011739, -99.46577247700151, -89.9784020677942, -119.36347779830534, -104.03935677486898, -78.61064995806699, -91.95446310933795, -97.87348394638603, -134.10975488347572, -83.14375458185263, -98.1895128867347, -96.52353634439686, -100.1737785938802, -88.65650145713504, -114.89826452526978, -117.83807335126085, -86.37090722176129, -92.49489782367321, -90.20781650629397, -93.49950365747227, -80.74593282818137, -78.53126069544514, -112.81121011836572, -84.06156478082079, -99.53272660295875, -121.92808422462167, -118.29093484771347, -79.77313337939447, -83.91281491997178, -100.08749022342124, -94.2210826594365, -93.968845776257, -107.78754255808686, -81.0319980393544, -100.3263750883451, -102.60659199591318, -83.74745317593487, -75.29927097662286, -90.3788248831605, -102.25827917474915, -147.81442952579104, -65.6069282667308, -96.76386962038676, -105.4674955370621, -121.38682473739516, -89.07701559160311, -87.18186730511788, -87.69271851998161, -73.10001267873396, -123.06906587311714, -88.18699154753863, -88.93500196098313, -79.27574338177504, -114.24364492728184, -64.54134774034706, -88.93275479177491, -89.21036764751739, -122.00712190039788, -112.10472131068995, -94.18233259295981, -89.62494774168773, -83.4286043785324, -89.44804505712555, -124.9742310565987, -93.57343385284204, -112.29883042258149, -70.96702453130867], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-38.1274141188586, -38.1274141188586, -38.1274141188586, -25.72372013823942, -25.22372013823942, -25.72372013823942, -33.28956041007313, -33.28956041007313, -33.28956041007313, -23.780591371256165, -23.780591371256165, -23.780591371256165, -42.02717715926037, -42.02717715926037, -42.02717715926037, -29.482531725914978, -29.982531725914978, -29.982531725914978, -27.968069885370145, -27.968069885370145, -27.968069885370145, -34.20471205378849, -34.20471205378849, -33.70471205378849, -31.02427011498947, -33.02427011498947, -33.02427011498947, -34.45170979955123, -35.95170979955123, -35.95170979955123, -25.452520197755835, -25.452520197755835, -25.452520197755835, -30.89660951619575, -29.89660951619575, -30.89660951619575, -37.5679384673536, -36.0679384673536, -37.5679384673536, -33.96019091004866, -36.46019091004867, -36.46019091004867, -35.80088733572679, -34.80088733572679, -35.30088733572679, -28.085301094806624, -28.085301094806624, -28.085301094806624, -30.3934883330543, -29.8934883330543, -30.3934883330543, -38.99606437436955, -38.99606437436955, -38.99606437436955, -24.83573902538882, -24.33573902538882, -24.83573902538882, -36.54541142998942, -37.04541142998942, -37.04541142998942, -28.56056783717498, -27.56056783717498, -28.56056783717498, -38.764261265432246, -38.764261265432246, -36.764261265432246, -42.92272416917659, -42.92272416917659, -40.922724169176576, -31.74592443450171, -31.74592443450171, -31.74592443450171, -33.08470332800732, -33.08470332800732, -33.08470332800732, -23.33227990881705, -23.33227990881705, -22.83227990881705, -32.471099697744066, -32.471099697744066, -30.97109969774407, -31.480205558110136, -30.480205558110136, -31.480205558110136, -39.047845285953684, -38.04784528595367, -39.047845285953684, -27.279302538359754, -26.279302538359754, -27.279302538359754, -35.70295690543785, -38.20295690543785, -38.20295690543785, -37.47360229846924, -36.97360229846924, -36.97360229846924, -38.7107317574744, -38.7107317574744, -38.7107317574744, -31.215543193088287, -31.215543193088287, -31.215543193088287, -32.22018491138519, -32.22018491138519, -32.22018491138519, -40.18943847315413, -40.18943847315413, -40.18943847315413, -28.267877501333004, -28.267877501333004, -28.267877501333004, -34.14460581389891, -32.64460581389891, -34.14460581389891, -23.122734261848695, -21.622734261848695, -23.122734261848695, -47.51381714518996, -47.51381714518996, -46.51381714518996, -36.06725126324176, -34.06725126324176, -33.56725126324176, -25.592072487920184, -27.092072487920184, -27.092072487920184, -28.928524781884217, -27.428524781884217, -28.928524781884217, -32.76213883800884, -32.76213883800884, -32.76213883800884, -28.54316855047803, -27.54316855047803, -28.54316855047803, -30.243231814613296, -30.243231814613296, -30.243231814613296, -38.53744865057194, -39.53744865057194, -39.53744865057194, -31.34785744628023, -31.34785744628023, -31.34785744628023, -28.1073335579667, -28.1073335579667, -27.6073335579667, -33.156734301953904, -33.656734301953904, -33.656734301953904, -23.773615278496344, -24.273615278496344, -24.273615278496344, -33.61567389411327, -33.61567389411327, -33.61567389411327, -34.65270126935618, -36.652701269356186, -35.652701269356186, -28.216031707327563, -28.216031707327563, -28.216031707327563, -25.45434643717807, -25.954346437178074, -25.954346437178074, -31.064295422428106, -31.064295422428106, -31.064295422428106, -38.53090487396431, -38.53090487396431, -38.53090487396431, -37.226109965060296, -37.226109965060296, -37.226109965060296, -26.478687173868842, -26.478687173868842, -26.478687173868842, -24.71186347105038, -24.71186347105038, -24.71186347105038, -34.500183044818556, -34.500183044818556, -34.500183044818556, -38.0112941051309, -38.0112941051309, -36.0112941051309, -36.15605459821845, -36.65605459821845, -36.65605459821845, -28.257882933724645, -28.257882933724645, -28.257882933724645, -33.15525749233383, -33.15525749233383, -33.15525749233383, -29.992800689264747, -29.992800689264747, -29.992800689264747, -39.787825932768435, -39.787825932768435, -39.787825932768435, -34.67978559162301, -34.67978559162301, -34.67978559162301, -25.203549986022317, -26.703549986022324, -26.703549986022324, -29.65148770311266, -31.15148770311266, -31.15148770311266, -33.12449464879533, -33.12449464879533, -31.624494648795338, -45.036584961158546, -45.036584961158546, -44.036584961158546, -27.714584860617535, -27.714584860617535, -27.714584860617535, -32.72983762891157, -32.72983762891157, -32.72983762891157, -32.17451211479894, -32.17451211479894, -32.17451211479894, -33.391259531293414, -33.391259531293414, -33.391259531293414, -29.552167152378345, -29.552167152378345, -29.552167152378345, -38.29942150842325, -38.29942150842325, -38.29942150842325, -39.27935778375362, -39.27935778375362, -39.27935778375362, -28.79030240725375, -28.79030240725375, -28.79030240725375, -29.498299274557713, -31.498299274557713, -31.498299274557713, -30.235938835431313, -30.235938835431313, -29.735938835431313, -31.166501219157418, -31.166501219157418, -31.166501219157418, -27.24864427606047, -26.24864427606047, -27.24864427606047, -26.8437535651484, -26.8437535651484, -24.843753565148393, -38.10373670612193, -36.60373670612193, -38.10373670612193, -28.020521593606954, -28.020521593606954, -28.020521593606954, -32.51090886765291, -33.51090886765291, -33.51090886765291, -40.642694741540545, -40.642694741540545, -40.642694741540545, -39.76364494923779, -39.76364494923779, -38.76364494923779, -26.924377793131498, -26.924377793131498, -25.924377793131498, -27.970938306657267, -27.970938306657267, -27.970938306657267, -33.36249674114042, -33.36249674114042, -33.36249674114042, -31.407027553145483, -31.407027553145483, -31.407027553145483, -31.322948592085677, -31.322948592085677, -31.322948592085677, -35.92918085269561, -35.92918085269561, -35.92918085269561, -28.010666013118144, -27.010666013118144, -26.010666013118144, -32.44212502944836, -33.94212502944836, -33.94212502944836, -34.20219733197106, -34.20219733197106, -34.20219733197106, -27.915817725311623, -27.915817725311623, -27.915817725311623, -25.099756992207638, -25.099756992207638, -25.099756992207638, -30.12627496105349, -30.12627496105349, -30.12627496105349, -34.08609305824971, -34.08609305824971, -34.08609305824971, -48.77147650859704, -49.27147650859704, -49.77147650859704, -22.20230942224362, -22.20230942224362, -21.20230942224362, -31.587956540128907, -32.58795654012891, -32.58795654012891, -35.15583184568739, -35.15583184568739, -35.15583184568739, -40.46227491246507, -40.46227491246507, -40.46227491246507, -30.025671863867704, -29.025671863867704, -30.025671863867704, -29.060622435039292, -29.060622435039292, -29.060622435039292, -29.23090617332721, -29.23090617332721, -29.23090617332721, -24.866670892911333, -24.866670892911333, -23.366670892911333, -41.023021957705716, -41.023021957705716, -41.023021957705716, -29.39566384917955, -29.39566384917955, -29.39566384917955, -30.478333986994347, -27.97833398699434, -30.478333986994347, -26.425247793925013, -26.425247793925013, -26.425247793925013, -36.41454830909396, -38.91454830909396, -38.91454830909396, -22.01378258011569, -22.01378258011569, -20.51378258011569, -29.644251597258293, -29.644251597258293, -29.644251597258293, -29.73678921583915, -29.73678921583915, -29.73678921583915, -40.83570730013262, -40.83570730013262, -40.33570730013262, -36.368240436896656, -37.868240436896656, -37.868240436896656, -31.394110864319924, -31.394110864319924, -31.394110864319924, -29.874982580562598, -29.874982580562598, -29.874982580562598, -25.14286812617748, -29.14286812617748, -29.14286812617748, -30.316015019041835, -29.816015019041835, -29.316015019041835, -41.65807701886624, -41.65807701886624, -41.65807701886624, -31.357811284280686, -31.357811284280686, -30.857811284280682, -37.43294347419384, -37.43294347419384, -37.43294347419384, -24.989008177102896, -22.989008177102896, -22.989008177102896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31363340939326745, "mean_inference_ms": 1.2698096273271968, "mean_action_processing_ms": 0.07001861079570554, "mean_env_wait_ms": 0.5821636146878604, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 134400, "timesteps_this_iter": 0, "agent_timesteps_total": 403200, "timers": {"sample_time_ms": 1547.404, "sample_throughput": 2067.979, "load_time_ms": 0.133, "load_throughput": 24061980.638, "learn_time_ms": 794.151, "learn_throughput": 4029.46, "update_time_ms": 1.503}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 80.1485710144043, "policy_loss": -0.002453362952568572, "vf_loss": 80.1640838623047, "vf_explained_var": -0.021733105182647705, "kl": 0.007251503578565288, "entropy": 1.306011402606964, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 134400, "num_agent_steps_sampled": 403200, "num_steps_trained": 134400, "num_agent_steps_trained": 403200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5370, "training_iteration": 42, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-41", "timestamp": 1718736401, "time_this_iter_s": 1.5412836074829102, "time_total_s": 64.58569049835205, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 64.58569049835205, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 29.73333333333333, "ram_util_percent": 30.333333333333332}}
{"episode_reward_max": -65.99619643826443, "episode_reward_min": -197.99604282337123, "episode_reward_mean": -99.484513392209, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -66.16534760779042}, "policy_reward_max": {"shared_policy": -21.16539881275481}, "policy_reward_mean": {"shared_policy": -33.16150446406966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-123.22318388636508, -73.10350713728754, -71.18013278417233, -120.91765386543412, -107.04154872505732, -111.9408580267154, -75.17844473191977, -93.75648978710515, -81.69487014938674, -137.9085859728631, -115.85420262437826, -96.50843126914471, -90.93498267808594, -82.11803172227995, -130.81094654899513, -87.29931655935125, -100.11584220068349, -106.07877108722812, -96.11101639167765, -127.16634871081594, -65.99619643826443, -82.62428243146722, -84.25118765490976, -87.06569595742943, -72.00183527599341, -133.29969121587192, -91.99284187496383, -111.21971752741723, -90.96315443671838, -79.07506647637253, -125.87157323475881, -106.702198104213, -95.46637363087616, -93.77753125232387, -105.87192528945577, -84.17749987862858, -107.85488331338512, -90.80844302813374, -92.01078101564156, -89.7100925305483, -77.70292400261798, -76.33478251371444, -104.40192780856236, -92.76604105814602, -107.05767719048794, -103.3210644761556, -112.5267740123631, -132.53329330121625, -131.9975768119619, -106.05936138327603, -81.16097515520676, -109.70450606073948, -72.1212798098476, -87.85659241099353, -94.57139007869232, -82.4156094526538, -114.9598579860293, -98.08461423179112, -102.3861692321158, -135.33627166760746, -84.57363276113234, -115.79586668495342, -87.98106211603182, -84.71957624304187, -92.03632880283739, -105.22164533098794, -131.3307118690079, -108.73436738034728, -92.67560494736693, -87.40651093343197, -111.69396140825151, -104.50654951764723, -113.00506011408515, -87.23075755790143, -86.7210780425243, -88.13353450427859, -94.63008926119336, -101.0406098086952, -95.15924323681499, -92.53955780371548, -114.59794223103098, -95.76559337115984, -81.81314338962986, -105.30777967876816, -103.87758403402188, -103.30493748597034, -84.51177519420001, -91.65605592377885, -91.0183223607508, -97.09666351593614, -83.07875908299104, -125.1276720813453, -94.997323126334, -75.02665983722223, -73.24704484700234, -82.85851615478128, -112.61720368351413, -82.87283074486204, -96.51851096098046, -92.09090192412259, -92.30859746593744, -128.95612720729497, -110.84529170272138, -88.24630971702045, -119.58386050109824, -79.9779589262333, -104.64997724751058, -102.14132409236059, -114.56237970047587, -87.08788621349315, -94.59035650483005, -115.76577180177853, -138.51631583002242, -101.59060161369024, -102.59513885534565, -69.1000658410983, -90.59208109910931, -97.1273590857824, -104.31500728908543, -197.99604282337123, -71.61359826134535, -102.6155761915827, -87.33339119944131, -111.94946423664801, -114.15867542023668, -93.62558955372135, -97.45109636324173, -125.93546511886257, -80.71638303900461, -111.53525606167675], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-40.90772796212167, -41.90772796212167, -40.40772796212166, -24.701169045762523, -24.701169045762523, -23.70116904576252, -23.726710928057425, -23.726710928057425, -23.726710928057425, -40.30588462181139, -40.30588462181139, -40.30588462181139, -35.680516241685766, -35.680516241685766, -35.680516241685766, -37.48028600890513, -37.48028600890513, -36.98028600890513, -23.226148243973267, -26.226148243973267, -25.72614824397326, -30.585496595701734, -31.585496595701734, -31.585496595701734, -26.56495671646227, -27.56495671646227, -27.56495671646227, -46.80286199095439, -46.80286199095439, -44.3028619909544, -39.118067541459425, -37.618067541459425, -39.118067541459425, -32.83614375638157, -30.836143756381567, -32.83614375638157, -30.311660892695336, -30.311660892695336, -30.311660892695336, -27.372677240759973, -27.372677240759973, -27.372677240759973, -43.60364884966504, -43.60364884966504, -43.60364884966504, -29.099772186450426, -29.099772186450426, -29.099772186450426, -33.3719474002278, -33.3719474002278, -33.3719474002278, -35.35959036240937, -35.35959036240937, -35.35959036240937, -32.03700546389258, -32.03700546389258, -32.03700546389258, -41.05544957027196, -43.05544957027196, -43.05544957027196, -21.66539881275481, -21.16539881275481, -23.16539881275481, -27.54142747715576, -27.54142747715576, -27.54142747715576, -28.083729218303258, -28.083729218303258, -28.083729218303258, -29.02189865247647, -29.02189865247647, -29.02189865247647, -24.00061175866448, -24.00061175866448, -24.00061175866448, -44.76656373862398, -44.76656373862398, -43.76656373862398, -30.997613958321267, -29.997613958321267, -30.997613958321267, -37.07323917580577, -37.07323917580577, -37.07323917580577, -30.321051478906124, -30.321051478906124, -30.321051478906124, -26.358355492124186, -26.358355492124186, -26.358355492124186, -42.457191078252954, -40.957191078252954, -42.457191078252954, -35.23406603473765, -35.73406603473764, -35.73406603473764, -31.82212454362537, -31.82212454362537, -31.82212454362537, -31.25917708410794, -31.25917708410794, -31.25917708410794, -36.123975096485246, -36.123975096485246, -33.623975096485246, -28.059166626209528, -28.059166626209528, -28.059166626209528, -35.95162777112837, -35.95162777112837, -35.95162777112837, -30.936147676044573, -29.936147676044573, -29.936147676044573, -30.670260338547187, -30.670260338547187, -30.670260338547187, -29.23669751018275, -30.23669751018275, -30.23669751018275, -26.23430800087266, -25.23430800087266, -26.23430800087266, -25.4449275045715, -25.4449275045715, -25.4449275045715, -34.80064260285409, -34.80064260285409, -34.80064260285409, -30.92201368604868, -31.42201368604868, -30.42201368604868, -35.685892396829324, -35.685892396829324, -35.685892396829324, -34.4403548253852, -34.4403548253852, -34.4403548253852, -37.508924670787714, -37.508924670787714, -37.508924670787714, -45.17776443373876, -42.17776443373876, -45.17776443373876, -44.49919227065396, -44.49919227065396, -42.99919227065396, -34.686453794425354, -35.686453794425354, -35.686453794425354, -27.05365838506894, -27.05365838506894, -27.05365838506894, -36.90150202024647, -35.90150202024647, -36.90150202024647, -24.040426603282533, -24.040426603282533, -24.040426603282533, -28.618864136997868, -29.618864136997868, -29.618864136997868, -31.52379669289745, -31.52379669289745, -31.52379669289745, -26.80520315088461, -27.80520315088461, -27.80520315088461, -39.153285995343076, -36.653285995343076, -39.153285995343076, -32.69487141059704, -32.69487141059704, -32.69487141059704, -34.12872307737196, -34.12872307737196, -34.12872307737196, -45.112090555869166, -45.112090555869166, -45.112090555869166, -28.191210920377443, -28.191210920377443, -28.191210920377443, -38.59862222831783, -38.59862222831783, -38.59862222831783, -30.160354038677283, -29.160354038677283, -28.660354038677283, -26.906525414347314, -29.906525414347314, -27.906525414347314, -31.345442934279138, -29.345442934279138, -31.345442934279138, -34.24054844366265, -36.24054844366265, -34.74054844366265, -43.77690395633597, -43.77690395633597, -43.77690395633597, -36.24478912678241, -36.24478912678241, -36.24478912678241, -31.725201649122297, -29.225201649122297, -31.725201649122297, -28.46883697781066, -29.46883697781066, -29.46883697781066, -37.397987136083856, -37.397987136083856, -36.897987136083856, -35.16884983921574, -34.16884983921574, -35.16884983921574, -37.66835337136172, -37.66835337136172, -37.66835337136172, -29.076919185967157, -29.076919185967157, -29.076919185967157, -28.907026014174765, -28.907026014174765, -28.907026014174765, -28.544511501426207, -29.044511501426207, -30.544511501426207, -32.21002975373111, -30.710029753731117, -31.710029753731117, -33.68020326956506, -33.68020326956506, -33.68020326956506, -31.719747745604998, -31.719747745604998, -31.719747745604998, -30.84651926790516, -30.84651926790516, -30.84651926790516, -38.199314077010335, -38.199314077010335, -38.199314077010335, -31.588531123719942, -32.088531123719946, -32.088531123719946, -26.60438112987662, -27.60438112987662, -27.60438112987662, -35.602593226256054, -35.602593226256054, -34.102593226256054, -34.62586134467397, -34.62586134467397, -34.62586134467397, -34.43497916199011, -34.43497916199011, -34.43497916199011, -27.503925064733338, -28.503925064733338, -28.503925064733338, -30.218685307926297, -30.718685307926297, -30.718685307926297, -31.339440786916928, -31.339440786916928, -28.339440786916928, -32.032221171978755, -32.532221171978755, -32.532221171978755, -27.692919694330342, -27.692919694330342, -27.692919694330342, -41.87589069378175, -41.87589069378175, -41.37589069378175, -31.66577437544467, -31.66577437544467, -31.66577437544467, -25.00888661240739, -25.00888661240739, -25.00888661240739, -24.415681615667445, -24.415681615667445, -24.415681615667445, -27.619505384927105, -28.119505384927105, -27.119505384927105, -36.87240122783805, -37.872401227838054, -37.872401227838054, -27.95761024828733, -26.95761024828733, -27.95761024828733, -32.17283698699351, -32.17283698699351, -32.17283698699351, -30.696967308040858, -30.696967308040858, -30.696967308040858, -30.769532488645808, -30.769532488645808, -30.769532488645808, -42.985375735765004, -42.985375735765004, -42.985375735765004, -36.94843056757377, -36.94843056757377, -36.94843056757377, -29.415436572340134, -29.415436572340134, -29.415436572340134, -39.8612868336994, -39.8612868336994, -39.8612868336994, -26.65931964207777, -26.65931964207777, -26.65931964207777, -34.883325749170204, -34.883325749170204, -34.883325749170204, -34.047108030786866, -34.047108030786866, -34.047108030786866, -37.854126566825286, -38.354126566825286, -38.354126566825286, -28.362628737831063, -29.362628737831063, -29.362628737831063, -31.530118834943345, -31.530118834943345, -31.530118834943345, -38.58859060059286, -38.58859060059286, -38.58859060059286, -46.17210527667413, -46.17210527667413, -46.17210527667413, -34.19686720456342, -34.19686720456342, -33.19686720456342, -33.53171295178188, -34.53171295178188, -34.53171295178188, -23.033355280366088, -23.033355280366088, -23.033355280366088, -29.5306936997031, -30.5306936997031, -30.5306936997031, -32.37578636192747, -32.37578636192747, -32.37578636192747, -34.77166909636179, -34.77166909636179, -34.77166909636179, -66.16534760779042, -65.66534760779042, -66.16534760779042, -22.704532753781788, -24.704532753781788, -24.204532753781788, -34.205192063860906, -34.205192063860906, -34.205192063860906, -28.444463733147074, -29.444463733147074, -29.444463733147074, -37.316488078882664, -37.316488078882664, -37.316488078882664, -38.05289180674555, -38.05289180674555, -38.05289180674555, -31.208529851240428, -31.208529851240428, -31.208529851240428, -32.81703212108058, -31.817032121080583, -32.81703212108058, -41.31182170628749, -42.31182170628749, -42.31182170628749, -26.90546101300153, -26.90546101300153, -26.90546101300153, -37.17841868722559, -36.67841868722559, -37.67841868722559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31412212093783776, "mean_inference_ms": 1.2706444660389407, "mean_action_processing_ms": 0.0700477146580853, "mean_env_wait_ms": 0.5826209920513518, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 137600, "timesteps_this_iter": 0, "agent_timesteps_total": 412800, "timers": {"sample_time_ms": 1559.23, "sample_throughput": 2052.295, "load_time_ms": 0.134, "load_throughput": 23954618.597, "learn_time_ms": 794.237, "learn_throughput": 4029.022, "update_time_ms": 1.516}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 84.48201751708984, "policy_loss": -0.0029996168895934927, "vf_loss": 84.4979866027832, "vf_explained_var": -0.025091838836669923, "kl": 0.006063493054402119, "entropy": 1.2968779444694518, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 137600, "num_agent_steps_sampled": 412800, "num_steps_trained": 137600, "num_agent_steps_trained": 412800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5500, "training_iteration": 43, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-42", "timestamp": 1718736402, "time_this_iter_s": 1.5784192085266113, "time_total_s": 66.16410970687866, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 66.16410970687866, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 40.1, "ram_util_percent": 30.4}}
{"episode_reward_max": -63.175135432270636, "episode_reward_min": -142.95359608863993, "episode_reward_mean": -95.52695961016832, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.81786536287996}, "policy_reward_max": {"shared_policy": -21.058378477423556}, "policy_reward_mean": {"shared_policy": -31.84231987005611}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.85159629724187, -102.62097297597796, -112.1970269057785, -82.1098331434565, -107.4055981930834, -94.95430410220375, -94.33379429424684, -78.31847623720111, -84.26554289532841, -90.93654377852432, -106.60608308811038, -82.7930682813848, -92.45437894212822, -92.95496314526696, -92.76670229524095, -116.52873650047965, -92.95057454301133, -94.53322711932458, -81.92490130918202, -99.68277953326718, -63.175135432270636, -123.54220888121503, -75.74265891557457, -98.10143141078143, -73.30353036442077, -89.23739979614786, -114.1497559272222, -108.84203608909354, -113.698524814849, -92.17691164621965, -84.26437738877526, -66.36550212154634, -98.46836592582692, -127.71424340997604, -93.2719130689554, -132.306395111144, -104.93667305381905, -92.10439118214968, -91.53059740491639, -87.49292557279905, -70.244141638191, -93.19053604647914, -89.7211071382667, -77.66228689763935, -106.77307903380569, -84.46448376602365, -100.35246879505857, -94.17594523026209, -75.8122378084875, -93.54175523857197, -108.14282537193591, -97.79549001101411, -96.96685784860226, -98.39980017548085, -79.22416806889846, -88.44642502539844, -82.97862858651855, -92.90063320934357, -82.57205962735883, -83.97752698035815, -83.5966270583262, -96.14469632134113, -79.44269290906487, -79.30128484190845, -100.35643628496842, -107.33375938817268, -86.18675024514154, -110.80222138236587, -94.26246835387066, -90.12017356677494, -102.86412853575355, -90.89017483306718, -107.10753273199536, -89.69289451200474, -79.00250346066393, -106.31242271017842, -91.51124669328968, -88.9313482685245, -99.5721493959376, -86.39269300137632, -124.0455371258849, -142.95359608863993, -120.90948197429766, -90.26571526595461, -89.02714409811827, -84.89974778698733, -91.71120350455803, -93.42053003092916, -85.90117606012835, -104.93793764742914, -88.83994006724312, -96.27528024470396, -84.28962440274938, -81.60508276653188, -87.48216489183059, -82.50954035930822, -108.95299095635478, -98.89280115243848, -104.95147443115117, -95.1345320034829, -102.08421907819665, -97.2260128761816, -91.90292892315135, -105.89580419477439, -125.32349316037367, -72.63775661187756, -73.54056642876003, -86.75795308352086, -117.3024949003811, -111.10953573892729, -100.38001783826294, -96.08197545904453, -122.51143192173156, -93.91690230694098, -110.73413197412312, -121.41907161356318, -96.99794076897004, -75.13298133109284, -125.18324089695537, -85.36679847809128, -112.92237541659466, -71.72562611734246, -76.00001613723752, -107.33201923807313, -88.41021440090499, -86.90631665557318, -129.7829038354877, -75.51926551919648, -138.03771639427603, -85.57679507299075], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-26.6171987657473, -26.6171987657473, -26.6171987657473, -34.37365765865933, -34.37365765865933, -33.87365765865933, -37.39900896859283, -37.39900896859283, -37.39900896859283, -27.369944381152195, -27.369944381152195, -27.369944381152195, -35.80186606436114, -35.80186606436114, -35.80186606436114, -31.65143470073458, -31.65143470073458, -31.65143470073458, -31.44459809808226, -31.44459809808226, -31.44459809808226, -26.1061587457337, -26.1061587457337, -26.1061587457337, -28.421847631776153, -27.421847631776153, -28.421847631776153, -30.64551459284144, -30.64551459284144, -29.64551459284144, -36.368694362703444, -33.868694362703444, -36.368694362703444, -27.597689427128245, -27.597689427128245, -27.597689427128245, -30.8181263140427, -30.8181263140427, -30.8181263140427, -31.151654381755662, -30.651654381755662, -31.151654381755662, -31.088900765080325, -30.588900765080325, -31.088900765080325, -39.176245500159865, -38.176245500159865, -39.176245500159865, -30.31685818100376, -31.31685818100376, -31.31685818100376, -31.844409039774867, -31.844409039774867, -30.844409039774867, -26.64163376972734, -27.64163376972734, -27.64163376972734, -33.22759317775573, -33.22759317775573, -33.22759317775573, -21.058378477423556, -21.058378477423556, -21.058378477423556, -41.34740296040503, -40.84740296040503, -41.34740296040503, -25.247552971858184, -25.247552971858184, -25.247552971858184, -33.03381047026048, -32.03381047026047, -33.03381047026048, -25.601176788140258, -24.101176788140258, -23.601176788140258, -29.412466598715966, -30.412466598715966, -29.412466598715966, -38.049918642407434, -38.049918642407434, -38.049918642407434, -36.28067869636451, -36.28067869636451, -36.28067869636451, -37.89950827161636, -37.89950827161636, -37.89950827161636, -31.558970548739865, -29.058970548739865, -31.558970548739865, -28.088125796258428, -28.088125796258428, -28.088125796258428, -22.121834040515438, -22.121834040515438, -22.121834040515438, -33.15612197527564, -33.15612197527564, -32.15612197527564, -42.23808113665869, -42.73808113665869, -42.73808113665869, -31.0906376896518, -31.0906376896518, -31.0906376896518, -44.26879837038133, -44.26879837038133, -43.76879837038133, -36.14555768460635, -35.14555768460635, -33.64555768460636, -31.201463727383242, -29.701463727383242, -31.201463727383242, -30.51019913497212, -30.51019913497212, -30.51019913497212, -29.997641857599696, -27.497641857599696, -29.997641857599696, -23.41471387939699, -23.41471387939699, -23.41471387939699, -31.063512015493064, -31.063512015493064, -31.063512015493064, -30.240369046088883, -30.240369046088883, -29.240369046088883, -26.720762299213117, -26.720762299213117, -24.220762299213117, -35.591026344601865, -35.591026344601865, -35.591026344601865, -28.154827922007875, -28.154827922007875, -28.154827922007875, -33.45082293168623, -33.45082293168623, -33.45082293168623, -32.558648410087336, -29.058648410087336, -32.558648410087336, -25.2707459361625, -25.2707459361625, -25.2707459361625, -31.18058507952399, -31.18058507952399, -31.18058507952399, -36.71427512397865, -34.71427512397865, -36.71427512397865, -32.93183000367138, -31.931830003671376, -32.93183000367138, -32.32228594953407, -32.32228594953407, -32.32228594953407, -32.799933391826954, -32.799933391826954, -32.799933391826954, -26.40805602296617, -26.40805602296617, -26.40805602296617, -29.98214167513283, -28.48214167513283, -29.98214167513283, -28.492876195506202, -28.492876195506202, -25.992876195506202, -30.966877736447888, -30.966877736447888, -30.966877736447888, -27.857353209119612, -27.857353209119612, -26.857353209119612, -27.992508993452738, -27.992508993452738, -27.992508993452738, -29.198875686108753, -27.698875686108753, -26.698875686108753, -32.04823210711372, -32.04823210711372, -32.04823210711372, -26.480897636354968, -26.480897636354968, -26.480897636354968, -26.433761613969494, -26.433761613969494, -26.433761613969494, -33.452145428322794, -33.452145428322794, -33.452145428322794, -35.77791979605756, -35.77791979605756, -35.77791979605756, -28.895583415047188, -28.395583415047188, -28.895583415047188, -36.934073794121986, -36.934073794121986, -36.934073794121986, -31.420822784623564, -31.420822784623564, -31.420822784623564, -29.873391188924987, -29.873391188924987, -30.373391188924987, -34.454709511917834, -34.454709511917834, -33.954709511917834, -30.296724944355706, -30.296724944355706, -30.296724944355706, -35.70251091066511, -35.70251091066511, -35.70251091066511, -30.564298170668255, -28.564298170668255, -30.564298170668255, -26.33416782022131, -26.33416782022131, -26.33416782022131, -35.437474236726146, -35.437474236726146, -35.437474236726146, -30.503748897763224, -30.503748897763224, -30.503748897763224, -28.977116089508172, -29.977116089508172, -29.977116089508172, -33.190716465312526, -33.190716465312526, -33.190716465312526, -28.464231000458778, -28.964231000458778, -28.964231000458778, -41.34851237529497, -41.34851237529497, -41.34851237529497, -47.81786536287996, -48.81786536287996, -46.31786536287996, -39.63649399143258, -40.63649399143258, -40.63649399143258, -30.088571755318227, -30.088571755318227, -30.088571755318227, -29.675714699372758, -29.675714699372758, -29.675714699372758, -27.299915928995773, -28.799915928995773, -28.799915928995773, -30.737067834852684, -30.237067834852684, -30.737067834852684, -31.140176676976388, -31.140176676976388, -31.140176676976388, -28.300392020042782, -28.800392020042782, -28.800392020042782, -34.97931254914305, -34.97931254914305, -34.97931254914305, -29.6133133557477, -29.6133133557477, -29.6133133557477, -32.091760081568, -32.091760081568, -32.091760081568, -29.763208134249787, -28.763208134249787, -25.763208134249787, -26.86836092217732, -27.36836092217732, -27.36836092217732, -28.494054963943523, -29.494054963943523, -29.494054963943523, -27.503180119769414, -27.503180119769414, -27.503180119769414, -36.31766365211827, -36.31766365211827, -36.31766365211827, -31.96426705081281, -33.46426705081281, -33.46426705081281, -34.98382481038372, -34.98382481038372, -34.98382481038372, -31.711510667827646, -31.711510667827646, -31.711510667827646, -34.028073026065535, -34.028073026065535, -34.028073026065535, -31.742004292060525, -32.74200429206053, -32.74200429206053, -30.800976307717118, -30.300976307717118, -30.800976307717118, -34.29860139825812, -35.79860139825813, -35.79860139825813, -41.94116438679123, -40.94116438679123, -42.44116438679123, -24.379252203959204, -23.879252203959208, -24.379252203959204, -24.180188809586692, -24.68018880958669, -24.68018880958669, -28.919317694506965, -28.919317694506965, -28.919317694506965, -39.100831633460366, -39.100831633460366, -39.100831633460366, -37.036511912975755, -37.036511912975755, -37.036511912975755, -33.46000594608767, -33.46000594608767, -33.46000594608767, -32.527325153014836, -32.527325153014836, -31.02732515301484, -41.00381064057717, -40.50381064057717, -41.00381064057717, -31.30563410231366, -31.30563410231366, -31.30563410231366, -37.24471065804104, -37.24471065804104, -36.24471065804104, -40.47302387118773, -40.47302387118773, -40.47302387118773, -32.66598025632335, -31.665980256323348, -32.66598025632335, -24.710993777030943, -25.210993777030943, -25.210993777030943, -41.72774696565176, -41.72774696565176, -41.72774696565176, -28.455599492697083, -28.455599492697083, -28.455599492697083, -38.30745847219822, -38.30745847219822, -36.30745847219822, -24.075208705780813, -24.075208705780813, -23.575208705780813, -25.500005379079163, -25.000005379079163, -25.500005379079163, -36.610673079357724, -34.110673079357724, -36.610673079357724, -29.470071466968314, -29.470071466968314, -29.470071466968314, -28.96877221852439, -28.96877221852439, -28.96877221852439, -41.92763461182924, -44.42763461182924, -43.42763461182924, -25.339755173065495, -24.839755173065495, -25.339755173065495, -45.679238798092015, -46.179238798092015, -46.179238798092015, -28.69226502433024, -28.69226502433024, -28.19226502433024]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3138746001928521, "mean_inference_ms": 1.269449566958362, "mean_action_processing_ms": 0.06998663691581714, "mean_env_wait_ms": 0.5822046923456218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 140800, "timesteps_this_iter": 0, "agent_timesteps_total": 422400, "timers": {"sample_time_ms": 1551.545, "sample_throughput": 2062.461, "load_time_ms": 0.133, "load_throughput": 24027520.229, "learn_time_ms": 790.156, "learn_throughput": 4049.832, "update_time_ms": 1.522}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 73.84164199829101, "policy_loss": -0.003251633751516536, "vf_loss": 73.85764923095704, "vf_explained_var": -0.022253525257110596, "kl": 0.007348918097002768, "entropy": 1.27514328956604, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140800, "num_agent_steps_sampled": 422400, "num_steps_trained": 140800, "num_agent_steps_trained": 422400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5630, "training_iteration": 44, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-44", "timestamp": 1718736404, "time_this_iter_s": 1.502213954925537, "time_total_s": 67.6663236618042, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 67.6663236618042, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 39.55, "ram_util_percent": 30.4}}
{"episode_reward_max": -62.968501915518104, "episode_reward_min": -142.6214052788118, "episode_reward_mean": -96.69814153381675, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -47.54046842627059}, "policy_reward_max": {"shared_policy": -20.322833971839376}, "policy_reward_mean": {"shared_policy": -32.232713844605584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.69582389682219, -68.07106122805884, -124.06051719240234, -73.71010049526751, -109.01385260327328, -115.57048927966201, -105.03119834849045, -101.9855083218838, -100.92509019139152, -84.0682143483262, -79.06560864047867, -90.43437489856407, -106.24963069460809, -92.7875431774364, -92.02076206902593, -99.10788611137716, -114.74899956748179, -97.63607960712334, -102.56869025977194, -100.09854895804752, -79.19106135713574, -108.03867840730072, -90.35486225356148, -83.55983616113568, -84.02878742453026, -86.59623314068244, -83.7234807243402, -102.5500299681807, -97.08556943024607, -100.08066945606303, -102.86147460003407, -100.6790775789545, -104.37276046515197, -62.968501915518104, -124.4781505431114, -80.56208344280103, -104.8383412317473, -96.8168111518023, -118.01778559861533, -84.70823736589993, -100.31596694922096, -97.10839445582802, -102.39130261241702, -110.71133516234903, -78.61938359017716, -89.48009335249219, -115.95291875068276, -90.89094210061708, -107.52401791496108, -70.21105230958247, -94.47096739035857, -91.86043946838397, -83.24125786050355, -97.62198217975823, -95.56099895333742, -90.65711248813672, -89.45576388840205, -99.90366836970746, -88.61922896655656, -109.55305900969473, -79.27251743020373, -91.69528854888289, -90.31254174593094, -97.65796298050608, -80.2721966586226, -106.79236619320143, -87.44933387325159, -95.90465956963249, -93.27830621267312, -71.15986911215168, -84.93134386769565, -122.23549122311115, -91.2469209417317, -108.26719019522423, -115.95930017066287, -104.03023174443068, -72.30989880497671, -99.77250485583487, -91.80443214581486, -89.0316207438769, -92.69551979995668, -90.2423947941129, -91.42973153077929, -142.6214052788118, -102.81567990600527, -107.58072536870327, -81.4398347030009, -71.400357665617, -128.26634052534394, -122.18612234423505, -109.76881901553122, -66.75758483845162, -77.70275077755888, -101.71635324140657, -126.8895966048734, -98.30014604260316, -101.7400138036199, -85.29508350397887, -80.48643395084487, -84.23076016217792, -110.30990043577125, -74.67448212328331, -80.458164257627, -95.93729542954904, -128.3045005122317, -116.5451010804217, -87.2723647289352, -102.18401261990837, -101.7183996705883, -111.93846262805661, -109.25167892935063, -87.53035682512417, -83.0360309991319, -103.68082362844511, -90.19807080540218, -78.81943193118664, -99.71646084873295, -92.94088288050936, -115.23819372483143, -91.92467770328813, -92.79432890721272, -95.22345249545069, -91.64703343479998, -94.96389658189203, -114.69762160311177, -118.03128013195024, -112.0006942881473, -95.21967793870444, -109.32467793759659, -86.7145155594363], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-35.06527463227406, -34.56527463227406, -35.06527463227406, -22.357020409352966, -22.857020409352966, -22.857020409352966, -41.520172397467434, -41.020172397467434, -41.520172397467434, -24.5700334984225, -24.5700334984225, -24.5700334984225, -34.33795086775773, -37.33795086775774, -37.33795086775774, -38.690163093220654, -38.690163093220654, -38.190163093220654, -35.010399449496795, -35.010399449496795, -35.010399449496795, -34.328502773961254, -34.328502773961254, -33.328502773961254, -33.80836339713052, -33.80836339713052, -33.30836339713052, -26.689404782775398, -28.189404782775398, -29.189404782775398, -26.35520288015957, -26.35520288015957, -26.35520288015957, -29.47812496618804, -30.47812496618804, -30.47812496618804, -35.41654356486934, -35.41654356486934, -35.41654356486934, -30.929181059145453, -30.929181059145453, -30.929181059145453, -31.34025402300865, -31.34025402300865, -29.34025402300865, -35.20262870379239, -32.20262870379239, -31.702628703792396, -38.24966652249391, -38.24966652249391, -38.24966652249391, -32.54535986904112, -32.54535986904112, -32.54535986904112, -34.356230086590635, -34.356230086590635, -33.856230086590635, -32.699516319349165, -33.699516319349165, -33.699516319349165, -26.397020452378577, -26.397020452378577, -26.397020452378577, -36.01289280243353, -36.01289280243353, -36.01289280243353, -30.118287417853814, -30.118287417853814, -30.118287417853814, -27.85327872037858, -27.85327872037858, -27.85327872037858, -28.342929141510112, -27.342929141510115, -28.342929141510112, -29.365411046894142, -29.365411046894142, -27.865411046894142, -27.907826908113407, -27.907826908113407, -27.907826908113407, -34.51667665606026, -33.51667665606026, -34.51667665606026, -31.861856476748695, -33.3618564767487, -31.861856476748695, -33.36022315202102, -33.36022315202102, -33.36022315202102, -34.28715820001135, -34.28715820001135, -34.28715820001135, -33.559692526318166, -33.559692526318166, -33.559692526318166, -35.12425348838398, -35.12425348838398, -34.124253488383985, -21.322833971839376, -20.322833971839376, -21.322833971839376, -42.32605018103715, -39.82605018103715, -42.32605018103715, -26.854027814267003, -26.854027814267003, -26.854027814267003, -33.779447077249095, -35.27944707724909, -35.77944707724909, -32.43893705060075, -32.43893705060075, -31.93893705060075, -39.33926186620515, -39.33926186620515, -39.33926186620515, -27.90274578863331, -28.40274578863331, -28.40274578863331, -33.77198898307364, -32.77198898307365, -33.77198898307364, -32.369464818609345, -32.369464818609345, -32.369464818609345, -34.29710087080569, -34.29710087080569, -33.79710087080569, -36.90377838744968, -36.90377838744968, -36.90377838744968, -26.20646119672573, -26.20646119672573, -26.20646119672573, -29.82669778416408, -29.82669778416408, -29.82669778416408, -38.650972916894226, -38.650972916894226, -38.650972916894226, -30.29698070020569, -30.29698070020569, -30.29698070020569, -36.008005971653674, -35.008005971653674, -36.508005971653674, -24.070350769860823, -22.570350769860823, -23.570350769860823, -31.490322463452877, -31.490322463452877, -31.490322463452877, -30.28681315612797, -30.78681315612797, -30.78681315612797, -27.580419286834513, -27.580419286834513, -28.080419286834513, -29.873994059919408, -33.873994059919404, -33.873994059919404, -32.52033298444579, -32.52033298444579, -30.52033298444579, -29.219037496045566, -30.719037496045566, -30.719037496045566, -29.81858796280066, -29.81858796280066, -29.81858796280066, -33.80122278990252, -33.80122278990252, -32.30122278990251, -29.539742988852204, -29.539742988852204, -29.539742988852204, -36.51768633656491, -36.51768633656491, -36.51768633656491, -26.42417247673458, -26.42417247673458, -26.42417247673458, -30.56509618296096, -30.56509618296096, -30.56509618296096, -30.437513915310337, -30.437513915310337, -29.437513915310337, -32.88598766016868, -31.88598766016868, -32.88598766016868, -26.090732219540854, -27.090732219540854, -27.090732219540854, -35.59745539773381, -35.59745539773381, -35.59745539773381, -29.149777957750494, -29.149777957750494, -29.149777957750494, -31.96821985654415, -31.96821985654415, -31.96821985654415, -31.09276873755772, -31.09276873755772, -31.09276873755772, -24.05328970405054, -23.05328970405054, -24.05328970405054, -28.810447955898546, -27.310447955898546, -28.810447955898546, -40.41183040770375, -40.91183040770375, -40.91183040770375, -30.915640313910586, -29.415640313910586, -30.915640313910586, -36.0890633984081, -36.0890633984081, -36.0890633984081, -38.65310005688762, -38.65310005688762, -38.65310005688762, -33.34341058147689, -35.34341058147689, -35.34341058147689, -24.103299601658897, -24.103299601658897, -24.103299601658897, -33.59083495194495, -32.59083495194495, -33.59083495194495, -30.60147738193828, -30.60147738193828, -30.60147738193828, -29.677206914625607, -29.677206914625607, -29.677206914625607, -30.898506599985563, -30.898506599985563, -30.898506599985563, -30.08079826470429, -30.08079826470429, -30.08079826470429, -30.476577176926416, -30.476577176926416, -30.476577176926416, -47.54046842627059, -47.54046842627059, -47.54046842627059, -33.6052266353351, -34.6052266353351, -34.6052266353351, -35.86024178956776, -35.86024178956776, -35.86024178956776, -27.146611567666977, -27.146611567666977, -27.146611567666977, -23.800119221872347, -23.800119221872347, -23.800119221872347, -43.92211350844794, -43.92211350844794, -40.42211350844796, -40.72870744807834, -40.72870744807834, -40.72870744807834, -37.089606338510386, -35.589606338510386, -37.089606338510386, -22.25252827948387, -22.25252827948387, -22.25252827948387, -25.900916925852957, -25.900916925852957, -25.900916925852957, -32.23878441380219, -34.7387844138022, -34.7387844138022, -42.29653220162447, -42.29653220162447, -42.29653220162447, -32.766715347534394, -32.766715347534394, -32.766715347534394, -33.91333793453997, -33.91333793453997, -33.91333793453997, -28.598361167992966, -28.598361167992966, -28.098361167992966, -26.828811316948293, -26.828811316948293, -26.828811316948293, -28.243586720725965, -27.743586720725965, -28.243586720725965, -37.43663347859041, -37.43663347859041, -35.43663347859041, -25.39149404109445, -25.39149404109445, -23.891494041094447, -26.819388085875676, -26.819388085875676, -26.819388085875676, -31.979098476516356, -31.979098476516356, -31.979098476516356, -42.76816683741057, -42.76816683741057, -42.76816683741057, -39.181700360140574, -39.181700360140574, -38.181700360140574, -29.09078824297839, -29.09078824297839, -29.09078824297839, -34.06133753996944, -34.06133753996944, -34.06133753996944, -34.07279989019605, -34.07279989019605, -33.57279989019605, -37.31282087601887, -37.31282087601887, -37.31282087601887, -36.41722630978352, -36.41722630978352, -36.41722630978352, -29.176785608374704, -29.176785608374704, -29.176785608374704, -27.678676999710632, -27.678676999710632, -27.678676999710632, -34.56027454281504, -34.56027454281504, -34.56027454281504, -30.066023601800726, -30.066023601800726, -30.066023601800726, -26.273143977062226, -26.273143977062226, -26.273143977062226, -33.5721536162443, -32.57215361624431, -33.5721536162443, -30.980294293503114, -30.980294293503114, -30.980294293503114, -38.246064574943794, -38.246064574943794, -38.746064574943794, -29.64155923442938, -31.14155923442938, -31.14155923442938, -30.93144296907093, -30.93144296907093, -30.93144296907093, -31.74115083181688, -31.74115083181688, -31.74115083181688, -29.88234447826667, -30.88234447826667, -30.88234447826667, -31.821298860630687, -31.821298860630687, -31.321298860630687, -38.73254053437059, -38.73254053437059, -37.2325405343706, -39.34376004398344, -39.34376004398344, -39.34376004398344, -36.6668980960491, -37.66689809604911, -37.66689809604911, -30.406559312901475, -32.40655931290148, -32.40655931290148, -36.77489264586553, -36.77489264586553, -35.77489264586553, -29.404838519812103, -27.904838519812103, -29.404838519812103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3137429582849989, "mean_inference_ms": 1.269121360765564, "mean_action_processing_ms": 0.06997920880590194, "mean_env_wait_ms": 0.5820605053056338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 1536.341, "sample_throughput": 2082.871, "load_time_ms": 0.136, "load_throughput": 23534583.202, "learn_time_ms": 791.246, "learn_throughput": 4044.256, "update_time_ms": 1.512}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 72.22657089233398, "policy_loss": -0.002775606555359733, "vf_loss": 72.24227523803711, "vf_explained_var": 0.01996469497680664, "kl": 0.005273780215977779, "entropy": 1.2929605722427369, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 432000, "num_steps_trained": 144000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5760, "training_iteration": 45, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-45", "timestamp": 1718736405, "time_this_iter_s": 1.5039935111999512, "time_total_s": 69.17031717300415, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 69.17031717300415, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 38.95, "ram_util_percent": 30.45}}
{"episode_reward_max": -62.759247588109275, "episode_reward_min": -149.46745684684862, "episode_reward_mean": -98.18728203487821, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -49.98915228228288}, "policy_reward_max": {"shared_policy": -20.919749196036435}, "policy_reward_mean": {"shared_policy": -32.72909401162607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.24596702280746, -100.16653132844093, -104.60288491473361, -99.39247234376748, -98.61803932215012, -112.77876778966358, -70.53937764693539, -79.35165245413555, -92.09825775772018, -83.2613190642029, -103.1396832067612, -110.16016866303872, -84.6379869592583, -98.19935616153171, -93.92569250933403, -97.96699178159709, -104.01578020825599, -88.78470666050849, -111.20536564567536, -106.10612566800592, -64.64566927682581, -70.60663214674094, -93.10418607320662, -70.20101421099874, -101.61727669455966, -108.76830601304977, -94.85134858453544, -94.61668775067594, -73.63033653107615, -86.05019532967748, -82.04818132660156, -87.3401701827692, -118.24942777280167, -88.44244598779326, -130.50633205763012, -138.10524454155066, -95.1283036061035, -149.46745684684862, -96.73981125297189, -87.32959519187182, -100.64210705051026, -98.74973172026786, -83.08908382966641, -97.55398096579921, -97.33089415983451, -84.3732081597212, -89.87380231952312, -96.66191527222176, -74.38792549790672, -110.53678147940506, -116.03670995656267, -115.01756702081205, -88.73830219814279, -108.55801150173397, -132.2470620848758, -98.95546681990038, -100.10149502995623, -72.90645698118048, -104.16527192946687, -117.01504577993101, -96.21256205256756, -95.49045367253441, -110.50390310117896, -102.06870635783655, -130.09981881714754, -109.07542501733536, -78.22940714038343, -106.71964350833912, -89.33047274186308, -103.24407546189519, -99.71405748487469, -93.52682589669156, -95.56013961724976, -94.91383467686283, -81.45354747519177, -82.5138448724005, -141.04505426043153, -86.15112991779534, -122.42494079610117, -98.34716067254945, -96.10869559934349, -100.81414210233143, -113.02378991251098, -69.64142906952681, -80.96954074019338, -84.01598343983238, -97.13381209050137, -91.76563189969991, -91.40264998500584, -123.84879507797788, -111.78231606912408, -88.39444595670959, -111.06941986871337, -104.18756908693112, -120.1199769398973, -142.95746231811765, -115.45440486478616, -62.759247588109275, -115.32915229773596, -84.92025975327196, -90.36334672624105, -90.63311417711492, -91.75391406222212, -84.6329173870145, -117.31323817286359, -66.44254156298227, -88.55565642053375, -93.13543235234035, -97.57959209199704, -86.9747370442044, -95.74212951150758, -113.56037521888443, -121.27352698606806, -70.7878550561466, -105.47248440869637, -109.85757312822624, -91.6286922956477, -94.47426803223551, -97.29046955477125, -88.09168354990588], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-36.08198900760247, -35.08198900760247, -36.08198900760247, -32.388843776147, -33.888843776147, -33.888843776147, -34.8676283049112, -34.8676283049112, -34.8676283049112, -33.46415744792248, -33.46415744792248, -32.46415744792248, -32.20601310738337, -33.20601310738337, -33.20601310738337, -36.92625592988786, -37.92625592988786, -37.92625592988786, -23.5131258823118, -24.0131258823118, -23.0131258823118, -24.783884151378516, -27.283884151378516, -27.283884151378516, -31.366085919240064, -29.366085919240057, -31.366085919240064, -27.753773021400967, -27.753773021400967, -27.753773021400967, -34.379894402253726, -34.379894402253726, -34.379894402253726, -36.38672288767958, -36.38672288767958, -37.38672288767958, -28.212662319752752, -28.212662319752752, -28.212662319752752, -32.733118720510575, -32.733118720510575, -32.733118720510575, -31.308564169778016, -31.308564169778016, -31.308564169778016, -32.655663927199036, -32.655663927199036, -32.655663927199036, -31.67192673608534, -36.17192673608535, -36.17192673608535, -29.594902220169516, -29.594902220169516, -29.594902220169516, -37.068455215225114, -37.068455215225114, -37.068455215225114, -34.36870855600197, -35.86870855600198, -35.86870855600198, -21.548556425608606, -21.548556425608606, -21.548556425608606, -23.702210715580318, -23.702210715580318, -23.202210715580318, -31.368062024402217, -31.368062024402217, -30.368062024402217, -23.067004736999593, -23.567004736999593, -23.567004736999593, -33.87242556485321, -33.87242556485321, -33.87242556485321, -36.25610200434993, -36.25610200434993, -36.25610200434993, -31.617116194845135, -31.617116194845135, -31.617116194845135, -31.538895916891992, -31.538895916891992, -31.538895916891992, -24.543445510358726, -24.543445510358726, -24.543445510358726, -28.850065109892498, -28.350065109892498, -28.850065109892498, -27.349393775533844, -27.349393775533844, -27.349393775533844, -29.28005672758974, -29.28005672758974, -28.78005672758974, -39.416475924267225, -39.416475924267225, -39.416475924267225, -29.48081532926441, -29.48081532926441, -29.48081532926441, -43.50211068587671, -43.50211068587671, -43.50211068587671, -46.03508151385025, -46.03508151385025, -46.03508151385025, -31.709434535367823, -31.709434535367823, -31.709434535367823, -49.489152282282866, -49.98915228228288, -49.98915228228288, -32.24660375099065, -32.24660375099065, -32.24660375099065, -28.77653173062395, -28.77653173062395, -29.77653173062395, -33.7140356835034, -33.7140356835034, -33.2140356835034, -32.9165772400893, -32.9165772400893, -32.9165772400893, -27.69636127655548, -27.69636127655548, -27.69636127655548, -32.51799365526639, -32.51799365526639, -32.51799365526639, -32.44363138661149, -32.44363138661149, -32.44363138661149, -28.457736053240392, -28.457736053240392, -27.457736053240392, -29.9579341065077, -29.9579341065077, -29.9579341065077, -31.55397175740724, -32.55397175740724, -32.55397175740724, -25.962641832635597, -22.962641832635594, -25.462641832635597, -36.17892715980168, -37.17892715980168, -37.17892715980168, -39.01223665218755, -39.01223665218755, -38.01223665218755, -38.33918900693737, -38.33918900693737, -38.33918900693737, -30.246100732714257, -29.746100732714257, -28.746100732714257, -36.18600383391133, -36.18600383391133, -36.18600383391133, -44.082354028291945, -44.082354028291945, -44.082354028291945, -32.985155606633455, -32.985155606633455, -32.985155606633455, -33.3671650099854, -33.3671650099854, -33.3671650099854, -25.135485660393527, -22.635485660393524, -25.135485660393527, -34.388423976488944, -34.888423976488944, -34.888423976488944, -39.00501525997699, -39.00501525997699, -39.00501525997699, -32.07085401752254, -32.07085401752254, -32.07085401752254, -31.830151224178124, -31.830151224178124, -31.830151224178124, -37.167967700392985, -36.16796770039298, -37.167967700392985, -34.18956878594553, -34.18956878594553, -33.68956878594553, -43.866606272382526, -42.366606272382526, -43.866606272382526, -36.35847500577845, -36.35847500577845, -36.35847500577845, -26.076469046794475, -26.076469046794475, -26.076469046794475, -35.573214502779706, -35.573214502779706, -35.573214502779706, -29.776824247287696, -29.776824247287696, -29.776824247287696, -34.41469182063174, -34.41469182063174, -34.41469182063174, -33.738019161624905, -33.738019161624905, -32.238019161624905, -31.675608632230528, -31.675608632230528, -30.175608632230528, -30.85337987241659, -32.35337987241659, -32.35337987241659, -31.63794489228765, -31.63794489228765, -31.63794489228765, -27.15118249173063, -27.15118249173063, -27.15118249173063, -28.171281624133496, -27.671281624133496, -26.671281624133492, -47.0150180868105, -47.0150180868105, -47.0150180868105, -28.717043305931778, -28.717043305931778, -28.717043305931778, -40.80831359870037, -40.80831359870037, -40.80831359870037, -33.782386890849814, -33.282386890849814, -31.282386890849814, -32.036231866447835, -32.036231866447835, -32.036231866447835, -33.60471403411045, -33.60471403411045, -33.60471403411045, -38.34126330417035, -38.34126330417035, -36.34126330417035, -23.21380968984228, -23.21380968984228, -23.21380968984228, -26.989846913397784, -26.989846913397784, -26.989846913397784, -28.33866114661079, -28.33866114661079, -27.33866114661079, -32.711270696833765, -32.711270696833765, -31.71127069683377, -30.255210633233315, -30.755210633233315, -30.755210633233315, -30.467549995001963, -30.467549995001963, -30.467549995001963, -41.28293169265929, -41.28293169265929, -41.28293169265929, -37.42743868970801, -37.42743868970801, -36.92743868970801, -29.464815318903234, -29.464815318903234, -29.464815318903234, -38.18980662290448, -36.68980662290448, -36.18980662290448, -34.895856362310376, -34.395856362310376, -34.895856362310376, -41.37332564663244, -37.37332564663244, -41.37332564663244, -47.65248743937253, -47.65248743937253, -47.65248743937253, -38.9848016215954, -38.9848016215954, -37.4848016215954, -20.919749196036435, -20.919749196036435, -20.919749196036435, -38.7763840992453, -38.7763840992453, -37.7763840992453, -27.97341991775731, -27.97341991775731, -28.97341991775731, -30.454448908747032, -29.454448908747032, -30.454448908747032, -30.211038059038323, -30.211038059038323, -30.211038059038323, -30.584638020740705, -30.584638020740705, -30.584638020740705, -28.377639129004827, -27.877639129004827, -28.377639129004827, -39.10441272428788, -39.10441272428788, -39.10441272428788, -21.980847187660768, -23.480847187660764, -20.980847187660768, -29.518552140177924, -29.518552140177924, -29.518552140177924, -31.045144117446792, -31.045144117446792, -31.045144117446792, -32.52653069733234, -32.52653069733234, -32.52653069733234, -29.324912348068136, -29.324912348068136, -28.324912348068136, -32.580709837169195, -32.580709837169195, -30.58070983716919, -37.853458406294806, -37.853458406294806, -37.853458406294806, -40.091175662022685, -40.591175662022685, -40.591175662022685, -22.929285018715532, -23.929285018715532, -23.929285018715532, -35.1574948028988, -35.1574948028988, -35.1574948028988, -34.61919104274203, -37.61919104274204, -37.61919104274204, -30.876230765215887, -29.876230765215887, -30.876230765215887, -31.658089344078526, -31.158089344078526, -31.658089344078526, -32.43015651825709, -32.43015651825709, -32.43015651825709, -29.03056118330198, -29.03056118330198, -30.03056118330198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3135225499310366, "mean_inference_ms": 1.2687420798063878, "mean_action_processing_ms": 0.06995557580707788, "mean_env_wait_ms": 0.5818383086837914, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 147200, "timesteps_this_iter": 0, "agent_timesteps_total": 441600, "timers": {"sample_time_ms": 1544.352, "sample_throughput": 2072.066, "load_time_ms": 0.136, "load_throughput": 23575922.712, "learn_time_ms": 797.224, "learn_throughput": 4013.927, "update_time_ms": 1.514}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 82.96634826660156, "policy_loss": -0.003271709390935307, "vf_loss": 82.98254165649413, "vf_explained_var": 0.0003442227840423584, "kl": 0.005920076563332299, "entropy": 1.292673683166504, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 147200, "num_agent_steps_sampled": 441600, "num_steps_trained": 147200, "num_agent_steps_trained": 441600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5880, "training_iteration": 46, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-47", "timestamp": 1718736407, "time_this_iter_s": 1.5492093563079834, "time_total_s": 70.71952652931213, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219bb80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 70.71952652931213, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.5, "ram_util_percent": 30.45}}
{"episode_reward_max": -66.91989943345506, "episode_reward_min": -146.86325912581327, "episode_reward_mean": -96.65574924279417, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -50.287753041937755}, "policy_reward_max": {"shared_policy": -22.284218359415064}, "policy_reward_mean": {"shared_policy": -32.218583080931396}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.43529080524655, -88.84377558637782, -105.51090348754441, -100.36724906994135, -92.30887867038632, -109.10027811479333, -95.43492883959723, -93.90858537576547, -82.62104419368974, -79.34093223460506, -96.0031767949015, -93.67742596853977, -96.90684515713413, -78.71129366723659, -95.57274770914066, -107.93927764677156, -99.06242155486683, -88.08198043914862, -91.95200083217419, -83.71841763835623, -74.17244385039238, -71.63777332573447, -76.3770169607053, -100.93946006067308, -97.85735244025007, -88.36085105846405, -103.807236929303, -84.1727419823636, -92.1225036538452, -108.1416659829633, -111.87931905683493, -109.77612047459903, -96.02289721848707, -89.84760438672964, -66.91989943345506, -95.27370482364948, -86.91337969868509, -84.46608090696371, -85.02566761327793, -70.85265507824519, -87.68880172714574, -113.91067914443167, -102.30750412470412, -119.81367857189969, -90.71531207316372, -120.41946357810102, -96.09370903878278, -90.76248392975843, -87.5992907666927, -97.95503878767154, -108.70036958612047, -116.22950565470163, -111.88506525635553, -104.55388330345933, -108.66166332971102, -89.75842296323711, -77.94081688619323, -97.79897679171854, -82.87452927058938, -82.81240900825334, -127.84925530338971, -88.34659874057637, -80.9672667240276, -96.10235631237126, -146.86325912581327, -97.55357545969828, -92.81475398919767, -127.07183903892346, -117.2250602751177, -92.17446142613571, -74.77121859798265, -106.82765628580162, -92.01589216625534, -93.36063983977924, -94.33448029985776, -83.16813467261784, -94.71690351204154, -89.52364221282927, -87.18913512828921, -88.48650624140419, -104.37108875240142, -88.11965405303846, -108.33360684136895, -94.30297170883463, -101.71699911965985, -101.01990525323133, -114.29486284317504, -93.23374303565215, -102.7133898924836, -92.36391238695778, -86.91010812831567, -90.45450378530397, -94.40222574132576, -92.07866516700052, -106.96532075486009, -94.77448910057352, -108.03194013991471, -79.83106034892675, -88.63435715919965, -95.5705242589855, -102.44956196577499, -88.88181439593707, -88.31577742746053, -110.09711060013703, -94.80169029533502, -99.96505785437022, -130.917465780763, -88.27531591070046, -92.81896766593262, -104.57781777489504, -91.85725507040955, -97.5863638588644, -102.97683547940066, -92.92001422962782, -122.98345977238148, -89.94217456734208, -121.72314015418415, -87.26855570166128, -114.22126339307488, -99.00573511846359, -109.80181697873633, -85.75200727770878, -84.54654203523157, -111.03937782585535, -85.07459184549235, -99.37657345586757, -100.24093048464239, -137.09758102226357, -82.92534924395088, -89.77585803892994], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-28.811763601748837, -28.811763601748837, -28.811763601748837, -29.614591862125938, -30.114591862125938, -29.114591862125938, -35.170301162514775, -35.170301162514775, -35.170301162514775, -33.455749689980436, -33.455749689980436, -33.455749689980436, -30.769626223462126, -30.769626223462126, -30.769626223462126, -36.700092704931116, -35.700092704931116, -36.700092704931116, -29.8116429465324, -32.81164294653241, -32.81164294653241, -31.302861791921817, -31.302861791921817, -31.302861791921817, -27.040348064563236, -28.040348064563236, -27.540348064563236, -26.44697741153503, -26.44697741153503, -26.44697741153503, -32.00105893163386, -32.00105893163386, -32.00105893163386, -31.225808656179908, -31.225808656179908, -31.225808656179908, -31.96894838571137, -32.46894838571137, -32.46894838571137, -26.237097889078875, -26.237097889078875, -26.237097889078875, -30.524249236380207, -32.52424923638021, -32.52424923638021, -35.97975921559051, -35.97975921559051, -35.97975921559051, -33.18747385162232, -33.18747385162232, -32.68747385162232, -29.027326813049537, -29.527326813049537, -29.527326813049537, -30.65066694405808, -30.65066694405808, -30.65066694405808, -27.57280587945206, -28.07280587945206, -28.07280587945206, -24.724147950130785, -24.724147950130785, -24.724147950130785, -24.212591108578156, -23.212591108578156, -24.212591108578156, -25.459005653568454, -25.459005653568454, -25.459005653568454, -33.64648668689103, -33.64648668689103, -33.64648668689103, -32.619117480083375, -32.619117480083375, -32.619117480083375, -28.453617019488025, -29.953617019488025, -29.953617019488025, -34.60241230976768, -34.60241230976768, -34.60241230976768, -28.557580660787867, -28.557580660787867, -27.057580660787867, -31.040834551281748, -31.040834551281748, -30.040834551281748, -36.04722199432109, -36.04722199432109, -36.04722199432109, -36.62643968561166, -37.62643968561166, -37.62643968561166, -36.59204015819968, -36.59204015819968, -36.59204015819968, -31.34096573949568, -32.34096573949567, -32.34096573949567, -30.115868128909884, -29.615868128909884, -30.115868128909884, -22.30663314448502, -22.30663314448502, -22.30663314448502, -31.924568274549816, -31.924568274549816, -31.424568274549816, -27.637793232895046, -29.637793232895046, -29.637793232895046, -28.15536030232123, -28.15536030232123, -28.15536030232123, -28.50855587109264, -28.50855587109264, -28.00855587109264, -24.284218359415064, -22.284218359415064, -24.284218359415064, -29.229600575715246, -29.229600575715246, -29.229600575715246, -37.970226381477225, -37.970226381477225, -37.970226381477225, -35.43583470823469, -33.435834708234694, -33.435834708234694, -39.937892857299886, -39.937892857299886, -39.937892857299886, -30.738437357721242, -29.238437357721242, -30.738437357721242, -40.13982119270035, -40.13982119270035, -40.13982119270035, -31.697903012927622, -31.697903012927622, -32.697903012927625, -30.420827976586146, -29.920827976586146, -30.420827976586146, -29.19976358889756, -29.19976358889756, -29.19976358889756, -32.98501292922385, -32.98501292922385, -31.98501292922385, -36.40012319537349, -36.40012319537349, -35.90012319537349, -38.90983521823389, -38.40983521823389, -38.90983521823389, -37.29502175211852, -37.29502175211852, -37.29502175211852, -34.18462776781979, -35.18462776781979, -35.18462776781979, -34.88722110990366, -36.88722110990366, -36.88722110990366, -30.08614098774572, -29.58614098774572, -30.08614098774572, -26.480272295397732, -24.98027229539774, -26.480272295397732, -32.76632559723953, -32.76632559723953, -32.26632559723953, -27.79150975686313, -27.29150975686313, -27.79150975686313, -27.604136336084448, -27.604136336084448, -27.604136336084448, -42.61641843446325, -42.61641843446325, -42.61641843446325, -29.4488662468588, -29.9488662468588, -28.9488662468588, -27.322422241342544, -26.322422241342544, -27.322422241342544, -32.36745210412377, -32.36745210412377, -31.36745210412377, -47.787753041937755, -50.287753041937755, -48.787753041937755, -32.18452515323275, -32.68452515323275, -32.68452515323275, -29.938251329732548, -31.43825132973255, -31.43825132973255, -42.357279679641174, -42.357279679641174, -42.357279679641174, -39.0750200917059, -39.0750200917059, -39.0750200917059, -31.224820475378586, -30.724820475378586, -30.224820475378586, -25.42373953266088, -24.42373953266088, -24.92373953266088, -35.60921876193387, -35.60921876193387, -35.60921876193387, -29.671964055418453, -31.171964055418453, -31.171964055418453, -30.45354661325975, -31.45354661325975, -31.45354661325975, -31.111493433285926, -31.611493433285926, -31.611493433285926, -27.889378224205952, -27.389378224205952, -27.889378224205952, -31.572301170680515, -31.572301170680515, -31.572301170680515, -30.174547404276428, -29.174547404276428, -30.174547404276428, -29.22971170942974, -29.72971170942974, -28.229711709429743, -29.495502080468047, -29.495502080468047, -29.495502080468047, -35.45702958413382, -33.45702958413382, -35.45702958413382, -29.373218017679488, -29.373218017679488, -29.373218017679488, -36.777868947122975, -36.277868947122975, -35.277868947122975, -31.43432390294487, -31.43432390294487, -31.43432390294487, -32.572333039886615, -34.572333039886615, -34.572333039886615, -34.17330175107711, -32.67330175107711, -34.17330175107711, -38.098287614391666, -38.098287614391666, -38.098287614391666, -31.077914345217387, -31.077914345217387, -31.077914345217387, -34.90446329749454, -33.90446329749454, -33.90446329749454, -30.787970795652598, -30.787970795652598, -30.787970795652598, -28.97003604277188, -28.97003604277188, -28.97003604277188, -29.81816792843464, -30.31816792843464, -30.31816792843464, -31.134075247108598, -31.634075247108598, -31.634075247108598, -30.69288838900018, -30.69288838900018, -30.69288838900018, -35.98844025162005, -34.98844025162005, -35.98844025162005, -32.091496366857825, -31.59149636685782, -31.09149636685782, -36.34398004663822, -36.34398004663822, -35.34398004663823, -26.610353449642243, -26.610353449642243, -26.610353449642243, -30.21145238639989, -30.21145238639989, -28.21145238639989, -32.19017475299517, -32.19017475299517, -31.19017475299517, -33.81652065525831, -34.31652065525831, -34.31652065525831, -28.960604798645672, -29.960604798645672, -29.960604798645672, -29.43859247582018, -29.43859247582018, -29.43859247582018, -36.69903686671235, -36.69903686671235, -36.69903686671235, -31.600563431778355, -31.600563431778355, -31.600563431778355, -33.32168595145676, -33.32168595145676, -33.32168595145676, -44.13915526025433, -44.13915526025433, -42.63915526025433, -29.425105303566806, -29.425105303566806, -29.425105303566806, -30.939655888644214, -30.939655888644214, -30.939655888644214, -35.359272591631665, -35.359272591631665, -33.859272591631665, -31.45241835680319, -29.952418356803186, -30.45241835680319, -32.52878795295479, -32.52878795295479, -32.52878795295479, -34.32561182646689, -34.32561182646689, -34.32561182646689, -31.306671409875946, -30.306671409875946, -31.306671409875946, -40.99448659079383, -40.99448659079383, -40.99448659079383, -29.98072485578069, -29.98072485578069, -29.98072485578069, -40.57438005139474, -40.57438005139474, -40.57438005139474, -29.08951856722041, -29.08951856722041, -29.08951856722041, -38.073754464358245, -38.073754464358245, -38.073754464358245, -33.1685783728212, -33.1685783728212, -32.66857837282121, -36.93393899291211, -36.93393899291211, -35.93393899291211, -28.91733575923626, -27.91733575923626, -28.91733575923626, -27.848847345077193, -28.348847345077193, -28.348847345077193, -37.84645927528511, -37.34645927528511, -35.84645927528511, -28.858197281830762, -28.858197281830762, -27.358197281830762, -33.125524485289176, -33.125524485289176, -33.125524485289176, -31.4136434948808, -34.41364349488081, -34.41364349488081, -45.365860340754516, -45.865860340754516, -45.865860340754516, -27.641783081316973, -27.641783081316973, -27.641783081316973, -29.92528601297666, -29.92528601297666, -29.92528601297666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3136547391191615, "mean_inference_ms": 1.268735647471009, "mean_action_processing_ms": 0.06993145521361889, "mean_env_wait_ms": 0.5819647642345743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 150400, "timesteps_this_iter": 0, "agent_timesteps_total": 451200, "timers": {"sample_time_ms": 1552.866, "sample_throughput": 2060.706, "load_time_ms": 0.133, "load_throughput": 23971732.095, "learn_time_ms": 793.64, "learn_throughput": 4032.056, "update_time_ms": 1.503}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005000000000000001, "total_loss": 77.03511428833008, "policy_loss": -0.0027495068857097847, "vf_loss": 77.0505355834961, "vf_explained_var": -0.00011743903160095215, "kl": 0.004708572042926041, "entropy": 1.2674704909324646, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 150400, "num_agent_steps_sampled": 451200, "num_steps_trained": 150400, "num_agent_steps_trained": 451200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6010, "training_iteration": 47, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-49", "timestamp": 1718736409, "time_this_iter_s": 1.496323823928833, "time_total_s": 72.21585035324097, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 72.21585035324097, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.700000000000003, "ram_util_percent": 30.366666666666664}}
{"episode_reward_max": -65.89491456992506, "episode_reward_min": -150.29476642406996, "episode_reward_mean": -97.30837766961922, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -50.09825547468996}, "policy_reward_max": {"shared_policy": -21.631638189975035}, "policy_reward_mean": {"shared_policy": -32.436125889873075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-77.51987903196463, -123.6714502522842, -87.83939789879896, -97.90846092738128, -76.25878626829243, -110.73020405167054, -107.88975835421542, -104.6525286520413, -102.91484599132818, -127.73032175858005, -92.57223439988512, -87.229365830342, -91.54057849758337, -107.45948020700996, -94.32078446027104, -87.43780902448408, -124.0006160464008, -93.50729660219315, -87.41361967331528, -104.19456508242729, -114.90255859334928, -100.48039893147777, -91.57312778994871, -123.79526196158751, -92.34198046080635, -121.65344014502186, -99.10771039453779, -86.05151324130713, -105.93973923745018, -83.88935731252946, -111.57959567917885, -134.81479764908676, -118.10689466874803, -85.60595888838617, -105.90280295352665, -73.12215464795969, -110.95212698238774, -113.99952846138663, -111.21375581860968, -68.31911128906135, -98.81875044351294, -124.9823645490608, -124.08683350485738, -126.24985666433548, -88.39814552764737, -102.01004031296051, -96.17983410870472, -84.07067798480938, -88.87476067639929, -93.07539050127903, -105.17053335850338, -65.89491456992506, -112.88366410277301, -83.2774903121747, -87.48180660502813, -94.42345975208313, -92.4928840874109, -106.01774315708731, -80.43869269769392, -106.47934527625178, -89.42512959655147, -85.61526927305646, -101.90582061885, -143.14047284348146, -75.19987880826838, -84.43456499087863, -116.62632008033296, -89.70228865101959, -90.38657353310194, -92.29967215239782, -90.88586275911142, -100.4375322286196, -85.049841142237, -83.50885376787492, -80.04743157424879, -127.35576528094107, -109.07133806751845, -74.36082140558692, -114.41559269406885, -72.59728020415788, -126.36227742639596, -93.19349096961322, -110.13796811849069, -73.78568801377716, -88.74435977324298, -104.0738550842223, -97.5534106339825, -93.69109257639357, -110.11861293039662, -95.69657126347266, -91.96747671927264, -96.69845084359085, -121.29267326708224, -84.07304354208067, -79.95061592351618, -85.30893548956305, -87.75234464579529, -123.74434891343685, -102.83048141441985, -100.9461199960557, -97.74446148128865, -84.656486911781, -86.4351685080013, -96.59516833356561, -111.4450484900021, -101.8667880146571, -82.88215347281259, -93.13194740759808, -89.56158502104272, -94.27605198011612, -95.81209638759094, -106.53683288895763, -79.63764733120729, -77.56765322923164, -82.19898533667953, -127.55939778689574, -79.36515384375258, -107.92657710916137, -107.02601642584774, -74.34058704474492, -83.53441416937832, -83.56562495896435, -79.46467973546272, -67.69813600558065, -119.98789977532185, -150.29476642406996, -79.74442556968634, -80.92681267405256, -74.95507825202291, -77.51233895460409], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-25.839959677321552, -25.839959677321552, -25.839959677321552, -41.723816750761394, -41.723816750761394, -40.223816750761394, -29.279799299599638, -29.279799299599638, -29.279799299599638, -32.63615364246043, -32.63615364246043, -32.63615364246043, -24.91959542276415, -25.41959542276415, -25.91959542276415, -35.24340135055685, -37.74340135055686, -37.74340135055686, -35.46325278473846, -35.96325278473846, -36.46325278473846, -34.884176217347104, -34.884176217347104, -34.884176217347104, -34.30494866377606, -34.30494866377606, -34.30494866377606, -42.74344058619334, -42.74344058619334, -42.24344058619334, -31.357411466628367, -29.857411466628367, -31.357411466628367, -29.07645527678068, -29.07645527678068, -29.07645527678068, -30.68019283252779, -30.68019283252779, -30.18019283252779, -35.819826735670006, -35.819826735670006, -35.819826735670006, -31.44026148675702, -31.44026148675702, -31.44026148675702, -29.312603008161346, -29.312603008161346, -28.81260300816135, -41.3335386821336, -41.3335386821336, -41.3335386821336, -30.502432200731054, -31.502432200731054, -31.502432200731054, -29.3045398911051, -28.8045398911051, -29.3045398911051, -35.39818836080911, -35.39818836080911, -33.3981883608091, -38.30085286444974, -38.30085286444974, -38.30085286444974, -33.99346631049257, -32.49346631049257, -33.99346631049257, -30.691042596649574, -30.691042596649574, -30.191042596649574, -41.765087320529155, -41.765087320529155, -40.265087320529155, -30.280660153602103, -31.780660153602103, -30.280660153602103, -39.551146715007285, -41.051146715007285, -41.051146715007285, -33.03590346484591, -33.03590346484591, -33.03590346484591, -28.850504413769038, -28.350504413769038, -28.850504413769038, -34.979913079150045, -35.479913079150045, -35.479913079150045, -26.9631191041765, -28.4631191041765, -28.4631191041765, -37.193198559726305, -37.193198559726305, -37.193198559726305, -44.27159921636225, -45.27159921636225, -45.27159921636225, -40.36896488958269, -39.36896488958269, -38.36896488958269, -28.53531962946205, -28.53531962946205, -28.53531962946205, -35.30093431784221, -35.30093431784221, -35.30093431784221, -23.37405154931989, -24.87405154931989, -24.87405154931989, -37.3173756607959, -36.3173756607959, -37.3173756607959, -38.16650948712888, -38.16650948712888, -37.66650948712888, -37.071251939536594, -37.071251939536594, -37.071251939536594, -22.773037096353786, -22.773037096353786, -22.773037096353786, -32.439583481171, -33.439583481171, -32.939583481171, -40.82745484968693, -41.82745484968693, -42.32745484968693, -41.52894450161912, -41.02894450161912, -41.52894450161912, -40.749952221445156, -42.249952221445156, -43.249952221445156, -29.466048509215796, -29.466048509215796, -29.466048509215796, -34.003346770986845, -34.003346770986845, -34.003346770986845, -32.05994470290156, -32.05994470290156, -32.05994470290156, -28.023559328269812, -28.023559328269812, -28.023559328269812, -29.624920225466425, -29.624920225466425, -29.624920225466425, -31.35846350042634, -31.35846350042634, -30.35846350042634, -35.056844452834454, -35.056844452834454, -35.056844452834454, -21.631638189975035, -22.131638189975035, -22.131638189975035, -37.6278880342577, -37.6278880342577, -37.6278880342577, -27.759163437391578, -27.759163437391578, -27.759163437391578, -29.493935535009367, -28.493935535009367, -29.493935535009367, -31.47448658402773, -31.47448658402773, -31.47448658402773, -31.49762802913697, -29.99762802913697, -30.99762802913697, -35.33924771902914, -35.33924771902914, -35.33924771902914, -26.31289756589798, -27.812897565897977, -26.312897565897977, -34.49311509208394, -35.99311509208393, -35.99311509208393, -29.975043198850504, -29.475043198850504, -29.975043198850504, -28.5384230910188, -28.5384230910188, -28.5384230910188, -33.968606872950005, -33.968606872950005, -33.968606872950005, -48.71349094782719, -45.71349094782719, -48.71349094782719, -24.233292936089434, -25.233292936089434, -25.733292936089434, -28.644854996959555, -28.644854996959555, -27.144854996959555, -38.208773360111, -39.208773360110996, -39.208773360110996, -29.900762883673185, -29.900762883673185, -29.900762883673185, -30.795524511033985, -28.795524511033985, -30.795524511033985, -30.76655738413261, -30.76655738413261, -30.76655738413261, -29.6286209197038, -30.6286209197038, -30.6286209197038, -33.64584407620654, -33.64584407620654, -33.145844076206544, -28.349947047412336, -28.349947047412336, -28.349947047412336, -27.669617922624983, -27.669617922624983, -28.169617922624983, -26.015810524749604, -27.015810524749604, -27.015810524749604, -42.451921760313695, -42.451921760313695, -42.451921760313695, -36.35711268917284, -36.35711268917284, -36.35711268917284, -24.120273801862304, -25.120273801862304, -25.120273801862304, -38.13853089802293, -38.13853089802293, -38.13853089802293, -23.532426734719294, -24.532426734719298, -24.532426734719298, -42.78742580879865, -42.78742580879865, -40.787425808798645, -31.06449698987106, -31.06449698987106, -31.06449698987106, -36.045989372830185, -37.045989372830185, -37.045989372830185, -24.595229337925705, -24.595229337925705, -24.595229337925705, -29.081453257747672, -29.581453257747672, -30.081453257747672, -34.35795169474079, -34.85795169474079, -34.85795169474079, -32.51780354466084, -32.51780354466084, -32.51780354466084, -31.230364192131177, -31.230364192131177, -31.230364192131177, -35.706204310132215, -37.20620431013222, -37.20620431013222, -31.232190421157558, -32.232190421157554, -32.232190421157554, -30.322492239757544, -30.322492239757544, -31.322492239757544, -32.2328169478636, -32.2328169478636, -32.2328169478636, -40.43089108902741, -40.43089108902741, -40.43089108902741, -28.02434784736022, -28.02434784736022, -28.02434784736022, -25.650205307838743, -27.150205307838743, -27.150205307838743, -27.436311829854358, -28.936311829854358, -28.936311829854358, -29.250781548598415, -29.250781548598415, -29.250781548598415, -41.248116304478934, -41.248116304478934, -41.248116304478934, -33.943493804806614, -34.443493804806614, -34.443493804806614, -33.6487066653519, -33.1487066653519, -34.1487066653519, -32.58148716042958, -32.58148716042958, -32.58148716042958, -28.552162303927, -27.552162303927, -28.552162303927, -28.145056169333756, -29.145056169333756, -29.145056169333756, -32.198389444521865, -32.198389444521865, -32.198389444521865, -37.148349496667365, -37.148349496667365, -37.148349496667365, -34.122262671552356, -34.122262671552356, -33.622262671552356, -28.960717824270855, -28.960717824270855, -24.960717824270855, -31.04398246919935, -31.04398246919935, -31.04398246919935, -28.853861673680928, -30.353861673680928, -30.353861673680928, -29.92535066003872, -32.425350660038724, -31.92535066003872, -31.937365462530337, -31.937365462530337, -31.937365462530337, -35.51227762965254, -35.51227762965254, -35.51227762965254, -26.545882443735753, -26.545882443735753, -26.545882443735753, -25.855884409743883, -25.855884409743883, -25.855884409743883, -26.732995112226515, -27.232995112226515, -28.232995112226515, -42.5197992622986, -42.5197992622986, -42.5197992622986, -26.78838461458417, -26.78838461458417, -25.78838461458417, -35.97552570305379, -35.97552570305379, -35.97552570305379, -34.67533880861595, -36.17533880861595, -36.17533880861595, -24.11352901491495, -25.11352901491495, -25.11352901491495, -27.844804723126114, -27.844804723126114, -27.844804723126114, -28.355208319654775, -26.855208319654775, -28.355208319654775, -26.48822657848759, -26.48822657848759, -26.48822657848759, -22.566045335193557, -22.566045335193557, -22.566045335193557, -40.66263325844063, -39.16263325844063, -40.16263325844063, -50.09825547468996, -50.09825547468996, -50.09825547468996, -26.91480852322877, -25.91480852322877, -26.91480852322877, -25.642270891350844, -27.642270891350844, -27.642270891350844, -24.818359417340965, -24.818359417340965, -25.318359417340965, -26.1707796515347, -26.1707796515347, -25.1707796515347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3133313993125306, "mean_inference_ms": 1.2672462265330537, "mean_action_processing_ms": 0.06984610489574032, "mean_env_wait_ms": 0.5813467852593276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 153600, "timesteps_this_iter": 0, "agent_timesteps_total": 460800, "timers": {"sample_time_ms": 1550.143, "sample_throughput": 2064.325, "load_time_ms": 0.133, "load_throughput": 23988870.063, "learn_time_ms": 791.559, "learn_throughput": 4042.656, "update_time_ms": 1.532}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 75.78534698486328, "policy_loss": -0.0026509399575103563, "vf_loss": 75.80038909912109, "vf_explained_var": 0.021895056962966918, "kl": 0.00540833373016984, "entropy": 1.2386908888816834, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 153600, "num_agent_steps_sampled": 460800, "num_steps_trained": 153600, "num_agent_steps_trained": 460800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6140, "training_iteration": 48, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-50", "timestamp": 1718736410, "time_this_iter_s": 1.492130994796753, "time_total_s": 73.70798134803772, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 73.70798134803772, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 39.05, "ram_util_percent": 30.3}}
{"episode_reward_max": -63.26957593543541, "episode_reward_min": -142.54369040601307, "episode_reward_mean": -97.9783377844708, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.87839600248567}, "policy_reward_max": {"shared_policy": -20.56728148544756}, "policy_reward_mean": {"shared_policy": -32.659445928156934}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.67079029475087, -97.3975163151738, -90.09581152959467, -141.82629777326227, -90.00593650299689, -94.11861684414616, -95.5729204590897, -108.42351493915174, -71.5719473837765, -116.1300428571258, -70.27572458533959, -81.52814422888197, -98.89141274985168, -107.38195714972251, -91.28418942019893, -136.7084532239869, -103.09296835184203, -112.4581703214556, -111.01109953561478, -92.55468821473494, -74.50939723517732, -95.20854377330718, -72.40602309452852, -105.19699877007795, -85.70896505522472, -87.45974662157329, -142.54369040601307, -119.8024779806165, -113.3463734992076, -101.95207751895728, -87.16064924204278, -80.4575664831249, -93.98176865915057, -101.67971928537055, -86.6931010989976, -95.32928848946504, -89.54506538118903, -104.1359330048512, -113.91468339507985, -93.934373479685, -101.19510767619013, -78.40891897719416, -120.67532358696916, -108.19958215510613, -108.61854065222967, -108.1125899052811, -117.2291584305547, -91.42930657160453, -108.61878688560675, -109.08740517659783, -77.66556101689461, -86.07709766182928, -111.99164317988398, -83.03447851028722, -104.72810473248398, -89.52959270150761, -101.35226122363707, -82.57557024937658, -88.40177272820516, -86.5490263760542, -71.09193147044657, -97.23322685728081, -69.26335155747243, -91.16292211779279, -80.48981339773034, -88.03295152193039, -85.92299109426754, -82.73531055455815, -116.27334363402838, -91.92457243289044, -79.96382911827105, -93.62444288945817, -76.93030461610293, -98.59772396446456, -98.27569013172852, -85.41379136653008, -107.95161305850257, -84.11367214901084, -107.06522036172109, -104.35555975902548, -95.84090336349958, -89.97629047329889, -102.03921971911687, -97.69961937855565, -108.25920375317283, -137.7483637402599, -93.02901548860184, -101.9440872582235, -63.26957593543541, -123.60101612406434, -98.79671551816351, -89.41438227086482, -92.62060970764348, -88.45581983836662, -132.52568330846162, -79.55642661212346, -132.25567024342806, -89.24946463915431, -93.21364289660492, -120.28344170155842, -99.77517464889218, -82.20533661202118, -80.71240228474245, -107.88550168133204, -69.4432972220073, -117.90302151876108, -112.76124187058196, -135.60464433065607, -66.15033875360113, -83.88849974583601, -99.54694325445148, -127.2548007644688, -76.83525805262053, -113.04531345650034, -92.38539805246211, -96.32850119378017, -89.52687310703112, -97.43810754404474, -90.87326721604646, -100.36171668499972, -90.53399582085895, -106.10555722027757, -104.30091430120517, -109.5416726212635, -66.70184445634267, -127.64962236814738, -127.95846206906677, -97.78767853264894, -141.63518800745712, -90.39545101345516], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-25.223596764916962, -25.223596764916962, -25.223596764916962, -32.46583877172462, -32.46583877172462, -32.46583877172462, -30.53193717653155, -29.03193717653155, -30.53193717653155, -47.27543259108741, -47.27543259108741, -47.27543259108741, -29.668645500998963, -30.168645500998963, -30.168645500998963, -31.539538948048712, -31.539538948048712, -31.039538948048712, -31.85764015302989, -31.85764015302989, -31.85764015302989, -36.14117164638389, -36.14117164638389, -36.14117164638389, -23.857315794592154, -23.857315794592154, -23.857315794592154, -38.37668095237527, -38.87668095237527, -38.87668095237527, -23.0919081951132, -23.5919081951132, -23.5919081951132, -27.17604807629398, -27.17604807629398, -27.17604807629398, -32.963804249950584, -32.963804249950584, -32.963804249950584, -35.79398571657415, -35.79398571657415, -35.79398571657415, -30.428063140066314, -30.428063140066314, -30.428063140066314, -44.90281774132898, -45.90281774132898, -45.90281774132898, -34.697656117280665, -33.697656117280665, -34.697656117280665, -37.48605677381853, -37.48605677381853, -37.48605677381853, -33.00369984520494, -39.00369984520494, -39.00369984520494, -30.85156273824496, -30.85156273824496, -30.85156273824496, -25.003132411725765, -24.503132411725765, -25.003132411725765, -31.736181257769076, -32.236181257769076, -31.236181257769076, -24.135341031509498, -24.135341031509498, -24.135341031509498, -35.06566625669263, -35.06566625669263, -35.06566625669263, -29.569655018408262, -26.569655018408266, -29.569655018408262, -29.819915540524427, -27.819915540524427, -29.819915540524427, -47.181230135337714, -47.681230135337714, -47.681230135337714, -40.60082599353884, -39.60082599353884, -39.60082599353884, -37.782124499735865, -37.782124499735865, -37.782124499735865, -34.15069250631911, -33.65069250631911, -34.15069250631911, -29.05354974734757, -29.05354974734757, -29.05354974734757, -26.819188827708285, -26.819188827708285, -26.819188827708285, -31.327256219716876, -31.327256219716876, -31.327256219716876, -32.22657309512352, -34.72657309512352, -34.72657309512352, -28.564367032999186, -29.064367032999186, -29.064367032999186, -31.943096163155026, -31.943096163155026, -31.443096163155026, -29.181688460396366, -30.181688460396366, -30.181688460396366, -34.71197766828374, -34.71197766828374, -34.71197766828374, -37.80489446502661, -38.80489446502661, -37.30489446502661, -30.978124493228336, -31.478124493228336, -31.478124493228336, -33.73170255873004, -34.23170255873004, -33.23170255873004, -25.136306325731404, -26.636306325731404, -26.636306325731404, -40.55844119565642, -40.05844119565642, -40.05844119565642, -36.0665273850354, -36.0665273850354, -36.0665273850354, -36.2061802174099, -36.2061802174099, -36.2061802174099, -36.03752996842703, -36.03752996842703, -36.03752996842703, -39.076386143518214, -39.076386143518214, -39.076386143518214, -29.14310219053485, -30.643102190534854, -31.643102190534854, -36.372928961868894, -36.372928961868894, -35.872928961868894, -36.36246839219929, -36.36246839219929, -36.36246839219929, -26.05518700563153, -25.55518700563153, -26.05518700563153, -29.192365887276438, -27.19236588727644, -29.692365887276438, -37.99721439329466, -37.99721439329466, -35.99721439329467, -27.678159503429075, -27.678159503429075, -27.678159503429075, -34.90936824416131, -34.90936824416131, -34.90936824416131, -30.17653090050256, -29.17653090050256, -30.17653090050256, -33.784087074545695, -33.784087074545695, -33.784087074545695, -27.525190083125548, -27.525190083125548, -27.525190083125548, -29.467257576068395, -29.467257576068395, -29.467257576068395, -28.683008792018082, -29.183008792018082, -28.683008792018082, -24.030643823482187, -24.030643823482187, -23.030643823482187, -32.4110756190936, -32.4110756190936, -32.4110756190936, -22.42111718582415, -23.42111718582415, -23.42111718582415, -31.054307372597613, -29.054307372597613, -31.054307372597613, -26.829937799243467, -26.829937799243467, -26.829937799243467, -29.510983840643455, -29.510983840643455, -29.010983840643455, -30.474330364755822, -28.974330364755822, -26.474330364755822, -27.5784368515194, -27.5784368515194, -27.5784368515194, -39.257781211342774, -37.75778121134277, -39.257781211342774, -30.30819081096349, -30.80819081096349, -30.80819081096349, -27.48794303942367, -25.48794303942367, -26.98794303942367, -32.04148096315272, -30.541480963152722, -31.041480963152722, -25.64343487203432, -25.64343487203432, -25.64343487203432, -32.86590798815485, -32.86590798815485, -32.86590798815485, -32.9252300439095, -32.9252300439095, -32.4252300439095, -28.47126378884338, -28.47126378884338, -28.47126378884338, -36.31720435283418, -35.81720435283418, -35.81720435283418, -28.20455738300363, -28.20455738300363, -27.70455738300363, -35.68840678724038, -35.68840678724038, -35.68840678724038, -34.451853253008515, -34.951853253008515, -34.951853253008515, -32.44696778783318, -30.946967787833184, -32.44696778783318, -29.992096824432934, -29.992096824432934, -29.992096824432934, -33.346406573038976, -34.346406573038976, -34.346406573038976, -32.56653979285187, -32.56653979285187, -32.56653979285187, -36.086401251057595, -36.086401251057595, -36.086401251057595, -46.08278791342, -45.58278791342, -46.08278791342, -31.34300516286726, -30.34300516286726, -31.34300516286726, -33.981362419407844, -33.981362419407844, -33.981362419407844, -21.089858645145135, -21.089858645145135, -21.089858645145135, -41.200338708021434, -41.200338708021434, -41.200338708021434, -33.26557183938786, -33.26557183938786, -32.26557183938786, -29.804794090288254, -29.804794090288254, -29.804794090288254, -31.040203235881144, -30.540203235881144, -31.040203235881144, -29.48527327945555, -29.48527327945555, -29.48527327945555, -44.34189443615385, -43.84189443615385, -44.34189443615385, -26.685475537374494, -26.185475537374494, -26.685475537374494, -44.08522341447601, -44.08522341447601, -44.08522341447601, -30.249821546384798, -28.749821546384798, -30.249821546384798, -31.237880965534963, -30.737880965534963, -31.237880965534963, -40.094480567186125, -40.094480567186125, -40.094480567186125, -32.92505821629742, -33.92505821629742, -32.92505821629742, -27.90177887067372, -27.40177887067372, -26.90177887067372, -26.5708007615808, -27.0708007615808, -27.0708007615808, -35.9618338937773, -35.9618338937773, -35.9618338937773, -22.814432407335758, -23.314432407335758, -23.314432407335758, -39.30100717292035, -39.80100717292035, -38.80100717292035, -35.253747290194006, -38.75374729019401, -38.75374729019401, -45.2015481102187, -45.2015481102187, -45.2015481102187, -22.05011291786706, -22.05011291786706, -22.05011291786706, -28.29616658194532, -27.79616658194532, -27.79616658194532, -33.182314418150504, -33.182314418150504, -33.182314418150504, -41.41826692148956, -42.91826692148956, -42.91826692148956, -25.778419350873534, -25.278419350873534, -25.778419350873534, -37.68177115216679, -37.68177115216679, -37.68177115216679, -30.795132684154012, -30.795132684154012, -30.795132684154012, -31.109500397926713, -32.60950039792671, -32.60950039792671, -29.508957702343718, -30.008957702343718, -30.008957702343718, -32.64603584801491, -32.64603584801491, -32.14603584801491, -30.291089072015478, -30.291089072015478, -30.291089072015478, -33.45390556166654, -33.45390556166654, -33.45390556166654, -30.17799860695299, -30.677998606952997, -29.677998606952997, -35.36851907342587, -35.36851907342587, -35.36851907342587, -34.766971433735044, -34.766971433735044, -34.766971433735044, -36.84722420708781, -36.84722420708781, -35.84722420708781, -23.067281485447555, -20.56728148544756, -23.067281485447555, -42.54987412271579, -42.54987412271579, -42.54987412271579, -41.319487356355616, -43.819487356355616, -42.819487356355616, -32.595892844216316, -32.595892844216316, -32.595892844216316, -46.378396002485665, -46.37839600248567, -48.87839600248567, -30.79848367115171, -30.79848367115171, -28.79848367115171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3130755249041926, "mean_inference_ms": 1.2659588347253095, "mean_action_processing_ms": 0.06978449472685595, "mean_env_wait_ms": 0.5807560824076822, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 156800, "timesteps_this_iter": 0, "agent_timesteps_total": 470400, "timers": {"sample_time_ms": 1544.34, "sample_throughput": 2072.083, "load_time_ms": 0.132, "load_throughput": 24279617.945, "learn_time_ms": 791.039, "learn_throughput": 4045.313, "update_time_ms": 1.524}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005000000000000001, "total_loss": 76.45253982543946, "policy_loss": -0.0021645709612640117, "vf_loss": 76.46705474853516, "vf_explained_var": 0.019168049097061157, "kl": 0.003574363605166475, "entropy": 1.2350816011428833, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156800, "num_agent_steps_sampled": 470400, "num_steps_trained": 156800, "num_agent_steps_trained": 470400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6270, "training_iteration": 49, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-52", "timestamp": 1718736412, "time_this_iter_s": 1.4874486923217773, "time_total_s": 75.1954300403595, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 75.1954300403595, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 36.9, "ram_util_percent": 30.3}}
{"episode_reward_max": -65.25235988642766, "episode_reward_min": -149.7278863438568, "episode_reward_mean": -99.06313495994442, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -50.90929544795233}, "policy_reward_max": {"shared_policy": -21.584119962142534}, "policy_reward_mean": {"shared_policy": -33.02104498664814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.90396718824056, -112.82689087000753, -94.17006116059663, -82.30487151065319, -92.87406294767497, -93.65115889880468, -101.47515499555914, -87.89456369212127, -91.5015181147346, -117.08911671210757, -91.80547436683747, -117.91030984207543, -73.28273941152906, -97.9934816122953, -97.06425887366674, -88.33010288444008, -80.73648227277891, -138.27162392304447, -104.93351890506202, -82.12940759504677, -89.10156908343198, -105.142953774993, -108.29630013562682, -109.67202671628141, -134.53377792808487, -82.84287994903035, -98.9849095652298, -119.1187433544947, -112.47038568493574, -85.08381975408201, -101.9135392638636, -72.98746948686535, -96.47798756232396, -115.26277188069683, -97.68403577127044, -95.51477643603172, -79.19434722069597, -136.31016896855692, -121.28953121914873, -109.28575252106441, -77.68509470052327, -86.39837377683678, -91.44985619013671, -117.75521587470115, -109.57818029493855, -107.94333244884325, -92.80774972865785, -97.00321243725799, -105.33175582561918, -85.60847585711483, -91.26279216976877, -90.15374337269107, -108.02829772596598, -116.21217305839032, -82.31504025647098, -85.82824923834482, -86.90245286953412, -101.36167214916462, -115.81502640381495, -104.32038504922255, -81.78697771434679, -149.7278863438568, -111.47936191682578, -92.5346123999008, -94.6029273446198, -84.122921260106, -88.28679918439724, -72.85638155052338, -73.54622013963237, -108.71220675564108, -79.6889046011315, -80.51717079844813, -113.22387772205445, -108.92765914604628, -134.69724530260183, -127.52209816949532, -116.79161763908597, -84.23239344541014, -95.19919951731124, -108.14018053927747, -94.10507597413472, -91.87531315266604, -86.19483845585111, -82.69571235610417, -95.51212373415052, -139.63404340472025, -112.15090164947443, -94.2895643878628, -98.79645416393303, -106.89696262706478, -130.7314984860872, -83.85127532110792, -70.87121968075401, -68.02037816935743, -117.26281069138552, -83.57834351571644, -103.37023148370069, -121.14627058347111, -97.81413427893696, -84.47006716770508, -74.67628385883216, -80.39927048691791, -120.79174811583827, -91.91428930267041, -82.00339143518698, -102.80941727554497, -105.70068826275804, -94.1150613471868, -94.60498705465888, -104.96403018536923, -105.89340319376157, -87.97655397178379, -74.63529326741374, -116.07047700235123, -94.41251252260236, -117.62591957913942, -118.20678153132415, -116.505170312183, -65.25235988642766, -77.21132456983246, -94.46226376707722, -108.58140820189789, -114.1825956160868, -97.86891919192232, -100.4628185305443, -107.80866570461895, -69.11299216954421, -141.03244648456803, -92.45270675645969, -92.53231295139348], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-30.634655729413513, -31.134655729413513, -31.134655729413513, -37.942296956669175, -37.942296956669175, -36.942296956669175, -31.39002038686554, -31.39002038686554, -31.39002038686554, -27.434957170217725, -27.434957170217725, -27.434957170217725, -30.958020982558306, -30.958020982558306, -30.958020982558306, -32.050386299601556, -32.050386299601556, -29.550386299601552, -33.82505166518636, -33.82505166518636, -33.82505166518636, -28.96485456404041, -29.46485456404041, -29.46485456404041, -31.333839371578204, -31.333839371578204, -28.833839371578204, -39.36303890403587, -38.36303890403587, -39.36303890403587, -30.601824788945837, -30.601824788945837, -30.601824788945837, -39.97010328069182, -37.97010328069181, -39.97010328069182, -24.427579803843006, -24.427579803843006, -24.427579803843006, -33.33116053743177, -31.33116053743177, -33.33116053743177, -32.35475295788889, -32.35475295788889, -32.35475295788889, -29.94336762814669, -28.94336762814669, -29.44336762814669, -26.578827424259618, -27.078827424259618, -27.078827424259618, -46.42387464101482, -46.42387464101482, -45.42387464101482, -34.97783963502068, -34.97783963502068, -34.97783963502068, -28.04313586501561, -26.54313586501561, -27.54313586501561, -29.700523027810657, -29.700523027810657, -29.700523027810657, -34.38098459166434, -35.38098459166434, -35.38098459166434, -36.09876671187559, -36.09876671187559, -36.09876671187559, -37.224008905427155, -35.724008905427155, -36.724008905427155, -44.844592642695, -44.844592642695, -44.844592642695, -27.61429331634345, -27.61429331634345, -27.61429331634345, -32.82830318840995, -32.82830318840995, -33.32830318840995, -40.03958111816493, -39.03958111816493, -40.03958111816493, -37.490128561645264, -37.490128561645264, -37.490128561645264, -28.36127325136067, -28.36127325136067, -28.36127325136067, -33.97117975462121, -33.97117975462121, -33.97117975462121, -24.32915649562179, -24.32915649562179, -24.32915649562179, -32.15932918744134, -32.15932918744134, -32.15932918744134, -38.42092396023226, -38.42092396023226, -38.42092396023226, -30.894678590423478, -33.394678590423474, -33.394678590423474, -32.00492547867725, -32.00492547867725, -31.50492547867725, -26.56478240689866, -25.56478240689866, -27.06478240689866, -45.7700563228523, -45.7700563228523, -44.7700563228523, -41.0965104063829, -40.5965104063829, -39.59651040638289, -36.42858417368812, -36.42858417368812, -36.42858417368812, -26.228364900174423, -25.228364900174423, -26.228364900174423, -28.799457925612245, -28.799457925612245, -28.799457925612245, -30.483285396712226, -30.483285396712226, -30.483285396712226, -39.2517386249004, -39.2517386249004, -39.2517386249004, -36.52606009831285, -36.52606009831285, -36.52606009831285, -35.981110816281095, -35.981110816281095, -35.981110816281095, -31.26924990955261, -31.26924990955261, -30.26924990955261, -32.50107081241933, -32.00107081241933, -32.50107081241933, -34.443918608539704, -35.443918608539704, -35.443918608539704, -28.202825285704964, -28.702825285704964, -28.702825285704964, -29.42093072325625, -30.92093072325625, -30.92093072325625, -30.551247790897037, -30.051247790897037, -29.551247790897037, -35.67609924198864, -36.17609924198864, -36.17609924198864, -39.404057686130116, -37.404057686130116, -39.404057686130116, -26.771680085490324, -27.771680085490324, -27.771680085490324, -27.942749746114924, -28.942749746114924, -28.942749746114924, -29.13415095651137, -28.63415095651137, -29.13415095651137, -33.78722404972155, -33.78722404972155, -33.78722404972155, -39.60500880127169, -36.60500880127169, -39.60500880127169, -34.773461683074174, -34.773461683074174, -34.773461683074174, -27.762325904782273, -27.762325904782273, -26.262325904782273, -50.90929544795233, -47.909295447952324, -50.90929544795233, -37.15978730560859, -37.15978730560859, -37.15978730560859, -30.844870799966937, -30.844870799966937, -30.844870799966937, -31.534309114873274, -31.534309114873274, -31.534309114873274, -28.207640420035332, -28.207640420035332, -27.707640420035332, -29.92893306146573, -29.92893306146573, -28.42893306146573, -24.28546051684112, -24.28546051684112, -24.28546051684112, -23.84874004654413, -24.84874004654413, -24.84874004654413, -36.57073558521367, -35.57073558521366, -36.57073558521367, -26.72963486704381, -26.22963486704381, -26.72963486704381, -26.839056932816042, -26.839056932816042, -26.839056932816042, -38.24129257401816, -37.74129257401816, -37.24129257401816, -36.309219715348746, -36.309219715348746, -36.309219715348746, -45.06574843420061, -45.06574843420061, -44.56574843420061, -42.34069938983174, -42.34069938983174, -42.84069938983174, -38.93053921302866, -38.93053921302866, -38.93053921302866, -28.91079781513671, -26.910797815136718, -28.410797815136718, -32.06639983910376, -32.06639983910376, -31.06639983910376, -36.04672684642581, -36.04672684642581, -36.04672684642581, -31.701691991378237, -31.701691991378237, -30.701691991378237, -30.625104384222016, -30.625104384222016, -30.625104384222016, -27.731612818617016, -29.231612818617016, -29.231612818617016, -27.731904118701383, -27.231904118701383, -27.731904118701383, -32.83737457805017, -29.83737457805017, -32.83737457805017, -47.04468113490674, -45.54468113490674, -47.04468113490674, -36.716967216491504, -37.716967216491504, -37.716967216491504, -30.596521462620935, -31.596521462620935, -32.096521462620935, -33.26548472131103, -32.26548472131103, -33.26548472131103, -33.965654209021615, -36.465654209021615, -36.465654209021615, -44.077166162029044, -42.577166162029044, -44.077166162029044, -27.950425107035947, -27.950425107035947, -27.950425107035947, -23.95707322691801, -22.95707322691801, -23.95707322691801, -22.673459389785805, -22.673459389785805, -22.673459389785805, -39.08760356379516, -39.08760356379516, -39.08760356379516, -28.19278117190549, -28.19278117190549, -27.19278117190549, -33.79007716123357, -34.79007716123357, -34.79007716123357, -40.71542352782372, -39.71542352782372, -40.71542352782372, -32.938044759645656, -31.93804475964566, -32.938044759645656, -28.32335572256836, -28.32335572256836, -27.82335572256836, -24.892094619610724, -24.892094619610724, -24.892094619610724, -27.299756828972637, -27.299756828972637, -25.799756828972637, -39.26391603861277, -40.76391603861277, -40.76391603861277, -30.638096434223474, -30.638096434223474, -30.638096434223474, -26.667797145062302, -27.667797145062302, -27.667797145062302, -33.93647242518167, -34.43647242518167, -34.43647242518167, -35.233562754252674, -35.733562754252674, -34.733562754252674, -31.705020449062268, -31.705020449062268, -30.705020449062268, -31.70166235155296, -31.20166235155296, -31.70166235155296, -35.48801006178975, -35.48801006178975, -33.98801006178975, -35.964467731253826, -35.964467731253826, -33.964467731253826, -30.15885132392791, -29.15885132392791, -28.65885132392791, -25.045097755804584, -25.045097755804584, -24.545097755804584, -37.69015900078373, -39.19015900078373, -39.19015900078373, -31.470837507534124, -31.470837507534124, -31.470837507534124, -39.20863985971314, -39.20863985971314, -39.20863985971314, -38.40226051044137, -39.90226051044137, -39.90226051044137, -39.00172343739436, -39.00172343739436, -38.50172343739436, -21.584119962142534, -22.084119962142534, -21.584119962142534, -26.23710818994417, -24.73710818994417, -26.23710818994417, -31.820754589025736, -30.820754589025736, -31.820754589025736, -36.860469400632596, -36.860469400632596, -34.86046940063261, -38.06086520536228, -38.06086520536228, -38.06086520536228, -32.78963973064076, -32.78963973064076, -32.28963973064076, -31.98760617684807, -33.487606176848075, -34.987606176848075, -35.93622190153966, -35.93622190153966, -35.93622190153966, -23.370997389848085, -21.870997389848085, -23.870997389848085, -47.34414882818938, -46.34414882818938, -47.34414882818938, -30.81756891881991, -30.81756891881991, -30.81756891881991, -31.177437650464498, -30.177437650464498, -31.177437650464498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3132624966182914, "mean_inference_ms": 1.2662594247315795, "mean_action_processing_ms": 0.06982793987382167, "mean_env_wait_ms": 0.5808476410570103, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 1537.76, "sample_throughput": 2080.948, "load_time_ms": 0.132, "load_throughput": 24244531.792, "learn_time_ms": 786.3, "learn_throughput": 4069.696, "update_time_ms": 1.524}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 78.06650085449219, "policy_loss": -0.0027518566525541743, "vf_loss": 78.08183517456055, "vf_explained_var": 0.02402324676513672, "kl": 0.006090086258343741, "entropy": 1.2578398823738097, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 480000, "num_steps_trained": 160000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": -76.19135145769975, "episode_reward_min": -117.93004179757473, "episode_reward_mean": -96.05327725081827, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": -39.3659440485846}, "policy_reward_max": {"shared_policy": -25.186858406078258}, "policy_reward_mean": {"shared_policy": -32.017759083606094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.67513656388476, -98.54944721402677, -93.47381803770008, -85.58820399305745, -76.19135145769975, -95.69707033365206, -116.59783214575381, -117.93004179757473, -77.56057521823473, -100.26929574659857], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-32.89171218796162, -32.89171218796162, -32.89171218796162, -33.18314907134225, -32.18314907134225, -33.18314907134225, -31.157939345900015, -31.157939345900015, -31.157939345900015, -28.529401331019145, -28.529401331019145, -28.529401331019145, -25.3971171525666, -25.3971171525666, -25.3971171525666, -31.565690111217332, -32.065690111217336, -32.065690111217336, -39.3659440485846, -38.3659440485846, -38.8659440485846, -39.31001393252491, -39.31001393252491, -39.31001393252491, -26.186858406078258, -25.186858406078258, -26.186858406078258, -33.75643191553285, -33.75643191553285, -32.75643191553285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14583143105069957, "mean_inference_ms": 0.6218554964103546, "mean_action_processing_ms": 0.03312498449804298, "mean_env_wait_ms": 0.2918167418217754, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 6400, "training_iteration": 50, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-53", "timestamp": 1718736413, "time_this_iter_s": 1.83266282081604, "time_total_s": 77.02809286117554, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219b820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.02809286117554, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 39.9, "ram_util_percent": 30.35}}
{"episode_reward_max": -63.606205962237766, "episode_reward_min": -138.54015452434632, "episode_reward_mean": -96.4795286400487, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -46.68005150811543}, "policy_reward_max": {"shared_policy": -21.202068654079255}, "policy_reward_mean": {"shared_policy": -32.15984288001623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.80342788845726, -110.34979933785452, -82.52632862203967, -82.01892002622014, -80.87732583666593, -79.83448857989997, -76.14632257297784, -100.8991445141468, -100.94132378615242, -105.94839468732472, -97.90429711125765, -103.68709701905354, -116.47031556903612, -106.76866997739143, -96.01667865890597, -76.69748403649093, -84.7759837678948, -121.47391526321874, -121.31507031769877, -106.38435250067474, -86.08116360820416, -102.69623450789412, -96.25583210369142, -106.08062139177589, -95.43472706655956, -104.08648710905717, -83.61461404125745, -94.4528072531667, -88.2307933320554, -94.86666117561025, -115.8324497179282, -102.80426047108193, -78.16407857311341, -85.61987865438343, -104.8472543155565, -108.63920488487855, -94.24276006978755, -89.2575800491213, -138.54015452434632, -124.51241886869387, -102.12100628407575, -83.41387948292969, -91.16483709415498, -86.12520619765343, -103.44408877160292, -117.95114415842113, -90.57287922130708, -85.69653994802313, -86.76313503355152, -90.86830388186225, -75.1499756769278, -86.05174596341871, -66.28635269203075, -81.38053888137335, -116.34752059519202, -121.98857160135644, -101.92573356828466, -101.32835894348685, -90.3257092946079, -83.62295080167573, -92.66186110486599, -81.37558387596972, -80.14098772198342, -103.13133185072991, -108.03385419381249, -93.61292578698709, -108.74399456324377, -63.606205962237766, -78.72005407351749, -95.07815963570668, -78.81385575611358, -107.4547562507178, -100.60073021895113, -106.65867431011684, -93.04884475051638, -86.3480633004379, -109.03596964065818, -84.04445043561667, -105.12920615677703, -87.92209133336819, -116.17027318128139, -102.3981223317937, -81.9722251891025, -98.19198991921944, -105.96435568819926, -73.45696445049728, -81.93618894848736, -119.95914119519576, -104.22925183387372, -108.70979275109782, -91.51598496154797, -99.18483278365817, -70.13757929830987, -107.09544184935856, -98.49028762370912, -82.94940680570814, -105.48495848654707, -90.51635318295483, -120.19014112403329, -75.03229646045246, -97.17102834595339, -96.91961374304125, -93.7470942911194, -118.63820989263854, -80.03952143546455, -114.89882948414287, -86.81111736723675, -109.61926893884379, -116.04206274382089, -91.54711734895251, -96.74435496982713, -66.38496784189378, -90.95617192009752, -102.83230941690748, -100.51543219575497, -80.37058309821296, -119.6897020239948, -89.4282872740229, -87.84091113370891, -114.97186446939212], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-39.10114262948574, -39.10114262948574, -38.60114262948574, -37.44993311261819, -37.44993311261819, -35.44993311261819, -27.508776207346557, -27.508776207346557, -27.508776207346557, -27.33964000874004, -27.33964000874004, -27.33964000874004, -26.959108612221996, -26.959108612221996, -26.959108612221996, -26.61149619329999, -27.11149619329999, -26.11149619329999, -25.54877419099262, -25.04877419099262, -25.54877419099262, -33.63304817138229, -33.63304817138229, -33.63304817138229, -34.14710792871746, -34.64710792871746, -32.14710792871746, -35.81613156244157, -35.81613156244157, -34.31613156244157, -32.63476570375254, -32.63476570375254, -32.63476570375254, -35.06236567301784, -35.06236567301784, -33.56236567301784, -39.6567718563454, -39.6567718563454, -37.1567718563454, -34.92288999246381, -35.92288999246381, -35.92288999246381, -33.00555955296866, -31.505559552968663, -31.505559552968663, -25.899161345496996, -25.899161345496996, -24.899161345496996, -28.75866125596492, -28.25866125596492, -27.758661255964928, -40.49130508773957, -40.49130508773957, -40.49130508773957, -40.60502343923292, -40.60502343923292, -40.10502343923292, -35.96145083355826, -35.46145083355826, -34.96145083355826, -28.693721202734718, -28.693721202734718, -28.693721202734718, -34.39874483596471, -34.39874483596471, -33.89874483596471, -32.585277367897135, -31.58527736789713, -32.085277367897135, -35.36020713059199, -35.36020713059199, -35.36020713059199, -31.97824235551987, -31.97824235551987, -31.47824235551987, -34.695495703019034, -34.695495703019034, -34.695495703019034, -27.87153801375249, -27.87153801375249, -27.87153801375249, -31.484269084388885, -31.484269084388885, -31.484269084388885, -29.910264444018463, -29.910264444018463, -28.41026444401846, -32.4555537252034, -29.9555537252034, -32.4555537252034, -38.944149905976076, -37.944149905976076, -38.944149905976076, -33.768086823693984, -34.768086823693984, -34.268086823693984, -26.388026191037792, -25.388026191037792, -26.388026191037792, -28.70662621812781, -28.20662621812781, -28.70662621812781, -35.615751438518835, -33.615751438518835, -35.615751438518835, -36.87973496162617, -35.87973496162617, -35.87973496162617, -31.58092002326254, -31.58092002326254, -31.08092002326254, -29.252526683040433, -30.252526683040433, -29.752526683040433, -45.68005150811543, -46.18005150811543, -46.68005150811543, -42.170806289564624, -41.170806289564624, -41.170806289564624, -34.04033542802525, -34.04033542802525, -34.04033542802525, -27.8046264943099, -27.8046264943099, -27.8046264943099, -30.72161236471831, -29.72161236471831, -30.72161236471831, -29.041735399217814, -28.04173539921781, -29.041735399217814, -33.981362923867636, -34.481362923867636, -34.981362923867636, -39.650381386140424, -39.650381386140424, -38.650381386140424, -29.690959740435712, -31.190959740435712, -29.690959740435712, -28.732179982674374, -28.732179982674374, -28.232179982674374, -28.921045011183843, -28.921045011183843, -28.921045011183843, -30.28943462728741, -30.28943462728741, -30.28943462728741, -24.3833252256426, -25.3833252256426, -25.3833252256426, -28.68391532113954, -28.68391532113954, -28.68391532113954, -22.26211756401024, -21.76211756401024, -22.26211756401024, -26.293512960457782, -27.793512960457782, -27.293512960457782, -39.11584019839733, -38.11584019839733, -39.11584019839733, -39.66285720045213, -40.66285720045213, -41.66285720045213, -33.47524452276156, -33.97524452276156, -34.47524452276156, -32.94278631449563, -34.44278631449563, -33.94278631449563, -30.108569764869305, -30.108569764869305, -30.108569764869305, -28.374316933891887, -28.374316933891887, -26.874316933891887, -30.88728703495533, -30.88728703495533, -30.88728703495533, -27.12519462532325, -27.12519462532325, -27.12519462532325, -26.713662573994505, -26.713662573994505, -26.713662573994505, -34.37711061690999, -34.37711061690999, -34.37711061690999, -37.01128473127081, -36.01128473127081, -35.01128473127081, -31.37097526232904, -31.37097526232904, -30.87097526232904, -36.24799818774793, -36.24799818774793, -36.24799818774793, -21.202068654079255, -21.202068654079255, -21.202068654079255, -26.24001802450583, -26.24001802450583, -26.24001802450583, -31.692719878568923, -31.692719878568923, -31.692719878568923, -26.271285252037867, -26.271285252037867, -26.271285252037867, -35.8182520835726, -35.8182520835726, -35.8182520835726, -33.533576739650364, -33.533576739650364, -33.533576739650364, -35.552891436705615, -35.552891436705615, -35.552891436705615, -31.516281583505446, -31.516281583505446, -30.016281583505446, -29.116021100145947, -29.116021100145947, -28.116021100145947, -34.845323213552724, -37.845323213552724, -36.345323213552724, -28.01481681187222, -28.01481681187222, -28.01481681187222, -34.876402052259, -35.37640205225901, -34.87640205225901, -29.307363777789405, -29.307363777789405, -29.307363777789405, -39.39009106042712, -39.39009106042712, -37.39009106042712, -33.799374110597924, -34.299374110597924, -34.299374110597924, -26.657408396367494, -27.657408396367494, -27.657408396367494, -33.06399663973983, -33.06399663973983, -32.06399663973983, -35.32145189606644, -35.32145189606644, -35.32145189606644, -24.652321483499094, -24.152321483499094, -24.652321483499094, -27.312062982829126, -27.312062982829126, -27.312062982829126, -40.319713731731895, -39.319713731731895, -40.319713731731895, -35.07641727795792, -34.076417277957916, -35.07641727795792, -36.23659758369927, -36.23659758369927, -36.23659758369927, -30.671994987182643, -30.171994987182643, -30.671994987182643, -33.22827759455272, -32.72827759455272, -33.22827759455272, -23.379193099436627, -23.379193099436627, -23.379193099436627, -35.365147283119526, -35.865147283119526, -35.865147283119526, -32.99676254123637, -32.99676254123637, -32.49676254123637, -28.1498022685694, -27.6498022685694, -27.1498022685694, -35.82831949551569, -34.32831949551569, -35.32831949551569, -30.172117727651614, -30.172117727651614, -30.172117727651614, -40.39671370801108, -39.39671370801108, -40.39671370801108, -26.177432153484148, -25.677432153484148, -23.177432153484148, -32.723676115317794, -31.723676115317794, -32.723676115317794, -32.47320458101376, -31.97320458101376, -32.47320458101376, -31.582364763706472, -30.582364763706472, -31.582364763706472, -39.87940329754616, -38.87940329754616, -39.87940329754616, -27.513173811821527, -27.013173811821527, -25.513173811821527, -38.299609828047636, -38.799609828047636, -37.799609828047636, -29.603705789078916, -27.603705789078912, -29.603705789078916, -35.53975631294797, -36.53975631294797, -37.53975631294797, -36.68068758127366, -39.68068758127366, -39.68068758127366, -30.849039116317492, -29.849039116317492, -30.849039116317492, -30.914784989942376, -32.914784989942376, -32.914784989942376, -22.1283226139646, -22.1283226139646, -22.1283226139646, -30.48539064003249, -29.98539064003249, -30.48539064003249, -33.77743647230246, -34.27743647230246, -34.77743647230246, -32.671810731918306, -34.671810731918306, -33.171810731918306, -26.790194366070992, -26.790194366070992, -26.790194366070992, -39.89656734133158, -39.89656734133158, -39.89656734133158, -29.97609575800766, -29.97609575800766, -29.47609575800766, -29.2803037112363, -29.2803037112363, -29.2803037112363, -38.657288156464055, -37.657288156464055, -38.657288156464055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3131385892857875, "mean_inference_ms": 1.2658729147702175, "mean_action_processing_ms": 0.06981460452554535, "mean_env_wait_ms": 0.5806556118154751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 163200, "timesteps_this_iter": 0, "agent_timesteps_total": 489600, "timers": {"sample_time_ms": 1563.835, "sample_throughput": 2046.251, "load_time_ms": 0.137, "load_throughput": 23378806.48, "learn_time_ms": 787.827, "learn_throughput": 4061.806, "update_time_ms": 1.573}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005000000000000001, "total_loss": 78.00427474975587, "policy_loss": -0.00280057701355933, "vf_loss": 78.01968078613281, "vf_explained_var": -0.005714428424835205, "kl": 0.00430782966407377, "entropy": 1.2605793356895447, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 163200, "num_agent_steps_sampled": 489600, "num_steps_trained": 163200, "num_agent_steps_trained": 489600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6520, "training_iteration": 51, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-55", "timestamp": 1718736415, "time_this_iter_s": 1.5213816165924072, "time_total_s": 78.54947447776794, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 78.54947447776794, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.233333333333334, "ram_util_percent": 30.366666666666664}}
{"episode_reward_max": -69.00373421595674, "episode_reward_min": -132.63678287856632, "episode_reward_mean": -98.72128476335058, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -44.21226095952207}, "policy_reward_max": {"shared_policy": -22.320914693177507}, "policy_reward_mean": {"shared_policy": -32.907094921116865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.34175526797038, -119.60721711036172, -90.76059381579945, -88.032172756075, -106.2944992695787, -130.70057627090796, -102.88743388756532, -114.78091265435765, -92.53140097041121, -84.97964324801468, -100.23702907495685, -98.33856366229334, -110.7465736411723, -90.88435923538972, -116.41530272617393, -79.29662196997994, -95.91624568530557, -108.44582125450673, -101.07024149891242, -73.52580210423655, -123.13534643387356, -107.60412125590055, -109.36829454446939, -102.53108573620223, -109.43264298467975, -83.33300803860031, -100.81466252046305, -101.01311001152226, -109.88489232716977, -103.22147562593878, -110.49393477981292, -95.21341222426817, -126.9595610269105, -104.46890946954895, -101.17111647754972, -101.18904542336374, -91.85295920451532, -81.02260193605974, -79.73894791088222, -80.54851057552106, -107.05588961152333, -98.71992466581712, -103.94956111698289, -98.93717757810413, -122.93133856628828, -72.80405949019061, -84.98725855271057, -116.9700806220801, -81.34023707024795, -112.96496697040733, -91.91665648419828, -86.976305096549, -89.20543822234877, -104.98511413294466, -113.829424163725, -111.65621325087659, -96.10916294515289, -96.65589535366323, -115.52099098709145, -112.18253498786773, -69.00373421595674, -95.71777902663673, -97.31804798682222, -105.46015126955497, -74.56541432297303, -79.61794423435708, -109.83093312651003, -123.50835877887894, -77.53754618321659, -90.46235261378513, -108.84385379680988, -105.45347733975356, -97.51415951733374, -78.59594234258108, -69.97020771834045, -87.15547029717763, -104.22551894109654, -110.9673973680639, -78.20581810231056, -84.47773324767604, -86.06684961969054, -113.99268493247314, -106.0376775660937, -94.10199745435979, -95.2955930817961, -95.99436141235621, -104.94309359418544, -82.73948735509448, -117.44342652345281, -82.57034245136293, -93.82501130709174, -90.0401369588838, -81.88888098872548, -84.24908485551768, -90.98951799283473, -96.51675892607624, -99.10251954443997, -116.43644190935325, -121.01820598448494, -128.41854856710245, -104.24015340598449, -109.85917420439999, -101.33777216885683, -114.56244649421687, -83.02208811240584, -71.96274407953257, -102.35751609825195, -107.52575283475112, -116.67211608668536, -118.97470152938651, -116.12640945445084, -83.58766425559786, -72.77739645411674, -94.79058278287357, -84.6269084741589, -84.17111394987002, -132.63678287856632, -110.90359045050847, -88.0764786471073, -86.52766051651804, -109.36896743387868, -109.55608687659462, -90.96601373985453, -86.2646201430692, -100.01551861001691, -97.62261124174275, -83.5646192573497, -109.12600915298339, -89.22430639936005, -85.7281175672854], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-37.11391842265678, -36.61391842265678, -35.61391842265678, -38.53573903678725, -39.53573903678725, -41.53573903678725, -30.420197938599813, -29.920197938599813, -30.420197938599813, -31.010724252024993, -27.010724252024996, -30.010724252024993, -35.93149975652625, -34.43149975652626, -35.93149975652625, -43.56685875696936, -43.56685875696936, -43.56685875696936, -34.62914462918844, -33.62914462918843, -34.62914462918844, -39.260304218119245, -37.760304218119245, -37.760304218119245, -31.17713365680373, -31.17713365680373, -30.17713365680373, -28.326547749338225, -28.326547749338225, -28.326547749338225, -33.07900969165229, -34.57900969165229, -32.57900969165229, -32.44618788743113, -32.94618788743113, -32.94618788743113, -36.91552454705745, -36.91552454705745, -36.91552454705745, -30.794786411796558, -30.794786411796558, -29.294786411796558, -38.80510090872463, -38.80510090872463, -38.80510090872463, -27.432207323326633, -24.932207323326633, -26.932207323326633, -31.97208189510188, -31.97208189510188, -31.97208189510188, -34.815273751502254, -36.81527375150225, -36.81527375150225, -33.856747166304146, -33.356747166304146, -33.856747166304146, -23.841934034745513, -24.841934034745513, -24.841934034745513, -41.045115477957836, -41.045115477957836, -41.045115477957836, -35.0347070853002, -36.0347070853002, -36.534707085300205, -36.78943151482312, -36.78943151482312, -35.78943151482312, -34.17702857873409, -34.17702857873409, -34.17702857873409, -36.47754766155991, -36.47754766155991, -36.47754766155991, -27.111002679533428, -27.611002679533428, -28.611002679533428, -33.60488750682102, -34.10488750682102, -33.10488750682102, -33.83770333717407, -33.33770333717407, -33.83770333717407, -36.628297442389936, -36.628297442389936, -36.628297442389936, -33.74049187531293, -34.74049187531293, -34.74049187531293, -37.16464492660433, -36.16464492660433, -37.16464492660433, -31.737804074756053, -31.737804074756053, -31.737804074756053, -41.819853675636836, -42.819853675636836, -42.31985367563683, -34.82296982318298, -34.82296982318298, -34.82296982318298, -33.39037215918325, -33.89037215918326, -33.89037215918326, -33.39634847445461, -33.89634847445461, -33.89634847445461, -31.450986401505105, -31.450986401505105, -28.950986401505105, -27.00753397868659, -27.00753397868659, -27.00753397868659, -26.746315970294063, -26.246315970294063, -26.746315970294063, -27.016170191840345, -26.516170191840345, -27.016170191840345, -35.518629870507766, -36.018629870507766, -35.518629870507766, -32.90664155527238, -32.90664155527238, -32.90664155527238, -35.31652037232763, -35.31652037232763, -33.31652037232763, -32.31239252603469, -33.31239252603469, -33.31239252603469, -40.977112855429425, -40.977112855429425, -40.977112855429425, -24.76801983006353, -23.26801983006353, -24.76801983006353, -28.49575285090353, -27.99575285090353, -28.49575285090353, -38.99002687402672, -38.99002687402672, -38.99002687402672, -25.44674569008264, -27.946745690082643, -27.946745690082643, -37.988322323469106, -37.988322323469106, -36.988322323469106, -30.805552161399444, -30.305552161399447, -30.805552161399444, -29.825435032182998, -29.825435032182998, -27.325435032182998, -30.23514607411623, -29.73514607411623, -29.23514607411623, -35.32837137764825, -34.32837137764825, -35.32837137764825, -38.27647472124165, -38.77647472124165, -36.77647472124164, -37.38540441695884, -36.88540441695884, -37.38540441695884, -32.369720981717656, -31.369720981717656, -32.369720981717656, -31.551965117887782, -32.55196511788778, -32.55196511788778, -38.84033032903047, -37.84033032903047, -38.84033032903047, -37.56084499595591, -37.56084499595591, -37.06084499595591, -23.001244738652247, -23.001244738652247, -23.001244738652247, -31.239259675545572, -32.23925967554557, -32.23925967554557, -33.272682662274086, -30.772682662274086, -33.272682662274086, -35.653383756518345, -34.15338375651835, -35.653383756518345, -24.8551381076577, -24.8551381076577, -24.8551381076577, -26.539314744785703, -26.539314744785703, -26.539314744785703, -36.61031104216999, -36.61031104216999, -36.61031104216999, -41.169452926293, -41.169452926293, -41.169452926293, -25.845848727738865, -25.845848727738865, -25.845848727738865, -30.154117537928368, -30.154117537928368, -30.154117537928368, -36.281284598936644, -36.281284598936644, -36.281284598936644, -35.317825779917854, -34.817825779917854, -35.317825779917854, -32.50471983911126, -32.50471983911126, -32.50471983911126, -25.531980780860366, -25.531980780860366, -27.531980780860366, -22.656735906113486, -23.656735906113486, -23.656735906113486, -27.05182343239253, -30.051823432392524, -30.051823432392524, -34.74183964703218, -34.74183964703218, -34.74183964703218, -36.98913245602128, -36.98913245602128, -36.98913245602128, -26.06860603410352, -26.06860603410352, -26.06860603410352, -27.825911082558694, -28.325911082558694, -28.325911082558694, -28.688949873230165, -28.688949873230165, -28.688949873230165, -38.16422831082437, -37.66422831082437, -38.16422831082437, -35.345892522031235, -35.845892522031235, -34.845892522031235, -31.367332484786594, -31.367332484786594, -31.367332484786594, -31.765197693932006, -31.765197693932006, -31.765197693932006, -32.9981204707854, -29.998120470785402, -32.9981204707854, -34.31436453139516, -35.31436453139516, -35.31436453139516, -27.579829118364824, -27.079829118364824, -28.079829118364824, -38.81447550781758, -39.31447550781758, -39.31447550781758, -27.523447483787653, -27.523447483787653, -27.523447483787653, -31.44167043569725, -31.44167043569725, -30.941670435697255, -30.013378986294608, -30.013378986294608, -30.013378986294608, -27.462960329575147, -27.462960329575147, -26.962960329575147, -28.24969495183923, -27.74969495183923, -28.24969495183923, -30.329839330944928, -30.329839330944928, -30.329839330944928, -32.3389196420254, -32.3389196420254, -31.838919642025406, -33.03417318148, -33.03417318148, -33.03417318148, -38.81214730311776, -38.81214730311776, -38.81214730311776, -40.33940199482831, -40.83940199482831, -39.83940199482831, -43.306182855700825, -41.806182855700825, -43.306182855700825, -35.08005113532816, -35.08005113532816, -34.08005113532816, -34.786391401466645, -37.786391401466645, -37.286391401466645, -33.77925738961895, -33.77925738961895, -33.77925738961895, -37.5208154980723, -38.5208154980723, -38.5208154980723, -27.674029370801925, -27.674029370801925, -27.674029370801925, -24.820914693177507, -22.320914693177507, -24.820914693177507, -33.452505366083976, -34.45250536608398, -34.45250536608398, -35.67525094491702, -36.17525094491702, -35.67525094491702, -39.22403869556183, -38.22403869556183, -39.22403869556183, -38.491567176462205, -40.4915671764622, -39.9915671764622, -40.54213648481694, -35.04213648481694, -40.54213648481694, -28.36255475186598, -26.86255475186598, -28.36255475186598, -23.92579881803892, -24.42579881803892, -24.42579881803892, -31.930194260957855, -31.930194260957855, -30.930194260957855, -26.875636158052977, -28.875636158052977, -28.875636158052977, -28.057037983289987, -28.057037983289987, -28.057037983289987, -44.21226095952207, -44.21226095952207, -44.21226095952207, -37.46786348350283, -37.46786348350283, -35.96786348350283, -28.692159549035747, -29.692159549035747, -29.692159549035747, -28.842553505506004, -28.842553505506004, -28.842553505506004, -36.789655811292874, -36.789655811292874, -35.78965581129288, -36.852028958864864, -35.852028958864864, -36.852028958864864, -30.3220045799515, -30.3220045799515, -30.3220045799515, -29.254873381023074, -29.254873381023074, -27.754873381023074, -33.338506203338966, -33.338506203338966, -33.338506203338966, -32.54087041391425, -32.54087041391425, -32.54087041391425, -27.85487308578322, -27.85487308578322, -27.85487308578322, -36.875336384327795, -35.375336384327795, -36.875336384327795, -29.741435466453346, -29.741435466453346, -29.741435466453346, -27.57603918909512, -29.07603918909512, -29.07603918909512]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3130400799034407, "mean_inference_ms": 1.2653399556812548, "mean_action_processing_ms": 0.06977991160632369, "mean_env_wait_ms": 0.5805732309728723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 166400, "timesteps_this_iter": 0, "agent_timesteps_total": 499200, "timers": {"sample_time_ms": 1563.184, "sample_throughput": 2047.103, "load_time_ms": 0.137, "load_throughput": 23301688.889, "learn_time_ms": 788.884, "learn_throughput": 4056.362, "update_time_ms": 1.563}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 78.76269454956055, "policy_loss": -0.0022064973088175453, "vf_loss": 78.77719573974609, "vf_explained_var": 0.024857038259506227, "kl": 0.005439522386887519, "entropy": 1.2300035119056703, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 166400, "num_agent_steps_sampled": 499200, "num_steps_trained": 166400, "num_agent_steps_trained": 499200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6650, "training_iteration": 52, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-56", "timestamp": 1718736416, "time_this_iter_s": 1.5263104438781738, "time_total_s": 80.07578492164612, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 80.07578492164612, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 38.7, "ram_util_percent": 30.35}}
{"episode_reward_max": -64.75986106017, "episode_reward_min": -169.34857074980445, "episode_reward_mean": -99.07119982479702, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -56.61619024993476}, "policy_reward_max": {"shared_policy": -20.25328702005666}, "policy_reward_mean": {"shared_policy": -33.02373327493233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.5578957704156, -96.31911638629222, -130.72954058582263, -86.49577037891332, -93.42947308868702, -121.25199925093928, -100.16576747228765, -79.23798863146865, -114.18046929534003, -113.76602276761729, -121.68958666312231, -144.51744912421577, -89.47499880678455, -112.24139526162125, -101.89299837479221, -85.64300056239287, -113.63465162328478, -86.75048802501632, -94.45605771432027, -75.84492330966611, -87.2090799324294, -76.2579610763553, -98.2049001596411, -84.82020009100475, -96.70843371259477, -101.14308299640672, -114.13178877336259, -114.93904296540678, -100.82710917347431, -93.88944681326578, -75.09221455097118, -71.73468202071939, -79.66339598472754, -133.07319937269278, -104.77394573294684, -101.86616842832447, -87.33525248687641, -92.12794523213289, -92.23940584467724, -103.92651586406916, -103.31933789203313, -84.24471756740843, -127.49449064196622, -101.49744193144186, -105.44830261143036, -121.35705425646552, -79.10626127025145, -105.65617307809839, -72.22846837370896, -90.18423464524268, -107.35405631766551, -113.71800335063911, -80.52980574552669, -108.42249413072672, -87.03416722179445, -169.34857074980445, -116.8657214543933, -103.226344806505, -98.6139405183093, -104.20686585969813, -76.54125126183165, -97.92665839273454, -139.2809917346695, -90.74729556173735, -85.05929401890525, -95.60796995672956, -84.75573197483627, -80.59559277199273, -101.64392689280938, -147.9729329484695, -97.44234323270199, -112.60368598883822, -89.38522082013185, -110.00231051576833, -91.80380762614674, -140.43418907160085, -114.67196060814933, -90.10707573835109, -111.06077348975565, -102.34421140980429, -91.99701321148554, -92.78457295253752, -85.31146358055646, -94.22979438256476, -108.02523274282618, -93.05360670942106, -99.29014800961735, -90.82298425157691, -113.86951285843328, -114.31247126898725, -102.2711103509912, -102.92768117948464, -96.40738212860305, -106.6128034858667, -94.58000361517661, -73.2964199070465, -88.3021377939542, -86.41058083352435, -83.08464691785437, -117.84754089029664, -89.04048795741294, -78.2147856438695, -96.65901215809144, -105.47669829683957, -101.46824408946075, -100.52753997417767, -89.30599919210245, -89.19991906279702, -95.35996600158883, -93.74220080764546, -118.56691122370593, -140.97484553152697, -113.2203805260713, -92.53007143418934, -89.94576551026107, -93.85542481400518, -102.51754146621694, -114.77032909090471, -73.08763553514005, -89.85287086619456, -92.7390157518677, -74.54771036652461, -85.67849927808605, -76.80082230242773, -80.09270111042014, -112.54047579260545, -64.75986106017, -103.39397174044115, -77.82950478442616, -103.03263803948336], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-30.85263192347187, -30.85263192347187, -30.85263192347187, -32.10637212876408, -32.10637212876408, -32.10637212876408, -44.24318019527422, -44.24318019527422, -42.24318019527422, -28.99859012630444, -28.99859012630444, -28.49859012630444, -31.30982436289566, -31.30982436289566, -30.80982436289566, -41.417333083646426, -38.417333083646426, -41.417333083646426, -31.721922490762545, -34.221922490762545, -34.221922490762545, -25.745996210489565, -26.745996210489572, -26.745996210489572, -39.06015643178002, -39.06015643178002, -36.06015643178002, -37.7553409225391, -37.7553409225391, -38.2553409225391, -39.896528887707476, -40.89652888770748, -40.89652888770748, -49.005816374738586, -49.005816374738586, -46.505816374738586, -29.991666268928192, -29.991666268928192, -29.491666268928192, -37.413798420540395, -37.413798420540395, -37.413798420540395, -34.13099945826408, -34.13099945826408, -33.63099945826408, -27.047666854130956, -29.047666854130956, -29.547666854130956, -38.378217207761544, -37.378217207761544, -37.878217207761544, -29.0834960083388, -29.0834960083388, -28.5834960083388, -31.818685904773435, -31.818685904773435, -30.818685904773435, -25.4483077698887, -25.4483077698887, -24.9483077698887, -29.403026644143125, -29.403026644143125, -28.403026644143125, -26.08598702545176, -26.08598702545176, -24.08598702545176, -32.734966719880376, -32.734966719880376, -32.734966719880376, -28.273400030334933, -28.273400030334933, -28.273400030334933, -32.4028112375316, -31.902811237531605, -32.4028112375316, -34.214360998802235, -34.214360998802235, -32.714360998802235, -37.377262924454186, -38.377262924454186, -38.377262924454186, -36.979680988468914, -38.979680988468914, -38.979680988468914, -32.60903639115812, -34.10903639115813, -34.10903639115813, -31.2964822710886, -31.2964822710886, -31.2964822710886, -25.197404850323704, -24.697404850323704, -25.197404850323704, -24.24489400690647, -24.24489400690647, -23.24489400690647, -26.55446532824253, -26.05446532824253, -27.05446532824253, -42.52439979089761, -45.02439979089761, -45.52439979089761, -35.75798191098228, -34.257981910982274, -34.757981910982274, -34.455389476108145, -32.95538947610815, -34.455389476108145, -30.11175082895882, -29.11175082895881, -28.11175082895881, -29.70931507737763, -31.20931507737763, -31.20931507737763, -30.746468614892418, -30.746468614892418, -30.746468614892418, -34.64217195468974, -34.64217195468974, -34.64217195468974, -34.439779297344394, -34.439779297344394, -34.439779297344394, -28.08157252246947, -28.08157252246947, -28.08157252246947, -41.83149688065539, -42.83149688065539, -42.83149688065539, -33.4991473104806, -33.9991473104806, -33.9991473104806, -34.316100870476795, -35.816100870476795, -35.316100870476795, -40.952351418821856, -39.452351418821856, -40.952351418821856, -26.368753756750472, -26.368753756750472, -26.368753756750472, -34.71872435936614, -35.21872435936614, -35.71872435936614, -24.07615612456965, -24.07615612456965, -24.07615612456965, -30.061411548414238, -30.061411548414238, -30.061411548414238, -36.28468543922183, -34.78468543922183, -36.28468543922183, -38.906001116879715, -35.906001116879715, -38.906001116879715, -27.67660191517558, -24.67660191517558, -28.17660191517558, -36.974164710242256, -34.47416471024225, -36.974164710242256, -28.678055740598147, -29.678055740598147, -28.678055740598147, -56.11619024993476, -56.61619024993476, -56.61619024993476, -39.62190715146445, -37.62190715146445, -39.62190715146445, -33.07544826883501, -35.07544826883502, -35.07544826883502, -32.87131350610311, -32.87131350610311, -32.87131350610311, -34.73562195323271, -34.73562195323271, -34.73562195323271, -25.51375042061055, -25.51375042061055, -25.51375042061055, -32.642219464244846, -32.642219464244846, -32.642219464244846, -44.92699724488983, -47.42699724488983, -46.92699724488983, -28.915765187245785, -30.915765187245785, -30.915765187245785, -28.186431339635078, -28.686431339635078, -28.186431339635078, -31.535989985576535, -32.035989985576535, -32.035989985576535, -28.41857732494541, -27.91857732494541, -28.41857732494541, -25.865197590664238, -27.365197590664238, -27.365197590664238, -33.881308964269806, -33.881308964269806, -33.881308964269806, -48.6576443161565, -49.6576443161565, -49.6576443161565, -32.480781077567315, -32.480781077567315, -32.480781077567315, -37.36789532961273, -36.86789532961273, -38.36789532961273, -29.795073606710623, -29.795073606710623, -29.795073606710623, -37.50077017192278, -36.00077017192278, -36.50077017192278, -30.60126920871558, -30.60126920871558, -30.60126920871558, -47.47806302386695, -46.97806302386695, -45.97806302386695, -38.72398686938311, -38.72398686938311, -37.22398686938311, -30.03569191278368, -30.03569191278368, -30.03569191278368, -37.35359116325188, -37.35359116325188, -36.353591163251885, -33.78140380326809, -34.28140380326809, -34.28140380326809, -30.83233773716184, -30.83233773716184, -30.33233773716184, -31.76152431751251, -31.76152431751251, -29.26152431751251, -27.770487860185472, -28.770487860185472, -28.770487860185472, -32.076598127521585, -30.07659812752158, -32.076598127521585, -36.17507758094208, -36.67507758094208, -35.17507758094208, -31.351202236473682, -31.351202236473682, -30.351202236473682, -32.76338266987246, -33.26338266987246, -33.26338266987246, -31.107661417192297, -28.607661417192297, -31.107661417192297, -38.28983761947778, -38.78983761947778, -36.78983761947779, -38.60415708966241, -37.10415708966241, -38.60415708966241, -34.757036783663715, -33.757036783663715, -33.757036783663715, -33.975893726494846, -34.475893726494846, -34.475893726494846, -31.469127376201033, -32.46912737620103, -32.46912737620103, -35.204267828622235, -36.20426782862224, -35.204267828622235, -31.526667871725543, -31.526667871725543, -31.526667871725543, -23.76547330234882, -24.76547330234882, -24.76547330234882, -28.100712597984728, -30.100712597984728, -30.100712597984728, -28.970193611174786, -29.470193611174786, -27.970193611174786, -28.028215639284785, -27.028215639284785, -28.028215639284785, -39.282513630098855, -39.282513630098855, -39.282513630098855, -30.680162652470987, -28.680162652470987, -29.680162652470987, -26.571595214623155, -25.071595214623155, -26.571595214623155, -30.886337386030473, -31.886337386030473, -33.88633738603047, -35.15889943227987, -35.15889943227987, -35.15889943227987, -33.48941469648694, -33.98941469648694, -33.989414696486925, -33.50917999139254, -33.50917999139254, -33.50917999139254, -29.768666397367483, -29.768666397367483, -29.768666397367483, -29.23330635426566, -30.23330635426566, -29.73330635426566, -31.786655333862964, -31.786655333862964, -31.786655333862964, -31.414066935881788, -29.914066935881788, -32.41406693588179, -39.52230374123532, -39.52230374123532, -39.52230374123532, -44.324948510509, -48.324948510509, -48.324948510509, -37.74012684202376, -37.74012684202376, -37.74012684202376, -31.176690478063136, -31.176690478063136, -30.176690478063136, -29.98192183675369, -29.98192183675369, -29.98192183675369, -31.11847493800171, -32.11847493800172, -30.61847493800171, -33.172513822072325, -34.17251382207233, -35.17251382207233, -38.256776363634906, -38.256776363634906, -38.256776363634906, -23.695878511713364, -24.695878511713364, -24.695878511713364, -30.117623622064865, -30.117623622064865, -29.617623622064865, -32.079671917289225, -29.079671917289225, -31.579671917289225, -25.68257012217488, -23.18257012217488, -25.68257012217488, -28.89283309269534, -28.89283309269534, -27.89283309269534, -26.266940767475898, -25.766940767475898, -24.766940767475898, -27.530900370140042, -26.030900370140042, -26.530900370140042, -38.18015859753511, -38.18015859753511, -36.18015859753511, -22.25328702005666, -20.25328702005666, -22.25328702005666, -34.46465724681372, -34.46465724681372, -34.46465724681372, -26.27650159480872, -26.27650159480872, -25.27650159480872, -35.51087934649445, -32.01087934649444, -35.51087934649445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3136569251359672, "mean_inference_ms": 1.2675732052640374, "mean_action_processing_ms": 0.06988051645978288, "mean_env_wait_ms": 0.5814606426080002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 169600, "timesteps_this_iter": 0, "agent_timesteps_total": 508800, "timers": {"sample_time_ms": 1567.358, "sample_throughput": 2041.652, "load_time_ms": 0.137, "load_throughput": 23366596.1, "learn_time_ms": 787.551, "learn_throughput": 4063.23, "update_time_ms": 1.559}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 79.6826271057129, "policy_loss": -0.002708110776962691, "vf_loss": 79.69761352539062, "vf_explained_var": 0.015516352653503419, "kl": 0.00533960662668761, "entropy": 1.227755057811737, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 169600, "num_agent_steps_sampled": 508800, "num_steps_trained": 169600, "num_agent_steps_trained": 508800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6780, "training_iteration": 53, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-46-58", "timestamp": 1718736418, "time_this_iter_s": 1.597508430480957, "time_total_s": 81.67329335212708, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 81.67329335212708, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 42.05, "ram_util_percent": 30.4}}
{"episode_reward_max": -62.72510306762576, "episode_reward_min": -135.65556644914653, "episode_reward_mean": -94.21174411745396, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -45.385188816382176}, "policy_reward_max": {"shared_policy": -18.575034355875253}, "policy_reward_mean": {"shared_policy": -31.403914705817993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-75.18568189248323, -85.81728097748261, -99.1591568973363, -111.17787264518248, -105.87561970648784, -87.82845160034185, -86.71715177941756, -78.88574153160133, -103.4383431551496, -93.60127574687301, -105.1016440942603, -111.1449052067879, -78.71311000672225, -95.97955252424023, -87.90777217809553, -93.66770580634183, -93.86561829072708, -73.27001135119514, -92.2542015826995, -84.22265447795162, -87.24988785606202, -77.58246638973465, -119.42015062450461, -83.14122173498336, -84.450205852081, -98.79942572139811, -89.60533921771241, -94.1282176147397, -100.39757454623826, -77.24499918645554, -85.9930629120244, -105.32527307344513, -84.3609035045879, -107.2724045934512, -119.81240836206706, -97.36885452194365, -62.80791951769323, -80.34278520859222, -87.00759903535346, -94.3161753542508, -89.13635452245147, -76.04897804558959, -82.06016429908624, -103.48108791266036, -100.37512120738805, -83.57804192848955, -96.45675591857221, -109.4054583059309, -115.55618894059579, -91.97073811123624, -97.52196840108401, -88.93703363492251, -76.00647911352827, -105.40464804835351, -85.24708552566301, -87.36373233126592, -113.69303819668423, -106.65250162788661, -91.59625185699466, -77.74008103140548, -108.3215683646783, -87.5043171413985, -92.39140919231814, -83.39565867145238, -117.69930475371788, -123.76607529139582, -94.9828816900095, -94.36720024540946, -90.71522632375554, -92.19286000064508, -117.98187707244536, -101.55483841611249, -108.46483213830028, -85.45584293463374, -118.07503063323476, -82.84629086174324, -108.64221476124581, -62.72510306762576, -120.69496604557513, -64.7076243277366, -89.34899163836212, -90.14844530191768, -91.13812477975456, -103.09204134840738, -77.76978313244022, -85.39840507947754, -100.82359855566173, -108.27817953525545, -102.55348096873303, -86.37291928593986, -104.57887876968242, -75.66716418229328, -125.31650386759273, -68.82563515128487, -102.99566766633548, -100.54257851712359, -100.32444114181268, -124.90196592579598, -81.8924013969811, -80.11789596091916, -75.70409251198957, -97.0165388390469, -70.96823643064731, -80.84712302129711, -89.7119178035725, -109.55683827999272, -119.43227126872617, -135.65556644914653, -93.76169166823271, -95.47855472172085, -104.01444137165556, -79.50233099737132, -68.45524838438178, -105.30728118868741, -109.10247427119225, -112.32084814451089, -73.34628634947205, -105.17181719628947, -68.75523697939951, -95.08617466892234, -117.92897739033472, -90.50279268939099, -85.16171107885826, -106.33485521825541, -66.36665928010652, -83.01392927401977, -99.37036095209028, -102.04502528741672, -114.24801576349714, -78.11487841110174], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-25.89522729749441, -24.89522729749442, -24.39522729749441, -28.60576032582753, -28.60576032582753, -28.60576032582753, -34.053052299112096, -34.053052299112096, -31.0530522991121, -37.059290881727506, -37.059290881727506, -37.059290881727506, -35.9585399021626, -35.9585399021626, -33.958539902162606, -29.942817200113943, -27.94281720011394, -29.942817200113943, -28.905717259805826, -28.905717259805826, -28.905717259805826, -26.461913843867123, -25.961913843867123, -26.461913843867123, -34.47944771838318, -34.47944771838318, -34.47944771838318, -31.700425248957657, -30.200425248957657, -31.700425248957657, -35.03388136475343, -35.03388136475343, -35.03388136475343, -37.71496840226263, -37.71496840226263, -35.71496840226263, -26.571036668907414, -26.571036668907414, -25.571036668907414, -31.993184174746734, -31.993184174746734, -31.993184174746734, -29.30259072603184, -28.80259072603184, -29.80259072603184, -31.055901935447285, -31.555901935447285, -31.055901935447285, -31.28853943024236, -31.28853943024236, -31.28853943024236, -23.423337117065042, -24.923337117065042, -24.923337117065042, -30.751400527566506, -30.751400527566506, -30.751400527566506, -29.0742181593172, -26.5742181593172, -28.5742181593172, -28.41662928535397, -29.41662928535397, -29.416629285353977, -25.860822129911558, -25.860822129911558, -25.860822129911558, -40.47338354150155, -38.47338354150155, -40.47338354150155, -27.047073911661116, -28.047073911661116, -28.047073911661116, -28.150068617360326, -28.150068617360326, -28.150068617360326, -33.43314190713269, -31.933141907132693, -33.43314190713269, -30.035113072570798, -30.035113072570798, -29.535113072570798, -31.542739204913236, -31.042739204913236, -31.542739204913236, -33.799191515412744, -33.799191515412744, -32.799191515412744, -25.08166639548517, -26.08166639548517, -26.08166639548517, -28.164354304008135, -29.664354304008135, -28.164354304008135, -35.9417576911484, -33.9417576911484, -35.4417576911484, -28.12030116819596, -29.12030116819596, -27.12030116819596, -34.92413486448375, -36.42413486448375, -35.92413486448375, -39.27080278735568, -40.27080278735568, -40.27080278735568, -32.456284840647896, -32.456284840647896, -32.456284840647896, -20.602639839231067, -21.102639839231067, -21.102639839231067, -26.780928402864046, -26.780928402864046, -26.780928402864046, -29.502533011784468, -28.002533011784468, -29.502533011784468, -31.10539178475026, -31.60539178475026, -31.60539178475026, -29.712118174150483, -29.712118174150483, -29.712118174150483, -25.349659348529872, -25.349659348529872, -25.349659348529872, -27.520054766362104, -27.020054766362104, -27.520054766362104, -34.493695970886776, -34.493695970886776, -34.493695970886776, -34.12504040246267, -34.12504040246267, -32.12504040246267, -28.859347309496506, -28.859347309496506, -25.859347309496503, -31.485585306190718, -32.48558530619072, -32.48558530619072, -37.135152768643636, -35.135152768643636, -37.135152768643636, -38.518729646865296, -38.518729646865296, -38.518729646865296, -31.156912703745387, -30.156912703745387, -30.656912703745387, -31.507322800361326, -33.50732280036132, -32.50732280036132, -28.97901121164084, -29.97901121164084, -29.97901121164084, -25.335493037842774, -25.335493037842774, -25.335493037842774, -35.13488268278452, -35.13488268278452, -35.13488268278452, -28.24902850855434, -27.74902850855434, -29.24902850855434, -29.62124411042195, -28.121244110421955, -29.62124411042195, -37.39767939889475, -36.89767939889475, -39.39767939889475, -36.55083387596224, -36.05083387596224, -34.05083387596224, -30.865417285664876, -29.865417285664876, -30.865417285664876, -26.080027010468502, -26.080027010468502, -25.580027010468502, -36.107189454892776, -36.107189454892776, -36.107189454892776, -27.168105713799516, -29.66810571379952, -30.66810571379952, -30.797136397439388, -30.797136397439388, -30.797136397439388, -28.131886223817467, -28.131886223817467, -27.131886223817467, -39.23310158457264, -39.23310158457264, -39.23310158457264, -41.08869176379861, -41.58869176379861, -41.08869176379861, -31.32762723000316, -32.82762723000316, -30.82762723000316, -30.789066748469857, -31.289066748469857, -32.28906674846986, -30.238408774585196, -30.238408774585196, -30.238408774585196, -29.73095333354837, -31.23095333354837, -31.23095333354837, -39.327292357481795, -40.327292357481795, -38.327292357481795, -35.01827947203747, -32.01827947203747, -34.51827947203747, -33.65494404610012, -37.15494404610011, -37.65494404610011, -29.151947644877904, -28.151947644877904, -28.15194764487791, -39.35834354441162, -39.35834354441162, -39.35834354441162, -27.2820969539144, -27.7820969539144, -27.7820969539144, -36.88073825374861, -36.88073825374861, -34.88073825374861, -18.575034355875253, -22.075034355875253, -22.075034355875253, -41.89832201519171, -40.39832201519171, -38.39832201519171, -21.569208109245533, -21.569208109245533, -21.569208109245533, -29.78299721278738, -29.78299721278738, -29.78299721278738, -30.04948176730588, -30.04948176730588, -30.04948176730588, -31.046041593251548, -30.046041593251548, -30.046041593251548, -34.86401378280244, -33.36401378280243, -34.86401378280244, -26.423261044146738, -24.923261044146738, -26.423261044146738, -28.966135026492484, -28.466135026492484, -27.966135026492484, -32.60786618522059, -34.10786618522059, -34.10786618522059, -36.09272651175182, -36.09272651175182, -36.09272651175182, -34.851160322910985, -33.851160322910985, -33.851160322910985, -28.79097309531331, -28.79097309531331, -28.79097309531331, -33.19295958989414, -35.19295958989413, -36.19295958989414, -24.555721394097755, -25.555721394097755, -25.555721394097755, -40.438834622530905, -42.4388346225309, -42.4388346225309, -23.608545050428287, -23.608545050428287, -21.608545050428287, -31.33188922211184, -35.83188922211184, -35.83188922211184, -34.014192839041165, -32.514192839041165, -34.014192839041165, -32.4414803806042, -33.9414803806042, -33.9414803806042, -41.46732197526535, -41.46732197526535, -41.96732197526536, -26.964133798993693, -27.964133798993693, -26.964133798993693, -26.03929865363972, -27.03929865363972, -27.03929865363972, -25.23469750399653, -25.23469750399653, -25.23469750399653, -31.00551294634896, -33.005512946348965, -33.005512946348965, -23.989412143549103, -23.489412143549103, -23.489412143549103, -27.115707673765716, -26.615707673765716, -27.115707673765716, -30.237305934524183, -30.237305934524183, -29.237305934524183, -35.5189460933309, -37.018946093330904, -37.018946093330904, -38.8107570895754, -40.3107570895754, -40.3107570895754, -45.385188816382176, -45.385188816382176, -44.885188816382176, -30.087230556077557, -32.08723055607756, -31.587230556077557, -32.49285157390696, -30.492851573906965, -32.49285157390696, -35.00481379055184, -34.00481379055184, -35.00481379055184, -26.50077699912378, -26.50077699912378, -26.50077699912378, -22.81841612812725, -22.81841612812725, -22.81841612812725, -34.76909372956249, -35.269093729562485, -35.269093729562485, -36.367491423730726, -36.367491423730726, -36.367491423730726, -37.106949381503625, -38.606949381503625, -36.606949381503625, -24.448762116490666, -24.448762116490666, -24.448762116490666, -34.22393906542981, -35.22393906542981, -35.72393906542981, -22.251745659799838, -23.251745659799838, -23.251745659799838, -31.86205822297414, -31.36205822297414, -31.86205822297414, -40.14299246344493, -38.64299246344494, -39.14299246344493, -30.334264229797, -29.834264229797, -30.334264229797, -27.387237026286083, -28.887237026286083, -28.887237026286083, -35.77828507275179, -35.27828507275181, -35.27828507275179, -22.12221976003552, -22.12221976003552, -22.12221976003552, -27.83797642467326, -26.33797642467326, -28.83797642467326, -33.12345365069675, -33.12345365069675, -33.12345365069675, -34.848341762472245, -32.348341762472245, -34.848341762472245, -38.08267192116569, -38.08267192116569, -38.08267192116569, -26.038292803700585, -25.038292803700585, -27.038292803700585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31341866937529944, "mean_inference_ms": 1.2666024693211544, "mean_action_processing_ms": 0.06982256614129223, "mean_env_wait_ms": 0.58095832505951, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 172800, "timesteps_this_iter": 0, "agent_timesteps_total": 518400, "timers": {"sample_time_ms": 1567.119, "sample_throughput": 2041.963, "load_time_ms": 0.138, "load_throughput": 23237141.274, "learn_time_ms": 787.0, "learn_throughput": 4066.074, "update_time_ms": 1.527}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 67.93833923339844, "policy_loss": -0.0033984378807945135, "vf_loss": 67.95405502319336, "vf_explained_var": 0.03821712136268616, "kl": 0.007591420205352811, "entropy": 1.2320488929748534, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172800, "num_agent_steps_sampled": 518400, "num_steps_trained": 172800, "num_agent_steps_trained": 518400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6910, "training_iteration": 54, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-00", "timestamp": 1718736420, "time_this_iter_s": 1.5072212219238281, "time_total_s": 83.1805145740509, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219bca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 83.1805145740509, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 38.2, "ram_util_percent": 30.4}}
{"episode_reward_max": -62.291956899757274, "episode_reward_min": -153.64601368638696, "episode_reward_mean": -99.07062482135723, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -51.54867122879562}, "policy_reward_max": {"shared_policy": -20.72938197743803}, "policy_reward_mean": {"shared_policy": -33.02354160711908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-99.34445653839491, -75.55110238872913, -69.79983243898347, -93.83997336765364, -80.33182600771397, -102.54414721671878, -108.47945395017668, -106.11567497075562, -106.70728367550768, -125.09292431979667, -111.76264274356201, -93.52049743965492, -83.4717293823181, -112.10272619516371, -97.222545172375, -85.50774782262836, -114.02272484588751, -106.14489137623146, -124.3131671830885, -101.56884403349781, -81.57558204502192, -144.83064656900407, -101.6230823199959, -113.77812455217409, -101.93299348534255, -86.47691829981743, -79.0379437602671, -73.03962104438503, -112.03693235025396, -73.9637794944657, -153.64601368638696, -85.35692379290315, -91.16049261202397, -107.84382606423596, -117.98953559883381, -69.5515538797625, -96.03729761119706, -76.1675334642198, -91.34736336352128, -87.93248242100054, -103.56859063145133, -138.38482445365148, -104.72054515263397, -79.82314081606074, -89.91786347891029, -89.80132218745997, -103.56384929075476, -104.58300591248369, -111.35216726019411, -100.13719946338908, -129.36650657685212, -106.09874272239333, -98.00536861427257, -101.21279643487333, -78.12253898625917, -89.73184374994734, -95.12319743422925, -88.9967883328275, -105.04266632028137, -100.6483922526513, -87.80490488435007, -98.57997184114214, -113.16782070159616, -126.11774985109257, -70.07343145628866, -106.54607156567549, -89.79154573126047, -91.53552278219028, -86.52684244390821, -88.7352484166402, -96.83148992324881, -89.27822816050805, -88.37904589190575, -110.3827202343126, -69.96269165222806, -91.8487705909635, -99.96713708227131, -98.64517212537422, -82.38347267372995, -97.78527881636346, -96.63447593314606, -116.64995840495055, -127.57259661787359, -105.29666970663881, -70.66888154602307, -82.82876233294807, -112.80978579899836, -81.55660361598835, -112.4159419532409, -77.07684250678267, -91.6713449601887, -95.68833786900471, -128.3042349286495, -107.55053251874848, -81.72100812852015, -117.9150079113159, -113.04716714060915, -105.93557915805562, -78.27903900678072, -118.51333119932644, -128.1299916397417, -80.70196578985237, -98.88973911518227, -95.05535046585285, -112.53789028520119, -134.43509422131396, -85.19119362252, -81.62441417915372, -129.62429284977068, -104.60129628691504, -120.67627399607188, -113.51582265594801, -99.69962054048803, -62.291956899757274, -89.93416842056088, -63.188145932314086, -92.78874265835003, -70.76295175553672, -141.25691278618, -110.86175662875672, -107.92397704000412, -107.25404598273651, -105.08417749652882, -82.84289714647885, -93.56852911933024, -97.34262493180381, -117.40653232882555, -89.88326572384895, -102.22802631900072, -92.42616434034801], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.114818846131634, -33.114818846131634, -33.114818846131634, -24.183700796243027, -25.683700796243027, -25.683700796243027, -22.933277479661164, -23.433277479661164, -23.433277479661164, -31.279991122551206, -31.279991122551206, -31.279991122551206, -26.77727533590465, -26.77727533590465, -26.77727533590465, -34.181382405572926, -34.181382405572926, -34.181382405572926, -35.993151316725545, -35.493151316725545, -36.993151316725545, -35.0385583235852, -35.5385583235852, -35.5385583235852, -35.56909455850254, -35.56909455850254, -35.56909455850254, -42.030974773265584, -42.030974773265584, -41.030974773265584, -37.254214247854, -37.254214247854, -37.254214247854, -31.673499146551624, -30.173499146551624, -31.673499146551624, -27.82390979410605, -27.82390979410605, -27.82390979410605, -37.36757539838794, -37.36757539838794, -37.36757539838794, -32.407515057458326, -32.407515057458326, -32.407515057458326, -29.0025826075428, -27.5025826075428, -29.0025826075428, -38.340908281962456, -37.840908281962456, -37.840908281962456, -35.38163045874385, -35.38163045874385, -35.38163045874385, -41.93772239436282, -42.93772239436282, -39.43772239436282, -34.189614677832594, -34.189614677832594, -33.189614677832594, -27.19186068167397, -27.19186068167397, -27.19186068167397, -47.94354885633473, -48.44354885633473, -48.44354885633473, -34.20769410666529, -34.70769410666529, -32.70769410666529, -37.92604151739137, -37.92604151739137, -37.92604151739137, -34.97766449511418, -31.977664495114187, -34.97766449511418, -28.82563943327249, -28.82563943327249, -28.82563943327249, -26.012647920089044, -26.512647920089044, -26.512647920089044, -24.846540348128347, -24.846540348128347, -23.346540348128347, -36.01231078341797, -38.01231078341798, -38.01231078341798, -24.98792649815521, -23.98792649815521, -24.98792649815521, -51.04867122879562, -51.04867122879562, -51.54867122879562, -27.45230793096772, -28.95230793096772, -28.95230793096772, -30.386830870674654, -30.386830870674654, -30.386830870674654, -36.781275354745304, -36.781275354745304, -34.281275354745304, -39.32984519961129, -39.32984519961129, -39.32984519961129, -23.183851293254165, -23.183851293254165, -23.183851293254165, -32.01243253706568, -32.01243253706568, -32.01243253706568, -25.389177821406594, -25.389177821406594, -25.389177821406594, -30.44912112117374, -30.44912112117374, -30.44912112117374, -29.310827473666844, -29.310827473666844, -29.310827473666844, -33.5228635438171, -35.02286354381711, -35.02286354381711, -47.12827481788383, -44.12827481788383, -47.12827481788383, -34.24018171754466, -36.24018171754466, -34.24018171754466, -26.607713605353595, -26.607713605353595, -26.607713605353595, -29.3059544929701, -30.3059544929701, -30.3059544929701, -30.10044072915332, -29.60044072915332, -30.10044072915332, -34.52128309691827, -34.52128309691827, -34.52128309691827, -34.194335304161214, -35.194335304161214, -35.194335304161214, -37.11738908673138, -37.11738908673138, -37.11738908673138, -33.87906648779635, -33.37906648779635, -32.87906648779635, -43.78883552561735, -43.78883552561735, -41.78883552561735, -35.53291424079778, -35.53291424079778, -35.03291424079778, -32.83512287142417, -32.33512287142417, -32.83512287142417, -33.73759881162443, -33.73759881162443, -33.73759881162443, -26.040846328753034, -26.040846328753034, -26.040846328753034, -30.243947916649123, -30.243947916649123, -29.243947916649123, -31.707732478076387, -31.707732478076387, -31.707732478076387, -29.998929444275813, -28.998929444275813, -29.998929444275813, -35.68088877342712, -35.68088877342712, -33.68088877342712, -33.88279741755042, -34.88279741755042, -31.882797417550425, -29.601634961450042, -29.601634961450042, -28.601634961450042, -32.85999061371406, -32.85999061371406, -32.85999061371406, -37.38927356719872, -37.38927356719872, -38.38927356719872, -42.705916617030844, -41.205916617030844, -42.205916617030844, -23.357810485429557, -23.357810485429557, -23.357810485429557, -35.51535718855851, -35.51535718855851, -35.51535718855851, -29.9305152437535, -29.9305152437535, -29.9305152437535, -30.51184092739677, -30.51184092739677, -30.51184092739677, -28.842280814636062, -28.842280814636062, -28.842280814636062, -29.578416138880062, -29.578416138880062, -29.578416138880062, -32.27716330774961, -32.27716330774961, -32.27716330774961, -31.09274272016935, -31.09274272016935, -27.09274272016935, -29.62634863063526, -29.62634863063526, -29.12634863063526, -37.294240078104224, -37.294240078104224, -35.794240078104224, -22.65423055074268, -24.15423055074268, -23.15423055074268, -30.616256863654485, -30.616256863654485, -30.616256863654485, -33.65571236075711, -33.65571236075711, -32.65571236075711, -32.2150573751247, -33.2150573751247, -33.2150573751247, -27.627824224576646, -27.127824224576646, -27.627824224576646, -32.59509293878783, -32.59509293878783, -32.59509293878783, -31.711491977715365, -32.21149197771537, -32.71149197771537, -38.88331946831686, -38.88331946831686, -38.88331946831686, -41.85753220595787, -42.85753220595787, -42.85753220595787, -36.09888990221292, -33.098889902212925, -36.09888990221292, -23.556293848674365, -24.056293848674365, -23.056293848674365, -26.94292077764935, -27.94292077764935, -27.94292077764935, -37.60326193299949, -37.60326193299949, -37.60326193299949, -27.18553453866278, -27.18553453866278, -27.18553453866278, -36.47198065108031, -37.9719806510803, -37.9719806510803, -25.358947502260875, -25.85894750226088, -25.85894750226088, -30.223781653396234, -30.723781653396234, -30.723781653396234, -32.39611262300156, -31.396112623001553, -31.896112623001553, -42.76807830954984, -42.76807830954984, -42.76807830954984, -35.850177506249516, -35.850177506249516, -35.850177506249516, -27.740336042840063, -26.240336042840063, -27.740336042840063, -40.138335970438646, -40.138335970438646, -37.63833597043865, -37.6823890468697, -37.6823890468697, -37.6823890468697, -35.64519305268519, -35.64519305268519, -34.64519305268519, -26.759679668926918, -25.759679668926918, -25.759679668926918, -39.50444373310882, -39.50444373310882, -39.50444373310882, -42.70999721324722, -42.70999721324722, -42.70999721324722, -26.90065526328412, -25.900655263284126, -27.90065526328412, -32.79657970506074, -33.79657970506074, -32.29657970506074, -32.01845015528429, -32.01845015528429, -31.01845015528429, -36.17929676173375, -38.17929676173375, -38.17929676173375, -45.64503140710466, -43.14503140710466, -45.64503140710466, -28.39706454083999, -28.39706454083999, -28.39706454083999, -27.208138059717903, -27.208138059717903, -27.208138059717903, -43.20809761659024, -43.20809761659024, -43.20809761659024, -34.20043209563832, -35.70043209563832, -34.70043209563832, -40.2254246653573, -40.2254246653573, -40.2254246653573, -38.671940885315976, -36.171940885315976, -38.671940885315976, -32.56654018016267, -33.56654018016267, -33.56654018016267, -20.76398563325244, -20.76398563325244, -20.76398563325244, -30.644722806853622, -28.644722806853622, -30.644722806853622, -20.72938197743803, -21.22938197743803, -21.22938197743803, -30.92958088611669, -30.92958088611669, -30.92958088611669, -23.25431725184557, -23.75431725184557, -23.75431725184557, -47.08563759539335, -47.08563759539335, -47.08563759539335, -36.95391887625225, -36.95391887625225, -36.95391887625225, -36.30799234666803, -35.30799234666802, -36.30799234666803, -35.084681994245514, -36.084681994245514, -36.084681994245514, -35.86139249884296, -33.86139249884296, -35.36139249884296, -28.11429904882628, -26.61429904882628, -28.11429904882628, -31.18950970644339, -31.18950970644339, -31.18950970644339, -32.78087497726792, -31.780874977267924, -32.78087497726792, -38.135510776275154, -39.635510776275154, -39.635510776275154, -29.961088574616326, -29.961088574616326, -29.961088574616326, -33.7426754396669, -34.2426754396669, -34.2426754396669, -30.475388113449338, -30.975388113449338, -30.975388113449338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3134105945268779, "mean_inference_ms": 1.2667870089436288, "mean_action_processing_ms": 0.0698342850774359, "mean_env_wait_ms": 0.5809801843015857, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 176000, "timesteps_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"sample_time_ms": 1567.933, "sample_throughput": 2040.903, "load_time_ms": 0.134, "load_throughput": 23810134.469, "learn_time_ms": 786.532, "learn_throughput": 4068.495, "update_time_ms": 1.513}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 78.66460723876953, "policy_loss": -0.0032993716367831103, "vf_loss": 78.68030471801758, "vf_explained_var": 0.020362609624862672, "kl": 0.005691652823283477, "entropy": 1.2396265149116517, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176000, "num_agent_steps_sampled": 528000, "num_steps_trained": 176000, "num_agent_steps_trained": 528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7040, "training_iteration": 55, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-01", "timestamp": 1718736421, "time_this_iter_s": 1.5133726596832275, "time_total_s": 84.69388723373413, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219b8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 84.69388723373413, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 39.75, "ram_util_percent": 30.3}}
{"episode_reward_max": -64.45852324574831, "episode_reward_min": -137.34891974466112, "episode_reward_mean": -95.7809867844192, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -45.877813346268404}, "policy_reward_max": {"shared_policy": -21.436787175913324}, "policy_reward_mean": {"shared_policy": -31.9269955948064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.51515886801879, -69.65427276238879, -99.02896521422898, -95.65440989960801, -101.59384539537105, -102.43315452457881, -92.66248547028593, -83.79582460556918, -88.1340156715297, -111.37688757424624, -117.28792350651605, -90.83385325246336, -107.63024566355323, -67.57686262577923, -84.22362265015164, -99.36479578427857, -68.31036152774, -69.81378673909542, -110.93886904182011, -96.81253957416327, -92.01775876275137, -107.16092397295326, -79.80527107087295, -92.66577491289934, -91.45933980224453, -73.57358814633108, -97.45525867973772, -108.20228811738808, -98.05124099103801, -99.01912342985182, -90.16040213015926, -105.36991324724843, -111.55063320733508, -97.56534706031326, -96.95277582973381, -84.06533105175296, -64.45852324574831, -126.13052298841761, -106.06356579152477, -79.85968901638631, -109.48015164558376, -122.98667545121123, -137.1334400388052, -91.62077491341454, -137.34891974466112, -93.07846979279935, -87.24487365142073, -75.49403496268029, -102.23928358625228, -88.06621369760364, -87.69952073260325, -91.25091686314472, -88.7936253248537, -85.78122021452683, -117.31624551638906, -91.64516028707965, -105.69121600592993, -79.9418820193033, -93.89867490372856, -81.95843392635201, -120.60387819157724, -100.43551826302986, -84.42309483522493, -122.38513097932581, -93.66354514268991, -114.99526860561612, -103.77297401761133, -71.16728450893663, -65.56406311981159, -96.42580537934866, -75.58344799724588, -112.24387496394414, -85.13949649997402, -97.92654594573665, -68.65396586791819, -80.05005869099736, -87.78632327317194, -113.98121139831972, -115.78345470072522, -73.27438381467762, -103.45095790285038, -125.73686034416669, -97.16722656300857, -73.45391353150256, -94.17494958327045, -118.38502760168983, -80.36593685262241, -94.04297102412006, -86.54305671898612, -101.45854699857405, -85.79574591846156, -106.8924562591155, -79.64720302719171, -97.04528647874466, -72.56892423672744, -96.7299390222199, -108.00855799918087, -129.80234520938288, -126.22953371162463, -68.64190703722176, -99.14484781470664, -101.71502628606261, -103.63282295109383, -104.1243168639648, -91.00840124857739, -76.57818058597462, -101.17468280522655, -77.41053111973542, -105.66097361589759, -83.29690066684401, -112.40775633691064, -120.3318684325146, -91.98473630285622, -100.35727191469526, -95.0792011216959, -106.50136154465612, -76.67652020709862, -102.36164837257135, -84.73884552702398, -118.63296311123608], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-27.838386289339606, -27.838386289339606, -27.838386289339606, -23.218090920796254, -23.218090920796254, -23.218090920796254, -34.00965507140962, -33.00965507140962, -32.00965507140962, -31.884803299869333, -31.884803299869333, -31.884803299869333, -32.86461513179036, -34.36461513179035, -34.36461513179035, -34.97771817485962, -34.97771817485962, -32.47771817485961, -31.554161823428654, -29.554161823428654, -31.554161823428654, -27.93194153518973, -27.93194153518973, -27.93194153518973, -29.378005223843235, -29.378005223843235, -29.378005223843235, -38.125629191415406, -37.125629191415406, -36.125629191415406, -38.095974502172034, -39.595974502172034, -39.595974502172034, -30.444617750821113, -30.444617750821113, -29.944617750821113, -36.5434152211844, -36.5434152211844, -34.5434152211844, -22.525620875259733, -22.525620875259733, -22.525620875259733, -28.074540883383882, -28.074540883383882, -28.074540883383882, -33.78826526142618, -32.28826526142618, -33.28826526142618, -23.436787175913317, -23.436787175913317, -21.436787175913324, -23.271262246365147, -23.271262246365147, -23.271262246365147, -37.31295634727337, -37.31295634727337, -36.312956347273364, -32.60417985805442, -31.60417985805442, -32.60417985805442, -30.005919587583783, -31.005919587583783, -31.005919587583783, -35.72030799098441, -35.72030799098441, -35.72030799098441, -25.93509035695766, -26.935090356957666, -26.935090356957666, -30.555258304299787, -31.555258304299787, -30.555258304299787, -30.81977993408152, -29.81977993408152, -30.81977993408152, -24.52452938211035, -24.52452938211035, -24.52452938211035, -32.485086226579256, -32.485086226579256, -32.485086226579256, -36.06742937246267, -36.06742937246267, -36.06742937246267, -32.68374699701266, -32.68374699701266, -32.68374699701266, -34.006374476617296, -32.506374476617296, -32.506374476617296, -30.720134043386384, -30.720134043386384, -28.720134043386384, -35.456637749082816, -35.456637749082816, -34.45663774908281, -38.3502110691117, -37.3502110691117, -35.8502110691117, -32.52178235343773, -32.52178235343773, -32.52178235343773, -32.31759194324461, -32.31759194324461, -32.31759194324461, -28.021777017250987, -28.021777017250987, -28.021777017250987, -21.486174415249444, -21.486174415249444, -21.486174415249444, -42.04350766280588, -42.04350766280588, -42.04350766280588, -35.854521930508234, -35.854521930508234, -34.354521930508234, -26.61989633879544, -26.61989633879544, -26.61989633879544, -36.49338388186126, -36.49338388186126, -36.49338388186126, -39.99555848373708, -40.99555848373708, -41.995558483737085, -45.877813346268404, -45.377813346268404, -45.877813346268404, -30.540258304471507, -30.540258304471507, -30.540258304471507, -45.78297324822036, -45.78297324822036, -45.78297324822036, -31.02615659759975, -31.02615659759975, -31.02615659759975, -29.748291217140228, -28.248291217140228, -29.248291217140228, -25.49801165422678, -24.49801165422678, -25.49801165422678, -34.079761195417426, -34.079761195417426, -34.079761195417426, -29.35540456586788, -29.35540456586788, -29.35540456586788, -29.89984024420107, -29.89984024420107, -27.89984024420107, -29.416972287714895, -31.416972287714895, -30.416972287714895, -30.76454177495123, -28.264541774951233, -29.764541774951233, -28.760406738175618, -28.260406738175618, -28.760406738175618, -39.43874850546302, -38.43874850546302, -39.43874850546302, -30.548386762359875, -31.048386762359875, -30.048386762359875, -35.563738668643296, -34.0637386686433, -36.063738668643296, -26.647294006434425, -26.647294006434425, -26.647294006434425, -31.299558301242854, -31.299558301242854, -31.299558301242854, -26.486144642117342, -27.486144642117342, -27.986144642117342, -40.20129273052576, -40.20129273052576, -40.20129273052576, -33.31183942100996, -32.81183942100996, -34.31183942100996, -28.64103161174164, -27.14103161174164, -28.64103161174164, -40.46171032644194, -40.96171032644194, -40.96171032644194, -31.387848380896642, -30.887848380896642, -31.387848380896642, -38.33175620187203, -38.33175620187203, -38.33175620187203, -34.59099133920379, -34.59099133920379, -34.59099133920379, -23.389094836312218, -23.889094836312218, -23.889094836312218, -22.02135437327054, -22.02135437327054, -21.52135437327054, -32.14193512644957, -32.14193512644957, -32.14193512644957, -24.527815999081948, -25.527815999081948, -25.527815999081948, -37.74795832131473, -36.74795832131473, -37.74795832131473, -28.379832166658012, -28.379832166658012, -28.379832166658012, -32.975515315245545, -32.975515315245545, -31.975515315245545, -22.884655289306068, -22.884655289306068, -22.884655289306068, -26.35001956366578, -26.85001956366578, -26.85001956366578, -29.42877442439066, -28.92877442439066, -29.42877442439066, -37.32707046610659, -38.32707046610659, -38.32707046610659, -39.59448490024176, -37.09448490024175, -39.09448490024175, -24.42479460489254, -24.42479460489254, -24.42479460489254, -34.65031930095014, -34.65031930095014, -34.15031930095014, -40.412286781388886, -42.41228678138889, -42.91228678138889, -32.722408854336194, -32.722408854336194, -31.72240885433619, -24.484637843834193, -24.484637843834193, -24.484637843834193, -30.891649861090123, -31.891649861090123, -31.391649861090123, -40.46167586722993, -37.961675867229935, -39.96167586722993, -27.121978950874144, -26.121978950874144, -27.121978950874144, -31.514323674706677, -31.514323674706677, -31.014323674706677, -28.847685572995356, -28.347685572995356, -29.347685572995356, -33.81951566619135, -33.81951566619135, -33.81951566619135, -28.59858197282052, -28.59858197282052, -28.59858197282052, -35.63081875303851, -35.63081875303851, -35.63081875303851, -26.549067675730555, -26.549067675730555, -26.549067675730555, -32.015095492914924, -32.01509549291492, -33.01509549291492, -24.189641412242494, -24.189641412242494, -24.189641412242494, -32.409979674073305, -31.909979674073302, -32.409979674073305, -36.00285266639362, -36.00285266639362, -36.00285266639362, -42.600781736460995, -43.600781736460995, -43.600781736460995, -42.07651123720821, -42.07651123720821, -42.07651123720821, -22.88063567907393, -22.88063567907393, -22.88063567907393, -30.881615938235555, -34.381615938235555, -33.881615938235555, -33.90500876202088, -33.90500876202088, -33.90500876202088, -33.37760765036461, -34.87760765036461, -35.37760765036461, -36.874772287988264, -31.874772287988268, -35.374772287988264, -30.3361337495258, -30.3361337495258, -30.3361337495258, -25.526060195324874, -25.526060195324874, -25.526060195324874, -33.05822760174217, -34.05822760174217, -34.05822760174217, -25.80351037324513, -25.80351037324513, -25.80351037324513, -34.22032453863252, -36.22032453863252, -35.22032453863252, -27.932300222281327, -27.932300222281327, -27.432300222281327, -36.46925211230353, -37.96925211230353, -37.96925211230353, -39.777289477504844, -39.777289477504844, -40.777289477504844, -30.661578767618728, -30.661578767618728, -30.661578767618728, -33.619090638231725, -33.11909063823172, -33.619090638231725, -31.69306704056529, -31.69306704056529, -31.69306704056529, -33.83378718155205, -36.33378718155205, -36.33378718155205, -26.225506735699568, -24.225506735699568, -26.225506735699568, -34.120549457523786, -34.120549457523786, -34.120549457523786, -29.246281842341336, -29.246281842341336, -26.246281842341336, -39.54432103707869, -39.54432103707869, -39.54432103707869]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3132711011087194, "mean_inference_ms": 1.2663429945243345, "mean_action_processing_ms": 0.069813716092963, "mean_env_wait_ms": 0.5808058277809368, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 179200, "timesteps_this_iter": 0, "agent_timesteps_total": 537600, "timers": {"sample_time_ms": 1566.29, "sample_throughput": 2043.044, "load_time_ms": 0.135, "load_throughput": 23721761.753, "learn_time_ms": 783.578, "learn_throughput": 4083.83, "update_time_ms": 1.536}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005000000000000001, "total_loss": 80.1912712097168, "policy_loss": -0.0020210225080117715, "vf_loss": 80.20581741333008, "vf_explained_var": 0.004939776659011841, "kl": 0.0038795348638693715, "entropy": 1.2521602272987367, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 179200, "num_agent_steps_sampled": 537600, "num_steps_trained": 179200, "num_agent_steps_trained": 537600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7160, "training_iteration": 56, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-03", "timestamp": 1718736423, "time_this_iter_s": 1.5097377300262451, "time_total_s": 86.20362496376038, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 86.20362496376038, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 29.600000000000005, "ram_util_percent": 30.46666666666667}}
{"episode_reward_max": -64.92340617714359, "episode_reward_min": -129.3538939364916, "episode_reward_mean": -94.67492890967318, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -43.45129797883051}, "policy_reward_max": {"shared_policy": -21.1411353923812}, "policy_reward_mean": {"shared_policy": -31.55830963655773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.54567815658994, -118.07943068264505, -106.41776099993128, -104.88996317889891, -88.46609099956576, -104.39697991442718, -107.19360406672183, -94.69042815456413, -118.62524501627951, -118.1819378499222, -76.5341751831869, -104.4111456012805, -88.48634245503324, -100.49107140167818, -114.02666574936244, -68.9079471995974, -112.81349454947247, -90.20972303563207, -90.8733603982168, -87.48000655981926, -90.43763046533118, -114.22594362156384, -91.49638427406708, -105.25096254534057, -79.68131695743837, -99.39688501282592, -95.4765733510134, -67.04303972338164, -116.19075481222167, -115.69552070981624, -90.86182774104195, -67.18127921987023, -74.67706802041832, -64.92340617714359, -85.33757926837752, -92.96636974829067, -92.4560256186814, -94.81198691996916, -73.80331094678911, -116.98675688194446, -87.89759100621397, -88.76729529437466, -104.69330563355204, -71.22279953929029, -78.80167726407727, -75.70249144179286, -111.26342524615904, -102.8269685439357, -98.1076580544971, -90.83109145587768, -75.29403857155886, -85.17621122171944, -107.35229471392854, -125.34865950217761, -66.43170824748778, -100.24624288803832, -92.7012175010245, -124.88733546066844, -100.8925395552739, -102.9262550091476, -77.52166256284922, -110.27759299123561, -105.96832315559051, -75.9072261442686, -91.43420215493266, -101.31848013574499, -107.3733370898063, -88.04697525677337, -88.67179844548592, -92.76900431951, -84.86125430232386, -74.96611846705419, -121.87729848304085, -122.33261483021624, -79.3360760392158, -97.67869093320247, -67.5823435640375, -96.64592407657601, -80.93556089574841, -84.92883496173044, -108.79070772167925, -75.56473322396819, -111.01017334095535, -94.38072805592006, -99.9156751868696, -86.38115966758983, -88.16204375729231, -88.34706734012167, -101.13195496906211, -85.64912903720673, -88.32495946440827, -99.11872583068961, -124.0291697197846, -104.07304204627674, -96.41058482136158, -99.65770350104688, -83.0135024073913, -97.4729622451398, -83.80279568119924, -82.42299987263189, -97.37471586472745, -115.99396909383707, -80.60820800445812, -70.53947785280754, -82.72006592563142, -80.47815537108798, -87.04250030475164, -80.41977722550955, -100.05305199805602, -91.08411078974456, -99.32160654220944, -93.50208136816957, -85.05122225985247, -104.73299340599999, -106.35868068612884, -83.52844685840078, -98.23867307228669, -129.3538939364916, -80.17231815185863, -100.33933047633504, -78.54480846568585, -103.38713731311373, -112.73959427133369, -89.21936427530817, -106.4484878319921, -76.59420233281936, -87.04980474942695, -112.9496875331542, -110.68019115870776, -95.12858511854343], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.84855938552997, -35.84855938552997, -34.84855938552997, -39.35981022754839, -39.35981022754839, -39.35981022754839, -34.13925366664377, -36.13925366664376, -36.13925366664376, -34.96332105963298, -34.96332105963298, -34.96332105963298, -29.98869699985523, -28.48869699985523, -29.98869699985523, -33.79899330480905, -35.29899330480906, -35.29899330480906, -35.73120135557393, -35.73120135557393, -35.73120135557393, -30.563476051521384, -32.063476051521384, -32.063476051521384, -40.04174833875982, -38.54174833875982, -40.04174833875982, -39.3939792833074, -39.3939792833074, -39.3939792833074, -25.011391727728974, -26.51139172772897, -25.01139172772897, -34.80371520042685, -34.80371520042685, -34.80371520042685, -29.8287808183444, -29.3287808183444, -29.3287808183444, -33.497023800559376, -33.497023800559376, -33.497023800559376, -38.008888583120815, -38.008888583120815, -38.008888583120815, -23.302649066532478, -23.302649066532478, -22.302649066532478, -36.937831516490824, -36.937831516490824, -38.937831516490824, -30.403241011877352, -29.403241011877356, -30.403241011877352, -30.291120132738936, -30.291120132738936, -30.291120132738936, -29.493335519939762, -28.493335519939762, -29.493335519939762, -28.812543488443726, -30.812543488443726, -30.812543488443726, -38.075314540521255, -38.075314540521255, -38.075314540521255, -29.49879475802234, -30.998794758022346, -30.998794758022346, -35.08365418178021, -35.08365418178021, -35.08365418178021, -26.560438985812798, -26.560438985812798, -26.560438985812798, -33.132295004275306, -33.132295004275306, -33.132295004275306, -32.32552445033778, -30.82552445033778, -32.32552445033778, -22.347679907793893, -22.347679907793893, -22.347679907793893, -39.063584937407256, -39.063584937407256, -38.063584937407256, -38.89850690327208, -38.89850690327208, -37.89850690327208, -31.453942580347306, -27.953942580347306, -31.453942580347306, -22.560426406623403, -22.560426406623403, -22.060426406623403, -23.89235600680611, -25.392356006806107, -25.392356006806107, -22.6411353923812, -21.1411353923812, -21.1411353923812, -28.445859756125834, -28.445859756125834, -28.445859756125834, -30.988789916096867, -30.988789916096867, -30.988789916096867, -30.985341872893795, -30.485341872893795, -30.985341872893795, -31.60399563998971, -31.60399563998971, -31.60399563998971, -24.60110364892969, -24.60110364892969, -24.60110364892969, -37.99558562731482, -39.49558562731482, -39.49558562731482, -29.799197002071327, -29.299197002071327, -28.799197002071327, -29.589098431458236, -29.589098431458236, -29.589098431458236, -34.89776854451732, -33.89776854451732, -35.89776854451732, -23.407599846430088, -23.907599846430088, -23.907599846430088, -26.267225754692415, -26.267225754692415, -26.267225754692415, -25.40083048059762, -25.40083048059762, -24.90083048059762, -36.921141748719684, -37.421141748719684, -36.921141748719684, -34.27565618131193, -34.27565618131193, -34.27565618131193, -33.369219351499034, -32.369219351499034, -32.36921935149904, -29.61036381862588, -31.11036381862588, -30.11036381862588, -25.098012857186273, -25.098012857186273, -25.098012857186273, -28.392070407239828, -28.392070407239828, -28.392070407239828, -35.78409823797619, -35.78409823797619, -35.78409823797619, -41.78288650072584, -41.78288650072584, -41.78288650072584, -22.310569415829267, -21.810569415829267, -22.310569415829267, -33.41541429601278, -33.41541429601278, -33.41541429601278, -30.900405833674835, -30.900405833674835, -30.900405833674835, -41.462445153556175, -42.462445153556175, -40.962445153556175, -33.13084651842462, -33.63084651842462, -34.13084651842462, -34.30875166971586, -34.30875166971586, -34.30875166971586, -25.840554187616387, -25.840554187616387, -25.840554187616387, -36.42586433041185, -37.42586433041185, -36.42586433041185, -35.322774385196844, -35.322774385196844, -35.322774385196844, -23.63574204808954, -26.63574204808954, -25.63574204808954, -31.311400718310885, -30.311400718310885, -29.811400718310892, -33.10616004524834, -33.60616004524833, -34.60616004524833, -35.95777902993546, -35.457779029935466, -35.95777902993546, -29.348991752257774, -29.348991752257774, -29.348991752257774, -29.557266148495334, -29.557266148495334, -29.557266148495334, -29.256334773169982, -31.756334773169982, -31.756334773169982, -28.78708476744131, -28.78708476744131, -27.28708476744131, -25.155372822351417, -24.655372822351417, -25.155372822351417, -40.12576616101363, -42.12576616101363, -39.62576616101363, -40.11087161007208, -40.11087161007208, -42.11087161007208, -25.778692013071925, -26.778692013071925, -26.778692013071925, -32.726230311067475, -33.726230311067475, -31.226230311067475, -22.860781188012492, -21.860781188012492, -22.860781188012492, -32.215308025525324, -32.215308025525324, -32.215308025525324, -26.978520298582836, -26.978520298582836, -26.978520298582836, -28.309611653910146, -28.309611653910146, -28.309611653910146, -36.26356924055977, -36.26356924055977, -36.26356924055977, -25.1882444079894, -25.1882444079894, -25.1882444079894, -37.00339111365179, -37.00339111365179, -37.00339111365179, -32.46024268530668, -29.460242685306678, -32.46024268530668, -33.6385583956232, -33.6385583956232, -32.6385583956232, -29.127053222529923, -29.127053222529923, -28.12705322252992, -29.387347919097426, -29.387347919097426, -29.387347919097426, -29.44902244670724, -29.44902244670724, -29.44902244670724, -33.71065165635403, -33.71065165635403, -33.71065165635403, -26.549709679068904, -29.549709679068904, -29.549709679068904, -29.441653154802758, -29.441653154802758, -29.441653154802758, -33.03957527689654, -33.03957527689654, -33.03957527689654, -40.67638990659488, -41.67638990659488, -41.67638990659488, -34.024347348758894, -35.024347348758894, -35.024347348758894, -32.13686160712051, -32.13686160712051, -32.13686160712051, -33.385901167015625, -32.885901167015625, -33.385901167015625, -27.171167469130435, -27.671167469130435, -28.17116746913043, -32.15765408171324, -32.65765408171324, -32.65765408171324, -28.600931893733094, -27.600931893733094, -27.600931893733094, -27.474333290877297, -27.474333290877297, -27.474333290877297, -32.45823862157581, -32.45823862157581, -32.45823862157581, -38.83132303127902, -38.33132303127902, -38.83132303127902, -27.70273600148604, -25.20273600148604, -27.70273600148604, -22.84649261760251, -23.846492617602507, -23.846492617602507, -26.90668864187715, -27.90668864187715, -27.90668864187715, -26.159385123695987, -27.159385123695987, -27.159385123695987, -28.680833434917215, -29.180833434917215, -29.180833434917215, -26.806592408503185, -26.806592408503185, -26.806592408503185, -33.351017332685316, -33.851017332685316, -32.851017332685316, -29.52803692991485, -30.52803692991485, -31.02803692991485, -33.10720218073647, -33.10720218073647, -33.10720218073647, -30.167360456056542, -31.667360456056542, -31.667360456056542, -28.850407419950827, -27.350407419950827, -28.850407419950827, -35.07766446866667, -34.57766446866667, -35.07766446866667, -35.78622689537627, -35.78622689537627, -34.78622689537627, -26.842815619466922, -28.342815619466922, -28.342815619466922, -32.41289102409554, -32.91289102409554, -32.91289102409554, -42.45129797883051, -43.45129797883051, -43.45129797883051, -26.89077271728621, -27.39077271728621, -25.89077271728621, -33.44644349211167, -33.44644349211167, -33.44644349211167, -25.848269488561947, -26.348269488561947, -26.348269488561947, -34.462379104371244, -34.462379104371244, -34.462379104371244, -38.57986475711124, -35.579864757111245, -38.57986475711124, -29.073121425102727, -30.073121425102727, -30.073121425102727, -35.14949594399738, -35.64949594399738, -35.64949594399738, -24.864734110939775, -25.86473411093978, -25.86473411093978, -29.349934916475668, -28.349934916475668, -29.349934916475668, -37.649895844384744, -37.649895844384744, -37.649895844384744, -35.56006371956925, -37.56006371956925, -37.56006371956925, -31.709528372847824, -31.709528372847824, -31.709528372847824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3134415172039237, "mean_inference_ms": 1.2668895392059516, "mean_action_processing_ms": 0.06984701204192748, "mean_env_wait_ms": 0.5809627063676562, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 182400, "timesteps_this_iter": 0, "agent_timesteps_total": 547200, "timers": {"sample_time_ms": 1564.635, "sample_throughput": 2045.205, "load_time_ms": 0.136, "load_throughput": 23538710.628, "learn_time_ms": 787.359, "learn_throughput": 4064.222, "update_time_ms": 1.543}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 73.5722267150879, "policy_loss": -0.003302110855157192, "vf_loss": 73.58800888061523, "vf_explained_var": -0.00010892748832702637, "kl": 0.006403986828789765, "entropy": 1.2479994416236877, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 182400, "num_agent_steps_sampled": 547200, "num_steps_trained": 182400, "num_agent_steps_trained": 547200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7290, "training_iteration": 57, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-04", "timestamp": 1718736424, "time_this_iter_s": 1.5460524559020996, "time_total_s": 87.74967741966248, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 87.74967741966248, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 39.0, "ram_util_percent": 30.4}}
{"episode_reward_max": -59.613920241823074, "episode_reward_min": -133.6759673875691, "episode_reward_mean": -96.28172874012897, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -46.05865579585635}, "policy_reward_max": {"shared_policy": -19.871306747274353}, "policy_reward_mean": {"shared_policy": -32.09390958004299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.34942178336419, -81.96691539496183, -102.38901910833931, -80.53938605638203, -101.00600954717771, -103.66507857301018, -96.41323250904601, -84.56482668769252, -122.94086706471572, -90.27615964267706, -97.66192129814348, -99.0925776833473, -83.74175536376508, -78.65151610228843, -111.51454571280595, -98.47364847181127, -64.02412538089632, -97.57327957811017, -116.7949690124993, -111.058487339028, -92.90071171111876, -118.32270080391262, -86.19244833611192, -90.13567288600959, -85.33345104627985, -70.2740533944072, -133.6759673875691, -107.24053800750474, -89.09518315035687, -98.41085290644396, -76.11561122906026, -97.56606789800358, -98.98970036062259, -109.12429101736565, -79.22172892401103, -113.79580681804117, -82.48531287169841, -110.94633562041062, -116.99257220521497, -66.20629712386216, -90.25281561216495, -114.56464361970548, -89.93702619785392, -101.31619070911124, -62.7175166923498, -93.44716823751605, -73.26933182420682, -94.60285694479205, -99.83929292458802, -76.81143340837275, -61.88237497910294, -86.7350627518297, -108.00125186696403, -105.99487735091276, -110.59800662987071, -113.30744172598253, -106.72461785173202, -95.49702307254617, -114.18684490461864, -128.82443203842953, -103.47138456337669, -124.26418075657119, -100.76961428127125, -92.8265562242514, -93.32932287896537, -92.3557102382751, -87.32232514152106, -113.03984065887921, -85.29376900665467, -77.83771523021566, -122.13052142560082, -100.67983333103452, -89.2411779876018, -73.96756456769816, -108.66735392705928, -86.91345173864168, -82.11608206641237, -90.83166834625096, -86.2400573847219, -92.47102276611365, -121.21289727355413, -84.23462323276108, -86.40936089402035, -118.57640376379759, -62.97933495904407, -101.80960946505822, -99.93222010856773, -98.49511776616315, -92.2434873976979, -99.01174932892496, -94.33799127287938, -100.752145428611, -86.54136093636987, -105.92194945222705, -110.60015222199254, -109.02339100702947, -77.34753749572329, -104.47212257863708, -112.25565484780985, -103.39073093436535, -104.42924270185503, -76.92923957232831, -79.79606408158087, -110.14792631673404, -117.22381842018714, -91.78462584916977, -105.92225455653595, -76.915621911808, -120.66190205057168, -106.72662591618632, -59.613920241823074, -92.22494582139248, -101.4930365962726, -67.85952024401043, -83.18791292604763, -92.5071148219156, -80.14666318139068, -82.68669118551232, -102.74737614121352, -77.42249360840327, -88.89714963999828, -103.77599504600202, -99.0106874618641, -85.4887994723571, -112.24401841674121, -112.68248254385846, -113.20691242887926, -119.94751716853676, -92.73968181902647, -98.65424783749584], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-37.116473927788064, -37.116473927788064, -38.116473927788064, -27.32230513165395, -27.32230513165395, -27.32230513165395, -35.1296730361131, -34.6296730361131, -32.6296730361131, -26.846462018794007, -26.846462018794007, -26.846462018794007, -34.00200318239255, -33.00200318239255, -34.00200318239255, -33.7216928576701, -35.2216928576701, -34.7216928576701, -32.13774416968204, -32.13774416968204, -32.13774416968204, -27.521608895897494, -28.521608895897494, -28.521608895897494, -41.48028902157192, -39.98028902157192, -41.48028902157192, -30.092053214225697, -30.092053214225697, -30.092053214225697, -32.220640432714504, -32.720640432714504, -32.720640432714504, -32.69752589444909, -33.19752589444909, -33.19752589444909, -26.913918454588348, -28.413918454588348, -28.413918454588348, -26.217172034096137, -26.217172034096137, -26.217172034096137, -34.83818190426869, -38.33818190426869, -38.33818190426869, -32.824549490603765, -32.824549490603765, -32.824549490603765, -21.841375126965442, -20.34137512696544, -21.841375126965442, -32.52442652603671, -32.52442652603671, -32.52442652603671, -38.931656337499746, -38.931656337499746, -38.931656337499746, -37.01949577967601, -37.51949577967601, -36.51949577967601, -30.966903903706257, -30.966903903706257, -30.966903903706257, -39.77423360130421, -38.77423360130421, -39.77423360130421, -28.7308161120373, -28.7308161120373, -28.7308161120373, -30.37855762866988, -30.37855762866988, -29.37855762866988, -28.44448368209327, -28.44448368209327, -28.44448368209327, -23.59135113146904, -23.59135113146904, -23.09135113146904, -42.55865579585636, -46.05865579585635, -45.05865579585636, -35.74684600250157, -35.74684600250157, -35.74684600250157, -29.698394383452314, -29.698394383452314, -29.698394383452314, -32.803617635481324, -32.803617635481324, -32.803617635481324, -25.371870409686753, -25.371870409686753, -25.371870409686753, -32.52202263266787, -32.52202263266787, -32.52202263266787, -33.16323345354086, -32.66323345354086, -33.16323345354086, -36.54143033912188, -36.04143033912188, -36.54143033912188, -26.407242974670343, -26.407242974670343, -26.407242974670343, -38.26526893934706, -37.26526893934707, -38.26526893934706, -26.828437623899465, -27.82843762389947, -27.82843762389947, -37.14877854013685, -36.64877854013685, -37.14877854013685, -38.33085740173834, -39.33085740173834, -39.33085740173834, -22.402099041287386, -22.402099041287386, -21.402099041287386, -30.25093853738831, -30.25093853738831, -29.75093853738831, -38.18821453990182, -38.18821453990182, -38.18821453990182, -28.64567539928465, -30.64567539928465, -30.64567539928465, -33.772063569703725, -33.772063569703725, -33.772063569703725, -20.90583889744993, -20.90583889744993, -20.90583889744993, -31.149056079172023, -31.149056079172023, -31.149056079172023, -24.423110608068942, -24.423110608068942, -24.423110608068942, -31.53428564826403, -31.53428564826403, -31.53428564826403, -33.279764308196015, -33.279764308196015, -33.279764308196015, -25.60381113612427, -25.60381113612427, -25.60381113612427, -20.794124993034323, -20.794124993034323, -20.294124993034323, -29.24502091727658, -29.24502091727658, -28.24502091727658, -35.333750622321304, -36.333750622321304, -36.333750622321304, -35.331625783637584, -35.331625783637584, -35.331625783637584, -37.53266887662356, -37.53266887662356, -35.53266887662357, -37.76914724199416, -37.76914724199416, -37.76914724199416, -34.90820595057732, -35.90820595057732, -35.90820595057732, -31.999007690848696, -31.499007690848696, -31.999007690848696, -37.39561496820621, -38.89561496820621, -37.89561496820621, -42.94147734614319, -42.94147734614319, -42.94147734614319, -34.490461521125575, -34.490461521125575, -34.490461521125575, -41.42139358552374, -41.42139358552374, -41.42139358552374, -31.089871427090394, -35.089871427090394, -34.589871427090394, -30.942185408083795, -30.942185408083795, -30.942185408083795, -30.443107626321797, -31.443107626321797, -31.443107626321797, -30.785236746091712, -30.785236746091712, -30.785236746091712, -29.107441713840355, -29.107441713840355, -29.107441713840355, -36.6799468862931, -38.1799468862931, -38.1799468862931, -28.93125633555156, -27.43125633555156, -28.93125633555156, -26.612571743405212, -26.612571743405212, -24.612571743405212, -40.04350714186694, -41.04350714186694, -41.04350714186694, -32.89327777701153, -34.39327777701153, -33.39327777701153, -29.747059329200603, -29.747059329200603, -29.747059329200603, -24.655854855899385, -24.655854855899385, -24.655854855899385, -36.22245130901976, -36.22245130901976, -36.22245130901976, -28.637817246213896, -29.137817246213896, -29.137817246213896, -26.705360688804127, -27.205360688804127, -28.205360688804127, -30.27722278208365, -30.27722278208365, -30.27722278208365, -27.913352461573947, -29.913352461573947, -28.413352461573947, -30.990340922037888, -30.990340922037888, -30.490340922037888, -39.40429909118472, -41.90429909118472, -39.90429909118472, -28.078207744253692, -28.078207744253692, -28.078207744253692, -29.136453631340125, -28.136453631340125, -29.136453631340125, -39.85880125459919, -38.85880125459919, -39.85880125459919, -20.99311165301469, -20.99311165301469, -20.99311165301469, -33.269869821686086, -34.269869821686086, -34.269869821686086, -33.31074003618926, -33.31074003618926, -33.31074003618926, -33.99837258872106, -33.99837258872106, -30.49837258872106, -30.747829132565947, -30.747829132565947, -30.747829132565947, -33.17058310964169, -32.67058310964169, -33.17058310964169, -30.779330424293136, -31.779330424293136, -31.779330424293136, -33.58404847620366, -33.58404847620366, -33.58404847620366, -29.513786978789977, -29.513786978789977, -27.513786978789977, -35.3073164840757, -35.3073164840757, -35.3073164840757, -37.86671740733086, -36.86671740733086, -35.86671740733087, -36.341130335676496, -36.341130335676496, -36.341130335676496, -25.782512498574427, -25.782512498574427, -25.782512498574427, -34.824040859545704, -34.824040859545704, -34.824040859545704, -37.085218282603286, -37.585218282603286, -37.585218282603286, -34.46357697812178, -34.46357697812178, -34.46357697812178, -35.14308090061833, -34.14308090061833, -35.14308090061833, -24.976413190776114, -25.976413190776114, -25.976413190776114, -26.598688027193628, -26.598688027193628, -26.598688027193628, -36.71597543891134, -36.71597543891134, -36.71597543891134, -39.241272806729036, -38.741272806729036, -39.241272806729036, -29.261541949723256, -31.261541949723256, -31.261541949723256, -35.30741818551199, -35.30741818551199, -35.30741818551199, -25.971873970602687, -25.971873970602687, -24.971873970602683, -38.72063401685722, -40.22063401685722, -41.72063401685721, -35.57554197206214, -35.57554197206214, -35.57554197206214, -19.871306747274353, -19.871306747274353, -19.871306747274353, -30.908315273797495, -30.408315273797495, -30.908315273797495, -33.83101219875755, -34.33101219875755, -33.33101219875755, -22.619840081336804, -22.619840081336804, -22.619840081336804, -27.729304308682554, -27.729304308682554, -27.729304308682554, -30.835704940638525, -30.835704940638525, -30.835704940638525, -26.048887727130243, -27.048887727130243, -27.048887727130243, -27.562230395170786, -27.562230395170786, -27.562230395170786, -33.915792047071164, -34.415792047071164, -34.415792047071164, -25.80749786946775, -25.80749786946775, -25.80749786946775, -29.632383213332748, -29.632383213332748, -29.632383213332748, -34.591998348667346, -35.091998348667346, -34.091998348667346, -33.00356248728804, -33.00356248728804, -33.00356248728804, -28.49626649078571, -28.49626649078571, -28.49626649078571, -37.74800613891372, -37.74800613891372, -36.74800613891372, -37.89416084795282, -36.89416084795282, -37.89416084795282, -37.902304142959736, -37.402304142959736, -37.902304142959736, -39.98250572284556, -39.98250572284556, -39.98250572284556, -30.913227273008836, -30.913227273008836, -30.913227273008836, -32.21808261249861, -33.218082612498605, -33.218082612498605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31377091168085636, "mean_inference_ms": 1.2678429700326228, "mean_action_processing_ms": 0.06988238276133318, "mean_env_wait_ms": 0.581445291146245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 185600, "timesteps_this_iter": 0, "agent_timesteps_total": 556800, "timers": {"sample_time_ms": 1576.43, "sample_throughput": 2029.904, "load_time_ms": 0.136, "load_throughput": 23476950.848, "learn_time_ms": 788.242, "learn_throughput": 4059.667, "update_time_ms": 1.527}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0005000000000000001, "total_loss": 73.7627960205078, "policy_loss": -0.0033388667063166677, "vf_loss": 73.77833786010743, "vf_explained_var": 0.01328783631324768, "kl": 0.004340657183248675, "entropy": 1.2205567359924316, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 185600, "num_agent_steps_sampled": 556800, "num_steps_trained": 185600, "num_agent_steps_trained": 556800, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7420, "training_iteration": 58, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-06", "timestamp": 1718736426, "time_this_iter_s": 1.5813417434692383, "time_total_s": 89.33101916313171, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd292463e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 89.33101916313171, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 39.099999999999994, "ram_util_percent": 30.35}}
{"episode_reward_max": -63.93542138509587, "episode_reward_min": -149.47953092800364, "episode_reward_mean": -96.95844003024179, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -50.493176976001216}, "policy_reward_max": {"shared_policy": -21.31180712836529}, "policy_reward_mean": {"shared_policy": -32.31948001008059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.35970504899458, -104.58361523229385, -113.0656861541002, -97.82204193938767, -99.67112938438777, -117.0275612073244, -92.22247307723568, -89.90183756401622, -71.20935086866047, -103.25109494976375, -103.40801156092922, -106.84793283140243, -94.81225178189052, -102.88266375524509, -96.08233946149912, -93.47396418809656, -89.14938050505198, -87.93633981958487, -77.1157418696473, -109.06283068025978, -123.37674801327535, -82.02915975146355, -68.78181745878192, -141.950548445435, -86.26445766860661, -73.79618129077424, -109.7554997160053, -75.5786327523705, -78.53249640069603, -93.32719994679248, -89.03085567042633, -94.4252228561551, -82.72685173418377, -75.17633021202222, -79.7182052212188, -102.66099435173044, -68.04377558396989, -102.30744609849111, -79.61231529988797, -113.66344214079295, -92.45149083117491, -95.36334595688719, -90.59547502469589, -109.93553835688263, -89.96756941277435, -106.72149161893847, -86.89978798634621, -99.18083667737173, -106.05128363958397, -88.27153327058197, -119.31612660307256, -95.86906190861667, -93.45997076494912, -102.04126974038361, -97.58659668084007, -110.28544334178468, -101.49667173625618, -101.5452685385435, -75.20678458579582, -95.26516624809952, -88.94118528636702, -88.70480069065586, -117.83270369593528, -73.71026796595005, -75.97864232264342, -77.81876354432873, -82.29083126085771, -102.24123166716727, -113.02731761033212, -111.75265418292294, -86.20635424613197, -114.34223497884379, -76.0990039483813, -82.60634341008125, -97.69314177273438, -115.32716870276862, -104.95639184191934, -93.92181263980133, -96.1885251074258, -72.89908605007344, -97.46444144983627, -113.9327600829027, -107.34052487569838, -97.56906534188789, -149.47953092800364, -114.69374601188115, -127.06459651885083, -105.22783045779398, -92.79296406217847, -108.83927215476433, -92.67105155786481, -114.53807622267315, -105.7198393637245, -95.75542061637022, -99.33057634426557, -88.05690073229684, -96.3327804408046, -84.39042191581103, -114.9278488488216, -106.31554279512133, -85.00026807678103, -98.2833257812447, -92.84727361399376, -108.27385961246722, -92.79025972680233, -135.13152483636495, -97.15044895710528, -66.1468368440655, -96.52194571051535, -63.93542138509587, -84.81300962300313, -86.98705413622369, -71.91632932079695, -104.87950857633555, -106.21146471668179, -94.78798354976102, -88.02847253209744, -132.13380767237174, -92.85064224948314, -69.07640506451474, -110.36807917264757, -83.32700293635875, -90.5314010165772, -114.76304723638248, -95.39440469566583, -126.80229914802294, -78.22072181982008, -102.03176085499761, -103.57510970584694, -117.68103829610374], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-33.786568349664826, -33.786568349664826, -33.786568349664826, -33.19453841076465, -35.69453841076464, -35.69453841076464, -38.68856205136671, -38.68856205136671, -35.688562051366716, -32.60734731312924, -32.60734731312924, -32.60734731312924, -33.390376461462594, -32.890376461462594, -33.390376461462594, -39.00918706910813, -39.00918706910813, -39.00918706910813, -29.740824359078555, -31.240824359078555, -31.240824359078555, -29.967279188005413, -29.967279188005413, -29.967279188005413, -23.40311695622014, -23.90311695622014, -23.90311695622014, -34.7503649832546, -33.7503649832546, -34.7503649832546, -34.4693371869764, -34.4693371869764, -34.4693371869764, -35.78264427713413, -35.28264427713413, -35.78264427713413, -31.60408392729685, -31.60408392729685, -31.60408392729685, -34.29422125174835, -34.29422125174835, -34.29422125174835, -32.02744648716637, -32.02744648716637, -32.02744648716637, -30.15798806269887, -31.65798806269887, -31.65798806269887, -29.88312683501733, -29.88312683501733, -29.38312683501733, -29.312113273194967, -29.312113273194967, -29.312113273194967, -25.70524728988244, -25.70524728988244, -25.70524728988244, -36.354276893419915, -36.354276893419915, -36.354276893419915, -41.29224933775847, -41.29224933775847, -40.79224933775847, -27.843053250487856, -27.843053250487856, -26.343053250487856, -22.593939152927287, -22.093939152927287, -24.093939152927287, -46.150182815145, -49.150182815145, -46.650182815145, -28.75481922286889, -28.75481922286889, -28.75481922286889, -25.09872709692474, -25.09872709692474, -23.59872709692474, -37.08516657200178, -35.58516657200178, -37.08516657200178, -25.52621091745684, -24.52621091745684, -25.52621091745684, -25.844165466898662, -26.344165466898662, -26.344165466898662, -31.109066648930824, -31.109066648930824, -31.109066648930824, -29.343618556808764, -29.843618556808764, -29.843618556808764, -31.47507428538505, -31.47507428538505, -31.47507428538505, -28.242283911394612, -26.242283911394612, -28.242283911394612, -25.05877673734072, -25.05877673734072, -25.05877673734072, -26.572735073739604, -26.572735073739604, -26.572735073739604, -34.55366478391016, -34.55366478391016, -33.55366478391016, -22.847925194656618, -22.347925194656618, -22.847925194656618, -34.60248203283036, -34.60248203283036, -33.10248203283035, -26.537438433295993, -26.537438433295993, -26.537438433295993, -37.88781404693099, -37.88781404693099, -37.88781404693099, -30.81716361039164, -30.81716361039164, -30.81716361039164, -32.28778198562906, -30.787781985629056, -32.28778198562906, -30.198491674898605, -30.198491674898605, -30.198491674898605, -36.645179452294215, -36.645179452294215, -36.645179452294215, -30.32252313759143, -29.32252313759143, -30.32252313759143, -35.57383053964617, -35.57383053964617, -35.57383053964617, -29.46659599544874, -28.96659599544874, -28.46659599544874, -33.060278892457255, -33.060278892457255, -33.060278892457255, -35.35042787986131, -35.35042787986131, -35.35042787986131, -30.42384442352735, -28.42384442352735, -29.42384442352735, -39.77204220102418, -39.77204220102418, -39.77204220102418, -31.956353969538903, -31.956353969538903, -31.956353969538903, -30.153323588316383, -31.653323588316383, -31.653323588316383, -33.347089913461204, -34.34708991346121, -34.34708991346121, -32.52886556028004, -32.52886556028004, -32.52886556028004, -37.59514778059491, -37.59514778059491, -35.09514778059491, -33.832223912085354, -33.832223912085354, -33.832223912085354, -33.84842284618115, -33.84842284618115, -33.84842284618115, -24.402261528598594, -25.402261528598594, -25.402261528598594, -31.755055416033162, -31.755055416033162, -31.755055416033162, -30.14706176212235, -28.64706176212235, -30.14706176212235, -29.56826689688528, -29.56826689688528, -29.56826689688528, -38.944234565311774, -39.444234565311774, -39.444234565311774, -24.57008932198337, -24.57008932198337, -24.57008932198337, -25.3262141075478, -25.3262141075478, -25.3262141075478, -26.43958784810958, -26.43958784810958, -24.93958784810958, -27.763610420285904, -26.763610420285904, -27.763610420285904, -34.580410555722466, -33.080410555722466, -34.580410555722466, -37.67577253677739, -37.67577253677739, -37.67577253677739, -38.0842180609743, -35.584218060974294, -38.0842180609743, -28.735451415377327, -28.735451415377327, -28.735451415377327, -38.11407832628127, -38.11407832628127, -38.11407832628127, -24.699667982793766, -25.69966798279377, -25.69966798279377, -27.535447803360412, -27.535447803360412, -27.535447803360412, -32.564380590911455, -32.564380590911455, -32.564380590911455, -39.10905623425616, -37.10905623425617, -39.10905623425616, -35.15213061397313, -35.15213061397313, -34.65213061397313, -31.307270879933768, -31.307270879933768, -31.307270879933768, -32.062841702475296, -32.062841702475296, -32.062841702475296, -22.966362016691136, -24.966362016691136, -24.966362016691136, -32.48814714994542, -32.48814714994542, -32.48814714994542, -37.97758669430091, -38.47758669430091, -37.47758669430091, -35.78017495856615, -35.78017495856615, -35.78017495856615, -33.18968844729597, -33.18968844729597, -31.189688447295964, -48.49317697600122, -50.493176976001216, -50.493176976001216, -38.231248670627075, -38.231248670627075, -38.231248670627075, -42.854865506283616, -41.854865506283616, -42.354865506283616, -35.07594348593135, -35.07594348593135, -35.07594348593135, -30.93098802072616, -30.93098802072616, -30.93098802072616, -34.61309071825478, -37.11309071825478, -37.11309071825478, -30.89035051928826, -30.89035051928826, -30.89035051928826, -39.17935874089102, -39.17935874089102, -36.17935874089102, -35.239946454574834, -35.239946454574834, -35.239946454574834, -31.918473538790074, -31.918473538790074, -31.918473538790074, -33.1101921147552, -33.1101921147552, -33.1101921147552, -28.685633577432277, -29.685633577432277, -29.685633577432277, -32.110926813601516, -32.110926813601516, -32.110926813601516, -28.130140638603695, -28.130140638603695, -28.130140638603695, -38.64261628294051, -37.64261628294051, -38.64261628294051, -35.43851426504043, -35.43851426504043, -35.43851426504043, -28.666756025593667, -28.666756025593667, -27.666756025593667, -32.76110859374824, -32.76110859374824, -32.76110859374824, -31.61575787133125, -29.615757871331258, -31.61575787133125, -35.4246198708224, -36.4246198708224, -36.4246198708224, -30.93008657560078, -30.93008657560078, -30.93008657560078, -43.710508278788296, -46.210508278788296, -45.210508278788296, -31.716816319035093, -32.71681631903509, -32.71681631903509, -22.048945614688527, -22.048945614688527, -22.048945614688527, -32.17398190350511, -32.17398190350511, -32.17398190350511, -21.31180712836529, -21.31180712836529, -21.31180712836529, -28.604336541001032, -27.604336541001032, -28.604336541001032, -28.995684712074556, -28.995684712074556, -28.995684712074556, -24.472109773599, -22.972109773599, -24.472109773599, -35.626502858778515, -33.626502858778515, -35.626502858778515, -35.570488238893915, -35.070488238893915, -35.570488238893915, -31.76266118325366, -31.26266118325366, -31.76266118325366, -29.509490844032477, -29.509490844032477, -29.009490844032477, -45.21126922412391, -43.71126922412391, -43.21126922412391, -30.950214083161043, -30.950214083161043, -30.950214083161043, -23.025468354838253, -23.025468354838253, -23.025468354838253, -36.28935972421587, -37.28935972421587, -36.78935972421587, -27.775667645452916, -27.775667645452916, -27.775667645452916, -30.177133672192415, -30.177133672192415, -30.177133672192415, -38.92101574546081, -36.9210157454608, -38.92101574546081, -31.798134898555254, -31.798134898555254, -31.798134898555254, -42.267433049341, -42.267433049341, -42.267433049341, -26.07357393994003, -26.07357393994003, -26.07357393994003, -34.01058695166588, -34.01058695166588, -34.01058695166588, -34.52503656861566, -34.52503656861566, -34.52503656861566, -39.22701276536791, -39.22701276536791, -39.22701276536791]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3135674813371942, "mean_inference_ms": 1.2670282880404158, "mean_action_processing_ms": 0.06984174583026537, "mean_env_wait_ms": 0.5811475089884215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 188800, "timesteps_this_iter": 0, "agent_timesteps_total": 566400, "timers": {"sample_time_ms": 1579.715, "sample_throughput": 2025.682, "load_time_ms": 0.137, "load_throughput": 23386953.825, "learn_time_ms": 790.904, "learn_throughput": 4046.003, "update_time_ms": 1.496}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 73.2206413269043, "policy_loss": -0.002630357402265293, "vf_loss": 73.23532791137696, "vf_explained_var": -0.0012262880802154541, "kl": 0.005549715464563604, "entropy": 1.205467200279236, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 188800, "num_agent_steps_sampled": 566400, "num_steps_trained": 188800, "num_agent_steps_trained": 566400, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7550, "training_iteration": 59, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-07", "timestamp": 1718736427, "time_this_iter_s": 1.5373809337615967, "time_total_s": 90.86840009689331, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 90.86840009689331, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 38.4, "ram_util_percent": 30.45}}
{"episode_reward_max": -58.363214418947116, "episode_reward_min": -149.5636723949022, "episode_reward_mean": -98.0547304035505, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -50.187890798300785}, "policy_reward_max": {"shared_policy": -19.454404806315694}, "policy_reward_mean": {"shared_policy": -32.68491013451683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.03845811316879, -69.56811674032919, -58.363214418947116, -90.3373037475268, -126.81759795534947, -87.32695706482002, -85.10165418352284, -119.54401569853856, -102.48293637117298, -110.32790933694648, -103.61007247603429, -76.99382113341464, -90.62829752622345, -111.601774281226, -96.38996016499027, -98.90788272248642, -96.47116993234484, -96.6875167212325, -80.94223126140571, -94.06190346117339, -84.39485761258923, -133.73551875541048, -103.1713586252939, -89.55269537445392, -85.53289747412548, -97.87669751510413, -101.98084719984183, -89.073383017708, -100.07000329691846, -94.82705860915846, -101.1240133567207, -104.93095796779379, -88.75270613300155, -87.37704442029481, -93.46390786482333, -126.73001956610779, -102.14470428445131, -101.48545196871363, -97.8378192994413, -85.62898562309097, -143.45752461616482, -98.95293804298157, -123.40565171440241, -77.26635633944845, -89.00899829042429, -84.2549733898054, -66.0295004141854, -104.6310112297524, -110.86452763826065, -111.14147557923768, -80.0344338444891, -80.49948570043416, -68.44290175627891, -78.94778041030003, -115.54826292258677, -107.16311130352874, -94.07685109742818, -99.77162230936263, -111.83850651653476, -82.03243128318246, -118.7750482861149, -75.09321128451379, -123.00280754724324, -82.61927458151212, -134.6389129925261, -72.70113112844027, -96.00861764705128, -117.76694631879325, -112.58410578327965, -107.9283165994415, -80.91774191433947, -90.02718600933137, -80.94686647842555, -99.78484485705327, -102.83856055009662, -75.64240657449365, -125.1666564507615, -72.61920718569951, -108.12959748226815, -63.75983557044252, -95.51321117151589, -119.1832572174951, -86.67674199716046, -118.78803451474502, -115.42746042349135, -96.47000243857084, -101.68661595447989, -95.92244797162277, -75.44936973116369, -112.62406612819376, -116.3641027327736, -70.85084554063371, -98.86259246769825, -81.90933009194946, -117.31399878061329, -73.86610227544327, -127.14532985764112, -123.18754102549919, -77.04217672344636, -101.57186500566498, -88.76067751162662, -106.07346363446713, -113.5240448537794, -108.49390736646113, -83.74753184387673, -89.97223622531901, -70.0172753700149, -106.66204603221613, -77.40645508202451, -106.6537363557168, -108.40766923174839, -105.70737398241009, -149.5636723949022, -115.49430780592286, -110.80951838064954, -101.01742521338146, -81.18300549304571, -104.40427202655557, -82.107037345202, -80.2443008934774, -72.37966309103247, -63.00851761803638, -122.6518629218236, -94.26710748715324, -95.24906164149327, -99.14476012147043, -130.14439366971888, -124.60970512102917, -113.95944709231256, -97.38204368838026], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-35.34615270438958, -33.34615270438958, -35.34615270438958, -23.18937224677639, -23.18937224677639, -23.18937224677639, -19.454404806315694, -19.454404806315694, -19.454404806315694, -30.94576791584226, -28.44576791584226, -30.94576791584226, -43.60586598511649, -42.60586598511649, -40.60586598511649, -29.44231902160667, -28.44231902160667, -29.44231902160667, -28.36721806117428, -28.36721806117428, -28.36721806117428, -39.848005232846184, -39.848005232846184, -39.848005232846184, -33.827645457057656, -34.327645457057656, -34.327645457057656, -36.77596977898217, -36.77596977898217, -36.77596977898217, -34.536690825344785, -34.536690825344785, -34.536690825344785, -27.164607044471538, -25.164607044471538, -24.664607044471538, -30.209432508741138, -30.209432508741138, -30.209432508741138, -37.200591427075324, -37.200591427075324, -37.200591427075324, -30.129986721663414, -33.129986721663414, -33.129986721663414, -33.13596090749547, -32.63596090749547, -33.13596090749547, -30.82372331078162, -32.32372331078162, -33.32372331078162, -32.895838907077504, -32.895838907077504, -30.895838907077504, -26.98074375380192, -26.98074375380192, -26.98074375380192, -30.020634487057805, -32.520634487057805, -31.520634487057805, -28.131619204196422, -28.63161920419642, -27.63161920419642, -44.57850625180347, -44.07850625180347, -45.07850625180347, -35.057119541764635, -33.05711954176463, -35.057119541764635, -29.850898458151296, -29.850898458151296, -29.850898458151296, -28.510965824708503, -28.510965824708503, -28.510965824708503, -32.79223250503469, -32.79223250503469, -32.29223250503469, -33.82694906661394, -35.32694906661394, -32.82694906661394, -28.357794339235966, -30.357794339235966, -30.357794339235966, -33.52333443230615, -34.02333443230615, -32.52333443230616, -31.609019536386132, -31.609019536386132, -31.609019536386132, -34.04133778557357, -33.041337785573575, -34.04133778557357, -34.97698598926459, -34.97698598926459, -34.97698598926459, -29.584235377667195, -29.584235377667195, -29.584235377667195, -29.12568147343161, -29.12568147343161, -29.12568147343161, -30.821302621607774, -31.321302621607774, -31.321302621607774, -42.24333985536923, -42.24333985536923, -42.24333985536923, -34.04823476148378, -34.04823476148378, -34.04823476148378, -32.828483989571204, -34.328483989571204, -34.328483989571204, -32.27927309981377, -32.27927309981377, -33.27927309981377, -28.042995207696976, -29.042995207696976, -28.542995207696976, -47.48584153872163, -47.98584153872163, -47.98584153872163, -31.98431268099386, -33.48431268099386, -33.48431268099386, -41.30188390480081, -41.30188390480081, -40.80188390480081, -25.25545211314951, -27.25545211314951, -24.75545211314951, -29.66966609680807, -29.66966609680807, -29.66966609680807, -27.75165779660178, -28.25165779660178, -28.25165779660178, -22.00983347139514, -22.00983347139514, -22.00983347139514, -35.210337076584125, -35.210337076584125, -34.21033707658413, -36.95484254608685, -36.45484254608685, -37.45484254608685, -35.713825193079224, -37.21382519307922, -38.21382519307922, -26.67814461482971, -26.67814461482971, -26.67814461482971, -26.499828566811402, -26.999828566811402, -26.999828566811402, -22.480967252092956, -23.480967252092952, -22.480967252092956, -26.31592680343332, -26.31592680343332, -26.31592680343332, -39.01608764086225, -39.01608764086225, -37.51608764086225, -36.05437043450961, -36.05437043450961, -35.05437043450961, -31.858950365809388, -31.858950365809388, -30.358950365809388, -33.257207436454216, -33.257207436454216, -33.257207436454216, -37.77950217217825, -36.27950217217825, -37.77950217217825, -27.344143761060813, -27.344143761060813, -27.344143761060813, -39.591682762038324, -38.091682762038324, -41.091682762038324, -25.03107042817127, -25.03107042817127, -25.03107042817127, -40.66760251574774, -41.66760251574774, -40.66760251574774, -26.53975819383737, -28.039758193837375, -28.039758193837375, -43.21297099750869, -45.71297099750869, -45.71297099750869, -23.900377042813403, -23.900377042813403, -24.900377042813403, -32.002872549017084, -32.002872549017084, -32.002872549017084, -39.58898210626443, -40.08898210626443, -38.08898210626443, -37.52803526109323, -37.52803526109323, -37.52803526109323, -35.97610553314717, -35.97610553314717, -35.97610553314717, -26.97258063811315, -26.97258063811315, -26.97258063811315, -29.675728669777122, -30.175728669777122, -30.175728669777122, -26.64895549280852, -27.64895549280852, -26.64895549280852, -33.261614952351074, -33.261614952351074, -33.261614952351074, -34.279520183365506, -34.279520183365506, -34.279520183365506, -25.214135524831214, -25.214135524831214, -25.214135524831214, -40.555552150253824, -42.555552150253824, -42.055552150253824, -24.206402395233145, -24.206402395233145, -24.206402395233145, -36.54319916075602, -35.043199160756025, -36.54319916075602, -21.58661185681417, -21.58661185681417, -20.58661185681417, -31.837737057171978, -31.837737057171978, -31.837737057171978, -40.39441907249836, -38.894419072498366, -39.89441907249836, -28.89224733238683, -28.89224733238683, -28.89224733238683, -39.59601150491498, -39.59601150491498, -39.59601150491498, -38.475820141163794, -38.475820141163794, -38.475820141163794, -31.82333414619028, -32.323334146190284, -32.323334146190284, -32.395538651493304, -34.895538651493304, -34.395538651493304, -31.640815990540943, -32.14081599054094, -32.14081599054094, -24.81645657705454, -25.31645657705454, -25.31645657705454, -38.041355376064594, -36.541355376064594, -38.041355376064594, -39.28803424425791, -39.28803424425791, -37.78803424425791, -23.783615180211235, -23.283615180211235, -23.783615180211235, -33.28753082256608, -32.28753082256608, -33.28753082256608, -27.636443363983144, -26.636443363983144, -27.636443363983144, -39.10466626020442, -39.10466626020442, -39.10466626020442, -24.62203409181442, -24.62203409181442, -24.62203409181442, -42.381776619213724, -42.381776619213724, -42.381776619213724, -41.0625136751664, -41.0625136751664, -41.0625136751664, -25.680725574482096, -25.680725574482096, -25.680725574482096, -33.85728833522167, -34.35728833522167, -33.35728833522167, -29.920225837208882, -28.920225837208882, -29.920225837208882, -35.357821211489075, -35.357821211489075, -35.357821211489075, -37.84134828459311, -37.84134828459311, -37.84134828459311, -36.1646357888204, -36.1646357888204, -36.1646357888204, -27.91584394795892, -27.91584394795892, -27.91584394795892, -29.99074540843965, -29.99074540843965, -29.99074540843965, -23.672425123338297, -22.672425123338297, -23.672425123338297, -33.55401534407202, -36.55401534407203, -36.55401534407203, -25.802151694008163, -25.802151694008163, -25.802151694008163, -35.551245451905594, -35.551245451905594, -35.551245451905594, -35.63588974391613, -36.63588974391613, -36.13588974391613, -34.23579132747005, -35.73579132747005, -35.73579132747005, -50.187890798300785, -49.187890798300785, -50.187890798300785, -38.4981026019743, -38.4981026019743, -38.4981026019743, -36.10317279354985, -37.60317279354985, -37.10317279354985, -33.67247507112717, -33.67247507112717, -33.67247507112717, -27.061001831015243, -27.061001831015243, -27.061001831015243, -35.134757342185196, -34.634757342185196, -34.634757342185196, -27.369012448400646, -27.369012448400646, -27.369012448400646, -26.414766964492454, -26.914766964492454, -26.914766964492454, -25.126554363677474, -24.626554363677474, -22.626554363677474, -21.002839206012123, -21.002839206012123, -21.002839206012123, -40.88395430727453, -41.38395430727453, -40.38395430727453, -31.422369162384413, -31.422369162384413, -31.422369162384413, -31.749687213831105, -31.749687213831105, -31.749687213831105, -33.04825337382347, -33.04825337382347, -33.04825337382347, -43.38146455657297, -43.38146455657297, -43.38146455657297, -41.703235040343074, -41.203235040343074, -41.703235040343074, -38.15314903077084, -38.15314903077084, -37.65314903077084, -32.96068122946007, -32.96068122946007, -31.460681229460075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3132133407894755, "mean_inference_ms": 1.2660232957878013, "mean_action_processing_ms": 0.06977650568042097, "mean_env_wait_ms": 0.5806451700334839, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 1578.054, "sample_throughput": 2027.814, "load_time_ms": 0.135, "load_throughput": 23746944.091, "learn_time_ms": 789.48, "learn_throughput": 4053.3, "update_time_ms": 1.509}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 80.77330856323242, "policy_loss": -0.003623904462127614, "vf_loss": 80.78906784057617, "vf_explained_var": -0.014942538738250733, "kl": 0.0059060142153824725, "entropy": 1.2139192700386048, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 576000, "num_steps_trained": 192000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7680, "training_iteration": 60, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-09", "timestamp": 1718736429, "time_this_iter_s": 1.4956843852996826, "time_total_s": 92.364084482193, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924de040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 92.364084482193, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.73333333333333, "ram_util_percent": 30.366666666666664}}
{"episode_reward_max": -61.08108076009672, "episode_reward_min": -144.44855989912892, "episode_reward_mean": -96.62946263165502, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"shared_policy": -48.482853299709625}, "policy_reward_max": {"shared_policy": -20.36036025336557}, "policy_reward_mean": {"shared_policy": -32.209820877218334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.64058300833946, -98.47279155988899, -86.04155380459771, -116.39023747591324, -119.93776980208197, -116.49362896697087, -100.66680662300175, -82.42613384950864, -89.27016662780868, -86.43205645260201, -97.6558067552407, -94.03226425562927, -97.76415930768884, -94.64345793819449, -78.54875258253115, -70.0736248363933, -87.37183868607137, -86.20893386363663, -116.33936242142235, -111.30593664514895, -76.39837569860954, -119.9365069609242, -103.56929317813554, -94.1511509208674, -83.2664862397843, -100.8835712236772, -105.02951255991486, -88.72947584669761, -80.97684224301437, -129.74071341798015, -74.20035756420383, -85.18223040066988, -108.95688062700027, -69.87126734058783, -94.74581251274438, -80.7443755904966, -75.11978073689485, -102.66675362884969, -100.94952512389126, -127.74430722386148, -144.44855989912892, -104.91125595841737, -114.74418465434101, -98.1747240401012, -95.32877123498736, -103.17912828049762, -100.55243039531912, -80.31743677001731, -91.00646093995319, -102.49105507271466, -93.03926951585458, -95.4637885205847, -85.77105788748631, -95.268738683015, -96.2276069788829, -113.56502629647159, -119.05011651060039, -102.42618943591017, -131.24093186261263, -85.62949192046196, -82.2105764288281, -86.69727360649755, -110.38269194907232, -94.44522979348731, -131.60648228230144, -90.71220683801164, -79.33933673113158, -132.05314302862794, -87.44616363643485, -98.5864676171364, -85.65921691632367, -78.98049198436627, -114.54745433095991, -117.87755313754036, -106.53802178390457, -102.86811205503966, -87.91779638372725, -92.71506420614679, -121.10099818653796, -79.7890739812342, -103.40472958693647, -94.30611289241, -80.77698853520447, -68.96045357401069, -80.11100010212675, -94.12443448897993, -109.56548657286832, -110.01971232984046, -80.71669040355002, -92.91899459886606, -89.6273162959144, -75.37892566756, -128.10260898504654, -83.56923626550514, -139.88592320644472, -97.43183158500443, -82.16307949160674, -106.03675684440373, -92.94844393924531, -108.21767209018164, -96.60576035628691, -109.69012908196822, -74.08205371754688, -97.41050534818883, -102.2098092551512, -104.19301490255883, -92.08904633667048, -98.03248111426566, -61.08108076009672, -86.36325385740459, -100.21949490741264, -67.52053369670641, -103.21296697226336, -69.95292889472874, -88.82065758892928, -82.89597547010902, -102.95111185983572, -88.87129829926373, -108.47174952200669, -96.70660216535866], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-26.21352766944649, -26.21352766944649, -26.21352766944649, -33.32426385329634, -31.324263853296333, -33.82426385329634, -29.180517934865914, -28.680517934865914, -28.180517934865914, -39.130079158637734, -38.130079158637734, -39.130079158637734, -39.31258993402732, -40.31258993402732, -40.31258993402732, -38.831209655656934, -38.831209655656934, -38.831209655656934, -33.72226887433392, -33.22226887433392, -33.72226887433392, -26.642044616502865, -28.142044616502865, -27.642044616502865, -29.756722209269565, -29.756722209269565, -29.756722209269565, -28.14401881753402, -29.14401881753402, -29.14401881753402, -32.55193558508023, -32.55193558508023, -32.55193558508023, -32.17742141854308, -29.677421418543073, -32.17742141854308, -31.254719769229627, -34.254719769229624, -32.254719769229624, -31.714485979398184, -31.714485979398184, -31.214485979398184, -24.516250860843712, -27.016250860843712, -27.016250860843712, -23.52454161213109, -23.52454161213109, -23.02454161213109, -29.457279562023807, -28.957279562023807, -28.957279562023807, -28.736311287878877, -28.736311287878877, -28.736311287878877, -38.779787473807474, -38.779787473807474, -38.779787473807474, -38.1019788817163, -35.1019788817163, -38.1019788817163, -25.466125232869857, -25.466125232869857, -25.466125232869857, -41.312168986974754, -41.312168986974754, -37.31216898697475, -34.68976439271185, -34.68976439271185, -34.18976439271185, -31.383716973622445, -31.383716973622445, -31.383716973622445, -27.92216207992811, -27.92216207992811, -27.42216207992811, -33.29452374122572, -33.79452374122572, -33.79452374122572, -35.0098375199716, -35.0098375199716, -35.0098375199716, -30.076491948899207, -30.076491948899207, -28.57649194889921, -25.658947414338122, -27.658947414338122, -27.658947414338122, -43.746904472660034, -42.246904472660034, -43.746904472660034, -23.400119188067936, -25.900119188067936, -24.900119188067936, -29.227410133556617, -26.727410133556617, -29.227410133556617, -36.31896020900011, -36.31896020900011, -36.31896020900011, -21.290422446862603, -24.290422446862596, -24.290422446862596, -32.08193750424814, -30.581937504248142, -32.08193750424814, -26.91479186349886, -26.91479186349886, -26.91479186349886, -25.206593578964952, -24.20659357896495, -25.706593578964952, -34.222251209616566, -34.222251209616566, -34.222251209616566, -33.649841707963766, -33.649841707963766, -33.649841707963766, -42.41476907462048, -40.91476907462048, -44.41476907462049, -47.482853299709625, -48.482853299709625, -48.482853299709625, -34.970418652805776, -34.970418652805776, -34.970418652805776, -38.24806155144699, -38.24806155144699, -38.24806155144699, -32.72490801336708, -32.72490801336708, -32.72490801336708, -31.442923744995788, -31.942923744995788, -31.942923744995788, -34.39304276016587, -34.39304276016587, -34.39304276016587, -33.517476798439716, -33.517476798439716, -33.517476798439716, -26.772478923339108, -26.772478923339108, -26.772478923339108, -30.33548697998439, -30.33548697998439, -30.33548697998439, -34.66368502423825, -34.66368502423825, -33.16368502423825, -31.013089838618193, -31.013089838618193, -31.013089838618193, -32.487929506861576, -30.487929506861576, -32.487929506861576, -28.923685962495426, -27.923685962495426, -28.923685962495426, -31.75624622767164, -31.75624622767164, -31.75624622767164, -31.40920232629429, -32.40920232629429, -32.40920232629429, -38.18834209882388, -38.18834209882388, -37.188342098823874, -40.516705503533466, -39.516705503533466, -39.016705503533466, -33.80872981197008, -34.30872981197008, -34.30872981197008, -43.913643954204204, -43.913643954204204, -43.41364395420421, -28.543163973487328, -28.543163973487328, -28.543163973487328, -27.57019214294269, -26.57019214294269, -28.07019214294269, -28.899091202165852, -28.899091202165852, -28.899091202165852, -36.794230649690775, -36.794230649690775, -36.794230649690775, -31.481743264495794, -31.481743264495794, -31.481743264495794, -43.53549409410049, -44.03549409410049, -44.03549409410049, -30.23740227933721, -30.23740227933721, -30.23740227933721, -26.446445577043868, -26.446445577043868, -26.446445577043868, -44.51771434287597, -44.51771434287597, -43.01771434287597, -29.148721212144938, -29.148721212144938, -29.148721212144938, -32.86215587237881, -31.862155872378807, -33.86215587237881, -27.55307230544123, -29.05307230544123, -29.05307230544123, -26.326830661455418, -26.326830661455418, -26.326830661455418, -38.01581811031997, -38.01581811031997, -38.51581811031997, -38.62585104584677, -39.62585104584677, -39.62585104584677, -33.51267392796817, -37.01267392796817, -36.01267392796817, -34.78937068501323, -34.78937068501323, -33.28937068501324, -29.305932127909095, -29.305932127909095, -29.305932127909095, -30.905021402048945, -30.905021402048945, -30.905021402048945, -40.36699939551267, -40.36699939551267, -40.36699939551267, -25.92969132707805, -26.92969132707805, -26.92969132707805, -34.80157652897883, -34.80157652897883, -33.80157652897883, -31.435370964136666, -31.435370964136666, -31.435370964136666, -28.258996178401475, -26.758996178401475, -25.758996178401475, -20.986817858003537, -23.986817858003537, -23.986817858003537, -26.703666700708922, -26.703666700708922, -26.703666700708922, -31.041478162993315, -31.541478162993315, -31.541478162993315, -35.85516219095609, -36.85516219095608, -36.85516219095608, -36.673237443280165, -36.673237443280165, -36.673237443280165, -27.238896801183344, -26.238896801183344, -27.238896801183344, -30.306331532955372, -31.306331532955372, -31.306331532955372, -30.875772098638144, -30.875772098638144, -27.875772098638144, -25.29297522252, -24.79297522252, -25.29297522252, -41.7008696616822, -43.20086966168221, -43.20086966168221, -28.3564120885017, -26.8564120885017, -28.3564120885017, -45.96197440214823, -46.96197440214823, -46.961974402148236, -31.643943861668113, -33.14394386166811, -32.64394386166811, -27.387693163868903, -27.387693163868903, -27.387693163868903, -35.67891894813458, -35.17891894813458, -35.17891894813458, -30.98281464641509, -30.98281464641509, -30.98281464641509, -36.072557363393855, -36.072557363393855, -36.072557363393855, -32.2019201187623, -32.2019201187623, -32.2019201187623, -35.896709693989415, -36.896709693989415, -36.896709693989415, -25.194017905848945, -23.694017905848945, -25.194017905848945, -29.803501782729587, -33.80350178272959, -33.80350178272959, -34.403269751717076, -34.403269751717076, -33.403269751717076, -34.7310049675196, -34.7310049675196, -34.7310049675196, -31.529682112223497, -29.029682112223497, -31.529682112223497, -33.01082703808855, -32.01082703808855, -33.01082703808855, -20.36036025336557, -20.36036025336557, -20.36036025336557, -28.787751285801534, -28.787751285801534, -28.787751285801534, -32.40649830247089, -33.906498302470894, -33.906498302470894, -23.340177898902144, -20.840177898902144, -23.340177898902144, -32.40432232408779, -35.404322324087794, -35.404322324087794, -23.317642964909588, -23.317642964909588, -23.317642964909588, -30.606885862976444, -30.606885862976444, -27.606885862976444, -27.63199182336968, -27.63199182336968, -27.63199182336968, -34.31703728661191, -34.31703728661191, -34.31703728661191, -28.62376609975457, -30.12376609975457, -30.12376609975457, -36.65724984066889, -36.65724984066889, -35.15724984066889, -32.235534055119565, -32.235534055119565, -32.235534055119565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3127072215428344, "mean_inference_ms": 1.264695156109723, "mean_action_processing_ms": 0.06969532122176467, "mean_env_wait_ms": 0.5800910015818488, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 195200, "timesteps_this_iter": 0, "agent_timesteps_total": 585600, "timers": {"sample_time_ms": 1544.906, "sample_throughput": 2071.324, "load_time_ms": 0.131, "load_throughput": 24389919.68, "learn_time_ms": 789.882, "learn_throughput": 4051.236, "update_time_ms": 1.448}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0005000000000000001, "total_loss": 80.31061477661133, "policy_loss": -0.0018172497311218726, "vf_loss": 80.32466430664063, "vf_explained_var": 0.0008044779300689697, "kl": 0.004474536021995529, "entropy": 1.2231919765472412, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 195200, "num_agent_steps_sampled": 585600, "num_steps_trained": 195200, "num_agent_steps_trained": 585600, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7800, "training_iteration": 61, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-10", "timestamp": 1718736430, "time_this_iter_s": 1.4924066066741943, "time_total_s": 93.85649108886719, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd29219b790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 93.85649108886719, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 37.4, "ram_util_percent": 30.4}}
{"episode_reward_max": -63.087079939273295, "episode_reward_min": -155.11593009770627, "episode_reward_mean": -98.2067609496632, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -54.038643365902075}, "policy_reward_max": {"shared_policy": -21.02902664642442}, "policy_reward_mean": {"shared_policy": -32.73558698322107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.28774518180818, -94.2585038881689, -83.51176657489634, -111.29001214610459, -124.14799335995258, -88.92170145561235, -98.20605419591848, -82.49582187544907, -71.02941054177604, -85.41373159766596, -112.58631264224921, -86.28951016398808, -135.76305734454473, -107.27477174705287, -94.82453742785358, -103.62236997485469, -101.98188317694861, -116.44101397624935, -85.53303609108124, -80.12971418733373, -76.81364965230513, -75.17583689948646, -84.16854381838161, -114.47678040361156, -93.49761143484133, -100.15763854509517, -132.93104728694084, -101.91716800198733, -106.99102457535388, -81.49437300550093, -155.11593009770627, -122.6608732900535, -102.4637637866456, -74.38530611756465, -121.84084804160887, -106.3971360693026, -91.21446256961045, -92.420461230212, -127.37881282766601, -91.76655465477447, -82.81751619633694, -101.03743459755964, -89.80288140769049, -96.67893499899466, -121.74515968412011, -68.25913946904507, -108.31854661000833, -88.8014297241632, -119.31614658838939, -96.06596955978951, -102.34526723599691, -92.1629215226401, -97.18387910783485, -86.4781397498169, -81.23741335770993, -90.71901980215414, -118.15784124894141, -80.0737657002269, -103.91051175725063, -109.14764140565562, -101.48812724317689, -121.62980050027458, -90.81648656597628, -130.07656974650217, -108.00758116539002, -63.087079939273295, -87.6628996730216, -112.67461080312133, -105.83203615986638, -73.48041647997573, -124.03563775464981, -77.89272804813, -106.19618205756325, -86.86781874348158, -65.94792915299496, -89.65308926745033, -78.91574711217412, -109.8032422949292, -91.06100373599833, -100.00432560630317, -91.28487617045056, -100.2808984053844, -88.37838992288407, -92.67776442462628, -95.62368105839901, -101.98015262682301, -85.76512446854585, -92.05655055308254, -66.66712407793418, -81.28475313102548, -110.68463330046983, -89.37532924049033, -99.32799591085501, -95.36111292818791, -64.44898776940062, -92.20050304133521, -88.44673625843024, -105.77134048848555, -102.06585914201881, -111.14804880579705, -109.73052726577657, -115.99513744823734, -105.05512564793818, -111.60222372968767, -90.09474255975226, -112.6248106353233, -106.07967698471289, -79.49977230469742, -84.87857598986781, -90.91144519217518, -101.34050359813257, -86.42121910151712, -89.52964521187421, -91.25876781180973, -105.9673376035602, -102.9350274208474, -74.66976965394838, -103.58813251365027, -88.7715676067556, -81.83351232978055, -87.70248660734352, -139.04566018363838, -85.78016152662127, -112.7360840120415, -108.97920019389447, -94.7116538232066, -92.96146606446179, -112.4245486946394, -134.211698693956, -131.0389396890095], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-34.59591506060269, -34.59591506060269, -34.09591506060269, -31.419501296056303, -31.419501296056303, -31.419501296056303, -27.83725552496542, -27.83725552496542, -27.83725552496542, -37.09667071536819, -37.09667071536819, -37.09667071536819, -41.38266445331754, -41.38266445331754, -41.38266445331754, -29.9739004852041, -29.9739004852041, -28.9739004852041, -32.40201806530617, -32.90201806530617, -32.90201806530617, -25.998607291816356, -27.99860729181635, -28.498607291816356, -23.67647018059199, -23.67647018059199, -23.67647018059199, -28.471243865888678, -28.471243865888678, -28.471243865888678, -37.695437547416404, -37.695437547416404, -37.195437547416404, -28.76317005466269, -28.76317005466269, -28.76317005466269, -45.254352448181606, -44.754352448181606, -45.754352448181606, -35.92492391568428, -35.42492391568428, -35.92492391568428, -31.274845809284514, -30.774845809284514, -32.774845809284514, -34.54078999161825, -34.54078999161825, -34.54078999161825, -33.66062772564956, -34.16062772564956, -34.16062772564956, -37.813671325416436, -39.313671325416436, -39.313671325416436, -28.511012030360416, -28.511012030360416, -28.511012030360416, -26.709904729111255, -26.709904729111255, -26.709904729111255, -26.271216550768372, -25.771216550768372, -24.771216550768372, -24.391945633162155, -25.391945633162155, -25.391945633162155, -28.056181272793864, -28.056181272793864, -28.056181272793864, -38.49226013453722, -37.49226013453722, -38.49226013453722, -31.3325371449471, -30.8325371449471, -31.3325371449471, -32.38587951503175, -33.885879515031746, -33.885879515031746, -44.31034909564695, -44.31034909564695, -44.31034909564695, -33.972389333995785, -33.972389333995785, -33.972389333995785, -36.663674858451316, -36.163674858451316, -34.16367485845132, -27.16479100183367, -27.16479100183367, -27.16479100183367, -51.038643365902075, -50.038643365902075, -54.038643365902075, -41.2202910966845, -41.2202910966845, -40.220291096684505, -33.321254595548545, -34.32125459554854, -34.821254595548545, -24.795102039188208, -24.795102039188208, -24.795102039188208, -40.780282680536274, -40.280282680536274, -40.780282680536274, -36.465712023100906, -35.965712023100906, -33.965712023100906, -30.4048208565368, -30.4048208565368, -30.4048208565368, -30.806820410070674, -30.806820410070674, -30.806820410070674, -43.792937609221994, -43.292937609221994, -40.292937609221994, -30.922184884924786, -30.922184884924786, -29.922184884924793, -27.772505398778993, -27.272505398778993, -27.772505398778993, -33.67914486585322, -33.67914486585322, -33.67914486585322, -29.93429380256349, -29.93429380256349, -29.93429380256349, -32.22631166633157, -32.22631166633157, -32.22631166633157, -40.58171989470669, -40.58171989470669, -40.58171989470669, -24.253046489681694, -21.253046489681694, -22.753046489681694, -37.439515536669454, -33.439515536669454, -37.439515536669454, -29.600476574721068, -29.600476574721068, -29.600476574721068, -40.10538219612979, -40.10538219612979, -39.10538219612979, -32.688656519929815, -31.688656519929808, -31.688656519929815, -34.11508907866567, -34.11508907866567, -34.11508907866567, -31.054307174213378, -31.054307174213378, -30.054307174213378, -32.39462636927831, -32.39462636927831, -32.39462636927831, -28.826046583272305, -28.826046583272305, -28.826046583272305, -27.412471119236667, -26.412471119236667, -27.412471119236667, -30.239673267384717, -30.239673267384717, -30.239673267384717, -36.38594708298048, -41.88594708298048, -39.88594708298048, -27.191255233408974, -24.191255233408974, -28.691255233408974, -35.47017058575022, -34.47017058575022, -33.97017058575022, -35.71588046855186, -36.71588046855186, -36.71588046855186, -33.829375747725656, -33.829375747725656, -33.829375747725656, -40.54326683342485, -40.54326683342485, -40.54326683342485, -30.27216218865876, -30.27216218865876, -30.27216218865876, -44.192189915500734, -43.692189915500734, -42.192189915500734, -36.00252705513002, -36.00252705513002, -36.00252705513002, -21.02902664642442, -21.02902664642442, -21.02902664642442, -29.220966557673872, -29.220966557673872, -29.220966557673872, -37.891536934373796, -36.891536934373796, -37.891536934373796, -35.77734538662213, -35.27734538662213, -34.77734538662213, -24.326805493325224, -23.826805493325224, -25.326805493325224, -39.84521258488328, -42.34521258488328, -41.84521258488328, -25.964242682709997, -25.964242682709997, -25.964242682709997, -35.398727352521064, -35.898727352521064, -34.898727352521064, -29.455939581160514, -27.955939581160514, -29.455939581160514, -22.14930971766498, -21.64930971766498, -22.14930971766498, -29.884363089150092, -29.884363089150092, -29.884363089150092, -26.97191570405803, -25.471915704058034, -26.47191570405803, -36.60108076497638, -36.60108076497638, -36.60108076497638, -30.35366791199945, -30.35366791199945, -30.35366791199945, -33.66810853543439, -33.66810853543439, -32.66810853543439, -30.42829205681684, -30.42829205681684, -30.42829205681684, -33.42696613512812, -33.42696613512812, -33.42696613512812, -30.126129974294678, -28.126129974294678, -30.126129974294678, -30.892588141542102, -30.892588141542102, -30.892588141542102, -31.87456035279967, -31.87456035279967, -31.87456035279967, -33.99338420894101, -33.99338420894101, -33.99338420894101, -28.75504148951527, -28.75504148951527, -28.25504148951527, -30.852183517694208, -30.852183517694208, -30.352183517694208, -22.22237469264473, -22.22237469264473, -22.22237469264473, -27.428251043675186, -27.428251043675186, -26.428251043675182, -36.89487776682329, -36.89487776682329, -36.89487776682329, -30.291776413496784, -29.291776413496784, -29.791776413496784, -32.775998636951655, -33.275998636951655, -33.275998636951655, -31.78703764272931, -31.78703764272931, -31.78703764272931, -21.649662589800204, -21.649662589800204, -21.149662589800204, -30.900167680445055, -30.400167680445055, -30.900167680445055, -29.482245419476733, -29.482245419476733, -29.482245419476733, -34.75711349616186, -35.75711349616186, -35.25711349616186, -35.18861971400625, -33.18861971400625, -33.68861971400625, -37.21601626859899, -37.21601626859899, -36.71601626859899, -36.57684242192552, -36.57684242192552, -36.57684242192552, -40.3317124827458, -40.3317124827458, -35.33171248274581, -35.01837521597938, -35.01837521597938, -35.01837521597938, -37.2007412432292, -37.2007412432292, -37.2007412432292, -29.698247519917402, -30.198247519917402, -30.198247519917402, -37.70827021177443, -37.70827021177443, -37.20827021177443, -35.359892328237635, -35.359892328237635, -35.359892328237635, -26.9999241015658, -26.9999241015658, -25.4999241015658, -28.6261919966226, -28.6261919966226, -27.6261919966226, -30.30381506405839, -30.30381506405839, -30.30381506405839, -33.11350119937755, -34.11350119937755, -34.11350119937755, -29.80707303383903, -29.80707303383903, -26.80707303383903, -29.343215070624712, -30.343215070624716, -29.843215070624716, -30.752922603936565, -30.752922603936565, -29.752922603936565, -34.98911253452006, -35.48911253452006, -35.48911253452006, -34.31167580694916, -34.31167580694916, -34.31167580694916, -25.556589884649487, -23.55658988464949, -25.556589884649487, -34.19604417121677, -34.69604417121677, -34.69604417121677, -27.590522535585208, -30.590522535585208, -30.590522535585208, -28.77783744326019, -28.77783744326019, -24.277837443260186, -29.4008288691145, -29.4008288691145, -28.9008288691145, -46.848553394546165, -44.848553394546165, -47.348553394546165, -28.593387175540418, -28.593387175540418, -28.593387175540418, -36.912028004013834, -37.912028004013834, -37.912028004013834, -36.659733397964835, -37.159733397964835, -35.159733397964835, -32.23721794106886, -30.23721794106886, -32.23721794106886, -30.653822021487244, -31.153822021487244, -31.153822021487244, -37.474849564879804, -37.474849564879804, -37.474849564879804, -44.40389956465205, -45.40389956465205, -44.40389956465205, -42.67964656300321, -44.17964656300321, -44.17964656300321]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31250948314975324, "mean_inference_ms": 1.2640248454810932, "mean_action_processing_ms": 0.06964246830532407, "mean_env_wait_ms": 0.579789765004543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 198400, "timesteps_this_iter": 0, "agent_timesteps_total": 595200, "timers": {"sample_time_ms": 1543.933, "sample_throughput": 2072.629, "load_time_ms": 0.134, "load_throughput": 23958894.68, "learn_time_ms": 788.104, "learn_throughput": 4060.379, "update_time_ms": 1.462}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 81.40027465820313, "policy_loss": -0.002330404776963402, "vf_loss": 81.41450653076171, "vf_explained_var": -0.0032860517501831056, "kl": 0.005042826905264308, "entropy": 1.190317738056183, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 198400, "num_agent_steps_sampled": 595200, "num_steps_trained": 198400, "num_agent_steps_trained": 595200, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7930, "training_iteration": 62, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-12", "timestamp": 1718736432, "time_this_iter_s": 1.4983274936676025, "time_total_s": 95.35481858253479, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d1790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 95.35481858253479, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 36.9, "ram_util_percent": 30.35}}
{"episode_reward_max": -61.87142464744423, "episode_reward_min": -143.53870000555867, "episode_reward_mean": -95.69167392285422, "episode_len_mean": 25.0, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {"shared_policy": -48.17956666851956}, "policy_reward_max": {"shared_policy": -20.623808215814744}, "policy_reward_mean": {"shared_policy": -31.897224640951407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.53870000555867, -94.02641516941632, -107.81188983880732, -115.68559308520658, -85.94581397096167, -96.32795930703334, -115.36447692851497, -89.00932518491656, -122.37342149193124, -131.82015637567036, -120.07244784906054, -95.91531798473969, -118.26865903331888, -86.80187415822449, -74.24771247915663, -81.86447366107497, -88.1644161220613, -101.20705157968092, -97.23758391507054, -65.73675868986606, -89.06386171653446, -66.72000639393464, -100.03195456140881, -79.83112552240011, -101.25005699167335, -78.82029997023191, -89.20211454473385, -105.74897959067204, -99.80113766935376, -87.75520614679445, -99.0947381675656, -110.18931228342304, -120.46814450621723, -86.44225917546493, -90.48493431885663, -71.20206160657511, -86.9908588273651, -91.49236357807025, -83.59589710589114, -75.19994122118484, -96.65550837659441, -104.23185994597897, -61.87142464744423, -98.07246664831142, -94.963507546246, -79.08781349669144, -100.95527106634816, -80.93162705863692, -89.5058020970564, -109.05904075199066, -108.48253338258047, -91.05026153418284, -98.20878999993087, -97.11930459063869, -84.69411361242088, -72.73374560799002, -93.06163185530555, -111.0011543423293, -101.74067711465159, -107.07588476524275, -119.71337762732259, -92.95079478497695, -88.06778146969098, -88.37872957918262, -95.02757934851003, -115.36604441227455, -92.17942101223504, -82.45346112444216, -98.09948089671043, -83.0980547369934, -110.98491455480212, -83.36560857460863, -105.5478191125551, -114.37786673987537, -68.28042669032308, -82.21141720596871, -99.50069044871063, -100.36985982373692, -96.22417258139794, -111.08201536630355, -94.09106228318065, -103.155532075803, -86.54928980522998, -84.40160795710378, -89.31663571456856, -82.69413251540483, -96.69046742411004, -106.85289402239212, -99.21318418529208, -81.26876636128401, -86.44272498363722, -87.92756841541589, -114.35948479306637, -81.09805925985968, -100.87932125795152, -85.4088310995474, -71.12327716062921, -105.69477848856405, -99.09965027889696, -74.87540939891694, -95.08594048802472, -103.62195961990864, -73.43579481641441, -104.02982454051711, -79.38078195844794, -86.25376291574028, -102.1188356314054, -120.91743672720168, -113.68186057045038, -76.35713929627879, -86.22567845983635, -109.24720593598265, -128.27991420978003, -90.52562150451584, -68.28157908710781, -95.9968987619987, -109.95772898698472, -86.23732890012823, -91.91903460481382, -129.4984886050673, -99.17525924094768, -99.53095415806939, -128.23518197890542, -121.38917324702246, -106.15618710994794, -105.18714327136928, -86.95215584601895, -84.01193771437906, -77.33911080851176, -97.1577782346037], "episode_lengths": [25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25], "policy_shared_policy_reward": [-48.17956666851956, -48.17956666851956, -47.17956666851956, -31.342138389805427, -31.342138389805427, -31.342138389805427, -34.93729661293578, -36.43729661293579, -36.43729661293579, -37.56186436173552, -39.06186436173552, -39.06186436173552, -28.64860465698721, -28.64860465698721, -28.64860465698721, -32.1093197690111, -32.1093197690111, -32.1093197690111, -38.45482564283834, -38.45482564283834, -38.45482564283834, -29.836441728305516, -29.336441728305516, -29.836441728305516, -41.79114049731038, -39.79114049731038, -40.79114049731038, -44.273385458556774, -43.273385458556774, -44.273385458556774, -39.35748261635351, -40.35748261635351, -40.35748261635351, -32.30510599491322, -31.305105994913216, -32.30510599491322, -39.25621967777295, -39.25621967777295, -39.75621967777295, -29.600624719408174, -28.600624719408174, -28.600624719408174, -24.749237493052203, -24.749237493052203, -24.749237493052203, -26.954824553691648, -27.454824553691648, -27.454824553691648, -29.38813870735377, -29.38813870735377, -29.38813870735377, -33.73568385989364, -33.73568385989364, -33.73568385989364, -32.57919463835684, -32.07919463835684, -32.57919463835684, -22.245586229955347, -21.245586229955347, -22.245586229955347, -30.02128723884481, -30.02128723884481, -29.02128723884481, -22.240002131311535, -22.240002131311535, -22.240002131311535, -32.34398485380297, -33.84398485380297, -33.84398485380297, -26.110375174133377, -26.610375174133377, -27.110375174133377, -33.25001899722446, -34.75001899722446, -33.25001899722446, -26.27343332341061, -26.27343332341061, -26.27343332341061, -29.73403818157796, -29.73403818157796, -29.73403818157796, -35.582993196890676, -34.582993196890676, -35.582993196890676, -33.267045889784576, -33.267045889784576, -33.267045889784576, -29.418402048931497, -28.918402048931497, -29.418402048931497, -33.1982460558552, -32.6982460558552, -33.1982460558552, -36.72977076114103, -36.72977076114103, -36.72977076114103, -40.48938150207242, -40.48938150207242, -39.48938150207242, -29.147419725154965, -28.147419725154965, -29.147419725154965, -30.49497810628555, -29.49497810628555, -30.49497810628555, -23.067353868858348, -24.067353868858348, -24.067353868858348, -28.99695294245506, -28.99695294245506, -28.99695294245506, -30.16412119269011, -30.66412119269011, -30.66412119269011, -27.865299035297028, -27.865299035297028, -27.865299035297028, -25.06664707372829, -25.06664707372829, -25.06664707372829, -31.885169458864798, -32.385169458864794, -32.385169458864794, -35.24395331532631, -34.243953315326316, -34.743953315326316, -20.623808215814744, -20.623808215814744, -20.623808215814744, -32.85748888277047, -32.85748888277047, -32.35748888277047, -31.98783584874869, -31.98783584874869, -30.98783584874869, -26.362604498897138, -26.362604498897138, -26.362604498897138, -33.651757022116065, -33.651757022116065, -33.651757022116065, -27.64387568621229, -27.14387568621229, -26.14387568621229, -29.835267365685464, -29.835267365685464, -29.835267365685464, -36.35301358399689, -36.35301358399689, -36.35301358399689, -34.49417779419348, -36.99417779419349, -36.99417779419349, -29.18342051139426, -30.68342051139426, -31.18342051139426, -32.736263333310305, -32.736263333310305, -32.736263333310305, -32.37310153021288, -32.37310153021288, -32.37310153021288, -27.564704537473638, -28.564704537473645, -28.564704537473645, -24.577915202663334, -24.577915202663334, -23.577915202663334, -31.020543951768513, -31.020543951768513, -31.020543951768513, -38.16705144744313, -35.66705144744313, -37.16705144744313, -34.08022570488387, -33.08022570488387, -34.58022570488387, -35.69196158841424, -35.69196158841424, -35.69196158841424, -39.571125875774214, -40.071125875774214, -40.071125875774214, -30.983598261658997, -30.983598261658997, -30.983598261658997, -29.522593823230324, -29.022593823230324, -29.522593823230324, -28.792909859727537, -29.792909859727537, -29.792909859727537, -31.675859782836643, -31.675859782836643, -31.675859782836643, -38.78868147075819, -38.78868147075819, -37.78868147075818, -30.89314033741168, -30.39314033741168, -30.89314033741168, -27.484487041480698, -27.484487041480698, -27.484487041480698, -32.699826965570146, -32.699826965570146, -32.699826965570146, -27.866018245664474, -27.366018245664474, -27.866018245664474, -37.661638184934034, -36.661638184934034, -36.661638184934034, -27.455202858202885, -27.955202858202885, -27.955202858202885, -35.18260637085171, -35.18260637085171, -35.18260637085171, -37.792622246625136, -38.292622246625136, -38.292622246625136, -22.760142230107682, -22.760142230107682, -22.760142230107682, -27.40380573532291, -27.40380573532291, -27.40380573532291, -33.16689681623689, -33.16689681623689, -33.16689681623689, -33.12328660791231, -34.12328660791231, -33.12328660791231, -32.074724193799334, -32.074724193799334, -32.074724193799334, -35.694005122101196, -37.6940051221012, -37.6940051221012, -31.363687427726877, -31.363687427726877, -31.363687427726877, -34.385177358601, -34.385177358601, -34.385177358601, -29.849763268410005, -29.349763268410005, -27.349763268410005, -28.133869319034613, -28.133869319034613, -28.133869319034613, -29.772211904856174, -29.772211904856174, -29.772211904856174, -27.731377505134954, -27.231377505134954, -27.731377505134954, -32.230155808036635, -32.230155808036635, -32.230155808036635, -35.28429800746405, -35.78429800746405, -35.78429800746405, -33.404394728430695, -33.404394728430695, -32.404394728430695, -27.08958878709468, -27.08958878709468, -27.08958878709468, -28.814241661212414, -28.814241661212414, -28.814241661212414, -29.80918947180529, -28.30918947180529, -29.80918947180529, -38.45316159768879, -38.45316159768879, -37.45316159768879, -27.032686419953222, -27.032686419953222, -27.032686419953222, -33.62644041931718, -33.62644041931718, -33.62644041931718, -28.46961036651578, -28.46961036651578, -28.46961036651578, -23.70775905354309, -23.70775905354309, -23.70775905354309, -35.23159282952136, -35.23159282952136, -35.23159282952136, -32.19988342629897, -33.69988342629897, -33.19988342629897, -25.291803132972323, -25.291803132972323, -24.291803132972323, -32.02864682934157, -32.02864682934157, -31.028646829341564, -34.540653206636236, -34.540653206636236, -34.540653206636236, -24.478598272138143, -24.478598272138143, -24.478598272138143, -35.176608180172394, -35.176608180172394, -33.676608180172394, -27.2935939861493, -27.2935939861493, -24.7935939861493, -28.751254305246746, -28.751254305246746, -28.751254305246746, -34.03961187713514, -34.03961187713514, -34.03961187713514, -40.30581224240053, -40.30581224240053, -40.30581224240053, -38.060620190150146, -37.560620190150146, -38.060620190150146, -25.452379765426276, -25.452379765426276, -25.452379765426276, -28.74189281994546, -28.74189281994546, -28.74189281994546, -36.415735311994226, -36.415735311994226, -36.415735311994226, -41.75997140325999, -43.25997140325999, -43.25997140325999, -30.17520716817196, -30.17520716817196, -30.17520716817196, -22.760526362369262, -22.760526362369262, -22.760526362369262, -31.998966253999576, -31.998966253999576, -31.998966253999576, -36.65257632899492, -36.65257632899492, -36.65257632899492, -29.912442966709428, -26.412442966709424, -29.912442966709428, -30.806344868271275, -30.806344868271275, -30.306344868271275, -43.83282953502245, -41.83282953502245, -43.83282953502245, -33.558419746982565, -32.058419746982565, -33.558419746982565, -33.17698471935647, -33.17698471935647, -33.17698471935647, -43.07839399296847, -42.07839399296847, -43.07839399296847, -40.46305774900747, -40.46305774900747, -40.46305774900747, -35.385395703315986, -35.385395703315986, -35.385395703315986, -35.39571442378976, -34.395714423789755, -35.39571442378976, -28.3173852820063, -29.3173852820063, -29.3173852820063, -28.003979238126355, -28.003979238126355, -28.003979238126355, -26.279703602837262, -24.779703602837262, -26.279703602837262, -32.38592607820124, -32.38592607820124, -32.38592607820124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31215779264911847, "mean_inference_ms": 1.2626637329711583, "mean_action_processing_ms": 0.06956018677105962, "mean_env_wait_ms": 0.5791966602103494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 201600, "timesteps_this_iter": 0, "agent_timesteps_total": 604800, "timers": {"sample_time_ms": 1531.071, "sample_throughput": 2090.04, "load_time_ms": 0.136, "load_throughput": 23534583.202, "learn_time_ms": 786.772, "learn_throughput": 4067.25, "update_time_ms": 1.458}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0005000000000000001, "total_loss": 72.43570022583008, "policy_loss": -0.0019618046791098466, "vf_loss": 72.44945602416992, "vf_explained_var": 0.01285133957862854, "kl": 0.004268150377125674, "entropy": 1.179325520992279, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 201600, "num_agent_steps_sampled": 604800, "num_steps_trained": 201600, "num_agent_steps_trained": 604800, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 8060, "training_iteration": 63, "trial_id": "f1bbf_00000", "experiment_id": "2df5944635d14c218b699d804854f796", "date": "2024-06-19_03-47-13", "timestamp": 1718736433, "time_this_iter_s": 1.4733595848083496, "time_total_s": 96.82817816734314, "pid": 401819, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "mpe", "env_args": {"continuous_actions": false, "max_cycles": 25, "map_name": "simple_spread"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 128, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 20.0, "batch_mode": "truncate_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-100.0, 100.0, (18,), float32))", "space_act": "Discrete(5)", "num_agents": 3, "episode_limit": 25, "policy_mapping_info": {"simple_adversary": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_crypto": {"description": "two team cooperate, one team attack", "team_prefix": ["eve_", "bob_", "alice_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_push": {"description": "one team target on landmark, one team attack", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_tag": {"description": "one team attack, one team survive", "team_prefix": ["adversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_spread": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_reference": {"description": "one team cooperate", "team_prefix": ["agent_"], "all_agents_one_policy": true, "one_agent_one_policy": true}, "simple_world_comm": {"description": "two team cooperate and attack, one team survive", "team_prefix": ["adversary_", "leadadversary_", "agent_"], "all_agents_one_policy": false, "one_agent_one_policy": true}, "simple_speaker_listener": {"description": "two team cooperate", "team_prefix": ["speaker_", "listener_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["agent_0", "agent_1", "agent_2"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "mpe_simple_spread", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7fd2924d14c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 96.82817816734314, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 38.45, "ram_util_percent": 30.3}}
