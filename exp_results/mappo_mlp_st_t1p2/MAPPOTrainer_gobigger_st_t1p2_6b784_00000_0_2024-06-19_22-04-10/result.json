{"episode_reward_max": 11983.715265088791, "episode_reward_min": 6291.534767425157, "episode_reward_mean": 9494.339995700511, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 3145.7673837125785}, "policy_reward_max": {"shared_policy": 5991.857632544394}, "policy_reward_mean": {"shared_policy": 4747.169997850258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19664032182443453, "mean_inference_ms": 1.1388122961018117, "mean_action_processing_ms": 0.1259726085019915, "mean_env_wait_ms": 3.05992586633537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 8000, "timesteps_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"sample_time_ms": 3835.466, "sample_throughput": 2085.796, "load_time_ms": 0.263, "load_throughput": 30366001.81, "learn_time_ms": 973.683, "learn_throughput": 8216.223, "update_time_ms": 1.821}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 0.0005, "total_loss": 316718.49375, "policy_loss": -0.002015933255012925, "vf_loss": 316718.5375, "vf_explained_var": 2.4116039276123048e-05, "kl": 0.0036573614459486465, "entropy": 2.868293619155884, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8000, "num_agent_steps_sampled": 16000, "num_steps_trained": 8000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-18", "timestamp": 1718802258, "time_this_iter_s": 4.798603296279907, "time_total_s": 4.798603296279907, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a5693a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4.798603296279907, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.67142857142857, "ram_util_percent": 33.72857142857142}}
{"episode_reward_max": 11983.715265088791, "episode_reward_min": 5200.0, "episode_reward_mean": 9498.957795753444, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2600.0}, "policy_reward_max": {"shared_policy": 5991.857632544394}, "policy_reward_mean": {"shared_policy": 4749.47889787672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19839581593743497, "mean_inference_ms": 1.154262559033513, "mean_action_processing_ms": 0.12729812998121412, "mean_env_wait_ms": 3.1384098269728797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"sample_time_ms": 4414.501, "sample_throughput": 1812.209, "load_time_ms": 0.203, "load_throughput": 39475802.353, "learn_time_ms": 945.187, "learn_throughput": 8463.935, "update_time_ms": 1.571}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 0.0005, "total_loss": 313372.6875, "policy_loss": -0.0011057291197587916, "vf_loss": 313372.7125, "vf_explained_var": 0.00020641088485717773, "kl": 0.0022691292804670605, "entropy": 2.8729267597198485, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 32000, "num_steps_trained": 16000, "num_agent_steps_trained": 32000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-23", "timestamp": 1718802263, "time_this_iter_s": 4.92280125617981, "time_total_s": 9.721404552459717, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 9.721404552459717, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 55.82857142857143, "ram_util_percent": 35.357142857142854}}
{"episode_reward_max": 12573.121346576881, "episode_reward_min": 5200.0, "episode_reward_mean": 9595.18556734661, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2600.0}, "policy_reward_max": {"shared_policy": 6286.560673288441}, "policy_reward_mean": {"shared_policy": 4797.592783673306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2003120318066505, "mean_inference_ms": 1.1684732036121352, "mean_action_processing_ms": 0.1288423905557526, "mean_env_wait_ms": 3.2010605766579516, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 4651.488, "sample_throughput": 1719.88, "load_time_ms": 0.185, "load_throughput": 43221681.408, "learn_time_ms": 942.534, "learn_throughput": 8487.76, "update_time_ms": 1.582}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 0.0005, "total_loss": 339685.4375, "policy_loss": -0.000911848132498605, "vf_loss": 339685.45625, "vf_explained_var": 0.00024384260177612305, "kl": 0.001936776016374277, "entropy": 2.9178646087646483, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 48000, "num_steps_trained": 24000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-28", "timestamp": 1718802268, "time_this_iter_s": 5.131563901901245, "time_total_s": 14.852968454360962, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4faf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 14.852968454360962, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 51.3625, "ram_util_percent": 35.525}}
{"episode_reward_max": 12573.121346576881, "episode_reward_min": 5000.0, "episode_reward_mean": 9310.126759229699, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 6286.560673288441}, "policy_reward_mean": {"shared_policy": 4655.063379614849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20084016602239832, "mean_inference_ms": 1.1713933695335768, "mean_action_processing_ms": 0.12903590180744207, "mean_env_wait_ms": 3.224008943995898, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"sample_time_ms": 4671.354, "sample_throughput": 1712.566, "load_time_ms": 0.173, "load_throughput": 46329902.658, "learn_time_ms": 928.465, "learn_throughput": 8616.369, "update_time_ms": 1.522}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 0.0005, "total_loss": 281846.38125, "policy_loss": -0.0014969653738662546, "vf_loss": 281846.4, "vf_explained_var": 0.00015807151794433594, "kl": 0.0027368013979883017, "entropy": 2.961466598510742, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 64000, "num_steps_trained": 32000, "num_agent_steps_trained": 64000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-32", "timestamp": 1718802272, "time_this_iter_s": 4.666704893112183, "time_total_s": 19.519673347473145, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19.519673347473145, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 59.35, "ram_util_percent": 35.81666666666667}}
{"episode_reward_max": 12573.121346576881, "episode_reward_min": 5000.0, "episode_reward_mean": 9112.614808244707, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 6286.560673288441}, "policy_reward_mean": {"shared_policy": 4556.307404122352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20069247722484365, "mean_inference_ms": 1.1709366944289952, "mean_action_processing_ms": 0.12885286579438804, "mean_env_wait_ms": 3.2331454620018523, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 4673.557, "sample_throughput": 1711.758, "load_time_ms": 0.164, "load_throughput": 48799348.458, "learn_time_ms": 920.987, "learn_throughput": 8686.332, "update_time_ms": 1.514}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0125, "cur_lr": 0.0005, "total_loss": 285265.58125, "policy_loss": -0.0014292138923892139, "vf_loss": 285265.6125, "vf_explained_var": 0.0006858587265014648, "kl": 0.0031361800734904756, "entropy": 3.0328649044036866, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 80000, "num_steps_trained": 40000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-37", "timestamp": 1718802277, "time_this_iter_s": 4.672040224075317, "time_total_s": 24.191713571548462, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 24.191713571548462, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.99999999999999, "ram_util_percent": 35.800000000000004}}
{"episode_reward_max": 12573.121346576881, "episode_reward_min": 5000.0, "episode_reward_mean": 9122.753590284443, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 6286.560673288441}, "policy_reward_mean": {"shared_policy": 4561.3767951422205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002489520135448, "mean_inference_ms": 1.1693596069416439, "mean_action_processing_ms": 0.12856134075494424, "mean_env_wait_ms": 3.2376799702890042, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 4684.657, "sample_throughput": 1707.702, "load_time_ms": 0.158, "load_throughput": 50622728.69, "learn_time_ms": 917.324, "learn_throughput": 8721.022, "update_time_ms": 1.479}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00625, "cur_lr": 0.0005, "total_loss": 342782.6625, "policy_loss": -0.0007900981644635152, "vf_loss": 342782.6875, "vf_explained_var": 0.000703728199005127, "kl": 0.0019159407413128764, "entropy": 3.1046688079833986, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 96000, "num_steps_trained": 48000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-42", "timestamp": 1718802282, "time_this_iter_s": 4.735121965408325, "time_total_s": 28.926835536956787, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f99d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28.926835536956787, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.67142857142858, "ram_util_percent": 35.81428571428571}}
{"episode_reward_max": 12910.53532256286, "episode_reward_min": 5000.0, "episode_reward_mean": 9173.734515121641, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 6455.2676612814175}, "policy_reward_mean": {"shared_policy": 4586.867257560822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19984438112556688, "mean_inference_ms": 1.168201186239219, "mean_action_processing_ms": 0.12833980697098446, "mean_env_wait_ms": 3.2439269767519354, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 56000, "timesteps_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"sample_time_ms": 4720.225, "sample_throughput": 1694.834, "load_time_ms": 0.154, "load_throughput": 51976327.506, "learn_time_ms": 925.875, "learn_throughput": 8640.479, "update_time_ms": 1.526}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.003125, "cur_lr": 0.0005, "total_loss": 338851.1125, "policy_loss": -0.0009665645102039377, "vf_loss": 338851.14375, "vf_explained_var": 0.00024558305740356444, "kl": 0.0014444831991616831, "entropy": 3.073476505279541, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 56000, "num_agent_steps_sampled": 112000, "num_steps_trained": 56000, "num_agent_steps_trained": 112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-47", "timestamp": 1718802287, "time_this_iter_s": 4.999037981033325, "time_total_s": 33.92587351799011, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 33.92587351799011, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.5, "ram_util_percent": 35.84285714285714}}
{"episode_reward_max": 12910.53532256286, "episode_reward_min": 5000.0, "episode_reward_mean": 8991.559067985316, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 6455.2676612814175}, "policy_reward_mean": {"shared_policy": 4495.779533992657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19943752254991237, "mean_inference_ms": 1.1669097032098903, "mean_action_processing_ms": 0.12812181535859005, "mean_env_wait_ms": 3.2476040151330934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 64000, "timesteps_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"sample_time_ms": 4728.582, "sample_throughput": 1691.839, "load_time_ms": 0.151, "load_throughput": 52998115.696, "learn_time_ms": 920.099, "learn_throughput": 8694.717, "update_time_ms": 1.513}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015625, "cur_lr": 0.0005, "total_loss": 233656.1875, "policy_loss": -0.0010924519313965319, "vf_loss": 233656.225, "vf_explained_var": 0.00018870830535888672, "kl": 0.0017697392555464909, "entropy": 3.126660776138306, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 128000, "num_steps_trained": 64000, "num_agent_steps_trained": 128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-52", "timestamp": 1718802292, "time_this_iter_s": 4.6746580600738525, "time_total_s": 38.600531578063965, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 38.600531578063965, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 52.54285714285714, "ram_util_percent": 35.9}}
{"episode_reward_max": 12943.499793897849, "episode_reward_min": 5000.0, "episode_reward_mean": 9008.298288775184, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 6471.749896948913}, "policy_reward_mean": {"shared_policy": 4504.149144387591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19909334097783188, "mean_inference_ms": 1.1658792267166673, "mean_action_processing_ms": 0.1279587374445108, "mean_env_wait_ms": 3.2511638076310407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 4740.067, "sample_throughput": 1687.74, "load_time_ms": 0.152, "load_throughput": 52510848.2, "learn_time_ms": 918.279, "learn_throughput": 8711.948, "update_time_ms": 1.523}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00078125, "cur_lr": 0.0005, "total_loss": 322089.34375, "policy_loss": -0.0015166521955279678, "vf_loss": 322089.36875, "vf_explained_var": 0.00017654895782470703, "kl": 0.002199343434772385, "entropy": 3.1587127208709718, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 144000, "num_steps_trained": 72000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-04-56", "timestamp": 1718802296, "time_this_iter_s": 4.843733072280884, "time_total_s": 43.44426465034485, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9dc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 43.44426465034485, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.271428571428565, "ram_util_percent": 35.871428571428574}}
{"episode_reward_max": 12943.499793897849, "episode_reward_min": 1000.0, "episode_reward_mean": 8954.845415975715, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 6471.749896948913}, "policy_reward_mean": {"shared_policy": 4477.4227079878565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9412.728696884067, 10274.001816888562, 11259.166367699145, 9219.808622846416, 8490.071620981482, 6474.573999802873, 10836.627174017049, 11983.715265088791, 6291.534767425157, 10701.171625371575, 10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4706.364348442038, 4706.364348442038, 5137.000908444294, 5137.000908444294, 5629.583183849579, 5629.583183849579, 4609.904311423205, 4609.904311423205, 4245.035810490741, 4245.035810490741, 3237.2869999014365, 3237.2869999014365, 5418.313587008523, 5418.313587008523, 5991.857632544394, 5991.857632544394, 3145.7673837125785, 3145.7673837125785, 5350.585812685787, 5350.585812685787, 5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1987591725632072, "mean_inference_ms": 1.164870896155351, "mean_action_processing_ms": 0.12780011101043165, "mean_env_wait_ms": 3.2540521562715345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 4748.423, "sample_throughput": 1684.77, "load_time_ms": 0.15, "load_throughput": 53210326.673, "learn_time_ms": 914.622, "learn_throughput": 8746.778, "update_time_ms": 1.506}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000390625, "cur_lr": 0.0005, "total_loss": 293978.51875, "policy_loss": -0.0015497759667226774, "vf_loss": 293978.55, "vf_explained_var": 8.108615875244141e-05, "kl": 0.003200225956975522, "entropy": 3.1681774139404295, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 160000, "num_steps_trained": 80000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-01", "timestamp": 1718802301, "time_this_iter_s": 4.788751125335693, "time_total_s": 48.23301577568054, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f90d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 48.23301577568054, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 60.650000000000006, "ram_util_percent": 35.800000000000004}}
{"episode_reward_max": 12962.43611701109, "episode_reward_min": 1000.0, "episode_reward_mean": 8910.398805801166, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 6481.21805850555}, "policy_reward_mean": {"shared_policy": 4455.199402900582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10476.924990973614, 9488.651729590638, 9438.491799062213, 11192.159883856693, 10821.154806703827, 7698.930508566922, 10539.400461501773, 9108.718098577338, 5200.0, 11071.323679230722, 9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5238.462495486803, 5238.462495486803, 4744.325864795312, 4744.325864795312, 4719.245899531114, 4719.245899531114, 5596.079941928345, 5596.079941928345, 5410.577403351919, 5410.577403351919, 3849.465254283461, 3849.465254283461, 5269.70023075087, 5269.70023075087, 4554.359049288667, 4554.359049288667, 2600.0, 2600.0, 5535.661839615356, 5535.661839615356, 4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1986556266588143, "mean_inference_ms": 1.1664199774605863, "mean_action_processing_ms": 0.12781469291437675, "mean_env_wait_ms": 3.275923803861443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 88000, "timesteps_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"sample_time_ms": 4846.617, "sample_throughput": 1650.636, "load_time_ms": 0.137, "load_throughput": 58457198.606, "learn_time_ms": 915.387, "learn_throughput": 8739.472, "update_time_ms": 1.515}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0001953125, "cur_lr": 0.0005, "total_loss": 310027.51875, "policy_loss": -0.0016160477467813904, "vf_loss": 310027.55625, "vf_explained_var": 2.8347969055175783e-05, "kl": 0.002348788798559254, "entropy": 3.1536710262298584, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 88000, "num_agent_steps_sampled": 176000, "num_steps_trained": 88000, "num_agent_steps_trained": 176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 110, "training_iteration": 11, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-06", "timestamp": 1718802306, "time_this_iter_s": 4.9043214321136475, "time_total_s": 53.13733720779419, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 53.13733720779419, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 48.27499999999999, "ram_util_percent": 35.8625}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 9017.700527531522, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 4508.85026376576}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9292.104770808954, 7911.0338108744145, 8177.161522080452, 8645.549398954681, 8918.325375097433, 12573.121346576881, 10135.573022544446, 10345.882141520731, 12246.868810419775, 9630.79090645178, 6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4646.052385404477, 4646.052385404477, 3955.5169054372072, 3955.5169054372072, 4088.5807610402226, 4088.5807610402226, 4322.774699477339, 4322.774699477339, 4459.1626875487145, 4459.1626875487145, 6286.560673288441, 6286.560673288441, 5067.786511272223, 5067.786511272223, 5172.941070760367, 5172.941070760367, 6123.434405209897, 6123.434405209897, 4815.395453225889, 4815.395453225889, 3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982803424483768, "mean_inference_ms": 1.1654941836798165, "mean_action_processing_ms": 0.1276370240981514, "mean_env_wait_ms": 3.284402765545193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 4865.814, "sample_throughput": 1644.124, "load_time_ms": 0.136, "load_throughput": 58857098.755, "learn_time_ms": 914.683, "learn_throughput": 8746.201, "update_time_ms": 1.528}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0005, "total_loss": 422864.9875, "policy_loss": -0.0014643470595586904, "vf_loss": 422865.0375, "vf_explained_var": -6.055831909179687e-06, "kl": 0.004140818084132525, "entropy": 3.2385180473327635, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 192000, "num_steps_trained": 96000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-11", "timestamp": 1718802311, "time_this_iter_s": 5.09400200843811, "time_total_s": 58.2313392162323, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f94c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 58.2313392162323, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 56.75714285714286, "ram_util_percent": 35.81428571428572}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 8902.614017866596, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 4451.307008933298}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6198.275807603399, 6710.1723185431965, 9822.660939412988, 7362.601055088973, 11303.533471120569, 11622.340889019404, 5000.0, 9227.24125021488, 7787.0123477524285, 9515.665270033696, 6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3099.1379038016994, 3099.1379038016994, 3355.0861592715983, 3355.0861592715983, 4911.3304697065005, 4911.3304697065005, 3681.3005275444866, 3681.3005275444866, 5651.766735560269, 5651.766735560269, 5811.1704445097, 5811.1704445097, 2500.0, 2500.0, 4613.620625107444, 4613.620625107444, 3893.5061738762142, 3893.5061738762142, 4757.832635016847, 4757.832635016847, 3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19759977667117978, "mean_inference_ms": 1.1618498747381565, "mean_action_processing_ms": 0.12712591182106764, "mean_env_wait_ms": 3.2822972856233683, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 104000, "timesteps_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"sample_time_ms": 4840.529, "sample_throughput": 1652.712, "load_time_ms": 0.137, "load_throughput": 58234002.083, "learn_time_ms": 909.553, "learn_throughput": 8795.53, "update_time_ms": 1.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0005, "total_loss": 282722.45, "policy_loss": -0.001458133450616117, "vf_loss": 282722.48125, "vf_explained_var": 1.6939640045166015e-05, "kl": 0.004209736129279848, "entropy": 3.2180595874786375, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104000, "num_agent_steps_sampled": 208000, "num_steps_trained": 104000, "num_agent_steps_trained": 208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 130, "training_iteration": 13, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-16", "timestamp": 1718802316, "time_this_iter_s": 4.835959196090698, "time_total_s": 63.067298412323, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 63.067298412323, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 54.47142857142858, "ram_util_percent": 35.714285714285715}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 8749.28326733335, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 4374.641633666674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6029.257646307287, 10349.740044983602, 8046.408568567273, 6200.0, 9442.929443511857, 7436.22030381392, 8514.535297290924, 6718.017758226175, 11020.050266973885, 9468.510713372445, 10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3014.6288231536437, 3014.6288231536437, 5174.870022491788, 5174.870022491788, 4023.2042842836363, 4023.2042842836363, 3100.0, 3100.0, 4721.464721755929, 4721.464721755929, 3718.11015190696, 3718.11015190696, 4257.267648645462, 4257.267648645462, 3359.0088791130875, 3359.0088791130875, 5510.025133486948, 5510.025133486948, 4734.255356686217, 4734.255356686217, 5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19706913085013653, "mean_inference_ms": 1.1598918965018539, "mean_action_processing_ms": 0.12684898000344594, "mean_env_wait_ms": 3.284186330510528, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 112000, "timesteps_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"sample_time_ms": 4858.062, "sample_throughput": 1646.747, "load_time_ms": 0.137, "load_throughput": 58487767.126, "learn_time_ms": 911.336, "learn_throughput": 8778.322, "update_time_ms": 1.522}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0005, "total_loss": 214944.659375, "policy_loss": -0.0007880992898250839, "vf_loss": 214944.6875, "vf_explained_var": 5.750656127929687e-05, "kl": 0.0032981508877225605, "entropy": 3.1289838790893554, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112000, "num_agent_steps_sampled": 224000, "num_steps_trained": 112000, "num_agent_steps_trained": 224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-21", "timestamp": 1718802321, "time_this_iter_s": 4.911463737487793, "time_total_s": 67.97876214981079, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 67.97876214981079, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 54.685714285714276, "ram_util_percent": 35.81428571428572}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 8452.593307512037, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 4226.29665375602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10617.939914624614, 11836.90882978887, 5325.913891346867, 9929.865969012142, 11872.4484395189, 9650.990692394196, 7491.710772409237, 8977.442454126493, 8768.300288875085, 7262.953752734775, 6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5308.969957312328, 5308.969957312328, 5918.45441489443, 5918.45441489443, 2662.9569456734334, 2662.9569456734334, 4964.932984506071, 4964.932984506071, 5936.224219759451, 5936.224219759451, 4825.495346197098, 4825.495346197098, 3745.8553862046183, 3745.8553862046183, 4488.721227063244, 4488.721227063244, 4384.150144437548, 4384.150144437548, 3631.4768763673874, 3631.4768763673874, 3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19672100709363824, "mean_inference_ms": 1.1589722955309278, "mean_action_processing_ms": 0.12671276623935607, "mean_env_wait_ms": 3.2881196197333495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 4867.988, "sample_throughput": 1643.39, "load_time_ms": 0.14, "load_throughput": 57152839.38, "learn_time_ms": 911.841, "learn_throughput": 8773.456, "update_time_ms": 1.526}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0005, "total_loss": 146284.271875, "policy_loss": -0.0019033309486694793, "vf_loss": 146284.303125, "vf_explained_var": 3.409385681152344e-05, "kl": 0.0031107280985526687, "entropy": 3.287691259384155, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 240000, "num_steps_trained": 120000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 150, "training_iteration": 15, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-26", "timestamp": 1718802326, "time_this_iter_s": 4.759575128555298, "time_total_s": 72.73833727836609, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 72.73833727836609, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 53.457142857142856, "ram_util_percent": 35.885714285714286}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 8037.087632321292, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 4018.5438161606457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6961.056678137305, 12910.53532256286, 9336.511335807121, 10928.957444532243, 6485.6419732992545, 10169.994865082703, 7089.17832647379, 8479.521650544531, 12586.249638931531, 9848.553406077237, 7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3480.5283390686527, 3480.5283390686527, 6455.2676612814175, 6455.2676612814175, 4668.255667903569, 4668.255667903569, 5464.478722266126, 5464.478722266126, 3242.8209866496272, 3242.8209866496272, 5084.997432541358, 5084.997432541358, 3544.589163236895, 3544.589163236895, 4239.76082527226, 4239.76082527226, 6293.124819465753, 6293.124819465753, 4924.276703038601, 4924.276703038601, 3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1965827601509567, "mean_inference_ms": 1.1588896204003334, "mean_action_processing_ms": 0.12668229652630028, "mean_env_wait_ms": 3.293467795554337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 128000, "timesteps_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"sample_time_ms": 4887.512, "sample_throughput": 1636.825, "load_time_ms": 0.14, "load_throughput": 57123649.983, "learn_time_ms": 909.922, "learn_throughput": 8791.961, "update_time_ms": 1.54}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0005, "total_loss": 129658.0609375, "policy_loss": -0.001089062071312341, "vf_loss": 129658.0984375, "vf_explained_var": 3.2019615173339846e-05, "kl": 0.0028086737846113085, "entropy": 3.2822046756744383, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 256000, "num_steps_trained": 128000, "num_agent_steps_trained": 256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-31", "timestamp": 1718802331, "time_this_iter_s": 4.907174587249756, "time_total_s": 77.64551186561584, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.64551186561584, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 54.58571428571428, "ram_util_percent": 35.91428571428572}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 7553.968860016833, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 3776.9844300084164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7244.835455411316, 9632.953191439454, 8443.599904319544, 5150.7273629621795, 8485.7843763825, 7197.780542770866, 7552.494785201903, 8287.412724749083, 8471.616828157603, 6696.104208915702, 12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3622.417727705658, 3622.417727705658, 4816.47659571973, 4816.47659571973, 4221.79995215977, 4221.79995215977, 2575.3636814810898, 2575.3636814810898, 4242.892188191241, 4242.892188191241, 3598.890271385433, 3598.890271385433, 3776.2473926009516, 3776.2473926009516, 4143.706362374538, 4143.706362374538, 4235.808414078798, 4235.808414078798, 3348.052104457851, 3348.052104457851, 6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19646917078232332, "mean_inference_ms": 1.1586891039527465, "mean_action_processing_ms": 0.12664091258597648, "mean_env_wait_ms": 3.2962961611081276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 136000, "timesteps_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"sample_time_ms": 4869.732, "sample_throughput": 1642.801, "load_time_ms": 0.14, "load_throughput": 57191805.011, "learn_time_ms": 901.401, "learn_throughput": 8875.071, "update_time_ms": 1.498}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0005, "total_loss": 115981.434375, "policy_loss": -0.0018976441818289835, "vf_loss": 115981.465625, "vf_explained_var": 3.222227096557617e-05, "kl": 0.0032742620678701878, "entropy": 3.295156955718994, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 136000, "num_agent_steps_sampled": 272000, "num_steps_trained": 136000, "num_agent_steps_trained": 272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 170, "training_iteration": 17, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-35", "timestamp": 1718802335, "time_this_iter_s": 4.753352165222168, "time_total_s": 82.39886403083801, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f94c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 82.39886403083801, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 60.050000000000004, "ram_util_percent": 36.0}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 7597.603257068319, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 3798.8016285341596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12943.499793897849, 8881.520638959159, 9253.680154023863, 8417.806829593552, 8596.965025711186, 9471.264407974075, 10649.423339698998, 10352.246092881192, 7255.714268201544, 5600.0, 9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6471.749896948913, 6471.749896948913, 4440.760319479574, 4440.760319479574, 4626.840077011921, 4626.840077011921, 4208.903414796787, 4208.903414796787, 4298.482512855597, 4298.482512855597, 4735.632203987034, 4735.632203987034, 5324.711669849496, 5324.711669849496, 5176.123046440591, 5176.123046440591, 3627.857134100772, 3627.857134100772, 2800.0, 2800.0, 4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19640378798476532, "mean_inference_ms": 1.1587319258730444, "mean_action_processing_ms": 0.1266270818779731, "mean_env_wait_ms": 3.2997218188383237, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 4871.672, "sample_throughput": 1642.147, "load_time_ms": 0.14, "load_throughput": 56949137.814, "learn_time_ms": 902.856, "learn_throughput": 8860.771, "update_time_ms": 1.495}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 296207.74375, "policy_loss": -0.0014222543260089537, "vf_loss": 296207.7875, "vf_explained_var": 6.365776062011719e-06, "kl": 0.0051694002235441044, "entropy": 3.2108927726745606, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 288000, "num_steps_trained": 144000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-40", "timestamp": 1718802340, "time_this_iter_s": 4.7947914600372314, "time_total_s": 87.19365549087524, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49b3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 87.19365549087524, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.55714285714286, "ram_util_percent": 36.0}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 7530.90026884842, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 3765.45013442421}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9506.736255624317, 10695.869290205232, 8584.683672870218, 11015.63223848677, 11257.506653968914, 9942.929254660394, 4000.0, 12081.936015855037, 6652.402226133991, 1000.0, 10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4753.368127812166, 4753.368127812166, 5347.934645102611, 5347.934645102611, 4292.341836435109, 4292.341836435109, 5507.81611924338, 5507.81611924338, 5628.753326984448, 5628.753326984448, 4971.464627330199, 4971.464627330199, 2000.0, 2000.0, 6040.968007927511, 6040.968007927511, 3326.2011130669953, 3326.2011130669953, 500.0, 500.0, 5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19635627094041572, "mean_inference_ms": 1.1586936457308503, "mean_action_processing_ms": 0.12659198887751846, "mean_env_wait_ms": 3.302329603603829, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 152000, "timesteps_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"sample_time_ms": 4865.975, "sample_throughput": 1644.069, "load_time_ms": 0.138, "load_throughput": 58022535.016, "learn_time_ms": 903.474, "learn_throughput": 8854.71, "update_time_ms": 1.469}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0005, "total_loss": 275475.44375, "policy_loss": -0.0016984662636183145, "vf_loss": 275475.48125, "vf_explained_var": 8.559226989746093e-06, "kl": 0.003399134217777094, "entropy": 3.344766855239868, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 152000, "num_agent_steps_sampled": 304000, "num_steps_trained": 152000, "num_agent_steps_trained": 304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 190, "training_iteration": 19, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-45", "timestamp": 1718802345, "time_this_iter_s": 4.779207944869995, "time_total_s": 91.97286343574524, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 91.97286343574524, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 53.79999999999999, "ram_util_percent": 36.0}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 7592.724104664637, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 3796.3620523323193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10587.598136469554, 8447.23534883634, 9602.860447129471, 9675.372475096803, 9145.056238886333, 8604.409204325148, 12962.43611701109, 5369.1772869218, 12304.59368487354, 3800.0, 12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5293.799068234794, 5293.799068234794, 4223.617674418163, 4223.617674418163, 4801.430223564731, 4801.430223564731, 4837.686237548404, 4837.686237548404, 4572.5281194431645, 4572.5281194431645, 4302.204602162571, 4302.204602162571, 6481.21805850555, 6481.21805850555, 2684.5886434609, 2684.5886434609, 6152.296842436768, 6152.296842436768, 1900.0, 1900.0, 6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19639362885941217, "mean_inference_ms": 1.1589177983223977, "mean_action_processing_ms": 0.126601008947118, "mean_env_wait_ms": 3.3052471401681975, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 4874.749, "sample_throughput": 1641.11, "load_time_ms": 0.141, "load_throughput": 56862280.969, "learn_time_ms": 906.083, "learn_throughput": 8829.214, "update_time_ms": 1.489}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0005, "total_loss": 323036.0875, "policy_loss": -0.0012439534179399913, "vf_loss": 323036.11875, "vf_explained_var": 3.1006336212158206e-05, "kl": 0.0036933124531218532, "entropy": 3.324684190750122, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 320000, "num_steps_trained": 160000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-50", "timestamp": 1718802350, "time_this_iter_s": 4.8961827754974365, "time_total_s": 96.86904621124268, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a59fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 96.86904621124268, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 55.128571428571426, "ram_util_percent": 36.01428571428571}}
{"episode_reward_max": 16556.98889191149, "episode_reward_min": 1000.0, "episode_reward_mean": 7748.449361181765, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8278.494445955741}, "policy_reward_mean": {"shared_policy": 3874.2246805908812}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12669.199745409362, 6943.314343611657, 10798.538838050474, 6772.126882229171, 11028.285484998116, 10798.495358899418, 9133.901290426147, 10590.041284848063, 16556.98889191149, 10475.036010715521, 9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6334.599872704683, 6334.599872704683, 3471.6571718058285, 3471.6571718058285, 5399.269419025244, 5399.269419025244, 3386.0634411145857, 3386.0634411145857, 5514.142742499074, 5514.142742499074, 5399.247679449703, 5399.247679449703, 4566.950645213078, 4566.950645213078, 5295.020642424031, 5295.020642424031, 8278.494445955741, 8278.494445955741, 5237.518005357768, 5237.518005357768, 4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19645196390568784, "mean_inference_ms": 1.1593818570287964, "mean_action_processing_ms": 0.12664670326220417, "mean_env_wait_ms": 3.309213768541889, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"sample_time_ms": 4894.273, "sample_throughput": 1634.564, "load_time_ms": 0.142, "load_throughput": 56280496.478, "learn_time_ms": 897.812, "learn_throughput": 8910.549, "update_time_ms": 1.421}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0005, "total_loss": 419387.25625, "policy_loss": -0.001353785396553775, "vf_loss": 419387.29375, "vf_explained_var": -5.125999450683594e-06, "kl": 0.0036827225005481926, "entropy": 3.2668229579925536, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 336000, "num_steps_trained": 168000, "num_agent_steps_trained": 336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 210, "training_iteration": 21, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-05-55", "timestamp": 1718802355, "time_this_iter_s": 4.987372398376465, "time_total_s": 101.85641860961914, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 101.85641860961914, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.771428571428565, "ram_util_percent": 36.1}}
{"episode_reward_max": 14537.14870068288, "episode_reward_min": 1000.0, "episode_reward_mean": 7763.043086118604, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 7268.5743503414305}, "policy_reward_mean": {"shared_policy": 3881.521543059302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9705.265634002477, 7949.339059326347, 11196.612822903022, 9113.43804972992, 5866.808091068349, 4846.090234131476, 13237.162774505832, 11172.01203079183, 5000.0, 8281.031442377865, 8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4852.6328170012375, 4852.6328170012375, 3974.6695296631733, 3974.6695296631733, 5598.306411451516, 5598.306411451516, 4556.719024864975, 4556.719024864975, 2933.4040455341747, 2933.4040455341747, 2423.045117065738, 2423.045117065738, 6618.581387252911, 6618.581387252911, 5586.006015395917, 5586.006015395917, 2500.0, 2500.0, 4140.515721188931, 4140.515721188931, 4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19642028483774587, "mean_inference_ms": 1.15919364370575, "mean_action_processing_ms": 0.12661400546409524, "mean_env_wait_ms": 3.310756118011957, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 176000, "timesteps_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"sample_time_ms": 4855.888, "sample_throughput": 1647.484, "load_time_ms": 0.143, "load_throughput": 56073582.888, "learn_time_ms": 899.603, "learn_throughput": 8892.807, "update_time_ms": 1.452}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0005, "total_loss": 404193.34375, "policy_loss": -0.0013404036532158159, "vf_loss": 404193.38125, "vf_explained_var": -1.938343048095703e-05, "kl": 0.0031806303654082976, "entropy": 3.364066219329834, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176000, "num_agent_steps_sampled": 352000, "num_steps_trained": 176000, "num_agent_steps_trained": 352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-00", "timestamp": 1718802360, "time_this_iter_s": 4.820531129837036, "time_total_s": 106.67694973945618, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 106.67694973945618, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 53.67142857142858, "ram_util_percent": 35.81428571428572}}
{"episode_reward_max": 15669.153284498982, "episode_reward_min": 1000.0, "episode_reward_mean": 7976.477065154002, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 7834.5766422494835}, "policy_reward_mean": {"shared_policy": 3988.238532577001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8677.409610179078, 10319.91946916917, 6020.184967946536, 9420.521432577214, 4800.0, 7502.262109273437, 4200.0, 3200.0, 5200.0, 9876.130706319513, 2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4338.7048050895355, 4338.7048050895355, 5159.959734584599, 5159.959734584599, 3010.092483973268, 3010.092483973268, 4710.260716288609, 4710.260716288609, 2400.0, 2400.0, 3751.1310546367185, 3751.1310546367185, 2100.0, 2100.0, 1600.0, 1600.0, 2600.0, 2600.0, 4938.065353159758, 4938.065353159758, 1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19632856211073593, "mean_inference_ms": 1.1592374056450603, "mean_action_processing_ms": 0.12661441828929204, "mean_env_wait_ms": 3.312777012299327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 184000, "timesteps_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"sample_time_ms": 4877.539, "sample_throughput": 1640.172, "load_time_ms": 0.141, "load_throughput": 56546059.993, "learn_time_ms": 903.116, "learn_throughput": 8858.223, "update_time_ms": 1.464}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0005, "total_loss": 437314.48125, "policy_loss": -0.0017998491838568497, "vf_loss": 437314.49375, "vf_explained_var": -1.876354217529297e-05, "kl": 0.004981967224761382, "entropy": 3.443202781677246, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 184000, "num_agent_steps_sampled": 368000, "num_steps_trained": 184000, "num_agent_steps_trained": 368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 230, "training_iteration": 23, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-05", "timestamp": 1718802365, "time_this_iter_s": 5.063258171081543, "time_total_s": 111.74020791053772, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fae50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 111.74020791053772, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 56.17142857142857, "ram_util_percent": 35.871428571428574}}
{"episode_reward_max": 15669.153284498982, "episode_reward_min": 1000.0, "episode_reward_mean": 8349.336486649825, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 7834.5766422494835}, "policy_reward_mean": {"shared_policy": 4174.6682433249125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2800.0, 6015.409521506463, 6140.812547665486, 5857.054309314673, 5090.664397199658, 4800.0, 6324.470478096926, 8528.262807132956, 3400.0, 4600.0, 2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [1400.0, 1400.0, 3007.7047607532313, 3007.7047607532313, 3070.406273832743, 3070.406273832743, 2928.5271546573367, 2928.5271546573367, 2545.332198599828, 2545.332198599828, 2400.0, 2400.0, 3162.235239048463, 3162.235239048463, 4264.131403566462, 4264.131403566462, 1700.0, 1700.0, 2300.0, 2300.0, 1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19625351950799685, "mean_inference_ms": 1.159284856028412, "mean_action_processing_ms": 0.12661289202454729, "mean_env_wait_ms": 3.314319297330664, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 4873.875, "sample_throughput": 1641.404, "load_time_ms": 0.142, "load_throughput": 56186255.861, "learn_time_ms": 900.387, "learn_throughput": 8885.066, "update_time_ms": 1.441}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0005, "total_loss": 405810.98125, "policy_loss": -0.0019271931789816676, "vf_loss": 405811.025, "vf_explained_var": -2.0933151245117187e-05, "kl": 0.004760540067249212, "entropy": 3.4459510803222657, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 384000, "num_steps_trained": 192000, "num_agent_steps_trained": 384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-10", "timestamp": 1718802370, "time_this_iter_s": 4.810956716537476, "time_total_s": 116.5511646270752, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 116.5511646270752, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 54.057142857142864, "ram_util_percent": 35.9}}
{"episode_reward_max": 15669.153284498982, "episode_reward_min": 1000.0, "episode_reward_mean": 8824.240090025054, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 7834.5766422494835}, "policy_reward_mean": {"shared_policy": 4412.120045012527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2000.0, 6499.988492392218, 6112.486952004452, 9258.797366578048, 3000.0, 8766.90929313891, 6345.725381642911, 1000.0, 4000.0, 3200.0, 3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [1000.0, 1000.0, 3249.994246196109, 3249.994246196109, 3056.243476002226, 3056.243476002226, 4629.398683289029, 4629.398683289029, 1500.0, 1500.0, 4383.454646569447, 4383.454646569447, 3172.8626908214555, 3172.8626908214555, 500.0, 500.0, 2000.0, 2000.0, 1600.0, 1600.0, 1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19622399549445757, "mean_inference_ms": 1.1593816239655572, "mean_action_processing_ms": 0.12661823246406154, "mean_env_wait_ms": 3.316129476657795, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 4876.814, "sample_throughput": 1640.415, "load_time_ms": 0.142, "load_throughput": 56441433.137, "learn_time_ms": 903.008, "learn_throughput": 8859.274, "update_time_ms": 1.438}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 398532.0375, "policy_loss": -0.0022141885586080432, "vf_loss": 398532.05, "vf_explained_var": -1.7023086547851564e-05, "kl": 0.005337729817284103, "entropy": 3.408599281311035, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 400000, "num_steps_trained": 200000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 250, "training_iteration": 25, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-15", "timestamp": 1718802375, "time_this_iter_s": 4.842146635055542, "time_total_s": 121.39331126213074, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 121.39331126213074, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 54.07142857142858, "ram_util_percent": 35.871428571428574}}
{"episode_reward_max": 15669.153284498982, "episode_reward_min": 2200.0, "episode_reward_mean": 9284.678302409355, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1100.0}, "policy_reward_max": {"shared_policy": 7834.5766422494835}, "policy_reward_mean": {"shared_policy": 4642.339151204677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3200.0, 2200.0, 2600.0, 6478.79464703124, 9007.547266300222, 4885.068644150779, 3800.0, 4600.0, 4555.999904058925, 5156.912949461497, 6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [1600.0, 1600.0, 1100.0, 1100.0, 1300.0, 1300.0, 3239.39732351562, 3239.39732351562, 4503.773633150105, 4503.773633150105, 2442.5343220753894, 2442.5343220753894, 1900.0, 1900.0, 2300.0, 2300.0, 2277.9999520294623, 2277.9999520294623, 2578.4564747307486, 2578.4564747307486, 3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19617601527775566, "mean_inference_ms": 1.1593680138190974, "mean_action_processing_ms": 0.1266149273832351, "mean_env_wait_ms": 3.317397183385243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 208000, "timesteps_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"sample_time_ms": 4872.486, "sample_throughput": 1641.872, "load_time_ms": 0.144, "load_throughput": 55692003.32, "learn_time_ms": 903.634, "learn_throughput": 8853.143, "update_time_ms": 1.437}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 326403.54375, "policy_loss": -0.0016001100353889796, "vf_loss": 326403.575, "vf_explained_var": -1.1038780212402343e-05, "kl": 0.00515472518748635, "entropy": 3.441854953765869, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 208000, "num_agent_steps_sampled": 416000, "num_steps_trained": 208000, "num_agent_steps_trained": 416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-19", "timestamp": 1718802379, "time_this_iter_s": 4.842530012130737, "time_total_s": 126.23584127426147, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 126.23584127426147, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 53.785714285714285, "ram_util_percent": 35.9}}
{"episode_reward_max": 15669.153284498982, "episode_reward_min": 2200.0, "episode_reward_mean": 9942.863745612985, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1100.0}, "policy_reward_max": {"shared_policy": 7834.5766422494835}, "policy_reward_mean": {"shared_policy": 4971.4318728064945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6449.150803680186, 4799.7293037580275, 7322.751273325746, 12813.552023525644, 2200.0, 9569.726695688758, 12174.334701034662, 10152.109204606499, 9314.526463294747, 6730.868616544449, 8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3224.575401840093, 3224.575401840093, 2399.8646518790138, 2399.8646518790138, 3661.375636662873, 3661.375636662873, 6406.776011762824, 6406.776011762824, 1100.0, 1100.0, 4784.863347844369, 4784.863347844369, 6087.1673505173185, 6087.1673505173185, 5076.05460230326, 5076.05460230326, 4657.2632316473755, 4657.2632316473755, 3365.4343082722244, 3365.4343082722244, 4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19617293181670303, "mean_inference_ms": 1.159531495809882, "mean_action_processing_ms": 0.12663492576053018, "mean_env_wait_ms": 3.3193708870485024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 4886.369, "sample_throughput": 1637.208, "load_time_ms": 0.144, "load_throughput": 55608936.029, "learn_time_ms": 903.625, "learn_throughput": 8853.231, "update_time_ms": 1.435}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0005, "total_loss": 480856.15, "policy_loss": -0.0009276878677297873, "vf_loss": 480856.2, "vf_explained_var": 9.65595245361328e-07, "kl": 0.004559516510965941, "entropy": 3.636139726638794, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 432000, "num_steps_trained": 216000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 270, "training_iteration": 27, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-24", "timestamp": 1718802384, "time_this_iter_s": 4.8861613273620605, "time_total_s": 131.12200260162354, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 131.12200260162354, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 54.8, "ram_util_percent": 35.67142857142857}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 3200.0, "episode_reward_mean": 10257.808896872495, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1600.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5128.904448436248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8552.995257069655, 9853.544854939257, 12614.9026240817, 12696.491922025198, 4400.0, 7451.792005982166, 4545.280290506102, 14036.353765524062, 3200.0, 7400.461008823346, 8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4276.49762853483, 4276.49762853483, 4926.772427469627, 4926.772427469627, 6307.451312040841, 6307.451312040841, 6348.245961012588, 6348.245961012588, 2200.0, 2200.0, 3725.896002991083, 3725.896002991083, 2272.64014525305, 2272.64014525305, 7018.176882762047, 7018.176882762047, 1600.0, 1600.0, 3700.230504411673, 3700.230504411673, 4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19619775965806852, "mean_inference_ms": 1.1598086896493374, "mean_action_processing_ms": 0.12667128847062054, "mean_env_wait_ms": 3.321901178351745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 224000, "timesteps_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"sample_time_ms": 4902.583, "sample_throughput": 1631.793, "load_time_ms": 0.142, "load_throughput": 56223914.209, "learn_time_ms": 903.354, "learn_throughput": 8855.89, "update_time_ms": 1.434}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0005, "total_loss": 483045.73125, "policy_loss": -0.0006301692142848481, "vf_loss": 483045.76875, "vf_explained_var": -2.78472900390625e-05, "kl": 0.004751497926237941, "entropy": 3.58838267326355, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 224000, "num_agent_steps_sampled": 448000, "num_steps_trained": 224000, "num_agent_steps_trained": 448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-29", "timestamp": 1718802389, "time_this_iter_s": 4.954979658126831, "time_total_s": 136.07698225975037, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 136.07698225975037, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 54.92857142857143, "ram_util_percent": 35.81428571428571}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 4200.0, "episode_reward_mean": 10602.384297303384, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2100.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5301.192148651694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8709.149501738644, 8014.89234532684, 11198.425391107648, 13057.555254483377, 4200.0, 6843.058306346773, 6738.700850238958, 8327.769914774552, 11549.07178295303, 12281.455842456831, 14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4354.574750869321, 4354.574750869321, 4007.44617266342, 4007.44617266342, 5599.21269555382, 5599.21269555382, 6528.777627241689, 6528.777627241689, 2100.0, 2100.0, 3421.5291531733856, 3421.5291531733856, 3369.350425119479, 3369.350425119479, 4163.884957387282, 4163.884957387282, 5774.535891476504, 5774.535891476504, 6140.727921228414, 6140.727921228414, 7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19628441721239923, "mean_inference_ms": 1.1604204740031536, "mean_action_processing_ms": 0.12674884577114198, "mean_env_wait_ms": 3.32547088427312, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 232000, "timesteps_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"sample_time_ms": 4940.454, "sample_throughput": 1619.284, "load_time_ms": 0.142, "load_throughput": 56158045.188, "learn_time_ms": 906.747, "learn_throughput": 8822.748, "update_time_ms": 1.431}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 511776.26875, "policy_loss": -0.002533422895520232, "vf_loss": 511776.33125, "vf_explained_var": -4.8232078552246096e-05, "kl": 0.008588240016305055, "entropy": 3.7586924552917482, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232000, "num_agent_steps_sampled": 464000, "num_steps_trained": 232000, "num_agent_steps_trained": 464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 290, "training_iteration": 29, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-35", "timestamp": 1718802395, "time_this_iter_s": 5.192994117736816, "time_total_s": 141.26997637748718, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f91f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 141.26997637748718, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 51.25, "ram_util_percent": 35.824999999999996}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 2800.0, "episode_reward_mean": 10746.275254741493, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1400.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5373.137627370747}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14537.14870068288, 11299.242428018078, 8610.990139989575, 9285.498771185652, 12150.01387952574, 9687.076332636392, 10463.98074880462, 8427.738581540201, 11257.985894837486, 10351.589114041952, 11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7268.5743503414305, 7268.5743503414305, 5649.621214009058, 5649.621214009058, 4305.495069994786, 4305.495069994786, 4642.749385592836, 4642.749385592836, 6075.0069397628695, 6075.0069397628695, 4843.538166318198, 4843.538166318198, 5231.990374402307, 5231.990374402307, 4213.869290770101, 4213.869290770101, 5628.992947418731, 5628.992947418731, 5175.794557020991, 5175.794557020991, 5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1963352080926293, "mean_inference_ms": 1.1609184576412022, "mean_action_processing_ms": 0.12680722302011463, "mean_env_wait_ms": 3.3286380795446933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 4941.285, "sample_throughput": 1619.012, "load_time_ms": 0.139, "load_throughput": 57387432.872, "learn_time_ms": 904.34, "learn_throughput": 8846.233, "update_time_ms": 1.406}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 401337.8, "policy_loss": -0.00019359078698357734, "vf_loss": 401337.825, "vf_explained_var": -2.1886825561523437e-05, "kl": 0.007968549896100656, "entropy": 3.5559205055236816, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 480000, "num_steps_trained": 240000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-39", "timestamp": 1718802399, "time_this_iter_s": 4.845844984054565, "time_total_s": 146.11582136154175, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f94c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 146.11582136154175, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 53.75714285714286, "ram_util_percent": 35.84285714285714}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 2800.0, "episode_reward_mean": 10684.24311490088, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1400.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5342.121557450442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11472.053064092095, 8175.482475674195, 10295.17268635739, 11274.982177046739, 13449.801855778496, 14012.956641141518, 11247.585025517856, 7132.442516916779, 10719.666821140807, 9445.15736111757, 12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5736.026532046037, 5736.026532046037, 4087.7412378370973, 4087.7412378370973, 5147.586343178675, 5147.586343178675, 5637.491088523362, 5637.491088523362, 6724.900927889266, 6724.900927889266, 7006.478320570772, 7006.478320570772, 5623.792512758941, 5623.792512758941, 3566.2212584583895, 3566.2212584583895, 5359.833410570414, 5359.833410570414, 4722.5786805587995, 4722.5786805587995, 6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19637061859134014, "mean_inference_ms": 1.161298771616297, "mean_action_processing_ms": 0.12685089072847489, "mean_env_wait_ms": 3.330825753145287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 248000, "timesteps_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"sample_time_ms": 4919.824, "sample_throughput": 1626.074, "load_time_ms": 0.14, "load_throughput": 57123649.983, "learn_time_ms": 904.015, "learn_throughput": 8849.413, "update_time_ms": 1.437}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 386161.90625, "policy_loss": -0.0011843690811659258, "vf_loss": 386161.94375, "vf_explained_var": -2.8085708618164062e-05, "kl": 0.006720032077342064, "entropy": 3.4847126960754395, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 248000, "num_agent_steps_sampled": 496000, "num_steps_trained": 248000, "num_agent_steps_trained": 496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 310, "training_iteration": 31, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-44", "timestamp": 1718802404, "time_this_iter_s": 4.796615123748779, "time_total_s": 150.91243648529053, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 150.91243648529053, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 61.650000000000006, "ram_util_percent": 35.85}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 2800.0, "episode_reward_mean": 10781.367055614339, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1400.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5390.683527807172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12875.777301189195, 10578.565275653626, 6163.161648715337, 10854.175075630708, 8337.437066347213, 12764.361363785043, 15669.153284498982, 14681.306027371767, 10787.220999185087, 5000.0, 10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6437.888650594599, 6437.888650594599, 5289.282637826814, 5289.282637826814, 3081.5808243576685, 3081.5808243576685, 5427.087537815354, 5427.087537815354, 4168.7185331736055, 4168.7185331736055, 6382.180681892531, 6382.180681892531, 7834.5766422494835, 7834.5766422494835, 7340.653013685891, 7340.653013685891, 5393.610499592525, 5393.610499592525, 2500.0, 2500.0, 5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19643897759988893, "mean_inference_ms": 1.1618785915307681, "mean_action_processing_ms": 0.12691565270213392, "mean_env_wait_ms": 3.3336213475730774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 256000, "timesteps_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"sample_time_ms": 4942.593, "sample_throughput": 1618.584, "load_time_ms": 0.139, "load_throughput": 57485749.529, "learn_time_ms": 900.725, "learn_throughput": 8881.731, "update_time_ms": 1.399}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 464902.275, "policy_loss": -0.0011640767477459236, "vf_loss": 464902.33125, "vf_explained_var": -4.2271614074707034e-05, "kl": 0.005881830141939787, "entropy": 3.7593101024627686, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 256000, "num_agent_steps_sampled": 512000, "num_steps_trained": 256000, "num_agent_steps_trained": 512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-49", "timestamp": 1718802409, "time_this_iter_s": 5.013353109359741, "time_total_s": 155.92578959465027, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f99d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 155.92578959465027, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 50.587500000000006, "ram_util_percent": 35.9}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 2800.0, "episode_reward_mean": 10615.284942662263, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1400.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5307.642471331132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10729.547495480154, 8739.217522983727, 13461.579288085202, 12366.453470986376, 12929.130969633075, 11299.678567322171, 10295.899849200156, 4600.0, 11352.226113358924, 10728.637167997542, 13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5364.773747740095, 5364.773747740095, 4369.6087614918615, 4369.6087614918615, 6730.789644042596, 6730.789644042596, 6183.226735493186, 6183.226735493186, 6464.5654848165395, 6464.5654848165395, 5649.839283661064, 5649.839283661064, 5147.949924600085, 5147.949924600085, 2300.0, 2300.0, 5676.113056679467, 5676.113056679467, 5364.318583998766, 5364.318583998766, 6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19647724052699164, "mean_inference_ms": 1.1622173061412202, "mean_action_processing_ms": 0.12694925381409983, "mean_env_wait_ms": 3.33559992624365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"sample_time_ms": 4918.177, "sample_throughput": 1626.619, "load_time_ms": 0.14, "load_throughput": 57289451.938, "learn_time_ms": 902.035, "learn_throughput": 8868.832, "update_time_ms": 1.398}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0005, "total_loss": 314619.35625, "policy_loss": -0.0012696948193010372, "vf_loss": 314619.4, "vf_explained_var": -2.4867057800292968e-05, "kl": 0.004910006793275823, "entropy": 3.5841493129730226, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 528000, "num_steps_trained": 264000, "num_agent_steps_trained": 528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 330, "training_iteration": 33, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-54", "timestamp": 1718802414, "time_this_iter_s": 4.869706869125366, "time_total_s": 160.79549646377563, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 160.79549646377563, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 54.01428571428571, "ram_util_percent": 35.871428571428574}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 2200.0, "episode_reward_mean": 10554.421510541097, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1100.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5277.210755270547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13409.239088187926, 8951.283596458736, 13038.046193396705, 11717.67067625262, 5773.636079008527, 14584.147538010515, 10522.643851060275, 7646.97687367662, 5305.877881968641, 10097.512620418402, 9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6704.619544093968, 6704.619544093968, 4475.641798229364, 4475.641798229364, 6519.023096698353, 6519.023096698353, 5858.835338126316, 5858.835338126316, 2886.8180395042637, 2886.8180395042637, 7292.073769005265, 7292.073769005265, 5261.32192553014, 5261.32192553014, 3823.48843683831, 3823.48843683831, 2652.9389409843207, 2652.9389409843207, 5048.756310209193, 5048.756310209193, 4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19653120483884717, "mean_inference_ms": 1.1626362822713747, "mean_action_processing_ms": 0.1269935168353146, "mean_env_wait_ms": 3.3377996389026365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 272000, "timesteps_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"sample_time_ms": 4934.711, "sample_throughput": 1621.169, "load_time_ms": 0.138, "load_throughput": 57842496.121, "learn_time_ms": 904.343, "learn_throughput": 8846.205, "update_time_ms": 1.414}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 375338.375, "policy_loss": -0.0017543122574693371, "vf_loss": 375338.4, "vf_explained_var": -3.0350685119628906e-05, "kl": 0.00648922610569379, "entropy": 3.5906934261322023, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 272000, "num_agent_steps_sampled": 544000, "num_steps_trained": 272000, "num_agent_steps_trained": 544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-06-59", "timestamp": 1718802419, "time_this_iter_s": 4.986272096633911, "time_total_s": 165.78176856040955, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 165.78176856040955, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 55.9, "ram_util_percent": 35.82857142857143}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 400.0, "episode_reward_mean": 10323.745390441052, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5161.872695220527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9084.75587693858, 9734.361031767676, 11603.717837421482, 7294.5161447189785, 12235.029703863722, 8997.383383658405, 4400.735198112705, 6108.395924591983, 14657.322847289117, 12111.510775824045, 14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4542.377938469291, 4542.377938469291, 4867.180515883839, 4867.180515883839, 5801.858918710743, 5801.858918710743, 3647.2580723594892, 3647.2580723594892, 6117.514851931861, 6117.514851931861, 4498.691691829194, 4498.691691829194, 2200.3675990563543, 2200.3675990563543, 3054.1979622959916, 3054.1979622959916, 7328.661423644551, 7328.661423644551, 6055.755387912014, 6055.755387912014, 7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19658343898462835, "mean_inference_ms": 1.1630363399419401, "mean_action_processing_ms": 0.1270358701748372, "mean_env_wait_ms": 3.3402351235673273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 4948.979, "sample_throughput": 1616.495, "load_time_ms": 0.135, "load_throughput": 59053910.595, "learn_time_ms": 902.055, "learn_throughput": 8868.637, "update_time_ms": 1.401}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 254856.25, "policy_loss": -0.0010791343895718342, "vf_loss": 254856.278125, "vf_explained_var": -4.0602684020996096e-05, "kl": 0.00604073433211697, "entropy": 3.7572373867034914, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 560000, "num_steps_trained": 280000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 350, "training_iteration": 35, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-04", "timestamp": 1718802424, "time_this_iter_s": 4.939265966415405, "time_total_s": 170.72103452682495, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 170.72103452682495, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 55.142857142857146, "ram_util_percent": 35.9}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 400.0, "episode_reward_mean": 10249.627955003485, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 5124.813977501744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14211.199479431638, 5812.232856822209, 11859.265316448385, 15237.036062106366, 10082.88063327094, 9755.843426107927, 12819.797993753724, 12836.47267472761, 9461.297147384004, 10226.842141313049, 9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7105.599739715824, 7105.599739715824, 2906.1164284111055, 2906.1164284111055, 5929.632658224204, 5929.632658224204, 7618.518031053183, 7618.518031053183, 5041.440316635473, 5041.440316635473, 4877.921713053966, 4877.921713053966, 6409.898996876873, 6409.898996876873, 6418.236337363818, 6418.236337363818, 4730.648573692013, 4730.648573692013, 5113.421070656523, 5113.421070656523, 4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19668028489528783, "mean_inference_ms": 1.163683310033133, "mean_action_processing_ms": 0.1271025573105304, "mean_env_wait_ms": 3.3434359485284415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 4976.183, "sample_throughput": 1607.658, "load_time_ms": 0.134, "load_throughput": 59716020.644, "learn_time_ms": 907.811, "learn_throughput": 8812.41, "update_time_ms": 1.395}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 297170.73125, "policy_loss": -0.0013529260918502927, "vf_loss": 297170.775, "vf_explained_var": -0.00010137557983398437, "kl": 0.005785220954624959, "entropy": 3.881013536453247, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 576000, "num_steps_trained": 288000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-09", "timestamp": 1718802429, "time_this_iter_s": 5.194758415222168, "time_total_s": 175.91579294204712, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 175.91579294204712, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.55714285714286, "ram_util_percent": 35.9}}
{"episode_reward_max": 17940.896850096222, "episode_reward_min": 400.0, "episode_reward_mean": 9964.990262285888, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 8970.448425048135}, "policy_reward_mean": {"shared_policy": 4982.495131142944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9534.327303856237, 12060.132461165522, 12696.131139625923, 13259.156502440117, 6408.532407744175, 17940.896850096222, 5760.571053583644, 14060.302607095178, 9386.395659494443, 11914.818226307929, 11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4767.163651928119, 4767.163651928119, 6030.066230582765, 6030.066230582765, 6348.06556981297, 6348.06556981297, 6629.578251220075, 6629.578251220075, 3204.2662038720855, 3204.2662038720855, 8970.448425048135, 8970.448425048135, 2880.285526791822, 2880.285526791822, 7030.1513035475855, 7030.1513035475855, 4693.197829747224, 4693.197829747224, 5957.409113153953, 5957.409113153953, 5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19676889869346031, "mean_inference_ms": 1.1643366698295754, "mean_action_processing_ms": 0.12717207082833587, "mean_env_wait_ms": 3.3464826429155545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 296000, "timesteps_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"sample_time_ms": 4988.148, "sample_throughput": 1603.802, "load_time_ms": 0.133, "load_throughput": 59972175.156, "learn_time_ms": 909.576, "learn_throughput": 8795.304, "update_time_ms": 1.426}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0005, "total_loss": 372779.00625, "policy_loss": -0.0017954892286098812, "vf_loss": 372779.04375, "vf_explained_var": -0.00010669231414794922, "kl": 0.004739628359755996, "entropy": 4.059442043304443, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 296000, "num_agent_steps_sampled": 592000, "num_steps_trained": 296000, "num_agent_steps_trained": 592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 370, "training_iteration": 37, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-14", "timestamp": 1718802434, "time_this_iter_s": 4.966606140136719, "time_total_s": 180.88239908218384, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4faf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 180.88239908218384, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 54.74285714285714, "ram_util_percent": 35.9}}
{"episode_reward_max": 16755.37010960382, "episode_reward_min": 400.0, "episode_reward_mean": 9773.50275391697, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 8377.685054801921}, "policy_reward_mean": {"shared_policy": 4886.751376958486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11584.097950017087, 15967.85977454283, 16352.391915725777, 12111.949648257461, 11735.840474420107, 12820.534587413378, 11186.561084697674, 10752.13960727452, 10789.576244400007, 5908.410485291923, 16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5792.048975008549, 5792.048975008549, 7983.929887271403, 7983.929887271403, 8176.195957862896, 8176.195957862896, 6055.974824128728, 6055.974824128728, 5867.920237210052, 5867.920237210052, 6410.267293706676, 6410.267293706676, 5593.280542348853, 5593.280542348853, 5376.0698036372705, 5376.0698036372705, 5394.788122200002, 5394.788122200002, 2954.2052426459613, 2954.2052426459613, 8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19685894647215463, "mean_inference_ms": 1.1649872379890558, "mean_action_processing_ms": 0.12724100013005052, "mean_env_wait_ms": 3.3492772531054835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 304000, "timesteps_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"sample_time_ms": 4981.486, "sample_throughput": 1605.947, "load_time_ms": 0.134, "load_throughput": 59599346.359, "learn_time_ms": 910.208, "learn_throughput": 8789.204, "update_time_ms": 1.434}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 330353.575, "policy_loss": -0.001184440991561786, "vf_loss": 330353.625, "vf_explained_var": -0.00012104511260986328, "kl": 0.0057591602207029855, "entropy": 3.8547269344329833, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 304000, "num_agent_steps_sampled": 608000, "num_steps_trained": 304000, "num_agent_steps_trained": 608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-19", "timestamp": 1718802439, "time_this_iter_s": 4.87764835357666, "time_total_s": 185.7600474357605, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49baf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 185.7600474357605, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 54.92857142857142, "ram_util_percent": 35.9}}
{"episode_reward_max": 16755.37010960382, "episode_reward_min": 400.0, "episode_reward_mean": 9733.911480219918, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 8377.685054801921}, "policy_reward_mean": {"shared_policy": 4866.955740109958}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16331.582607140805, 5774.560636774855, 2800.0, 13619.900041732511, 9854.533751535539, 11778.512406193542, 8662.423061814778, 10089.668292092047, 12518.081756626802, 13879.912379326415, 12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [8165.791303570404, 8165.791303570404, 2887.2803183874285, 2887.2803183874285, 1400.0, 1400.0, 6809.950020866254, 6809.950020866254, 4927.266875767773, 4927.266875767773, 5889.256203096755, 5889.256203096755, 4331.211530907379, 4331.211530907379, 5044.834146046023, 5044.834146046023, 6259.040878313412, 6259.040878313412, 6939.956189663217, 6939.956189663217, 6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19689035122165965, "mean_inference_ms": 1.1653627963573543, "mean_action_processing_ms": 0.1272793760269917, "mean_env_wait_ms": 3.3510884935223753, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"sample_time_ms": 4948.171, "sample_throughput": 1616.759, "load_time_ms": 0.133, "load_throughput": 60004349.07, "learn_time_ms": 904.976, "learn_throughput": 8840.017, "update_time_ms": 1.447}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 490220.95, "policy_loss": -0.0014129594768391486, "vf_loss": 490220.9875, "vf_explained_var": -4.4393539428710935e-05, "kl": 0.007995535479955903, "entropy": 3.463228368759155, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 624000, "num_steps_trained": 312000, "num_agent_steps_trained": 624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 390, "training_iteration": 39, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-24", "timestamp": 1718802444, "time_this_iter_s": 4.8007214069366455, "time_total_s": 190.56076884269714, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 190.56076884269714, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 53.614285714285714, "ram_util_percent": 35.9}}
{"episode_reward_max": 16755.37010960382, "episode_reward_min": 400.0, "episode_reward_mean": 9528.579433511173, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 8377.685054801921}, "policy_reward_mean": {"shared_policy": 4764.2897167555875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12197.845604847014, 4600.0, 6110.448264260238, 11484.157073643331, 7096.937904437429, 9974.51332129577, 13785.907259502586, 16755.37010960382, 10980.823420291923, 6882.047649319322, 9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6098.922802423505, 6098.922802423505, 2300.0, 2300.0, 3055.224132130119, 3055.224132130119, 5742.078536821671, 5742.078536821671, 3548.4689522187145, 3548.4689522187145, 4987.2566606478795, 4987.2566606478795, 6892.953629751293, 6892.953629751293, 8377.685054801921, 8377.685054801921, 5490.411710145971, 5490.411710145971, 3441.0238246596628, 3441.0238246596628, 4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1969204925073509, "mean_inference_ms": 1.1657048960989358, "mean_action_processing_ms": 0.12731204480150077, "mean_env_wait_ms": 3.3527454342598033, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 4934.258, "sample_throughput": 1621.318, "load_time_ms": 0.136, "load_throughput": 58661594.406, "learn_time_ms": 907.323, "learn_throughput": 8817.145, "update_time_ms": 1.465}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 263954.69375, "policy_loss": -0.002045275907777011, "vf_loss": 263954.71875, "vf_explained_var": -9.062290191650391e-05, "kl": 0.005974084581376362, "entropy": 3.458748531341553, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 640000, "num_steps_trained": 320000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-29", "timestamp": 1718802449, "time_this_iter_s": 4.781916856765747, "time_total_s": 195.3426856994629, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 195.3426856994629, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 53.0, "ram_util_percent": 35.9}}
{"episode_reward_max": 14874.524869154055, "episode_reward_min": 400.0, "episode_reward_mean": 9311.241771821824, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 7437.262434577029}, "policy_reward_mean": {"shared_policy": 4655.620885910911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9381.644148579799, 5681.571384214816, 14874.524869154055, 11905.511332043126, 14319.697918423204, 12384.534070474576, 11319.020692695445, 13288.698616917387, 14286.89935233656, 9495.59231129037, 11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4690.82207428989, 4690.82207428989, 2840.785692107408, 2840.785692107408, 7437.262434577029, 7437.262434577029, 5952.755666021574, 5952.755666021574, 7159.848959211611, 7159.848959211611, 6192.267035237275, 6192.267035237275, 5659.5103463477235, 5659.5103463477235, 6644.349308458684, 6644.349308458684, 7143.449676168268, 7143.449676168268, 4747.796155645191, 4747.796155645191, 5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19694636053272432, "mean_inference_ms": 1.1660171129797334, "mean_action_processing_ms": 0.12734049852248838, "mean_env_wait_ms": 3.3543494876562705, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 328000, "timesteps_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"sample_time_ms": 4938.536, "sample_throughput": 1619.913, "load_time_ms": 0.135, "load_throughput": 59335865.606, "learn_time_ms": 908.578, "learn_throughput": 8804.966, "update_time_ms": 1.467}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 214665.23125, "policy_loss": -0.0007048969186143949, "vf_loss": 214665.265625, "vf_explained_var": -0.00012280941009521485, "kl": 0.006440502964032137, "entropy": 3.662617015838623, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 328000, "num_agent_steps_sampled": 656000, "num_steps_trained": 328000, "num_agent_steps_trained": 656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 410, "training_iteration": 41, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-34", "timestamp": 1718802454, "time_this_iter_s": 4.826398611068726, "time_total_s": 200.16908431053162, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 200.16908431053162, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 53.685714285714276, "ram_util_percent": 35.9}}
{"episode_reward_max": 14082.906425620236, "episode_reward_min": 400.0, "episode_reward_mean": 9052.511637495845, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 7041.453212810124}, "policy_reward_mean": {"shared_policy": 4526.255818747923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11021.573282892463, 12165.137227200754, 6735.608083708059, 13547.802971224442, 4116.050215359475, 10055.241730080463, 5133.885028694784, 9992.35975201859, 10473.306823825045, 7861.981632165074, 8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5510.786641446231, 5510.786641446231, 6082.56861360037, 6082.56861360037, 3367.8040418540295, 3367.8040418540295, 6773.901485612223, 6773.901485612223, 2058.0251076797394, 2058.0251076797394, 5027.620865040227, 5027.620865040227, 2566.942514347392, 2566.942514347392, 4996.179876009296, 4996.179876009296, 5236.653411912533, 5236.653411912533, 3930.990816082537, 3930.990816082537, 4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19694358063827333, "mean_inference_ms": 1.1661179805025967, "mean_action_processing_ms": 0.12734698916416895, "mean_env_wait_ms": 3.355525762222685, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"sample_time_ms": 4927.306, "sample_throughput": 1623.605, "load_time_ms": 0.135, "load_throughput": 59252043.087, "learn_time_ms": 913.244, "learn_throughput": 8759.986, "update_time_ms": 1.48}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 317552.16875, "policy_loss": -0.0007810107685625844, "vf_loss": 317552.21875, "vf_explained_var": -0.00011811256408691406, "kl": 0.007452255021889671, "entropy": 3.731605863571167, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 672000, "num_steps_trained": 336000, "num_agent_steps_trained": 672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-39", "timestamp": 1718802459, "time_this_iter_s": 4.936762571334839, "time_total_s": 205.10584688186646, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 205.10584688186646, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 53.9, "ram_util_percent": 35.9}}
{"episode_reward_max": 14635.436634205715, "episode_reward_min": 400.0, "episode_reward_mean": 9033.80794909262, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 7317.718317102866}, "policy_reward_mean": {"shared_policy": 4516.90397454631}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8815.530381466397, 7433.016409756139, 2200.0, 10149.670224815116, 12846.77919192001, 13151.387031162027, 12040.391910022845, 9513.18349859881, 11096.14797571675, 13169.920609472505, 10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4407.765190733204, 4407.765190733204, 3716.5082048780687, 3716.5082048780687, 1100.0, 1100.0, 5074.83511240757, 5074.83511240757, 6423.389595959994, 6423.389595959994, 6575.693515581017, 6575.693515581017, 6020.195955011435, 6020.195955011435, 4756.5917492994, 4756.5917492994, 5548.073987858371, 5548.073987858371, 6584.960304736247, 6584.960304736247, 5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1969378362294538, "mean_inference_ms": 1.16625545667302, "mean_action_processing_ms": 0.12735596677140532, "mean_env_wait_ms": 3.3567462478713153, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 344000, "timesteps_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"sample_time_ms": 4938.555, "sample_throughput": 1619.907, "load_time_ms": 0.132, "load_throughput": 60732003.62, "learn_time_ms": 910.258, "learn_throughput": 8788.717, "update_time_ms": 1.494}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 292882.30625, "policy_loss": -0.0012858084648854629, "vf_loss": 292882.34375, "vf_explained_var": -6.773471832275391e-05, "kl": 0.008495264547060176, "entropy": 3.4996825218200684, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 344000, "num_agent_steps_sampled": 688000, "num_steps_trained": 344000, "num_agent_steps_trained": 688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 430, "training_iteration": 43, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-43", "timestamp": 1718802463, "time_this_iter_s": 4.904622793197632, "time_total_s": 210.0104696750641, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 210.0104696750641, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 55.00000000000001, "ram_util_percent": 35.9}}
{"episode_reward_max": 14635.436634205715, "episode_reward_min": 400.0, "episode_reward_mean": 8701.158545503773, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 7317.718317102866}, "policy_reward_mean": {"shared_policy": 4350.5792727518865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10151.370858525603, 5492.2343486954705, 11642.046636265466, 11370.855570293028, 7250.31795847976, 8807.549415508634, 8680.388716753201, 400.0, 2800.0, 11384.658883913566, 9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5075.6854292627995, 5075.6854292627995, 2746.1171743477353, 2746.1171743477353, 5821.023318132733, 5821.023318132733, 5685.427785146499, 5685.427785146499, 3625.15897923988, 3625.15897923988, 4403.7747077543245, 4403.7747077543245, 4340.194358376595, 4340.194358376595, 200.0, 200.0, 1400.0, 1400.0, 5692.329441956813, 5692.329441956813, 4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19694526883089444, "mean_inference_ms": 1.1663946387888846, "mean_action_processing_ms": 0.12736405065833897, "mean_env_wait_ms": 3.3578653696011833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 352000, "timesteps_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"sample_time_ms": 4938.689, "sample_throughput": 1619.863, "load_time_ms": 0.136, "load_throughput": 58754039.573, "learn_time_ms": 910.956, "learn_throughput": 8781.982, "update_time_ms": 1.535}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 184126.91875, "policy_loss": -0.001933787342347415, "vf_loss": 184126.95625, "vf_explained_var": -1.5115737915039062e-05, "kl": 0.00863876468511775, "entropy": 3.7448028564453124, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 352000, "num_agent_steps_sampled": 704000, "num_steps_trained": 352000, "num_agent_steps_trained": 704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 44, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-49", "timestamp": 1718802469, "time_this_iter_s": 5.027085304260254, "time_total_s": 215.03755497932434, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 215.03755497932434, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 56.11428571428571, "ram_util_percent": 35.9}}
{"episode_reward_max": 14635.436634205715, "episode_reward_min": 400.0, "episode_reward_mean": 8763.433552250739, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 7317.718317102866}, "policy_reward_mean": {"shared_policy": 4381.7167761253695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9292.67700867225, 6500.900701455683, 10595.408957625488, 12634.594786758818, 7145.3898882333015, 12008.691645618594, 8649.498583775101, 9733.420158003162, 2600.0, 9655.40345028757, 6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4646.338504336127, 4646.338504336127, 3250.4503507278414, 3250.4503507278414, 5297.704478812741, 5297.704478812741, 6317.297393379413, 6317.297393379413, 3572.6949441166516, 3572.6949441166516, 6004.345822809292, 6004.345822809292, 4324.749291887545, 4324.749291887545, 4866.710079001587, 4866.710079001587, 1300.0, 1300.0, 4827.701725143811, 4827.701725143811, 3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19694607987405, "mean_inference_ms": 1.1665300565002095, "mean_action_processing_ms": 0.12737197476495093, "mean_env_wait_ms": 3.358652100690634, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 4927.314, "sample_throughput": 1623.603, "load_time_ms": 0.137, "load_throughput": 58508163.906, "learn_time_ms": 910.177, "learn_throughput": 8789.499, "update_time_ms": 1.538}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 237164.821875, "policy_loss": -0.0008275460312258786, "vf_loss": 237164.871875, "vf_explained_var": -7.104873657226562e-05, "kl": 0.00771622261974417, "entropy": 3.423033857345581, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 720000, "num_steps_trained": 360000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 450, "training_iteration": 45, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-53", "timestamp": 1718802473, "time_this_iter_s": 4.807874917984009, "time_total_s": 219.84542989730835, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9f70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 219.84542989730835, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 54.10000000000001, "ram_util_percent": 35.9}}
{"episode_reward_max": 14635.436634205715, "episode_reward_min": 400.0, "episode_reward_mean": 8921.893865557959, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 200.0}, "policy_reward_max": {"shared_policy": 7317.718317102866}, "policy_reward_mean": {"shared_policy": 4460.946932778979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6400.0, 12020.267460026036, 13429.427808297965, 12308.864223417895, 2000.0, 400.0, 4882.322939475143, 13176.982075308912, 8312.360605269045, 10908.873347811077, 4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3200.0, 3200.0, 6010.133730013012, 6010.133730013012, 6714.7139041489845, 6714.7139041489845, 6154.432111708922, 6154.432111708922, 1000.0, 1000.0, 200.0, 200.0, 2441.1614697375717, 2441.1614697375717, 6588.491037654461, 6588.491037654461, 4156.180302634523, 4156.180302634523, 5454.436673905537, 5454.436673905537, 2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19690946587152328, "mean_inference_ms": 1.166438804915365, "mean_action_processing_ms": 0.12735775106665342, "mean_env_wait_ms": 3.3586954994046327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 368000, "timesteps_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"sample_time_ms": 4893.998, "sample_throughput": 1634.655, "load_time_ms": 0.137, "load_throughput": 58589893.487, "learn_time_ms": 907.437, "learn_throughput": 8816.039, "update_time_ms": 1.535}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 371552.39375, "policy_loss": -0.0008942886907775005, "vf_loss": 371552.425, "vf_explained_var": -5.5909156799316406e-05, "kl": 0.0073875339237496245, "entropy": 3.486317014694214, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 368000, "num_agent_steps_sampled": 736000, "num_steps_trained": 368000, "num_agent_steps_trained": 736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 460, "training_iteration": 46, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-07-58", "timestamp": 1718802478, "time_this_iter_s": 4.840759038925171, "time_total_s": 224.68618893623352, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 224.68618893623352, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 54.01428571428572, "ram_util_percent": 35.9}}
{"episode_reward_max": 16862.89570414863, "episode_reward_min": 600.0, "episode_reward_mean": 9259.704318275486, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 300.0}, "policy_reward_max": {"shared_policy": 8431.447852074325}, "policy_reward_mean": {"shared_policy": 4629.852159137742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4000.0, 10408.87830149136, 13123.251421780464, 7796.702859811732, 9846.018953821625, 9839.888034919066, 3200.0, 12289.38335994877, 13789.267474703644, 9579.122968040996, 8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2000.0, 2000.0, 5204.439150745692, 5204.439150745692, 6561.6257108902355, 6561.6257108902355, 3898.351429905866, 3898.351429905866, 4923.009476910816, 4923.009476910816, 4919.944017459534, 4919.944017459534, 1600.0, 1600.0, 6144.691679974376, 6144.691679974376, 6894.633737351822, 6894.633737351822, 4789.561484020498, 4789.561484020498, 4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1968619509019122, "mean_inference_ms": 1.1662597460119246, "mean_action_processing_ms": 0.12733154230402105, "mean_env_wait_ms": 3.358459221258795, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 376000, "timesteps_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"sample_time_ms": 4882.431, "sample_throughput": 1638.528, "load_time_ms": 0.14, "load_throughput": 57084777.135, "learn_time_ms": 905.6, "learn_throughput": 8833.926, "update_time_ms": 1.501}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 487548.0125, "policy_loss": -0.00030305365954992337, "vf_loss": 487548.03125, "vf_explained_var": -9.016990661621093e-05, "kl": 0.013233198411938993, "entropy": 3.516172409057617, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 376000, "num_agent_steps_sampled": 752000, "num_steps_trained": 376000, "num_agent_steps_trained": 752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 470, "training_iteration": 47, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-03", "timestamp": 1718802483, "time_this_iter_s": 4.857872247695923, "time_total_s": 229.54406118392944, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4faee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 229.54406118392944, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 53.24285714285715, "ram_util_percent": 35.98571428571429}}
{"episode_reward_max": 16862.89570414863, "episode_reward_min": 600.0, "episode_reward_mean": 9300.915262083992, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 300.0}, "policy_reward_max": {"shared_policy": 8431.447852074325}, "policy_reward_mean": {"shared_policy": 4650.457631041996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8403.577196838032, 2600.0, 13558.97094059308, 14082.906425620236, 13235.267384823997, 13897.659855435551, 13233.898928549082, 11980.511210380791, 10731.56804526625, 13525.874414828315, 11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4201.788598419016, 4201.788598419016, 1300.0, 1300.0, 6779.4854702965295, 6779.4854702965295, 7041.453212810124, 7041.453212810124, 6617.6336924120005, 6617.6336924120005, 6948.829927717768, 6948.829927717768, 6616.949464274541, 6616.949464274541, 5990.255605190395, 5990.255605190395, 5365.784022633132, 5365.784022633132, 6762.937207414154, 6762.937207414154, 5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19680956433740157, "mean_inference_ms": 1.1660276798489317, "mean_action_processing_ms": 0.12729922298089638, "mean_env_wait_ms": 3.3580496965594464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"sample_time_ms": 4877.618, "sample_throughput": 1640.145, "load_time_ms": 0.141, "load_throughput": 56871918.644, "learn_time_ms": 905.786, "learn_throughput": 8832.106, "update_time_ms": 1.494}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 331673.2625, "policy_loss": 0.0004564434549247487, "vf_loss": 331673.2875, "vf_explained_var": 3.6203861236572264e-05, "kl": 0.009191081952465676, "entropy": 3.0418370246887205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 768000, "num_steps_trained": 384000, "num_agent_steps_trained": 768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 48, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-08", "timestamp": 1718802488, "time_this_iter_s": 4.8491058349609375, "time_total_s": 234.39316701889038, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 234.39316701889038, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 53.64285714285715, "ram_util_percent": 35.94285714285714}}
{"episode_reward_max": 16862.89570414863, "episode_reward_min": 600.0, "episode_reward_mean": 8988.340805729604, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 300.0}, "policy_reward_max": {"shared_policy": 8431.447852074325}, "policy_reward_mean": {"shared_policy": 4494.170402864802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11461.935489831852, 13700.116247502712, 8587.809728352237, 8243.984346648132, 8326.554396202035, 2800.0, 6433.30638943924, 5778.495818445246, 11265.88398519927, 8177.883860742459, 6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5730.9677449159135, 5730.9677449159135, 6850.058123751343, 6850.058123751343, 4293.904864176122, 4293.904864176122, 4121.992173324057, 4121.992173324057, 4163.277198101019, 4163.277198101019, 1400.0, 1400.0, 3216.65319471962, 3216.65319471962, 2889.247909222623, 2889.247909222623, 5632.941992599635, 5632.941992599635, 4088.9419303712293, 4088.9419303712293, 3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19676740802352197, "mean_inference_ms": 1.1658779421652727, "mean_action_processing_ms": 0.12727632624054916, "mean_env_wait_ms": 3.3581277877382325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 392000, "timesteps_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"sample_time_ms": 4901.598, "sample_throughput": 1632.121, "load_time_ms": 0.141, "load_throughput": 56833387.534, "learn_time_ms": 907.087, "learn_throughput": 8819.439, "update_time_ms": 1.508}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 296980.0125, "policy_loss": 0.0022736863524656314, "vf_loss": 296980.03125, "vf_explained_var": -8.0108642578125e-06, "kl": 0.015517491847389736, "entropy": 3.186388874053955, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 392000, "num_agent_steps_sampled": 784000, "num_steps_trained": 392000, "num_agent_steps_trained": 784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 490, "training_iteration": 49, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-13", "timestamp": 1718802493, "time_this_iter_s": 5.050886392593384, "time_total_s": 239.44405341148376, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 239.44405341148376, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 55.942857142857136, "ram_util_percent": 36.0}}
{"episode_reward_max": 16862.89570414863, "episode_reward_min": 600.0, "episode_reward_mean": 9020.535241122585, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 300.0}, "policy_reward_max": {"shared_policy": 8431.447852074325}, "policy_reward_mean": {"shared_policy": 4510.2676205612925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6013.578633728797, 11160.42100011084, 5000.0, 6790.351586112454, 6254.813820627905, 10581.656325985208, 6501.445152850032, 6900.0631583538125, 8785.537115473344, 10146.417645023877, 12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3006.7893168643986, 3006.7893168643986, 5580.210500055428, 5580.210500055428, 2500.0, 2500.0, 3395.175793056227, 3395.175793056227, 3127.4069103139536, 3127.4069103139536, 5290.828162992592, 5290.828162992592, 3250.722576425016, 3250.722576425016, 3450.0315791769062, 3450.0315791769062, 4392.768557736671, 4392.768557736671, 5073.208822511942, 5073.208822511942, 6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1967371120236118, "mean_inference_ms": 1.1657877438316393, "mean_action_processing_ms": 0.12726116309989435, "mean_env_wait_ms": 3.358416960940383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 4910.101, "sample_throughput": 1629.294, "load_time_ms": 0.139, "load_throughput": 57733021.335, "learn_time_ms": 905.601, "learn_throughput": 8833.912, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 277690.7125, "policy_loss": -0.0008570247698575173, "vf_loss": 277690.7375, "vf_explained_var": 1.633167266845703e-05, "kl": 0.013211311772625639, "entropy": 3.1569239139556884, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 800000, "num_steps_trained": 400000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 14993.331790762139, "episode_reward_min": 4000.0, "episode_reward_mean": 10270.075143693097, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2000.0}, "policy_reward_max": {"shared_policy": 7496.665895381071}, "policy_reward_mean": {"shared_policy": 5135.03757184655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8948.728815652685, 4000.0, 12373.550004267065, 11244.531308377329, 8558.933817805646, 14083.384462584596, 14993.331790762139, 11723.620688555588, 8987.140240162676, 7787.5303087632365], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4474.364407826323, 4474.364407826323, 2000.0, 2000.0, 6186.775002133532, 6186.775002133532, 5622.265654188666, 5622.265654188666, 4279.466908902826, 4279.466908902826, 7041.692231292305, 7041.692231292305, 7496.665895381071, 7496.665895381071, 5861.810344277812, 5861.810344277812, 4493.570120081345, 4493.570120081345, 3893.7651543816182, 3893.7651543816182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09764088584309652, "mean_inference_ms": 0.6447469215216659, "mean_action_processing_ms": 0.06886059575461698, "mean_env_wait_ms": 1.8184568834012782, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 500, "training_iteration": 50, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-39", "timestamp": 1718802519, "time_this_iter_s": 25.910433769226074, "time_total_s": 265.35448718070984, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a5693a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 265.35448718070984, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.916216216216217, "ram_util_percent": 35.8837837837838}}
{"episode_reward_max": 16862.89570414863, "episode_reward_min": 600.0, "episode_reward_mean": 9218.046963827632, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 300.0}, "policy_reward_max": {"shared_policy": 8431.447852074325}, "policy_reward_mean": {"shared_policy": 4609.023481913816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12510.804351234401, 9453.638708897175, 3000.0, 8014.9799035134565, 12747.181990679717, 4600.0, 11611.289394432944, 8890.28251596669, 10873.603491512538, 9362.900907294494, 8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6255.402175617204, 6255.402175617204, 4726.819354448585, 4726.819354448585, 1500.0, 1500.0, 4007.4899517567283, 4007.4899517567283, 6373.590995339862, 6373.590995339862, 2300.0, 2300.0, 5805.64469721649, 5805.64469721649, 4445.141257983348, 4445.141257983348, 5436.801745756273, 5436.801745756273, 4681.450453647255, 4681.450453647255, 4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19671342097276187, "mean_inference_ms": 1.165735758027132, "mean_action_processing_ms": 0.1272525173046924, "mean_env_wait_ms": 3.3587763485626403, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"sample_time_ms": 7016.927, "sample_throughput": 1140.1, "load_time_ms": 0.139, "load_throughput": 57367809.882, "learn_time_ms": 904.757, "learn_throughput": 8842.151, "update_time_ms": 1.517}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 319079.69375, "policy_loss": -0.00036171500924950804, "vf_loss": 319079.71875, "vf_explained_var": -9.541511535644531e-05, "kl": 0.011290285177666856, "entropy": 3.438019847869873, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 816000, "num_steps_trained": 408000, "num_agent_steps_trained": 816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 510, "training_iteration": 51, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-44", "timestamp": 1718802524, "time_this_iter_s": 4.82899284362793, "time_total_s": 270.18348002433777, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 270.18348002433777, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 54.142857142857146, "ram_util_percent": 35.9}}
{"episode_reward_max": 16984.859973388557, "episode_reward_min": 600.0, "episode_reward_mean": 9324.183674486798, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 300.0}, "policy_reward_max": {"shared_policy": 8492.429986694257}, "policy_reward_mean": {"shared_policy": 4662.091837243398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8994.126317865619, 8373.862452346842, 11094.88296153142, 4600.0, 5566.213899485316, 14635.436634205715, 12361.479449763181, 8562.076772963053, 6211.605449520252, 8832.893969165161, 8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4497.063158932804, 4497.063158932804, 4186.931226173425, 4186.931226173425, 5547.4414807657095, 5547.4414807657095, 2300.0, 2300.0, 2783.106949742658, 2783.106949742658, 7317.718317102866, 7317.718317102866, 6180.739724881583, 6180.739724881583, 4281.038386481527, 4281.038386481527, 3105.802724760126, 3105.802724760126, 4416.446984582588, 4416.446984582588, 4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19671449760991702, "mean_inference_ms": 1.1658804243119871, "mean_action_processing_ms": 0.12726774383103728, "mean_env_wait_ms": 3.3595127714837743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 416000, "timesteps_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"sample_time_ms": 7037.4, "sample_throughput": 1136.783, "load_time_ms": 0.139, "load_throughput": 57485749.529, "learn_time_ms": 900.534, "learn_throughput": 8883.622, "update_time_ms": 1.524}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 393117.06875, "policy_loss": -0.0002811373413067031, "vf_loss": 393117.1, "vf_explained_var": -1.1706352233886719e-05, "kl": 0.010813071858342788, "entropy": 3.190893268585205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 416000, "num_agent_steps_sampled": 832000, "num_steps_trained": 416000, "num_agent_steps_trained": 832000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 520, "training_iteration": 52, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-49", "timestamp": 1718802529, "time_this_iter_s": 5.106167316436768, "time_total_s": 275.28964734077454, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 275.28964734077454, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 57.40000000000001, "ram_util_percent": 35.9}}
{"episode_reward_max": 16984.859973388557, "episode_reward_min": 600.0, "episode_reward_mean": 9487.632330181217, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 300.0}, "policy_reward_max": {"shared_policy": 8492.429986694257}, "policy_reward_mean": {"shared_policy": 4743.816165090608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8451.472661899421, 7017.581056117058, 600.0, 8550.116068605163, 11705.049655522369, 10833.533264822694, 2800.0, 2400.0, 11993.33416707937, 2800.0, 8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4225.736330949707, 4225.736330949707, 3508.790528058531, 3508.790528058531, 300.0, 300.0, 4275.058034302577, 4275.058034302577, 5852.524827761194, 5852.524827761194, 5416.766632411343, 5416.766632411343, 1400.0, 1400.0, 1200.0, 1200.0, 5996.667083539669, 5996.667083539669, 1400.0, 1400.0, 4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196703055979106, "mean_inference_ms": 1.1659540677209217, "mean_action_processing_ms": 0.12727629501070628, "mean_env_wait_ms": 3.360046508581793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 424000, "timesteps_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"sample_time_ms": 7025.108, "sample_throughput": 1138.772, "load_time_ms": 0.139, "load_throughput": 57604175.107, "learn_time_ms": 898.61, "learn_throughput": 8902.643, "update_time_ms": 1.513}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 396309.73125, "policy_loss": 0.0004556827648542594, "vf_loss": 396309.7625, "vf_explained_var": -0.00011289119720458984, "kl": 0.013328824658148792, "entropy": 3.31271014213562, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 424000, "num_agent_steps_sampled": 848000, "num_steps_trained": 424000, "num_agent_steps_trained": 848000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 530, "training_iteration": 53, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-54", "timestamp": 1718802534, "time_this_iter_s": 4.806981563568115, "time_total_s": 280.09662890434265, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fac10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 280.09662890434265, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.44285714285714, "ram_util_percent": 35.91428571428572}}
{"episode_reward_max": 17045.361625486912, "episode_reward_min": 1000.0, "episode_reward_mean": 9799.771595251797, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8522.680812743463}, "policy_reward_mean": {"shared_policy": 4899.885797625898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8678.601800939163, 10220.482953401908, 12954.006846785429, 10023.613072727287, 9142.429744754416, 5475.246054222713, 8506.88662784349, 2400.0, 9347.850081727876, 7457.8058807291745, 11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4339.30090046959, 4339.30090046959, 5110.241476700952, 5110.241476700952, 6477.003423392696, 6477.003423392696, 5011.806536363649, 5011.806536363649, 4571.2148723772225, 4571.2148723772225, 2737.6230271113564, 2737.6230271113564, 4253.443313921749, 4253.443313921749, 1200.0, 1200.0, 4673.925040863934, 4673.925040863934, 3728.9029403645873, 3728.9029403645873, 5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19666369707351083, "mean_inference_ms": 1.1659051844619974, "mean_action_processing_ms": 0.12727145883877267, "mean_env_wait_ms": 3.3602342627491684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"sample_time_ms": 7002.498, "sample_throughput": 1142.449, "load_time_ms": 0.135, "load_throughput": 59409405.099, "learn_time_ms": 896.577, "learn_throughput": 8922.821, "update_time_ms": 1.479}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 355477.8875, "policy_loss": -0.001221812995104088, "vf_loss": 355477.91875, "vf_explained_var": -2.5987625122070312e-05, "kl": 0.014030594192722554, "entropy": 3.33858962059021, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 864000, "num_steps_trained": 432000, "num_agent_steps_trained": 864000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 540, "training_iteration": 54, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-08-59", "timestamp": 1718802539, "time_this_iter_s": 4.797172784805298, "time_total_s": 284.89380168914795, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 284.89380168914795, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 53.82857142857143, "ram_util_percent": 36.0}}
{"episode_reward_max": 17045.361625486912, "episode_reward_min": 1000.0, "episode_reward_mean": 9906.958415987594, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8522.680812743463}, "policy_reward_mean": {"shared_policy": 4953.479207993797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11159.58403984474, 5316.168060953782, 14004.650929580592, 11824.632940433185, 12921.807171454911, 5675.810649930839, 14316.746621097016, 10803.376262323687, 8835.200593731319, 9804.039241801733, 9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5579.792019922368, 5579.792019922368, 2658.084030476891, 2658.084030476891, 7002.3254647902995, 7002.3254647902995, 5912.3164702165905, 5912.3164702165905, 6460.903585727447, 6460.903585727447, 2837.9053249654226, 2837.9053249654226, 7158.373310548508, 7158.373310548508, 5401.688131161852, 5401.688131161852, 4417.600296865656, 4417.600296865656, 4902.019620900865, 4902.019620900865, 4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19663920257433998, "mean_inference_ms": 1.1659001759614112, "mean_action_processing_ms": 0.12727379693699017, "mean_env_wait_ms": 3.3605489932181865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"sample_time_ms": 7005.808, "sample_throughput": 1141.91, "load_time_ms": 0.135, "load_throughput": 59377865.864, "learn_time_ms": 896.81, "learn_throughput": 8920.51, "update_time_ms": 1.506}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 309650.15625, "policy_loss": 0.0001402704815859579, "vf_loss": 309650.175, "vf_explained_var": -0.0001959562301635742, "kl": 0.011992605217040117, "entropy": 3.368306875228882, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 880000, "num_steps_trained": 440000, "num_agent_steps_trained": 880000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 550, "training_iteration": 55, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-03", "timestamp": 1718802543, "time_this_iter_s": 4.866994857788086, "time_total_s": 289.76079654693604, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 289.76079654693604, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 55.15714285714286, "ram_util_percent": 35.98571428571429}}
{"episode_reward_max": 17045.361625486912, "episode_reward_min": 1000.0, "episode_reward_mean": 9822.309234029774, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8522.680812743463}, "policy_reward_mean": {"shared_policy": 4911.154617014886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9556.183279174169, 7725.560216262998, 16862.89570414863, 13215.8513899442, 14472.896569023917, 9987.446103179835, 6747.772294493916, 15376.666248731173, 14289.573522033566, 9385.298404366382, 13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4778.091639587083, 4778.091639587083, 3862.780108131499, 3862.780108131499, 8431.447852074325, 8431.447852074325, 6607.925694972102, 6607.925694972102, 7236.448284511953, 7236.448284511953, 4993.723051589914, 4993.723051589914, 3373.886147246958, 3373.886147246958, 7688.333124365581, 7688.333124365581, 7144.786761016781, 7144.786761016781, 4692.649202183188, 4692.649202183188, 6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966191015323052, "mean_inference_ms": 1.1658877933989766, "mean_action_processing_ms": 0.12727541434274145, "mean_env_wait_ms": 3.3609336319845315, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 448000, "timesteps_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"sample_time_ms": 7008.714, "sample_throughput": 1141.436, "load_time_ms": 0.136, "load_throughput": 58630843.963, "learn_time_ms": 893.652, "learn_throughput": 8952.031, "update_time_ms": 1.535}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 327569.73125, "policy_loss": 2.405001269778495e-05, "vf_loss": 327569.75625, "vf_explained_var": -9.660720825195312e-05, "kl": 0.00900049395884101, "entropy": 3.4850742340087892, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 448000, "num_agent_steps_sampled": 896000, "num_steps_trained": 448000, "num_agent_steps_trained": 896000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 560, "training_iteration": 56, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-08", "timestamp": 1718802548, "time_this_iter_s": 4.838016748428345, "time_total_s": 294.5988132953644, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 294.5988132953644, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 54.01428571428572, "ram_util_percent": 36.0}}
{"episode_reward_max": 17045.361625486912, "episode_reward_min": 1000.0, "episode_reward_mean": 9667.424149931085, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8522.680812743463}, "policy_reward_mean": {"shared_policy": 4833.712074965542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13393.60488107803, 11987.66551724631, 7451.8815425705525, 5811.572230529717, 13963.372666472173, 2400.0, 12417.811458196717, 13540.395981322978, 8620.76582753053, 8406.537650421375, 5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6696.80244053901, 6696.80244053901, 5993.832758623152, 5993.832758623152, 3725.9407712852762, 3725.9407712852762, 2905.7861152648584, 2905.7861152648584, 6981.686333236077, 6981.686333236077, 1200.0, 1200.0, 6208.9057290983565, 6208.9057290983565, 6770.197990661476, 6770.197990661476, 4310.3829137652665, 4310.3829137652665, 4203.268825210693, 4203.268825210693, 2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196603861485803, "mean_inference_ms": 1.1659040914387075, "mean_action_processing_ms": 0.1272823032627428, "mean_env_wait_ms": 3.3614786244444836, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"sample_time_ms": 7006.133, "sample_throughput": 1141.857, "load_time_ms": 0.133, "load_throughput": 60262988.506, "learn_time_ms": 893.562, "learn_throughput": 8952.935, "update_time_ms": 1.556}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 366793.95, "policy_loss": -0.00043258700093673497, "vf_loss": 366793.975, "vf_explained_var": -6.99758529663086e-05, "kl": 0.009071088675622055, "entropy": 3.257355070114136, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 912000, "num_steps_trained": 456000, "num_agent_steps_trained": 912000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 570, "training_iteration": 57, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-13", "timestamp": 1718802553, "time_this_iter_s": 4.8662261962890625, "time_total_s": 299.46503949165344, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 299.46503949165344, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 54.21428571428572, "ram_util_percent": 36.0}}
{"episode_reward_max": 17045.361625486912, "episode_reward_min": 1000.0, "episode_reward_mean": 9682.916760163927, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 8522.680812743463}, "policy_reward_mean": {"shared_policy": 4841.458380081963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5658.781807575133, 14841.467482894597, 6958.698194280387, 1000.0, 8116.504198918497, 12950.974655914346, 9234.53061903144, 13209.000940214075, 4400.0, 7622.830868068075, 11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2829.390903787569, 2829.390903787569, 7420.733741447304, 7420.733741447304, 3479.3490971401934, 3479.3490971401934, 500.0, 500.0, 4058.2520994592487, 4058.2520994592487, 6475.487327957169, 6475.487327957169, 4617.26530951572, 4617.26530951572, 6604.500470107027, 6604.500470107027, 2200.0, 2200.0, 3811.4154340340374, 3811.4154340340374, 5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966008254390859, "mean_inference_ms": 1.1659799230631498, "mean_action_processing_ms": 0.12729520137660422, "mean_env_wait_ms": 3.3622015835120145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 464000, "timesteps_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"sample_time_ms": 7019.709, "sample_throughput": 1139.648, "load_time_ms": 0.132, "load_throughput": 60545709.13, "learn_time_ms": 893.258, "learn_throughput": 8955.976, "update_time_ms": 1.558}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0005, "total_loss": 356085.09375, "policy_loss": 0.0019370116129515224, "vf_loss": 356085.125, "vf_explained_var": -6.473064422607422e-05, "kl": 0.020525883324789024, "entropy": 3.303442144393921, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 464000, "num_agent_steps_sampled": 928000, "num_steps_trained": 464000, "num_agent_steps_trained": 928000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 580, "training_iteration": 58, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-18", "timestamp": 1718802558, "time_this_iter_s": 4.980369806289673, "time_total_s": 304.4454092979431, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa4c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 304.4454092979431, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 54.77142857142858, "ram_util_percent": 35.9}}
{"episode_reward_max": 17045.361625486912, "episode_reward_min": 2800.0, "episode_reward_mean": 10029.616109835582, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1400.0}, "policy_reward_max": {"shared_policy": 8522.680812743463}, "policy_reward_mean": {"shared_policy": 5014.808054917791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11657.78532709986, 6921.853401108923, 13438.690097743016, 8497.897670421673, 13327.08403437629, 4165.030666547722, 8908.819914316457, 6289.959790137356, 4000.0, 10788.292899909913, 15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5828.892663549941, 5828.892663549941, 3460.9267005544616, 3460.9267005544616, 6719.345048871513, 6719.345048871513, 4248.948835210829, 4248.948835210829, 6663.542017188152, 6663.542017188152, 2082.515333273861, 2082.515333273861, 4454.409957158231, 4454.409957158231, 3144.979895068678, 3144.979895068678, 2000.0, 2000.0, 5394.146449954955, 5394.146449954955, 7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19658861069389835, "mean_inference_ms": 1.1659995687245204, "mean_action_processing_ms": 0.12730122800693652, "mean_env_wait_ms": 3.3625256761824005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 472000, "timesteps_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"sample_time_ms": 7000.947, "sample_throughput": 1142.703, "load_time_ms": 0.132, "load_throughput": 60688066.558, "learn_time_ms": 891.191, "learn_throughput": 8976.755, "update_time_ms": 1.543}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 472265.9375, "policy_loss": -0.0005051359209463868, "vf_loss": 472265.9875, "vf_explained_var": -0.0001659393310546875, "kl": 0.012440960854597784, "entropy": 3.3200497150421144, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 472000, "num_agent_steps_sampled": 944000, "num_steps_trained": 472000, "num_agent_steps_trained": 944000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 590, "training_iteration": 59, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-23", "timestamp": 1718802563, "time_this_iter_s": 4.8465235233306885, "time_total_s": 309.2919328212738, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fab80>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 309.2919328212738, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 53.942857142857136, "ram_util_percent": 35.92857142857143}}
{"episode_reward_max": 17045.361625486912, "episode_reward_min": 2000.0, "episode_reward_mean": 9913.230875835057, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1000.0}, "policy_reward_max": {"shared_policy": 8522.680812743463}, "policy_reward_mean": {"shared_policy": 4956.615437917529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15998.348819584222, 10204.281780037043, 11973.599742169565, 5478.7721864152445, 10765.402785647035, 8933.651026369655, 11172.939731425413, 9803.892362467286, 5791.473390603664, 7763.09488405181, 7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7999.174409792118, 7999.174409792118, 5102.1408900185215, 5102.1408900185215, 5986.799871084799, 5986.799871084799, 2739.3860932076223, 2739.3860932076223, 5382.701392823512, 5382.701392823512, 4466.825513184826, 4466.825513184826, 5586.469865712703, 5586.469865712703, 4901.946181233639, 4901.946181233639, 2895.736695301832, 2895.736695301832, 3881.547442025905, 3881.547442025905, 3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196562362709459, "mean_inference_ms": 1.1659862283220008, "mean_action_processing_ms": 0.127303349660167, "mean_env_wait_ms": 3.36272271893875, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 6995.03, "sample_throughput": 1143.669, "load_time_ms": 0.132, "load_throughput": 60831094.996, "learn_time_ms": 892.63, "learn_throughput": 8962.285, "update_time_ms": 1.539}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 214807.203125, "policy_loss": -0.00020260442590824823, "vf_loss": 214807.23125, "vf_explained_var": 8.536577224731446e-05, "kl": 0.008691057935569712, "entropy": 2.8959093570709227, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 960000, "num_steps_trained": 480000, "num_agent_steps_trained": 960000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 60, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-28", "timestamp": 1718802568, "time_this_iter_s": 4.815908670425415, "time_total_s": 314.1078414916992, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 314.1078414916992, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 52.65714285714286, "ram_util_percent": 35.971428571428575}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 2000.0, "episode_reward_mean": 10116.634503117173, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1000.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5058.317251558587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7894.355610317492, 10733.368666151357, 12418.574762310527, 12694.424789079556, 10697.032043909068, 5917.08267528161, 16984.859973388557, 8585.015692620284, 12953.638116389502, 2800.0, 11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3947.177805158746, 3947.177805158746, 5366.684333075674, 5366.684333075674, 6209.287381155258, 6209.287381155258, 6347.212394539783, 6347.212394539783, 5348.516021954523, 5348.516021954523, 2958.541337640805, 2958.541337640805, 8492.429986694257, 8492.429986694257, 4292.50784631013, 4292.50784631013, 6476.819058194742, 6476.819058194742, 1400.0, 1400.0, 5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19653443214287517, "mean_inference_ms": 1.165960289400557, "mean_action_processing_ms": 0.12730269834265087, "mean_env_wait_ms": 3.3629230185503274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 488000, "timesteps_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"sample_time_ms": 4885.766, "sample_throughput": 1637.41, "load_time_ms": 0.13, "load_throughput": 61556470.372, "learn_time_ms": 895.226, "learn_throughput": 8936.287, "update_time_ms": 1.527}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 470740.90625, "policy_loss": 0.0004819730811519207, "vf_loss": 470740.9375, "vf_explained_var": -7.500648498535157e-05, "kl": 0.012336529605461591, "entropy": 3.4796002388000487, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 488000, "num_agent_steps_sampled": 976000, "num_steps_trained": 488000, "num_agent_steps_trained": 976000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 610, "training_iteration": 61, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-33", "timestamp": 1718802573, "time_this_iter_s": 4.822080612182617, "time_total_s": 318.92992210388184, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 318.92992210388184, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 54.0142857142857, "ram_util_percent": 35.92857142857143}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 2000.0, "episode_reward_mean": 10181.026987387808, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1000.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5090.513493693905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11211.745921634156, 10166.237639185183, 10151.273100528066, 11895.469200205873, 11262.67843977411, 8021.527391000818, 15232.293500273936, 7605.454690971452, 7099.834505765048, 12930.929086949898, 9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5605.872960817083, 5605.872960817083, 5083.11881959259, 5083.11881959259, 5075.636550264028, 5075.636550264028, 5947.734600102929, 5947.734600102929, 5631.339219887066, 5631.339219887066, 4010.763695500409, 4010.763695500409, 7616.146750136959, 7616.146750136959, 3802.727345485726, 3802.727345485726, 3549.917252882524, 3549.917252882524, 6465.464543474964, 6465.464543474964, 4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19647781004236683, "mean_inference_ms": 1.1657388150990302, "mean_action_processing_ms": 0.1272788872339868, "mean_env_wait_ms": 3.362560151349977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 496000, "timesteps_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"sample_time_ms": 4856.677, "sample_throughput": 1647.217, "load_time_ms": 0.13, "load_throughput": 61749046.743, "learn_time_ms": 897.582, "learn_throughput": 8912.838, "update_time_ms": 1.512}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 371099.925, "policy_loss": -0.0008947549429734636, "vf_loss": 371099.95, "vf_explained_var": -2.4700164794921874e-05, "kl": 0.010763009358477757, "entropy": 3.7308792591094972, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 496000, "num_agent_steps_sampled": 992000, "num_steps_trained": 496000, "num_agent_steps_trained": 992000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 620, "training_iteration": 62, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-37", "timestamp": 1718802577, "time_this_iter_s": 4.815762281417847, "time_total_s": 323.7456843852997, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 323.7456843852997, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 53.185714285714276, "ram_util_percent": 36.01428571428571}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 2000.0, "episode_reward_mean": 10195.50690585677, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1000.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5097.753452928387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9983.518344060169, 9993.3126898927, 11068.255614461152, 17045.361625486912, 10260.934987533248, 7460.265200763053, 3797.9885075488137, 8422.754814282416, 13620.609408028886, 6712.012189046658, 8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4991.75917203008, 4991.75917203008, 4996.656344946352, 4996.656344946352, 5534.127807230568, 5534.127807230568, 8522.680812743463, 8522.680812743463, 5130.467493766636, 5130.467493766636, 3730.1326003815266, 3730.1326003815266, 1898.9942537744068, 1898.9942537744068, 4211.377407141212, 4211.377407141212, 6810.304704014456, 6810.304704014456, 3356.006094523329, 3356.006094523329, 4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19642494166305685, "mean_inference_ms": 1.1655369969186915, "mean_action_processing_ms": 0.12725690833794576, "mean_env_wait_ms": 3.3623950133962195, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 504000, "timesteps_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"sample_time_ms": 4869.918, "sample_throughput": 1642.738, "load_time_ms": 0.132, "load_throughput": 60666121.859, "learn_time_ms": 898.126, "learn_throughput": 8907.438, "update_time_ms": 1.513}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 375291.30625, "policy_loss": 5.0361627224049244e-05, "vf_loss": 375291.325, "vf_explained_var": -3.478527069091797e-05, "kl": 0.013848526776106578, "entropy": 3.088574934005737, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 504000, "num_agent_steps_sampled": 1008000, "num_steps_trained": 504000, "num_agent_steps_trained": 1008000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 630, "training_iteration": 63, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-42", "timestamp": 1718802582, "time_this_iter_s": 4.91779637336731, "time_total_s": 328.663480758667, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a59fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 328.663480758667, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 54.51428571428573, "ram_util_percent": 36.05714285714286}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 1600.0, "episode_reward_mean": 10047.669810982678, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5023.834905491341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8263.071491600458, 5881.054829813409, 7880.259006565357, 15377.338344265972, 8693.97231516772, 14500.52025924894, 6955.099358568485, 9861.68784220736, 6971.279866132267, 10541.321823141352, 8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4131.535745800227, 4131.535745800227, 2940.5274149067045, 2940.5274149067045, 3940.1295032826783, 3940.1295032826783, 7688.669172132995, 7688.669172132995, 4346.986157583861, 4346.986157583861, 7250.2601296244775, 7250.2601296244775, 3477.5496792842423, 3477.5496792842423, 4930.843921103676, 4930.843921103676, 3485.6399330661334, 3485.6399330661334, 5270.660911570663, 5270.660911570663, 4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19638602182763237, "mean_inference_ms": 1.1653603666371501, "mean_action_processing_ms": 0.12723658178019645, "mean_env_wait_ms": 3.3622606087070364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 512000, "timesteps_this_iter": 0, "agent_timesteps_total": 1024000, "timers": {"sample_time_ms": 4874.066, "sample_throughput": 1641.34, "load_time_ms": 0.134, "load_throughput": 59514778.29, "learn_time_ms": 903.558, "learn_throughput": 8853.891, "update_time_ms": 1.531}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 267337.35625, "policy_loss": -0.0015001013071739067, "vf_loss": 267337.38125, "vf_explained_var": 8.035898208618164e-05, "kl": 0.008633988723500054, "entropy": 3.0257452487945558, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 512000, "num_agent_steps_sampled": 1024000, "num_steps_trained": 512000, "num_agent_steps_trained": 1024000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 64, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-47", "timestamp": 1718802587, "time_this_iter_s": 4.885547399520874, "time_total_s": 333.54902815818787, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f94c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 333.54902815818787, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 54.028571428571425, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 1600.0, "episode_reward_mean": 10261.58959616478, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5130.794798082392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8312.422289406237, 13054.714867792463, 6891.501681373895, 6181.070793632152, 8826.792317430612, 11066.86314503337, 9731.498128866915, 13086.092919790306, 13258.552194792184, 5787.589977251491, 11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4156.211144703116, 4156.211144703116, 6527.357433896219, 6527.357433896219, 3445.7508406869474, 3445.7508406869474, 3090.535396816076, 3090.535396816076, 4413.396158715311, 4413.396158715311, 5533.431572516685, 5533.431572516685, 4865.749064433462, 4865.749064433462, 6543.046459895144, 6543.046459895144, 6629.276097396094, 6629.276097396094, 2893.7949886257456, 2893.7949886257456, 5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1963506044280579, "mean_inference_ms": 1.1652067184953179, "mean_action_processing_ms": 0.12721632897361795, "mean_env_wait_ms": 3.362263167391788, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 1040000, "timers": {"sample_time_ms": 4887.511, "sample_throughput": 1636.825, "load_time_ms": 0.134, "load_throughput": 59822485.291, "learn_time_ms": 905.395, "learn_throughput": 8835.92, "update_time_ms": 1.523}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 422330.95625, "policy_loss": -0.0007530595138675267, "vf_loss": 422330.99375, "vf_explained_var": -0.0001493692398071289, "kl": 0.010737485904583085, "entropy": 3.2773488044738768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 1040000, "num_steps_trained": 520000, "num_agent_steps_trained": 1040000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 650, "training_iteration": 65, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-52", "timestamp": 1718802592, "time_this_iter_s": 4.964724779129028, "time_total_s": 338.5137529373169, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 338.5137529373169, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.64285714285715, "ram_util_percent": 36.1}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 1600.0, "episode_reward_mean": 10325.649747318645, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5162.824873659323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11736.1130539361, 15205.059142641316, 6699.6568506184485, 12334.91240329561, 13240.44480128105, 5463.617483404272, 10515.760370299551, 8583.303085680393, 8149.630165952338, 10203.137964380963, 6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5868.056526968045, 5868.056526968045, 7602.529571320654, 7602.529571320654, 3349.8284253092243, 3349.8284253092243, 6167.4562016478085, 6167.4562016478085, 6620.22240064053, 6620.22240064053, 2731.808741702136, 2731.808741702136, 5257.880185149777, 5257.880185149777, 4291.651542840198, 4291.651542840198, 4074.815082976169, 4074.815082976169, 5101.56898219048, 5101.56898219048, 3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19631754313473965, "mean_inference_ms": 1.1650604392067934, "mean_action_processing_ms": 0.1271973127607953, "mean_env_wait_ms": 3.3621611344168243, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 528000, "timesteps_this_iter": 0, "agent_timesteps_total": 1056000, "timers": {"sample_time_ms": 4883.734, "sample_throughput": 1638.091, "load_time_ms": 0.132, "load_throughput": 60776004.347, "learn_time_ms": 904.946, "learn_throughput": 8840.308, "update_time_ms": 1.516}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 373460.575, "policy_loss": 0.0005084068423833798, "vf_loss": 373460.59375, "vf_explained_var": 7.390975952148438e-07, "kl": 0.011985435616561914, "entropy": 3.466150331497192, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 528000, "num_agent_steps_sampled": 1056000, "num_steps_trained": 528000, "num_agent_steps_trained": 1056000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 660, "training_iteration": 66, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-09-57", "timestamp": 1718802597, "time_this_iter_s": 4.774142026901245, "time_total_s": 343.28789496421814, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9700>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 343.28789496421814, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 53.68571428571429, "ram_util_percent": 36.1}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 1600.0, "episode_reward_mean": 10539.536519583778, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5269.76825979189}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6145.87233712315, 8894.88617548674, 9665.985558706154, 8053.693043446208, 10165.793110534207, 11190.243944882724, 8413.731730075742, 15792.696074880045, 13927.737564106767, 7292.229239410597, 12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3072.936168561575, 3072.936168561575, 4447.443087743369, 4447.443087743369, 4832.992779353058, 4832.992779353058, 4026.846521723104, 4026.846521723104, 5082.896555267112, 5082.896555267112, 5595.121972441364, 5595.121972441364, 4206.865865037871, 4206.865865037871, 7896.348037440022, 7896.348037440022, 6963.8687820534, 6963.8687820534, 3646.1146197052985, 3646.1146197052985, 6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1962863814821279, "mean_inference_ms": 1.164913561442466, "mean_action_processing_ms": 0.12717746394701404, "mean_env_wait_ms": 3.362001993982123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 536000, "timesteps_this_iter": 0, "agent_timesteps_total": 1072000, "timers": {"sample_time_ms": 4879.289, "sample_throughput": 1639.583, "load_time_ms": 0.137, "load_throughput": 58447016.199, "learn_time_ms": 904.542, "learn_throughput": 8844.252, "update_time_ms": 1.506}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 492235.71875, "policy_loss": 0.00013155304659164812, "vf_loss": 492235.75625, "vf_explained_var": 2.4902820587158204e-05, "kl": 0.010207861941604673, "entropy": 3.3757708072662354, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 536000, "num_agent_steps_sampled": 1072000, "num_steps_trained": 536000, "num_agent_steps_trained": 1072000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 670, "training_iteration": 67, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-02", "timestamp": 1718802602, "time_this_iter_s": 4.821950435638428, "time_total_s": 348.10984539985657, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f90d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 348.10984539985657, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 61.25, "ram_util_percent": 36.03333333333333}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 1000.0, "episode_reward_mean": 10513.326326510874, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5256.663163255437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12049.089454912744, 12470.972519950938, 13052.567741171111, 10726.432484370373, 11995.562316019626, 9173.097530974064, 15075.333846094894, 11675.789709969453, 12080.817649550496, 10363.060481048593, 4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6024.5447274563685, 6024.5447274563685, 6235.486259975469, 6235.486259975469, 6526.283870585556, 6526.283870585556, 5363.216242185179, 5363.216242185179, 5997.78115800981, 5997.78115800981, 4586.548765487032, 4586.548765487032, 7537.666923047462, 7537.666923047462, 5837.894854984737, 5837.894854984737, 6040.408824775252, 6040.408824775252, 5181.530240524299, 5181.530240524299, 2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19624669032927344, "mean_inference_ms": 1.1647288415680805, "mean_action_processing_ms": 0.1271541814892042, "mean_env_wait_ms": 3.3616968760096864, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 544000, "timesteps_this_iter": 0, "agent_timesteps_total": 1088000, "timers": {"sample_time_ms": 4863.615, "sample_throughput": 1644.867, "load_time_ms": 0.138, "load_throughput": 57862445.249, "learn_time_ms": 904.838, "learn_throughput": 8841.358, "update_time_ms": 1.505}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 327560.65, "policy_loss": -0.0009788861978798913, "vf_loss": 327560.69375, "vf_explained_var": 5.984306335449219e-06, "kl": 0.008580683684267357, "entropy": 3.2822242259979246, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 544000, "num_agent_steps_sampled": 1088000, "num_steps_trained": 544000, "num_agent_steps_trained": 1088000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 680, "training_iteration": 68, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-07", "timestamp": 1718802607, "time_this_iter_s": 4.832162380218506, "time_total_s": 352.9420077800751, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 352.9420077800751, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 53.87142857142857, "ram_util_percent": 36.05714285714286}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 1000.0, "episode_reward_mean": 10369.89312351737, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5184.946561758686}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4800.0, 12379.108497554695, 7043.108788293517, 7529.852699738392, 12227.354649173649, 8272.585966540824, 8003.798075005598, 2000.0, 11701.081725301992, 2400.0, 4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2400.0, 2400.0, 6189.554248777351, 6189.554248777351, 3521.5543941467586, 3521.5543941467586, 3764.926349869196, 3764.926349869196, 6113.677324586833, 6113.677324586833, 4136.292983270409, 4136.292983270409, 4001.899037502799, 4001.899037502799, 1000.0, 1000.0, 5850.540862651007, 5850.540862651007, 1200.0, 1200.0, 2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19620480366684184, "mean_inference_ms": 1.164541150449568, "mean_action_processing_ms": 0.12713036228086527, "mean_env_wait_ms": 3.3613810908895205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 552000, "timesteps_this_iter": 0, "agent_timesteps_total": 1104000, "timers": {"sample_time_ms": 4860.833, "sample_throughput": 1645.808, "load_time_ms": 0.144, "load_throughput": 55526116.167, "learn_time_ms": 905.873, "learn_throughput": 8831.264, "update_time_ms": 1.5}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 368878.58125, "policy_loss": 0.0006456264380364729, "vf_loss": 368878.61875, "vf_explained_var": -0.00010118484497070312, "kl": 0.012015246972871738, "entropy": 3.163523626327515, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 552000, "num_agent_steps_sampled": 1104000, "num_steps_trained": 552000, "num_agent_steps_trained": 1104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 690, "training_iteration": 69, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-12", "timestamp": 1718802612, "time_this_iter_s": 4.825198650360107, "time_total_s": 357.7672064304352, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f91f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 357.7672064304352, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 54.07142857142857, "ram_util_percent": 36.1}}
{"episode_reward_max": 18319.55664593701, "episode_reward_min": 1000.0, "episode_reward_mean": 10663.525300039724, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 9159.778322968537}, "policy_reward_mean": {"shared_policy": 5331.762650019863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4400.0, 11381.05158715665, 9961.611684778585, 14277.284348096335, 9647.342967044118, 13176.444563023786, 18319.55664593701, 10854.241341312798, 13949.137397269336, 12259.148902363875, 12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2200.0, 2200.0, 5690.525793578327, 5690.525793578327, 4980.805842389282, 4980.805842389282, 7138.642174048178, 7138.642174048178, 4823.671483522058, 4823.671483522058, 6588.222281511908, 6588.222281511908, 9159.778322968537, 9159.778322968537, 5427.120670656415, 5427.120670656415, 6974.568698634668, 6974.568698634668, 6129.574451181934, 6129.574451181934, 6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1961727560514516, "mean_inference_ms": 1.1643838684615124, "mean_action_processing_ms": 0.12710996590688103, "mean_env_wait_ms": 3.3612653952961837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 1120000, "timers": {"sample_time_ms": 4872.256, "sample_throughput": 1641.95, "load_time_ms": 0.143, "load_throughput": 56120474.996, "learn_time_ms": 904.349, "learn_throughput": 8846.145, "update_time_ms": 1.497}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 356012.4, "policy_loss": -0.0008970564899037469, "vf_loss": 356012.425, "vf_explained_var": -6.494522094726562e-05, "kl": 0.010568077303865083, "entropy": 3.3865194797515867, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 1120000, "num_steps_trained": 560000, "num_agent_steps_trained": 1120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 700, "training_iteration": 70, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-17", "timestamp": 1718802617, "time_this_iter_s": 4.903064489364624, "time_total_s": 362.6702709197998, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 362.6702709197998, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 54.042857142857144, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 18150.336419144296, "episode_reward_min": 1000.0, "episode_reward_mean": 10591.964044119188, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 9075.16820957215}, "policy_reward_mean": {"shared_policy": 5295.982022059592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12470.864455480198, 11812.026266016495, 8587.437456122887, 12033.280415476263, 3568.210946912761, 12699.527673154174, 8530.426897103363, 12221.557419915334, 13121.846602820318, 13072.422623509734, 12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6235.432227740088, 6235.432227740088, 5906.013133008236, 5906.013133008236, 4293.718728061444, 4293.718728061444, 6016.640207738137, 6016.640207738137, 1784.1054734563804, 1784.1054734563804, 6349.763836577076, 6349.763836577076, 4265.213448551682, 4265.213448551682, 6110.778709957674, 6110.778709957674, 6560.923301410159, 6560.923301410159, 6536.211311754872, 6536.211311754872, 6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19614898324949143, "mean_inference_ms": 1.1642524174990518, "mean_action_processing_ms": 0.12709288829673845, "mean_env_wait_ms": 3.361212214964366, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 568000, "timesteps_this_iter": 0, "agent_timesteps_total": 1136000, "timers": {"sample_time_ms": 4878.977, "sample_throughput": 1639.688, "load_time_ms": 0.143, "load_throughput": 56120474.996, "learn_time_ms": 902.786, "learn_throughput": 8861.462, "update_time_ms": 1.483}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 414185.40625, "policy_loss": -0.0006388196244021316, "vf_loss": 414185.43125, "vf_explained_var": -7.37905502319336e-05, "kl": 0.011198610067657273, "entropy": 3.6786000728607178, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 568000, "num_agent_steps_sampled": 1136000, "num_steps_trained": 568000, "num_agent_steps_trained": 1136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 710, "training_iteration": 71, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-21", "timestamp": 1718802621, "time_this_iter_s": 4.889483690261841, "time_total_s": 367.55975461006165, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fad30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 367.55975461006165, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 54.8, "ram_util_percent": 36.05714285714286}}
{"episode_reward_max": 18150.336419144296, "episode_reward_min": 1000.0, "episode_reward_mean": 10619.951595428307, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 9075.16820957215}, "policy_reward_mean": {"shared_policy": 5309.9757977141535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12986.951239628808, 12554.109754991372, 15094.286866774379, 11386.563778727996, 10822.205263563668, 12723.286763352342, 4585.443609278365, 4715.498847543451, 10646.600454569947, 11510.488744754439, 4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6493.47561981439, 6493.47561981439, 6277.054877495684, 6277.054877495684, 7547.143433387195, 7547.143433387195, 5693.281889364009, 5693.281889364009, 5411.102631781835, 5411.102631781835, 6361.643381676171, 6361.643381676171, 2292.7218046391827, 2292.7218046391827, 2357.7494237717256, 2357.7494237717256, 5323.300227284968, 5323.300227284968, 5755.244372377224, 5755.244372377224, 2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19613187302296012, "mean_inference_ms": 1.1641588661572868, "mean_action_processing_ms": 0.12708112625010953, "mean_env_wait_ms": 3.361285611071022, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 576000, "timesteps_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"sample_time_ms": 4882.057, "sample_throughput": 1638.654, "load_time_ms": 0.143, "load_throughput": 56129862.83, "learn_time_ms": 900.03, "learn_throughput": 8888.59, "update_time_ms": 1.491}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 396575.04375, "policy_loss": 2.7589892874857468e-05, "vf_loss": 396575.06875, "vf_explained_var": 3.809928894042969e-05, "kl": 0.010917886719387891, "entropy": 3.1953821182250977, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 576000, "num_agent_steps_sampled": 1152000, "num_steps_trained": 576000, "num_agent_steps_trained": 1152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 72, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-26", "timestamp": 1718802626, "time_this_iter_s": 4.832611322402954, "time_total_s": 372.3923659324646, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fd30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 372.3923659324646, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 54.5, "ram_util_percent": 36.1}}
{"episode_reward_max": 18150.336419144296, "episode_reward_min": 1000.0, "episode_reward_mean": 10429.348152677216, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 500.0}, "policy_reward_max": {"shared_policy": 9075.16820957215}, "policy_reward_mean": {"shared_policy": 5214.674076338607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4191.619965603395, 1600.0, 5800.0, 4161.951894197184, 10960.912570114539, 8648.103795912328, 13547.562727983033, 10948.714826167052, 16139.497577159975, 7582.940536557318, 11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2095.809982801698, 2095.809982801698, 800.0, 800.0, 2900.0, 2900.0, 2080.975947098593, 2080.975947098593, 5480.456285057267, 5480.456285057267, 4324.051897956162, 4324.051897956162, 6773.781363991526, 6773.781363991526, 5474.357413083541, 5474.357413083541, 8069.748788579982, 8069.748788579982, 3791.470268278659, 3791.470268278659, 5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1961204505008569, "mean_inference_ms": 1.1640804262902338, "mean_action_processing_ms": 0.1270711542132635, "mean_env_wait_ms": 3.3612516600019986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 584000, "timesteps_this_iter": 0, "agent_timesteps_total": 1168000, "timers": {"sample_time_ms": 4868.522, "sample_throughput": 1643.209, "load_time_ms": 0.141, "load_throughput": 56804523.447, "learn_time_ms": 899.417, "learn_throughput": 8894.65, "update_time_ms": 1.499}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 274139.61875, "policy_loss": -0.0008754663669506612, "vf_loss": 274139.66875, "vf_explained_var": 4.030466079711914e-05, "kl": 0.016733716055973322, "entropy": 3.7018618106842043, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 584000, "num_agent_steps_sampled": 1168000, "num_steps_trained": 584000, "num_agent_steps_trained": 1168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 730, "training_iteration": 73, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-31", "timestamp": 1718802631, "time_this_iter_s": 4.806556701660156, "time_total_s": 377.19892263412476, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9a60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 377.19892263412476, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 54.14285714285713, "ram_util_percent": 36.0}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10641.739074710958, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5320.869537355478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11745.445726588037, 11164.82903931562, 9741.23434631719, 14109.513529082462, 12069.846896897656, 15351.245480628513, 6711.8848408857775, 11779.807960911552, 10717.843046336711, 12925.932787957976, 10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5872.722863294013, 5872.722863294013, 5582.414519657809, 5582.414519657809, 4870.6171731586, 4870.6171731586, 7054.756764541224, 7054.756764541224, 6034.923448448831, 6034.923448448831, 7675.622740314255, 7675.622740314255, 3355.9424204428888, 3355.9424204428888, 5889.903980455771, 5889.903980455771, 5358.921523168351, 5358.921523168351, 6462.966393978984, 6462.966393978984, 5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19609857720900176, "mean_inference_ms": 1.163992813186356, "mean_action_processing_ms": 0.127061497279385, "mean_env_wait_ms": 3.3612118440551733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 592000, "timesteps_this_iter": 0, "agent_timesteps_total": 1184000, "timers": {"sample_time_ms": 4867.212, "sample_throughput": 1643.651, "load_time_ms": 0.139, "load_throughput": 57683396.94, "learn_time_ms": 893.478, "learn_throughput": 8953.778, "update_time_ms": 1.476}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 392288.36875, "policy_loss": -0.0011727860843762984, "vf_loss": 392288.39375, "vf_explained_var": 8.754730224609375e-05, "kl": 0.009722098894904706, "entropy": 3.2930569648742676, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 592000, "num_agent_steps_sampled": 1184000, "num_steps_trained": 592000, "num_agent_steps_trained": 1184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 740, "training_iteration": 74, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-36", "timestamp": 1718802636, "time_this_iter_s": 4.822305917739868, "time_total_s": 382.0212285518646, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fad30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 382.0212285518646, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 54.07142857142857, "ram_util_percent": 36.01428571428571}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10515.727201042588, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5257.863600521295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10296.499959309935, 13814.242681137388, 8489.29323898907, 12598.649574276133, 3792.2464244023404, 13345.03206266107, 8003.257207102395, 12712.201349679039, 9516.624464323464, 10035.066468875288, 16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5148.249979654976, 5148.249979654976, 6907.1213405686885, 6907.1213405686885, 4244.646619494535, 4244.646619494535, 6299.324787138068, 6299.324787138068, 1896.1232122011702, 1896.1232122011702, 6672.516031330537, 6672.516031330537, 4001.6286035511976, 4001.6286035511976, 6356.10067483951, 6356.10067483951, 4758.312232161732, 4758.312232161732, 5017.533234437643, 5017.533234437643, 8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19606856252856977, "mean_inference_ms": 1.163865443349716, "mean_action_processing_ms": 0.12704726318134557, "mean_env_wait_ms": 3.3609989885857345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 4852.315, "sample_throughput": 1648.698, "load_time_ms": 0.139, "load_throughput": 57713161.335, "learn_time_ms": 893.095, "learn_throughput": 8957.615, "update_time_ms": 1.468}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 338788.6875, "policy_loss": 0.0003536632359029568, "vf_loss": 338788.71875, "vf_explained_var": 2.0265579223632812e-05, "kl": 0.018166759424226214, "entropy": 3.2424002647399903, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 600000, "num_agent_steps_trained": 1200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 750, "training_iteration": 75, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-41", "timestamp": 1718802641, "time_this_iter_s": 4.870180368423462, "time_total_s": 386.8914089202881, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49b1f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 386.8914089202881, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.05714285714286, "ram_util_percent": 36.028571428571425}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10454.41632665299, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5227.208163326494}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16035.909525060997, 6629.25521758234, 17375.882588497014, 6741.539598974305, 9978.826043914498, 14290.912178201219, 7396.215389348297, 16726.496627770422, 14485.0998874051, 13860.175491249192, 10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [8017.954762530513, 8017.954762530513, 3314.62760879117, 3314.62760879117, 8687.941294248503, 8687.941294248503, 3370.7697994871523, 3370.7697994871523, 4989.413021957244, 4989.413021957244, 7145.456089100608, 7145.456089100608, 3698.1076946741487, 3698.1076946741487, 8363.248313885217, 8363.248313885217, 7242.549943702548, 7242.549943702548, 6930.087745624598, 6930.087745624598, 5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1960391031624809, "mean_inference_ms": 1.163728455358346, "mean_action_processing_ms": 0.12703112408618733, "mean_env_wait_ms": 3.3607772863026497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 608000, "timesteps_this_iter": 0, "agent_timesteps_total": 1216000, "timers": {"sample_time_ms": 4860.691, "sample_throughput": 1645.857, "load_time_ms": 0.14, "load_throughput": 57045957.157, "learn_time_ms": 894.076, "learn_throughput": 8947.789, "update_time_ms": 1.456}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 335636.49375, "policy_loss": 0.0008335429114282533, "vf_loss": 335636.5125, "vf_explained_var": 0.00011025667190551758, "kl": 0.015766123496276103, "entropy": 3.02687029838562, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 608000, "num_agent_steps_sampled": 1216000, "num_steps_trained": 608000, "num_agent_steps_trained": 1216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 760, "training_iteration": 76, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-46", "timestamp": 1718802646, "time_this_iter_s": 4.872994899749756, "time_total_s": 391.76440382003784, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 391.76440382003784, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 53.199999999999996, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10118.258782227856, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5059.129391113927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10634.026574134008, 9476.045003653635, 7790.200465614827, 1000.0, 16622.32113079987, 11337.783786998429, 11791.991492776735, 6571.963432336979, 11593.866633698784, 10103.650951348394, 11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5317.0132870670095, 5317.0132870670095, 4738.02250182681, 4738.02250182681, 3895.1002328074137, 3895.1002328074137, 500.0, 500.0, 8311.160565399929, 8311.160565399929, 5668.891893499216, 5668.891893499216, 5895.995746388364, 5895.995746388364, 3285.9817161684887, 3285.9817161684887, 5796.933316849385, 5796.933316849385, 5051.825475674196, 5051.825475674196, 5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19605779597267536, "mean_inference_ms": 1.163910745209619, "mean_action_processing_ms": 0.12704647194565324, "mean_env_wait_ms": 3.3615666073930055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 616000, "timesteps_this_iter": 0, "agent_timesteps_total": 1232000, "timers": {"sample_time_ms": 4945.011, "sample_throughput": 1617.792, "load_time_ms": 0.136, "load_throughput": 58970882.25, "learn_time_ms": 897.342, "learn_throughput": 8915.215, "update_time_ms": 1.452}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 282973.44375, "policy_loss": 0.0012909959048963415, "vf_loss": 282973.48125, "vf_explained_var": 5.0067901611328125e-05, "kl": 0.018746644072600207, "entropy": 3.2656723976135256, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 616000, "num_agent_steps_sampled": 1232000, "num_steps_trained": 616000, "num_agent_steps_trained": 1232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 770, "training_iteration": 77, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-51", "timestamp": 1718802651, "time_this_iter_s": 5.685252904891968, "time_total_s": 397.4496567249298, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 397.4496567249298, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 57.2125, "ram_util_percent": 36.025}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10262.638950715404, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5131.319475357703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11391.566017109519, 11264.337588222887, 12836.741804599613, 10832.513244460246, 3200.0, 8946.070843780228, 7841.129021854364, 13402.353805145147, 9414.77674252632, 15189.914367013724, 10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5695.783008554763, 5695.783008554763, 5632.16879411144, 5632.16879411144, 6418.3709022998155, 6418.3709022998155, 5416.256622230121, 5416.256622230121, 1600.0, 1600.0, 4473.0354218901175, 4473.0354218901175, 3920.564510927182, 3920.564510927182, 6701.176902572579, 6701.176902572579, 4707.388371263161, 4707.388371263161, 7594.95718350686, 7594.95718350686, 5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19610643744262493, "mean_inference_ms": 1.1642362221471407, "mean_action_processing_ms": 0.12707970390786405, "mean_env_wait_ms": 3.362941169383746, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 624000, "timesteps_this_iter": 0, "agent_timesteps_total": 1248000, "timers": {"sample_time_ms": 4997.785, "sample_throughput": 1600.709, "load_time_ms": 0.135, "load_throughput": 59346360.099, "learn_time_ms": 899.981, "learn_throughput": 8889.081, "update_time_ms": 1.461}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 382281.4625, "policy_loss": 0.00019143113289032954, "vf_loss": 382281.525, "vf_explained_var": 1.5079975128173828e-05, "kl": 0.011572299897929307, "entropy": 3.460729789733887, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 624000, "num_agent_steps_sampled": 1248000, "num_steps_trained": 624000, "num_agent_steps_trained": 1248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 780, "training_iteration": 78, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-10-57", "timestamp": 1718802657, "time_this_iter_s": 5.3540122509002686, "time_total_s": 402.8036689758301, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 402.8036689758301, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 53.2625, "ram_util_percent": 36.0125}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10324.628779069884, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5162.314389534942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10783.860965554028, 10549.674753515668, 8806.527255978355, 11812.832617480388, 6946.5688697992355, 18150.336419144296, 9735.949815587515, 10810.319294700905, 11361.61289326048, 6762.425168823216, 8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5391.9304827770175, 5391.9304827770175, 5274.837376757827, 5274.837376757827, 4403.263627989183, 4403.263627989183, 5906.416308740202, 5906.416308740202, 3473.2844348996177, 3473.2844348996177, 9075.16820957215, 9075.16820957215, 4867.974907793761, 4867.974907793761, 5405.159647350459, 5405.159647350459, 5680.806446630229, 5680.806446630229, 3381.212584411608, 3381.212584411608, 4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19617405804450638, "mean_inference_ms": 1.1646739247461848, "mean_action_processing_ms": 0.12712590380860664, "mean_env_wait_ms": 3.3647036481356567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 632000, "timesteps_this_iter": 0, "agent_timesteps_total": 1264000, "timers": {"sample_time_ms": 5035.284, "sample_throughput": 1588.788, "load_time_ms": 0.131, "load_throughput": 61030251.0, "learn_time_ms": 904.061, "learn_throughput": 8848.965, "update_time_ms": 1.539}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 369931.875, "policy_loss": 0.0018153667554258845, "vf_loss": 369931.9, "vf_explained_var": 8.096694946289063e-05, "kl": 0.017440188490220186, "entropy": 3.4555495738983155, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 632000, "num_agent_steps_sampled": 1264000, "num_steps_trained": 632000, "num_agent_steps_trained": 1264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 790, "training_iteration": 79, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-02", "timestamp": 1718802662, "time_this_iter_s": 5.214201927185059, "time_total_s": 408.01787090301514, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 408.01787090301514, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 57.385714285714286, "ram_util_percent": 36.1}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10224.366131482047, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5112.183065741023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8812.474520875461, 7661.4569982521225, 13627.632838314203, 15835.440575531742, 17378.17919286678, 9734.61585314737, 9754.686459971246, 12106.040700421603, 10208.57201807525, 5950.594687473022, 8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4406.237260437729, 4406.237260437729, 3830.7284991260613, 3830.7284991260613, 6813.816419157118, 6813.816419157118, 7917.720287765871, 7917.720287765871, 8689.089596433387, 8689.089596433387, 4867.307926573671, 4867.307926573671, 4877.343229985621, 4877.343229985621, 6053.020350210812, 6053.020350210812, 5104.286009037617, 5104.286009037617, 2975.297343736511, 2975.297343736511, 4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19624440871130588, "mean_inference_ms": 1.1651050886355068, "mean_action_processing_ms": 0.12717177509466313, "mean_env_wait_ms": 3.3663360339055135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 1280000, "timers": {"sample_time_ms": 5030.03, "sample_throughput": 1590.448, "load_time_ms": 0.132, "load_throughput": 60469331.411, "learn_time_ms": 905.239, "learn_throughput": 8837.445, "update_time_ms": 1.541}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 285038.36875, "policy_loss": -0.0003835787958934134, "vf_loss": 285038.39375, "vf_explained_var": -9.198188781738282e-05, "kl": 0.01090122610373838, "entropy": 3.478073072433472, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 1280000, "num_steps_trained": 640000, "num_agent_steps_trained": 1280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 800, "training_iteration": 80, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-07", "timestamp": 1718802667, "time_this_iter_s": 4.814188480377197, "time_total_s": 412.83205938339233, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 412.83205938339233, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 54.21428571428572, "ram_util_percent": 35.9}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10174.373497078352, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5087.186748539177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8711.460978961652, 8650.119721255447, 16265.347591534515, 13358.257919403499, 4776.374045566474, 15177.104197101813, 14114.469427683354, 10576.489581397927, 6950.77083432968, 12335.961590188988, 3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4355.730489480826, 4355.730489480826, 4325.059860627723, 4325.059860627723, 8132.673795767259, 8132.673795767259, 6679.128959701751, 6679.128959701751, 2388.187022783237, 2388.187022783237, 7588.552098550896, 7588.552098550896, 7057.234713841677, 7057.234713841677, 5288.244790698962, 5288.244790698962, 3475.38541716484, 3475.38541716484, 6167.980795094476, 6167.980795094476, 1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19631465451506883, "mean_inference_ms": 1.1655167329249119, "mean_action_processing_ms": 0.12721498068833148, "mean_env_wait_ms": 3.3678776044430623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 648000, "timesteps_this_iter": 0, "agent_timesteps_total": 1296000, "timers": {"sample_time_ms": 5032.728, "sample_throughput": 1589.595, "load_time_ms": 0.133, "load_throughput": 60338845.531, "learn_time_ms": 901.761, "learn_throughput": 8871.535, "update_time_ms": 1.533}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 344008.95625, "policy_loss": 0.0009843964405359174, "vf_loss": 344008.975, "vf_explained_var": -3.225803375244141e-05, "kl": 0.014541810378924134, "entropy": 3.7523467540740967, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 648000, "num_agent_steps_sampled": 1296000, "num_steps_trained": 648000, "num_agent_steps_trained": 1296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 810, "training_iteration": 81, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-12", "timestamp": 1718802672, "time_this_iter_s": 4.865639925003052, "time_total_s": 417.6976993083954, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9670>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 417.6976993083954, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 53.771428571428565, "ram_util_percent": 36.01428571428571}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10168.340612456414, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5084.170306228207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3400.0, 8036.96701952761, 10399.177752161246, 7305.406916720309, 13282.187986138888, 1600.0, 10354.24204383709, 14540.20700379575, 7136.140964848106, 11910.76136104677, 14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [1700.0, 1700.0, 4018.483509763805, 4018.483509763805, 5199.58887608063, 5199.58887608063, 3652.7034583601544, 3652.7034583601544, 6641.093993069433, 6641.093993069433, 800.0, 800.0, 5177.121021918548, 5177.121021918548, 7270.103501897869, 7270.103501897869, 3568.070482424053, 3568.070482424053, 5955.380680523391, 5955.380680523391, 7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19638555886468706, "mean_inference_ms": 1.165921487150397, "mean_action_processing_ms": 0.12725692490651522, "mean_env_wait_ms": 3.3693501027476356, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 656000, "timesteps_this_iter": 0, "agent_timesteps_total": 1312000, "timers": {"sample_time_ms": 5030.047, "sample_throughput": 1590.442, "load_time_ms": 0.132, "load_throughput": 60393146.148, "learn_time_ms": 904.033, "learn_throughput": 8849.232, "update_time_ms": 1.535}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 386006.85, "policy_loss": 0.0004795691235585764, "vf_loss": 386006.875, "vf_explained_var": -3.9076805114746095e-05, "kl": 0.011369621009003444, "entropy": 3.8087604522705076, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 656000, "num_agent_steps_sampled": 1312000, "num_steps_trained": 656000, "num_agent_steps_trained": 1312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 820, "training_iteration": 82, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-17", "timestamp": 1718802677, "time_this_iter_s": 4.862529039382935, "time_total_s": 422.5602283477783, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 422.5602283477783, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 53.957142857142856, "ram_util_percent": 36.0}}
{"episode_reward_max": 19749.967963544143, "episode_reward_min": 0.0, "episode_reward_mean": 10376.565437410609, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 0.0}, "policy_reward_max": {"shared_policy": 9874.983981772064}, "policy_reward_mean": {"shared_policy": 5188.282718705305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14171.770760492738, 7795.329492080011, 6415.767822489834, 15009.173706313482, 8600.958267877195, 19749.967963544143, 10173.398746843963, 14474.952298232387, 8429.077039195345, 0.0, 10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7085.885380246375, 7085.885380246375, 3897.6647460400054, 3897.6647460400054, 3207.883911244917, 3207.883911244917, 7504.586853156732, 7504.586853156732, 4300.479133938594, 4300.479133938594, 9874.983981772064, 9874.983981772064, 5086.699373421983, 5086.699373421983, 7237.476149116201, 7237.476149116201, 4214.538519597675, 4214.538519597675, 0.0, 0.0, 5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19645475067082951, "mean_inference_ms": 1.1663050044033119, "mean_action_processing_ms": 0.12729666247399896, "mean_env_wait_ms": 3.3707783074564297, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 664000, "timesteps_this_iter": 0, "agent_timesteps_total": 1328000, "timers": {"sample_time_ms": 5026.734, "sample_throughput": 1591.491, "load_time_ms": 0.132, "load_throughput": 60567566.787, "learn_time_ms": 907.199, "learn_throughput": 8818.351, "update_time_ms": 1.514}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 375604.79375, "policy_loss": -0.00014789152005683092, "vf_loss": 375604.81875, "vf_explained_var": -5.929470062255859e-05, "kl": 0.013335360400666612, "entropy": 3.182894992828369, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 664000, "num_agent_steps_sampled": 1328000, "num_steps_trained": 664000, "num_agent_steps_trained": 1328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 830, "training_iteration": 83, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-21", "timestamp": 1718802681, "time_this_iter_s": 4.780553340911865, "time_total_s": 427.3407816886902, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 427.3407816886902, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 53.885714285714286, "ram_util_percent": 36.028571428571425}}
{"episode_reward_max": 18592.14908507042, "episode_reward_min": 1200.0, "episode_reward_mean": 10296.271828930794, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 600.0}, "policy_reward_max": {"shared_policy": 9296.074542535214}, "policy_reward_mean": {"shared_policy": 5148.135914465397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10115.142509584108, 5400.0, 7516.680290835719, 12764.343432105863, 14305.939005714928, 7617.468700769437, 15152.098303733957, 13261.90809811157, 5405.693058862353, 12177.122888366554, 8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5057.57125479207, 5057.57125479207, 2700.0, 2700.0, 3758.3401454178593, 3758.3401454178593, 6382.17171605293, 6382.17171605293, 7152.969502857466, 7152.969502857466, 3808.7343503847187, 3808.7343503847187, 7576.0491518669805, 7576.0491518669805, 6630.954049055774, 6630.954049055774, 2702.8465294311773, 2702.8465294311773, 6088.561444183279, 6088.561444183279, 4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19651721262253674, "mean_inference_ms": 1.166668688339206, "mean_action_processing_ms": 0.12733382434816096, "mean_env_wait_ms": 3.3722603016184056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 672000, "timesteps_this_iter": 0, "agent_timesteps_total": 1344000, "timers": {"sample_time_ms": 5031.696, "sample_throughput": 1589.921, "load_time_ms": 0.132, "load_throughput": 60589440.231, "learn_time_ms": 911.806, "learn_throughput": 8773.797, "update_time_ms": 1.504}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 278307.2125, "policy_loss": 0.0016452911677760085, "vf_loss": 278307.23125, "vf_explained_var": -4.024505615234375e-05, "kl": 0.013669287413695785, "entropy": 3.336945104598999, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 672000, "num_agent_steps_sampled": 1344000, "num_steps_trained": 672000, "num_agent_steps_trained": 1344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 840, "training_iteration": 84, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-26", "timestamp": 1718802686, "time_this_iter_s": 4.88599419593811, "time_total_s": 432.2267758846283, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9c10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 432.2267758846283, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 54.07142857142858, "ram_util_percent": 36.1}}
{"episode_reward_max": 18592.14908507042, "episode_reward_min": 1200.0, "episode_reward_mean": 10434.91691869893, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 600.0}, "policy_reward_max": {"shared_policy": 9296.074542535214}, "policy_reward_mean": {"shared_policy": 5217.458459349465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8668.69923180664, 9103.701521417242, 7879.47566403147, 13146.993241535678, 3400.0, 9439.5040239618, 1200.0, 12917.035855557944, 15525.049938409069, 15191.566515076305, 7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4334.349615903322, 4334.349615903322, 4551.850760708625, 4551.850760708625, 3939.737832015735, 3939.737832015735, 6573.496620767832, 6573.496620767832, 1700.0, 1700.0, 4719.752011980907, 4719.752011980907, 600.0, 600.0, 6458.517927778972, 6458.517927778972, 7762.524969204538, 7762.524969204538, 7595.783257538151, 7595.783257538151, 3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19658694113568148, "mean_inference_ms": 1.167039203977871, "mean_action_processing_ms": 0.12737207113718632, "mean_env_wait_ms": 3.3737546086848296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 1360000, "timers": {"sample_time_ms": 5041.699, "sample_throughput": 1586.767, "load_time_ms": 0.135, "load_throughput": 59419925.624, "learn_time_ms": 909.27, "learn_throughput": 8798.265, "update_time_ms": 1.49}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 420655.99375, "policy_loss": -0.0011247225113947934, "vf_loss": 420656.04375, "vf_explained_var": -8.089542388916016e-05, "kl": 0.012926883344047657, "entropy": 3.363214874267578, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 1360000, "num_steps_trained": 680000, "num_agent_steps_trained": 1360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 850, "training_iteration": 85, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-31", "timestamp": 1718802691, "time_this_iter_s": 4.899848461151123, "time_total_s": 437.1266243457794, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49b3a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 437.1266243457794, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 54.25714285714285, "ram_util_percent": 36.07142857142857}}
{"episode_reward_max": 19118.38563212441, "episode_reward_min": 2400.0, "episode_reward_mean": 10736.952672899668, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1200.0}, "policy_reward_max": {"shared_policy": 9559.19281606218}, "policy_reward_mean": {"shared_policy": 5368.476336449834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7042.971432379152, 2400.0, 6318.003677316017, 13260.845692956846, 4746.293216501883, 11223.039614518868, 8342.191708375074, 7065.887420763951, 18592.14908507042, 10913.176257607822, 12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3521.485716189576, 3521.485716189576, 1200.0, 1200.0, 3159.0018386580086, 3159.0018386580086, 6630.422846478423, 6630.422846478423, 2373.1466082509414, 2373.1466082509414, 5611.519807259424, 5611.519807259424, 4171.095854187535, 4171.095854187535, 3532.9437103819755, 3532.9437103819755, 9296.074542535214, 9296.074542535214, 5456.588128803906, 5456.588128803906, 6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19665737390630503, "mean_inference_ms": 1.1674188699535388, "mean_action_processing_ms": 0.12741247224288832, "mean_env_wait_ms": 3.375287312807661, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 688000, "timesteps_this_iter": 0, "agent_timesteps_total": 1376000, "timers": {"sample_time_ms": 5035.052, "sample_throughput": 1588.861, "load_time_ms": 0.132, "load_throughput": 60425773.456, "learn_time_ms": 909.621, "learn_throughput": 8794.874, "update_time_ms": 1.491}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 542260.6, "policy_loss": 0.00027355053194355605, "vf_loss": 542260.625, "vf_explained_var": 4.56690788269043e-05, "kl": 0.012595554721344548, "entropy": 3.6387331962585447, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 688000, "num_agent_steps_sampled": 1376000, "num_steps_trained": 688000, "num_agent_steps_trained": 1376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 860, "training_iteration": 86, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-36", "timestamp": 1718802696, "time_this_iter_s": 4.834745407104492, "time_total_s": 441.9613697528839, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9ca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 441.9613697528839, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 53.82857142857143, "ram_util_percent": 36.0}}
{"episode_reward_max": 19118.38563212441, "episode_reward_min": 3800.0, "episode_reward_mean": 10852.83195903038, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 9559.19281606218}, "policy_reward_mean": {"shared_policy": 5426.41597951519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12403.05331567855, 10134.811587493074, 11256.675171825183, 14069.195377347707, 14841.941993221968, 8092.353307434212, 11872.046963783807, 7712.37867560091, 12028.506451572186, 8948.903476159077, 15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6201.526657839284, 6201.526657839284, 5067.405793746535, 5067.405793746535, 5628.337585912594, 5628.337585912594, 7034.597688673839, 7034.597688673839, 7420.970996610988, 7420.970996610988, 4046.176653717106, 4046.176653717106, 5936.023481891903, 5936.023481891903, 3856.1893378004534, 3856.1893378004534, 6014.253225786105, 6014.253225786105, 4474.4517380795405, 4474.4517380795405, 7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19667959316005734, "mean_inference_ms": 1.1674785751772587, "mean_action_processing_ms": 0.12742127695119473, "mean_env_wait_ms": 3.3757932687128345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 696000, "timesteps_this_iter": 0, "agent_timesteps_total": 1392000, "timers": {"sample_time_ms": 4952.537, "sample_throughput": 1615.334, "load_time_ms": 0.132, "load_throughput": 60688066.558, "learn_time_ms": 907.091, "learn_throughput": 8819.405, "update_time_ms": 1.507}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 333994.78125, "policy_loss": -0.0010068134678528295, "vf_loss": 333994.83125, "vf_explained_var": -9.78708267211914e-05, "kl": 0.010967043229054814, "entropy": 3.475847673416138, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 696000, "num_agent_steps_sampled": 1392000, "num_steps_trained": 696000, "num_agent_steps_trained": 1392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 870, "training_iteration": 87, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-41", "timestamp": 1718802701, "time_this_iter_s": 4.830895185470581, "time_total_s": 446.7922649383545, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a569310>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 446.7922649383545, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 54.21428571428571, "ram_util_percent": 36.01428571428571}}
{"episode_reward_max": 19118.38563212441, "episode_reward_min": 3800.0, "episode_reward_mean": 10755.043523513214, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 9559.19281606218}, "policy_reward_mean": {"shared_policy": 5377.521761756608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15302.836848530103, 10350.410015495148, 10423.984048338458, 12435.448605527276, 12800.394644593744, 11337.390568525596, 7368.8311308854845, 15163.376076214256, 7138.698372837382, 8197.015959212462, 9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7651.41842426505, 7651.41842426505, 5175.205007747572, 5175.205007747572, 5211.992024169223, 5211.992024169223, 6217.724302763636, 6217.724302763636, 6400.197322296877, 6400.197322296877, 5668.695284262798, 5668.695284262798, 3684.4155654427423, 3684.4155654427423, 7581.6880381071205, 7581.6880381071205, 3569.349186418691, 3569.349186418691, 4098.507979606231, 4098.507979606231, 4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966778669355431, "mean_inference_ms": 1.1674084871142805, "mean_action_processing_ms": 0.12741291647129296, "mean_env_wait_ms": 3.3757301002143856, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 704000, "timesteps_this_iter": 0, "agent_timesteps_total": 1408000, "timers": {"sample_time_ms": 4900.554, "sample_throughput": 1632.468, "load_time_ms": 0.132, "load_throughput": 60831094.996, "learn_time_ms": 903.535, "learn_throughput": 8854.114, "update_time_ms": 1.506}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 351479.3, "policy_loss": 4.491368384336169e-05, "vf_loss": 351479.35625, "vf_explained_var": -9.984970092773438e-05, "kl": 0.011760275811412224, "entropy": 4.112815093994141, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 704000, "num_agent_steps_sampled": 1408000, "num_steps_trained": 704000, "num_agent_steps_trained": 1408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 880, "training_iteration": 88, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-46", "timestamp": 1718802706, "time_this_iter_s": 4.825705051422119, "time_total_s": 451.6179699897766, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 451.6179699897766, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 53.94285714285714, "ram_util_percent": 36.05714285714286}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3800.0, "episode_reward_mean": 10661.907117402248, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 5330.953558701124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9860.812821004176, 5000.0, 9849.4548936781, 5719.49217616245, 14098.551994514226, 12254.492906093452, 6000.0, 8478.562044934093, 10626.737289281387, 13805.739169392455, 11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4930.406410502084, 4930.406410502084, 2500.0, 2500.0, 4924.7274468390515, 4924.7274468390515, 2859.746088081225, 2859.746088081225, 7049.275997257113, 7049.275997257113, 6127.246453046719, 6127.246453046719, 3000.0, 3000.0, 4239.281022467046, 4239.281022467046, 5313.368644640708, 5313.368644640708, 6902.869584696231, 6902.869584696231, 5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19666813930196317, "mean_inference_ms": 1.167313645181683, "mean_action_processing_ms": 0.12740205951259206, "mean_env_wait_ms": 3.375542123095573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 712000, "timesteps_this_iter": 0, "agent_timesteps_total": 1424000, "timers": {"sample_time_ms": 4888.297, "sample_throughput": 1636.562, "load_time_ms": 0.129, "load_throughput": 61908546.125, "learn_time_ms": 901.138, "learn_throughput": 8877.662, "update_time_ms": 1.437}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771488e-09, "cur_lr": 0.0005, "total_loss": 360789.475, "policy_loss": 0.0023201820647344106, "vf_loss": 360789.5125, "vf_explained_var": -4.208087921142578e-05, "kl": 0.021612302586891254, "entropy": 3.844980335235596, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 712000, "num_agent_steps_sampled": 1424000, "num_steps_trained": 712000, "num_agent_steps_trained": 1424000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 890, "training_iteration": 89, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-51", "timestamp": 1718802711, "time_this_iter_s": 5.10357141494751, "time_total_s": 456.7215414047241, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 456.7215414047241, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 36.028571428571425}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3800.0, "episode_reward_mean": 10690.337588073535, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1900.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 5345.168794036768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11994.828627763905, 9897.765359792033, 6410.740069129035, 5288.689994033071, 7695.518356638797, 8162.635859657976, 10822.164151458608, 16984.689613669216, 13853.739535124325, 14959.658837292438, 11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5997.414313881958, 5997.414313881958, 4948.88267989602, 4948.88267989602, 3205.3700345645175, 3205.3700345645175, 2644.3449970165357, 2644.3449970165357, 3847.7591783193984, 3847.7591783193984, 4081.317929828988, 4081.317929828988, 5411.082075729291, 5411.082075729291, 8492.3448068346, 8492.3448068346, 6926.86976756217, 6926.86976756217, 7479.829418646223, 7479.829418646223, 5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19665859647168987, "mean_inference_ms": 1.1672270873407733, "mean_action_processing_ms": 0.1273926159402579, "mean_env_wait_ms": 3.3753792738049, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 4887.356, "sample_throughput": 1636.877, "load_time_ms": 0.128, "load_throughput": 62310922.934, "learn_time_ms": 900.084, "learn_throughput": 8888.062, "update_time_ms": 1.438}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.352761268615723e-09, "cur_lr": 0.0005, "total_loss": 304593.375, "policy_loss": 0.0018249759553000898, "vf_loss": 304593.425, "vf_explained_var": -0.00016698837280273437, "kl": 0.015110494196920527, "entropy": 3.5117048263549804, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 720000, "num_agent_steps_trained": 1440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 900, "training_iteration": 90, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-11-56", "timestamp": 1718802716, "time_this_iter_s": 4.82656717300415, "time_total_s": 461.54810857772827, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f94c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 461.54810857772827, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 54.6, "ram_util_percent": 36.0}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3200.0, "episode_reward_mean": 10672.15756806209, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1600.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 5336.078784031046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11063.485667843674, 11411.311843813171, 9492.101831592863, 8031.6917120035705, 16825.362838967354, 14481.69126760527, 8599.9568417767, 6935.520892052176, 8289.084599992264, 15182.859929582497, 6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5531.742833921842, 5531.742833921842, 5705.655921906588, 5705.655921906588, 4746.050915796431, 4746.050915796431, 4015.8458560017853, 4015.8458560017853, 8412.681419483666, 8412.681419483666, 7240.845633802632, 7240.845633802632, 4299.978420888351, 4299.978420888351, 3467.760446026088, 3467.760446026088, 4144.542299996134, 4144.542299996134, 7591.429964791245, 7591.429964791245, 3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19665270216666145, "mean_inference_ms": 1.167186823442647, "mean_action_processing_ms": 0.12738852515026328, "mean_env_wait_ms": 3.3754780982408357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 728000, "timesteps_this_iter": 0, "agent_timesteps_total": 1456000, "timers": {"sample_time_ms": 4899.35, "sample_throughput": 1632.87, "load_time_ms": 0.128, "load_throughput": 62357242.148, "learn_time_ms": 902.607, "learn_throughput": 8863.219, "update_time_ms": 1.439}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.352761268615723e-09, "cur_lr": 0.0005, "total_loss": 333439.1625, "policy_loss": -0.000680920964683196, "vf_loss": 333439.21875, "vf_explained_var": -0.00015895366668701173, "kl": 0.012359665893426937, "entropy": 4.249878883361816, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 728000, "num_agent_steps_sampled": 1456000, "num_steps_trained": 728000, "num_agent_steps_trained": 1456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 910, "training_iteration": 91, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-01", "timestamp": 1718802721, "time_this_iter_s": 5.025007009506226, "time_total_s": 466.5731155872345, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa820>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 466.5731155872345, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 56.01428571428572, "ram_util_percent": 36.01428571428571}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3200.0, "episode_reward_mean": 10474.411533565459, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1600.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 5237.205766782729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6469.306659947044, 10527.957301370734, 12173.489564090847, 15953.613102424097, 8253.201150317931, 12059.457715664736, 12430.42512001513, 12057.188183502807, 5572.493389976018, 13290.441356185973, 10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3234.653329973522, 3234.653329973522, 5263.978650685361, 5263.978650685361, 6086.744782045424, 6086.744782045424, 7976.80655121205, 7976.80655121205, 4126.6005751589655, 4126.6005751589655, 6029.728857832366, 6029.728857832366, 6215.212560007556, 6215.212560007556, 6028.594091751413, 6028.594091751413, 2786.246694988009, 2786.246694988009, 6645.220678092992, 6645.220678092992, 5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19665068144983167, "mean_inference_ms": 1.1671486809540124, "mean_action_processing_ms": 0.12738469249322212, "mean_env_wait_ms": 3.3755987825781313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 736000, "timesteps_this_iter": 0, "agent_timesteps_total": 1472000, "timers": {"sample_time_ms": 4898.243, "sample_throughput": 1633.239, "load_time_ms": 0.132, "load_throughput": 60798028.628, "learn_time_ms": 899.353, "learn_throughput": 8895.285, "update_time_ms": 1.422}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.352761268615723e-09, "cur_lr": 0.0005, "total_loss": 263288.1, "policy_loss": 0.00034875221885712906, "vf_loss": 263288.14375, "vf_explained_var": -7.071495056152344e-05, "kl": 0.01722455099267778, "entropy": 3.6173400402069094, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 736000, "num_agent_steps_sampled": 1472000, "num_steps_trained": 736000, "num_agent_steps_trained": 1472000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 920, "training_iteration": 92, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-06", "timestamp": 1718802726, "time_this_iter_s": 4.794924736022949, "time_total_s": 471.36804032325745, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4faf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 471.36804032325745, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 53.8142857142857, "ram_util_percent": 36.0}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3000.0, "episode_reward_mean": 10277.345954500366, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 5138.672977250184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10128.67184357614, 8149.5321637061425, 12000.14491132115, 11769.547689532494, 11247.588005123143, 10310.5333197287, 9815.726461290029, 5902.938563926316, 9752.488367530685, 7713.863923352901, 11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5064.33592178807, 5064.33592178807, 4074.7660818530712, 4074.7660818530712, 6000.072455660578, 6000.072455660578, 5884.7738447662505, 5884.7738447662505, 5623.794002561576, 5623.794002561576, 5155.266659864352, 5155.266659864352, 4907.863230644998, 4907.863230644998, 2951.469281963158, 2951.469281963158, 4876.244183765334, 4876.244183765334, 3856.9319616764506, 3856.9319616764506, 5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966527445119578, "mean_inference_ms": 1.1671184254493392, "mean_action_processing_ms": 0.12738259709338937, "mean_env_wait_ms": 3.3757393107338025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 744000, "timesteps_this_iter": 0, "agent_timesteps_total": 1488000, "timers": {"sample_time_ms": 4904.794, "sample_throughput": 1631.057, "load_time_ms": 0.132, "load_throughput": 60447544.587, "learn_time_ms": 895.89, "learn_throughput": 8929.668, "update_time_ms": 1.432}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.352761268615723e-09, "cur_lr": 0.0005, "total_loss": 254599.190625, "policy_loss": 0.010039950759708916, "vf_loss": 254599.2125, "vf_explained_var": -0.0001806974411010742, "kl": 0.04080293923664936, "entropy": 3.8097980499267576, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 744000, "num_agent_steps_sampled": 1488000, "num_steps_trained": 744000, "num_agent_steps_trained": 1488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 930, "training_iteration": 93, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-10", "timestamp": 1718802730, "time_this_iter_s": 4.847238302230835, "time_total_s": 476.2152786254883, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f94c0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 476.2152786254883, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 53.47142857142858, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3000.0, "episode_reward_mean": 10356.805080178612, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 5178.402540089306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11999.976645301362, 15338.089425522503, 10782.920478408338, 10410.124491786846, 10261.554352434738, 12277.144252058704, 7928.296515418588, 13504.8203030667, 15035.737982400344, 10042.240818499762, 19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5999.988322650683, 5999.988322650683, 7669.044712761239, 7669.044712761239, 5391.4602392041625, 5391.4602392041625, 5205.062245893434, 5205.062245893434, 5130.7771762173725, 5130.7771762173725, 6138.572126029361, 6138.572126029361, 3964.148257709294, 3964.148257709294, 6752.410151533362, 6752.410151533362, 7517.868991200172, 7517.868991200172, 5021.120409249885, 5021.120409249885, 9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966609994847018, "mean_inference_ms": 1.1671074360963654, "mean_action_processing_ms": 0.12738276909855673, "mean_env_wait_ms": 3.3757979245000245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 752000, "timesteps_this_iter": 0, "agent_timesteps_total": 1504000, "timers": {"sample_time_ms": 4900.239, "sample_throughput": 1632.573, "load_time_ms": 0.132, "load_throughput": 60753996.017, "learn_time_ms": 891.853, "learn_throughput": 8970.093, "update_time_ms": 1.461}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.029141902923584e-09, "cur_lr": 0.0005, "total_loss": 351686.95625, "policy_loss": 0.003181295035966514, "vf_loss": 351687.0, "vf_explained_var": -0.0002526283264160156, "kl": 0.02000310272024155, "entropy": 3.934092569351196, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 752000, "num_agent_steps_sampled": 1504000, "num_steps_trained": 752000, "num_agent_steps_trained": 1504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 940, "training_iteration": 94, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-15", "timestamp": 1718802735, "time_this_iter_s": 4.835529327392578, "time_total_s": 481.05080795288086, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49b8b0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 481.05080795288086, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 53.8, "ram_util_percent": 36.0}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3000.0, "episode_reward_mean": 9930.795466774487, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 4965.397733387244}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19118.38563212441, 16021.696685660485, 9157.04069127608, 14592.952265969332, 8195.0516370375, 11610.918940834898, 10617.782394524354, 12153.14462506862, 9621.741599289391, 15586.886940084889, 14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [9559.19281606218, 9559.19281606218, 8010.848342830244, 8010.848342830244, 4578.520345638046, 4578.520345638046, 7296.476132984666, 7296.476132984666, 4097.525818518756, 4097.525818518756, 5805.459470417434, 5805.459470417434, 5308.891197262176, 5308.891197262176, 6076.572312534318, 6076.572312534318, 4810.870799644687, 4810.870799644687, 7793.443470042461, 7793.443470042461, 7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19666176698591575, "mean_inference_ms": 1.167091548648365, "mean_action_processing_ms": 0.12738275953066408, "mean_env_wait_ms": 3.3758351301832126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 1520000, "timers": {"sample_time_ms": 4890.227, "sample_throughput": 1635.916, "load_time_ms": 0.131, "load_throughput": 60886285.611, "learn_time_ms": 893.285, "learn_throughput": 8955.704, "update_time_ms": 1.473}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.543712854385377e-09, "cur_lr": 0.0005, "total_loss": 182120.6375, "policy_loss": 0.0036844079338017367, "vf_loss": 182120.66875, "vf_explained_var": -8.966922760009766e-05, "kl": 0.0225225280975156, "entropy": 4.028489208221435, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 1520000, "num_steps_trained": 760000, "num_agent_steps_trained": 1520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 950, "training_iteration": 95, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-20", "timestamp": 1718802740, "time_this_iter_s": 4.852969408035278, "time_total_s": 485.90377736091614, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49baf0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 485.90377736091614, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 54.01428571428572, "ram_util_percent": 36.04285714285714}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3000.0, "episode_reward_mean": 9537.708639456334, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 4768.854319728166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14896.486653232965, 10399.421023098392, 8604.01056308603, 4397.701226160309, 8860.386611333764, 3800.0, 11842.336881795949, 13861.747749065475, 10266.826086215857, 14563.569924572541, 13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7448.243326616475, 7448.243326616475, 5199.710511549192, 5199.710511549192, 4302.005281543015, 4302.005281543015, 2198.8506130801543, 2198.8506130801543, 4430.193305666887, 4430.193305666887, 1900.0, 1900.0, 5921.168440897978, 5921.168440897978, 6930.873874532737, 6930.873874532737, 5133.41304310793, 5133.41304310793, 7281.784962286276, 7281.784962286276, 6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19666264948225812, "mean_inference_ms": 1.1670830411934672, "mean_action_processing_ms": 0.12738418348641142, "mean_env_wait_ms": 3.3758983232051607, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"sample_time_ms": 4893.148, "sample_throughput": 1634.939, "load_time_ms": 0.132, "load_throughput": 60666121.859, "learn_time_ms": 892.733, "learn_throughput": 8961.249, "update_time_ms": 1.465}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1315569281578066e-08, "cur_lr": 0.0005, "total_loss": 248839.359375, "policy_loss": 0.004179696426540503, "vf_loss": 248839.39375, "vf_explained_var": -0.00020003318786621094, "kl": 0.025590905920111557, "entropy": 3.5834598541259766, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 1536000, "num_steps_trained": 768000, "num_agent_steps_trained": 1536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 960, "training_iteration": 96, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-25", "timestamp": 1718802745, "time_this_iter_s": 4.846433162689209, "time_total_s": 490.75021052360535, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49b280>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 490.75021052360535, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 54.528571428571425, "ram_util_percent": 36.07142857142857}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 3000.0, "episode_reward_mean": 9449.533905504573, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1500.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 4724.7669527522885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13020.01479959362, 14528.30813302892, 3929.1981249484525, 15125.332777578671, 8928.236301373025, 9050.761101328386, 7011.293329380744, 15465.873174946402, 5370.527967930966, 9151.47705829097, 8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6510.00739979681, 6510.00739979681, 7264.15406651446, 7264.15406651446, 1964.5990624742262, 1964.5990624742262, 7562.666388789337, 7562.666388789337, 4464.118150686521, 4464.118150686521, 4525.380550664187, 4525.380550664187, 3505.646664690372, 3505.646664690372, 7732.936587473201, 7732.936587473201, 2685.263983965485, 2685.263983965485, 4575.738529145482, 4575.738529145482, 4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.196666490344936, "mean_inference_ms": 1.1670797252421348, "mean_action_processing_ms": 0.12738572016567212, "mean_env_wait_ms": 3.3759782773426603, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 776000, "timesteps_this_iter": 0, "agent_timesteps_total": 1552000, "timers": {"sample_time_ms": 4892.451, "sample_throughput": 1635.172, "load_time_ms": 0.132, "load_throughput": 60611329.48, "learn_time_ms": 892.719, "learn_throughput": 8961.383, "update_time_ms": 1.487}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6973353922367097e-08, "cur_lr": 0.0005, "total_loss": 275053.48125, "policy_loss": 0.005055127201974585, "vf_loss": 275053.525, "vf_explained_var": -0.00019655227661132812, "kl": 0.031175839901651285, "entropy": 4.362699031829834, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 776000, "num_agent_steps_sampled": 1552000, "num_steps_trained": 776000, "num_agent_steps_trained": 1552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 970, "training_iteration": 97, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-30", "timestamp": 1718802750, "time_this_iter_s": 4.829789161682129, "time_total_s": 495.5799996852875, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49b040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 495.5799996852875, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 61.116666666666674, "ram_util_percent": 36.016666666666666}}
{"episode_reward_max": 19862.33038035223, "episode_reward_min": 2600.0, "episode_reward_mean": 9081.963266556382, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 9931.165190176134}, "policy_reward_mean": {"shared_policy": 4540.981633278193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8934.399654249111, 7735.270874941023, 9417.932619340896, 9417.457724866068, 7645.915019766509, 19862.33038035223, 13731.551032815321, 9927.137685148547, 9967.564473356568, 4565.186194226946, 7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [4467.199827124556, 4467.199827124556, 3867.6354374705115, 3867.6354374705115, 4708.966309670442, 4708.966309670442, 4708.728862433033, 4708.728862433033, 3822.9575098832547, 3822.9575098832547, 9931.165190176134, 9931.165190176134, 6865.775516407655, 6865.775516407655, 4963.568842574272, 4963.568842574272, 4983.782236678273, 4983.782236678273, 2282.593097113473, 2282.593097113473, 3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966764732274077, "mean_inference_ms": 1.1671291617619635, "mean_action_processing_ms": 0.12739440251126577, "mean_env_wait_ms": 3.376374742576321, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 784000, "timesteps_this_iter": 0, "agent_timesteps_total": 1568000, "timers": {"sample_time_ms": 4923.55, "sample_throughput": 1624.844, "load_time_ms": 0.132, "load_throughput": 60589440.231, "learn_time_ms": 892.925, "learn_throughput": 8959.324, "update_time_ms": 1.491}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5460030883550643e-08, "cur_lr": 0.0005, "total_loss": 141202.446875, "policy_loss": 0.0024519334664567793, "vf_loss": 141202.484375, "vf_explained_var": -1.2755393981933594e-05, "kl": 0.025449269637873872, "entropy": 3.9168676376342773, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 784000, "num_agent_steps_sampled": 1568000, "num_steps_trained": 784000, "num_agent_steps_trained": 1568000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 980, "training_iteration": 98, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-35", "timestamp": 1718802755, "time_this_iter_s": 5.137377977371216, "time_total_s": 500.7173776626587, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a49b790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 500.7173776626587, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 51.8125, "ram_util_percent": 36.1}}
{"episode_reward_max": 14760.77655184305, "episode_reward_min": 2600.0, "episode_reward_mean": 8880.893271063127, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 7380.388275921539}, "policy_reward_mean": {"shared_policy": 4440.446635531564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7152.625784035932, 14029.493614519444, 10249.072226502816, 9923.837712234672, 8236.341824334824, 14419.932336773141, 8227.024375834455, 7816.137096205533, 8627.885289000224, 9854.540102747906, 3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3576.312892017966, 3576.312892017966, 7014.746807259733, 7014.746807259733, 5124.536113251417, 5124.536113251417, 4961.918856117353, 4961.918856117353, 4118.170912167412, 4118.170912167412, 7209.966168386567, 7209.966168386567, 4113.512187917226, 4113.512187917226, 3908.0685481027667, 3908.0685481027667, 4313.942644500121, 4313.942644500121, 4927.270051373958, 4927.270051373958, 1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19667567561283483, "mean_inference_ms": 1.1670810469760358, "mean_action_processing_ms": 0.12739164171229506, "mean_env_wait_ms": 3.376441302707852, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 792000, "timesteps_this_iter": 0, "agent_timesteps_total": 1584000, "timers": {"sample_time_ms": 4894.145, "sample_throughput": 1634.606, "load_time_ms": 0.139, "load_throughput": 57614065.934, "learn_time_ms": 892.655, "learn_throughput": 8962.031, "update_time_ms": 1.484}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.819004632532597e-08, "cur_lr": 0.0005, "total_loss": 188212.934375, "policy_loss": 0.0012994476024992708, "vf_loss": 188212.975, "vf_explained_var": -0.00018110275268554688, "kl": 0.02564905453515235, "entropy": 4.056278228759766, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 792000, "num_agent_steps_sampled": 1584000, "num_steps_trained": 792000, "num_agent_steps_trained": 1584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 990, "training_iteration": 99, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-12-40", "timestamp": 1718802760, "time_this_iter_s": 4.804698705673218, "time_total_s": 505.5220763683319, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fadc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 505.5220763683319, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 52.75714285714286, "ram_util_percent": 36.0}}
{"episode_reward_max": 14760.77655184305, "episode_reward_min": 2600.0, "episode_reward_mean": 8706.88995275743, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 7380.388275921539}, "policy_reward_mean": {"shared_policy": 4353.444976378716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3200.0, 9445.409660270729, 14230.683400509202, 10502.10529911155, 13792.452389943475, 8578.250834765084, 11069.560428583802, 8604.756615857375, 14007.212163420878, 10821.997610953033, 11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [1600.0, 1600.0, 4722.704830135371, 4722.704830135371, 7115.341700254594, 7115.341700254594, 5251.052649555768, 5251.052649555768, 6896.226194971743, 6896.226194971743, 4289.125417382549, 4289.125417382549, 5534.780214291896, 5534.780214291896, 4302.378307928686, 4302.378307928686, 7003.606081710437, 7003.606081710437, 5410.998805476522, 5410.998805476522, 5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19667321235048604, "mean_inference_ms": 1.1670302074228336, "mean_action_processing_ms": 0.12738810708405368, "mean_env_wait_ms": 3.376487865224726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 1600000, "timers": {"sample_time_ms": 4895.378, "sample_throughput": 1634.195, "load_time_ms": 0.139, "load_throughput": 57752895.009, "learn_time_ms": 895.459, "learn_throughput": 8933.969, "update_time_ms": 1.492}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.728506948798895e-08, "cur_lr": 0.0005, "total_loss": 191185.34375, "policy_loss": 0.00767378877103333, "vf_loss": 191185.384375, "vf_explained_var": -0.00036804676055908204, "kl": 0.041588675231307326, "entropy": 4.136118316650391, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 1600000, "num_steps_trained": 800000, "num_agent_steps_trained": 1600000, "num_steps_trained_this_iter": 0}, "evaluation": {"episode_reward_max": 14234.152147601613, "episode_reward_min": 5000.0, "episode_reward_mean": 9532.284168538901, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 2500.0}, "policy_reward_max": {"shared_policy": 7117.076073800799}, "policy_reward_mean": {"shared_policy": 4766.142084269452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5340.275788751158, 14234.152147601613, 9811.777945165915, 11159.594817744848, 5000.0, 9972.057377522677, 6894.762101175866, 12295.617682809476, 8351.593727961052, 12263.01009665641], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2670.137894375579, 2670.137894375579, 7117.076073800799, 7117.076073800799, 4905.888972582972, 4905.888972582972, 5579.797408872426, 5579.797408872426, 2500.0, 2500.0, 4986.028688761334, 4986.028688761334, 3447.381050587933, 3447.381050587933, 6147.808841404739, 6147.808841404739, 4175.796863980523, 4175.796863980523, 6131.5050483282175, 6131.5050483282175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.10091469784198974, "mean_inference_ms": 0.6676563716860058, "mean_action_processing_ms": 0.07047144206387798, "mean_env_wait_ms": 1.8539385798275305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 1000, "training_iteration": 100, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-07", "timestamp": 1718802787, "time_this_iter_s": 26.949239015579224, "time_total_s": 532.4713153839111, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4fa160>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 532.4713153839111, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 17.544736842105262, "ram_util_percent": 36.08947368421051}}
{"episode_reward_max": 14760.77655184305, "episode_reward_min": 2600.0, "episode_reward_mean": 8391.714286418666, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 7380.388275921539}, "policy_reward_mean": {"shared_policy": 4195.857143209334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11697.976285124794, 14760.77655184305, 5126.559714993691, 7901.369748681755, 11616.902783952817, 9144.12108202518, 10096.033332376977, 11330.545184486036, 3800.0, 5064.17929208183, 6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5848.988142562401, 5848.988142562401, 7380.388275921539, 7380.388275921539, 2563.2798574968456, 2563.2798574968456, 3950.6848743408773, 3950.6848743408773, 5808.4513919763995, 5808.4513919763995, 4572.0605410125845, 4572.0605410125845, 5048.016666188479, 5048.016666188479, 5665.272592243024, 5665.272592243024, 1900.0, 1900.0, 2532.089646040915, 2532.089646040915, 3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19666401035352707, "mean_inference_ms": 1.1669488510699626, "mean_action_processing_ms": 0.12738210769512925, "mean_env_wait_ms": 3.3763354267770453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 808000, "timesteps_this_iter": 0, "agent_timesteps_total": 1616000, "timers": {"sample_time_ms": 7091.368, "sample_throughput": 1128.132, "load_time_ms": 0.138, "load_throughput": 57792683.431, "learn_time_ms": 895.839, "learn_throughput": 8930.177, "update_time_ms": 1.498}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.592760423198343e-08, "cur_lr": 0.0005, "total_loss": 150495.18125, "policy_loss": 0.012627512726187718, "vf_loss": 150495.203125, "vf_explained_var": -0.0002865314483642578, "kl": 0.050031051785188484, "entropy": 4.164259147644043, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 808000, "num_agent_steps_sampled": 1616000, "num_steps_trained": 808000, "num_agent_steps_trained": 1616000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1010, "training_iteration": 101, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-12", "timestamp": 1718802792, "time_this_iter_s": 4.873108625411987, "time_total_s": 537.3444240093231, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fdc0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 537.3444240093231, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 54.128571428571426, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 15343.032953506237, "episode_reward_min": 2600.0, "episode_reward_mean": 8265.489972838399, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 7671.5164767531205}, "policy_reward_mean": {"shared_policy": 4132.7449864192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6754.983137177225, 8077.005381540437, 3000.0, 9695.246719679497, 12316.087039418955, 9131.261080717486, 11587.599929154429, 9436.870834064619, 5398.275807603399, 13683.685707630193, 13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3377.4915685886126, 3377.4915685886126, 4038.5026907702186, 4038.5026907702186, 1500.0, 1500.0, 4847.623359839754, 4847.623359839754, 6158.043519709468, 6158.043519709468, 4565.630540358738, 4565.630540358738, 5793.79996457722, 5793.79996457722, 4718.435417032302, 4718.435417032302, 2699.1379038016994, 2699.1379038016994, 6841.8428538151, 6841.8428538151, 6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19665000863053458, "mean_inference_ms": 1.1668693893921733, "mean_action_processing_ms": 0.1273757229833072, "mean_env_wait_ms": 3.3761726918464436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 816000, "timesteps_this_iter": 0, "agent_timesteps_total": 1632000, "timers": {"sample_time_ms": 7095.743, "sample_throughput": 1127.436, "load_time_ms": 0.135, "load_throughput": 59126752.423, "learn_time_ms": 901.952, "learn_throughput": 8869.652, "update_time_ms": 1.507}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2889140634797514e-07, "cur_lr": 0.0005, "total_loss": 191192.834375, "policy_loss": 0.006058572801202189, "vf_loss": 191192.85625, "vf_explained_var": 3.886222839355469e-06, "kl": 0.03447757326141317, "entropy": 3.683732748031616, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 816000, "num_agent_steps_sampled": 1632000, "num_steps_trained": 816000, "num_agent_steps_trained": 1632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1020, "training_iteration": 102, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-17", "timestamp": 1718802797, "time_this_iter_s": 4.896163463592529, "time_total_s": 542.2405874729156, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a569940>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 542.2405874729156, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 53.87142857142857, "ram_util_percent": 36.0}}
{"episode_reward_max": 16139.523231716488, "episode_reward_min": 2600.0, "episode_reward_mean": 8406.257277691075, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 8069.761615858246}, "policy_reward_mean": {"shared_policy": 4203.128638845539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13251.88609368894, 8434.58376698209, 8599.277333677128, 11288.552045182008, 13545.586876625963, 14155.9793934558, 10144.05386627909, 13385.70574872267, 8531.3226922986, 3400.0, 10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6625.943046844473, 6625.943046844473, 4217.291883491043, 4217.291883491043, 4299.638666838571, 4299.638666838571, 5644.276022590999, 5644.276022590999, 6772.793438312978, 6772.793438312978, 7077.9896967279055, 7077.9896967279055, 5072.026933139548, 5072.026933139548, 6692.852874361321, 6692.852874361321, 4265.661346149302, 4265.661346149302, 1700.0, 1700.0, 5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966358576617691, "mean_inference_ms": 1.1668124052396585, "mean_action_processing_ms": 0.12737156913572503, "mean_env_wait_ms": 3.3760700614214882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 824000, "timesteps_this_iter": 0, "agent_timesteps_total": 1648000, "timers": {"sample_time_ms": 7101.201, "sample_throughput": 1126.57, "load_time_ms": 0.135, "load_throughput": 59189331.452, "learn_time_ms": 904.739, "learn_throughput": 8842.331, "update_time_ms": 1.518}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.933371095219627e-07, "cur_lr": 0.0005, "total_loss": 332274.28125, "policy_loss": 0.003960086184740063, "vf_loss": 332274.30625, "vf_explained_var": -5.950927734375e-05, "kl": 0.029825163633193243, "entropy": 4.2784647941589355, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 824000, "num_agent_steps_sampled": 1648000, "num_steps_trained": 824000, "num_agent_steps_trained": 1648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1030, "training_iteration": 103, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-21", "timestamp": 1718802801, "time_this_iter_s": 4.866819143295288, "time_total_s": 547.1074066162109, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 547.1074066162109, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 54.357142857142854, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 16139.523231716488, "episode_reward_min": 2600.0, "episode_reward_mean": 8234.624313116223, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 8069.761615858246}, "policy_reward_mean": {"shared_policy": 4117.312156558113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10676.609713468079, 4200.0, 8711.917585384206, 8182.677026881091, 4400.0, 7388.888273505316, 3800.0, 9592.582270682371, 5393.1072613459655, 12634.161793218474, 7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5338.304856734048, 5338.304856734048, 2100.0, 2100.0, 4355.958792692103, 4355.958792692103, 4091.33851344054, 4091.33851344054, 2200.0, 2200.0, 3694.4441367526597, 3694.4441367526597, 1900.0, 1900.0, 4796.291135341191, 4796.291135341191, 2696.5536306729828, 2696.5536306729828, 6317.080896609237, 6317.080896609237, 3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19662262552767257, "mean_inference_ms": 1.166754505339825, "mean_action_processing_ms": 0.12736763081080302, "mean_env_wait_ms": 3.376004258110182, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 832000, "timesteps_this_iter": 0, "agent_timesteps_total": 1664000, "timers": {"sample_time_ms": 7107.344, "sample_throughput": 1125.596, "load_time_ms": 0.139, "load_throughput": 57673482.296, "learn_time_ms": 905.697, "learn_throughput": 8832.979, "update_time_ms": 1.502}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.900056642829441e-07, "cur_lr": 0.0005, "total_loss": 230862.390625, "policy_loss": 0.0015873448164427373, "vf_loss": 230862.43125, "vf_explained_var": -0.0002451896667480469, "kl": 0.018866976164991858, "entropy": 4.124125289916992, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 832000, "num_agent_steps_sampled": 1664000, "num_steps_trained": 832000, "num_agent_steps_trained": 1664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1040, "training_iteration": 104, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-26", "timestamp": 1718802806, "time_this_iter_s": 4.877232551574707, "time_total_s": 551.9846391677856, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 551.9846391677856, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 53.857142857142854, "ram_util_percent": 35.95714285714286}}
{"episode_reward_max": 16139.523231716488, "episode_reward_min": 2600.0, "episode_reward_mean": 8489.960158021111, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 1300.0}, "policy_reward_max": {"shared_policy": 8069.761615858246}, "policy_reward_mean": {"shared_policy": 4244.980079010557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7703.594456673312, 9263.725005753968, 9391.689228370764, 9964.37791851403, 4000.0, 4307.550417485589, 11536.36751775428, 14259.62758978218, 6037.030078472635, 10902.956467247514, 10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3851.797228336656, 3851.797228336656, 4631.86250287699, 4631.86250287699, 4695.844614185379, 4695.844614185379, 4982.188959257023, 4982.188959257023, 2000.0, 2000.0, 2153.775208742796, 2153.775208742796, 5768.18375887714, 5768.18375887714, 7129.813794891095, 7129.813794891095, 3018.5150392363175, 3018.5150392363175, 5451.478233623762, 5451.478233623762, 5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966084879405467, "mean_inference_ms": 1.1667049703878438, "mean_action_processing_ms": 0.1273641322899221, "mean_env_wait_ms": 3.376014368891374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 840000, "timesteps_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"sample_time_ms": 7115.01, "sample_throughput": 1124.384, "load_time_ms": 0.137, "load_throughput": 58518367.632, "learn_time_ms": 908.093, "learn_throughput": 8809.671, "update_time_ms": 1.526}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.900056642829441e-07, "cur_lr": 0.0005, "total_loss": 328765.78125, "policy_loss": 0.0021504441572353984, "vf_loss": 328765.8125, "vf_explained_var": -3.4236907958984374e-05, "kl": 0.024591581896564595, "entropy": 4.368718528747559, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 1680000, "num_steps_trained": 840000, "num_agent_steps_trained": 1680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1050, "training_iteration": 105, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-31", "timestamp": 1718802811, "time_this_iter_s": 4.947356462478638, "time_total_s": 556.9319956302643, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4faf70>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 556.9319956302643, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 54.92857142857143, "ram_util_percent": 35.98571428571429}}
{"episode_reward_max": 16139.523231716488, "episode_reward_min": 1600.0, "episode_reward_mean": 8402.520371649654, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 8069.761615858246}, "policy_reward_mean": {"shared_policy": 4201.260185824829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10283.209524192425, 13202.722709360096, 9538.429933636275, 7433.28130657053, 10632.087990415017, 5253.7518673059785, 5080.65780369805, 9683.984703394708, 11146.880865771636, 10420.006619040796, 6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5141.604762096226, 5141.604762096226, 6601.36135468005, 6601.36135468005, 4769.214966818138, 4769.214966818138, 3716.640653285265, 3716.640653285265, 5316.0439952075085, 5316.0439952075085, 2626.8759336529893, 2626.8759336529893, 2540.328901849025, 2540.328901849025, 4841.992351697354, 4841.992351697354, 5573.44043288582, 5573.44043288582, 5210.003309520404, 5210.003309520404, 3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19659217305962337, "mean_inference_ms": 1.1666486575228403, "mean_action_processing_ms": 0.1273585534571101, "mean_env_wait_ms": 3.375962573252234, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 848000, "timesteps_this_iter": 0, "agent_timesteps_total": 1696000, "timers": {"sample_time_ms": 7111.752, "sample_throughput": 1124.899, "load_time_ms": 0.14, "load_throughput": 57289451.938, "learn_time_ms": 911.527, "learn_throughput": 8776.485, "update_time_ms": 1.573}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.350084964244161e-07, "cur_lr": 0.0005, "total_loss": 199003.909375, "policy_loss": 0.0022518186066299963, "vf_loss": 199003.95, "vf_explained_var": -0.0005536556243896484, "kl": 0.02847398705814707, "entropy": 4.28531436920166, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 848000, "num_agent_steps_sampled": 1696000, "num_steps_trained": 848000, "num_agent_steps_trained": 1696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1060, "training_iteration": 106, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-36", "timestamp": 1718802816, "time_this_iter_s": 4.824136018753052, "time_total_s": 561.7561316490173, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9430>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 561.7561316490173, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 54.214285714285715, "ram_util_percent": 36.0}}
{"episode_reward_max": 16139.523231716488, "episode_reward_min": 1600.0, "episode_reward_mean": 8339.603541768105, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 8069.761615858246}, "policy_reward_mean": {"shared_policy": 4169.8017708840525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6454.780548142791, 9673.318670638717, 5391.098902722701, 6457.839253542099, 4600.0, 2600.0, 13627.696013935627, 2600.0, 9226.405187540524, 4192.820297058628, 13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3227.3902740713957, 3227.3902740713957, 4836.6593353193575, 4836.6593353193575, 2695.5494513613503, 2695.5494513613503, 3228.9196267710495, 3228.9196267710495, 2300.0, 2300.0, 1300.0, 1300.0, 6813.848006967819, 6813.848006967819, 1300.0, 1300.0, 4613.202593770258, 4613.202593770258, 2096.410148529314, 2096.410148529314, 6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19657397392536796, "mean_inference_ms": 1.166588992610617, "mean_action_processing_ms": 0.12735258604159558, "mean_env_wait_ms": 3.375909364784263, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 856000, "timesteps_this_iter": 0, "agent_timesteps_total": 1712000, "timers": {"sample_time_ms": 7113.54, "sample_throughput": 1124.616, "load_time_ms": 0.141, "load_throughput": 56939473.952, "learn_time_ms": 914.199, "learn_throughput": 8750.826, "update_time_ms": 1.546}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.525127446366242e-07, "cur_lr": 0.0005, "total_loss": 231426.946875, "policy_loss": 0.004423679812998671, "vf_loss": 231426.98125, "vf_explained_var": -0.00024542808532714846, "kl": 0.032880444452944475, "entropy": 4.139262294769287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 856000, "num_agent_steps_sampled": 1712000, "num_steps_trained": 856000, "num_agent_steps_trained": 1712000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1070, "training_iteration": 107, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-41", "timestamp": 1718802821, "time_this_iter_s": 4.8400726318359375, "time_total_s": 566.5962042808533, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f91f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 566.5962042808533, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 53.51428571428571, "ram_util_percent": 36.07142857142857}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1600.0, "episode_reward_mean": 8795.773817156009, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4397.886908578005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13525.465033802771, 7418.664146610605, 6260.031978541714, 7140.204990513306, 12582.873320045379, 9201.787129137287, 6410.31426218747, 7610.223715356267, 4000.0, 6948.181533542607, 10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6762.732516901393, 6762.732516901393, 3709.3320733053024, 3709.3320733053024, 3130.0159892708625, 3130.0159892708625, 3570.102495256653, 3570.102495256653, 6291.4366600227, 6291.4366600227, 4600.893564568637, 4600.893564568637, 3205.157131093735, 3205.157131093735, 3805.1118576781337, 3805.1118576781337, 2000.0, 2000.0, 3474.0907667713036, 3474.0907667713036, 5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19654691559919496, "mean_inference_ms": 1.1664665531000982, "mean_action_processing_ms": 0.1273395037206242, "mean_env_wait_ms": 3.3755392320093462, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 864000, "timesteps_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"sample_time_ms": 7084.12, "sample_throughput": 1129.286, "load_time_ms": 0.14, "load_throughput": 57084777.135, "learn_time_ms": 913.675, "learn_throughput": 8755.844, "update_time_ms": 1.555}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.787691169549363e-07, "cur_lr": 0.0005, "total_loss": 365531.38125, "policy_loss": 0.005787874417006833, "vf_loss": 365531.41875, "vf_explained_var": -0.00024006366729736328, "kl": 0.03081117160675474, "entropy": 4.204934978485108, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 864000, "num_agent_steps_sampled": 1728000, "num_steps_trained": 864000, "num_agent_steps_trained": 1728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 108, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-46", "timestamp": 1718802826, "time_this_iter_s": 4.8127617835998535, "time_total_s": 571.4089660644531, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 571.4089660644531, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 53.857142857142854, "ram_util_percent": 36.07142857142857}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1600.0, "episode_reward_mean": 8881.644573147096, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 800.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4440.822286573548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10989.088625782897, 6935.214157235929, 5417.12986334943, 8669.119465021551, 12858.238134513638, 6525.557313469173, 4392.2464244023395, 10568.128303921341, 6379.374511391097, 8402.46173253209, 5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5494.54431289145, 5494.54431289145, 3467.6070786179644, 3467.6070786179644, 2708.564931674715, 2708.564931674715, 4334.559732510772, 4334.559732510772, 6429.119067256821, 6429.119067256821, 3262.7786567345865, 3262.7786567345865, 2196.1232122011697, 2196.1232122011697, 5284.064151960679, 5284.064151960679, 3189.6872556955495, 3189.6872556955495, 4201.23086626604, 4201.23086626604, 2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1965264173908218, "mean_inference_ms": 1.1664069622512059, "mean_action_processing_ms": 0.12733467319893238, "mean_env_wait_ms": 3.375384099295057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 872000, "timesteps_this_iter": 0, "agent_timesteps_total": 1744000, "timers": {"sample_time_ms": 7105.221, "sample_throughput": 1125.933, "load_time_ms": 0.133, "load_throughput": 60295475.292, "learn_time_ms": 912.852, "learn_throughput": 8763.742, "update_time_ms": 1.555}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.4681536754324044e-06, "cur_lr": 0.0005, "total_loss": 246478.15625, "policy_loss": 0.0028132831312717597, "vf_loss": 246478.203125, "vf_explained_var": -0.0003699064254760742, "kl": 0.023869782687025845, "entropy": 4.5592942237854, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 872000, "num_agent_steps_sampled": 1744000, "num_steps_trained": 872000, "num_agent_steps_trained": 1744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1090, "training_iteration": 109, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-51", "timestamp": 1718802831, "time_this_iter_s": 5.011841058731079, "time_total_s": 576.4208071231842, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a477550>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 576.4208071231842, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 56.72857142857142, "ram_util_percent": 36.1}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 8887.651297495793, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4443.825648747897}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5923.3144512405015, 8773.90891427626, 3600.0, 7661.22072253947, 5221.876548054543, 7888.3051362106435, 7360.506130898857, 8311.133166340744, 6750.9148557697645, 11243.681844207964, 7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2961.6572256202508, 2961.6572256202508, 4386.95445713813, 4386.95445713813, 1800.0, 1800.0, 3830.610361269735, 3830.610361269735, 2610.9382740272713, 2610.9382740272713, 3944.1525681053217, 3944.1525681053217, 3680.2530654494285, 3680.2530654494285, 4155.566583170374, 4155.566583170374, 3375.4574278848822, 3375.4574278848822, 5621.840922104007, 5621.840922104007, 3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19650721483304362, "mean_inference_ms": 1.1663515201735442, "mean_action_processing_ms": 0.12733081208965025, "mean_env_wait_ms": 3.3752362060961723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 880000, "timesteps_this_iter": 0, "agent_timesteps_total": 1760000, "timers": {"sample_time_ms": 7102.419, "sample_throughput": 1126.377, "load_time_ms": 0.134, "load_throughput": 59918628.571, "learn_time_ms": 908.886, "learn_throughput": 8801.989, "update_time_ms": 1.555}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2022305131486067e-06, "cur_lr": 0.0005, "total_loss": 234545.4, "policy_loss": 0.004223434065841048, "vf_loss": 234545.434375, "vf_explained_var": -0.00028541088104248045, "kl": 0.03481363579684048, "entropy": 4.459845066070557, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 880000, "num_agent_steps_sampled": 1760000, "num_steps_trained": 880000, "num_agent_steps_trained": 1760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1100, "training_iteration": 110, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-13-56", "timestamp": 1718802836, "time_this_iter_s": 4.808398008346558, "time_total_s": 581.2292051315308, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4773a0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 581.2292051315308, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 53.59999999999999, "ram_util_percent": 36.028571428571425}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 9047.325493057671, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4523.662746528836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7437.165497945753, 2600.0, 8228.383462975533, 5107.104563616311, 7979.703024445616, 6870.723872545001, 5086.152348404954, 7671.318520076211, 11592.448374023763, 15343.032953506237, 11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3718.5827489728763, 3718.5827489728763, 1300.0, 1300.0, 4114.1917314877655, 4114.1917314877655, 2553.5522818081554, 2553.5522818081554, 3989.851512222808, 3989.851512222808, 3435.3619362725003, 3435.3619362725003, 2543.0761742024824, 2543.0761742024824, 3835.6592600381055, 3835.6592600381055, 5796.224187011892, 5796.224187011892, 7671.5164767531205, 7671.5164767531205, 5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19649131723059457, "mean_inference_ms": 1.166295490602634, "mean_action_processing_ms": 0.1273262185280348, "mean_env_wait_ms": 3.375085928483303, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 888000, "timesteps_this_iter": 0, "agent_timesteps_total": 1776000, "timers": {"sample_time_ms": 4887.222, "sample_throughput": 1636.922, "load_time_ms": 0.135, "load_throughput": 59137173.07, "learn_time_ms": 908.386, "learn_throughput": 8806.825, "update_time_ms": 1.569}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.30334576972291e-06, "cur_lr": 0.0005, "total_loss": 244581.790625, "policy_loss": 0.003258541405946147, "vf_loss": 244581.834375, "vf_explained_var": -0.0006888151168823242, "kl": 0.027890370414398513, "entropy": 4.081483936309814, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 888000, "num_agent_steps_sampled": 1776000, "num_steps_trained": 888000, "num_agent_steps_trained": 1776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1110, "training_iteration": 111, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-01", "timestamp": 1718802841, "time_this_iter_s": 4.842859983444214, "time_total_s": 586.072065114975, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a477ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 586.072065114975, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 54.39999999999999, "ram_util_percent": 36.07142857142857}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 9182.629559745212, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4591.314779872606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11140.660260126318, 11805.658790212194, 6079.877861046993, 5363.932669875132, 8502.669195544691, 16139.523231716488, 10095.861490295898, 9893.188724699208, 12297.069865349236, 11839.304033387805, 11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5570.330130063154, 5570.330130063154, 5902.829395106087, 5902.829395106087, 3039.9389305234963, 3039.9389305234963, 2681.966334937566, 2681.966334937566, 4251.334597772347, 4251.334597772347, 8069.761615858246, 8069.761615858246, 5047.930745147944, 5047.930745147944, 4946.594362349607, 4946.594362349607, 6148.534932674616, 6148.534932674616, 5919.652016693913, 5919.652016693913, 5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19647994273852917, "mean_inference_ms": 1.1662511365546866, "mean_action_processing_ms": 0.1273232246460504, "mean_env_wait_ms": 3.3750193895230995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 896000, "timesteps_this_iter": 0, "agent_timesteps_total": 1792000, "timers": {"sample_time_ms": 4893.473, "sample_throughput": 1634.831, "load_time_ms": 0.135, "load_throughput": 59158025.388, "learn_time_ms": 903.75, "learn_throughput": 8852.006, "update_time_ms": 1.562}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.955018654584365e-06, "cur_lr": 0.0005, "total_loss": 246355.215625, "policy_loss": 0.002147234801575593, "vf_loss": 246355.265625, "vf_explained_var": -0.000225830078125, "kl": 0.022701733187643368, "entropy": 4.367468738555909, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 896000, "num_agent_steps_sampled": 1792000, "num_steps_trained": 896000, "num_agent_steps_trained": 1792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1120, "training_iteration": 112, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-05", "timestamp": 1718802845, "time_this_iter_s": 4.91668701171875, "time_total_s": 590.9887521266937, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fc10>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 590.9887521266937, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 54.942857142857136, "ram_util_percent": 36.0}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 9231.985341133943, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4615.992670566971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11067.398335415328, 8455.264112215013, 9888.629786507434, 11262.327219638533, 2800.0, 12040.232004546811, 12719.92376598149, 4582.120673382769, 7365.1650973006945, 7392.590364438896, 14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5533.699167707659, 5533.699167707659, 4227.632056107508, 4227.632056107508, 4944.314893253728, 4944.314893253728, 5631.16360981926, 5631.16360981926, 1400.0, 1400.0, 6020.116002273395, 6020.116002273395, 6359.96188299077, 6359.96188299077, 2291.0603366913847, 2291.0603366913847, 3682.5825486503472, 3682.5825486503472, 3696.295182219448, 3696.295182219448, 7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19648903860435316, "mean_inference_ms": 1.1662218859565747, "mean_action_processing_ms": 0.1273215102629799, "mean_env_wait_ms": 3.3750858270456394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 904000, "timesteps_this_iter": 0, "agent_timesteps_total": 1808000, "timers": {"sample_time_ms": 4908.526, "sample_throughput": 1629.817, "load_time_ms": 0.136, "load_throughput": 58991617.44, "learn_time_ms": 901.058, "learn_throughput": 8878.449, "update_time_ms": 1.567}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.432527981876546e-06, "cur_lr": 0.0005, "total_loss": 361655.33125, "policy_loss": 0.0025714175360278093, "vf_loss": 361655.375, "vf_explained_var": -0.00025975704193115234, "kl": 0.02093725949621379, "entropy": 4.818638896942138, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 904000, "num_agent_steps_sampled": 1808000, "num_steps_trained": 904000, "num_agent_steps_trained": 1808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1130, "training_iteration": 113, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-10", "timestamp": 1718802850, "time_this_iter_s": 5.037639617919922, "time_total_s": 596.0263917446136, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 596.0263917446136, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 55.65714285714285, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 9131.162654718004, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4565.581327359002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14452.990733067472, 13367.868387021677, 6400.0, 14642.196930425529, 11611.495636953918, 9242.041317734944, 13423.745645976163, 4851.40039573114, 9321.78936806343, 3200.0, 5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7226.495366533731, 7226.495366533731, 6683.934193510842, 6683.934193510842, 3200.0, 3200.0, 7321.098465212748, 7321.098465212748, 5805.747818476965, 5805.747818476965, 4621.020658867468, 4621.020658867468, 6711.872822988076, 6711.872822988076, 2425.70019786557, 2425.70019786557, 4660.894684031711, 4660.894684031711, 1600.0, 1600.0, 2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19649821990672045, "mean_inference_ms": 1.1661969375651642, "mean_action_processing_ms": 0.1273198929292703, "mean_env_wait_ms": 3.3751330762334506, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 912000, "timesteps_this_iter": 0, "agent_timesteps_total": 1824000, "timers": {"sample_time_ms": 4901.221, "sample_throughput": 1632.246, "load_time_ms": 0.135, "load_throughput": 59335865.606, "learn_time_ms": 901.076, "learn_throughput": 8878.279, "update_time_ms": 1.552}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.114879197281482e-05, "cur_lr": 0.0005, "total_loss": 182563.121875, "policy_loss": 0.0156174825489515, "vf_loss": 182563.140625, "vf_explained_var": -0.0007257223129272461, "kl": 0.0550731454053641, "entropy": 4.019289159774781, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 912000, "num_agent_steps_sampled": 1824000, "num_steps_trained": 912000, "num_agent_steps_trained": 1824000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1140, "training_iteration": 114, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-15", "timestamp": 1718802855, "time_this_iter_s": 4.833586931228638, "time_total_s": 600.8599786758423, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a477e50>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 600.8599786758423, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 53.800000000000004, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 9090.678653830948, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4545.339326915473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5800.978866227921, 7089.797938432768, 11189.822432040102, 5749.133495338352, 7582.19011346476, 12778.36448524124, 10867.960216461557, 5200.0, 10764.692495702053, 1600.0, 7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [2900.4894331139603, 2900.4894331139603, 3544.898969216384, 3544.898969216384, 5594.9112160200575, 5594.9112160200575, 2874.566747669176, 2874.566747669176, 3791.09505673238, 3791.09505673238, 6389.18224262062, 6389.18224262062, 5433.98010823077, 5433.98010823077, 2600.0, 2600.0, 5382.346247851028, 5382.346247851028, 800.0, 800.0, 3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19650946179842874, "mean_inference_ms": 1.1661793098620095, "mean_action_processing_ms": 0.12731874400251356, "mean_env_wait_ms": 3.37509615069401, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 920000, "timesteps_this_iter": 0, "agent_timesteps_total": 1840000, "timers": {"sample_time_ms": 4895.942, "sample_throughput": 1634.006, "load_time_ms": 0.134, "load_throughput": 59705395.018, "learn_time_ms": 898.8, "learn_throughput": 8900.754, "update_time_ms": 1.514}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.672318795922223e-05, "cur_lr": 0.0005, "total_loss": 268534.83125, "policy_loss": 0.013947112251818083, "vf_loss": 268534.8625, "vf_explained_var": 2.8729438781738283e-06, "kl": 0.04126668274504991, "entropy": 4.451475143432617, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 920000, "num_agent_steps_sampled": 1840000, "num_steps_trained": 920000, "num_agent_steps_trained": 1840000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1150, "training_iteration": 115, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-20", "timestamp": 1718802860, "time_this_iter_s": 4.869856834411621, "time_total_s": 605.7298355102539, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a4779d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 605.7298355102539, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 54.228571428571435, "ram_util_percent": 36.08571428571428}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 9435.649336774706, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4717.824668387352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7738.770111866528, 9131.139570725594, 9238.369226557905, 5167.90702703016, 10693.270097919918, 13161.935817432844, 10059.325514719658, 4400.0, 10477.883729553774, 6314.7292394239685, 6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3869.385055933264, 3869.385055933264, 4565.569785362801, 4565.569785362801, 4619.184613278958, 4619.184613278958, 2583.95351351508, 2583.95351351508, 5346.635048959959, 5346.635048959959, 6580.967908716433, 6580.967908716433, 5029.6627573598325, 5029.6627573598325, 2200.0, 2200.0, 5238.941864776882, 5238.941864776882, 3157.3646197119842, 3157.3646197119842, 3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19651999711563037, "mean_inference_ms": 1.1661656271217025, "mean_action_processing_ms": 0.1273190885207513, "mean_env_wait_ms": 3.3751027408915752, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 928000, "timesteps_this_iter": 0, "agent_timesteps_total": 1856000, "timers": {"sample_time_ms": 4895.671, "sample_throughput": 1634.097, "load_time_ms": 0.131, "load_throughput": 60941576.462, "learn_time_ms": 895.705, "learn_throughput": 8931.514, "update_time_ms": 1.484}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.5084781938833343e-05, "cur_lr": 0.0005, "total_loss": 380053.95, "policy_loss": 0.0014197094879591532, "vf_loss": 380053.975, "vf_explained_var": -0.0001962423324584961, "kl": 0.022061610222802806, "entropy": 4.287150764465332, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 928000, "num_agent_steps_sampled": 1856000, "num_steps_trained": 928000, "num_agent_steps_trained": 1856000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1160, "training_iteration": 116, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-25", "timestamp": 1718802865, "time_this_iter_s": 4.811367988586426, "time_total_s": 610.5412034988403, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fca0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 610.5412034988403, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 53.77142857142858, "ram_util_percent": 36.042857142857144}}
{"episode_reward_max": 16655.816749651654, "episode_reward_min": 1400.0, "episode_reward_mean": 9183.557496643478, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8327.908374825822}, "policy_reward_mean": {"shared_policy": 4591.778748321739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6766.6644417095995, 10932.621048835692, 16655.816749651654, 7149.936419096055, 9845.833972562818, 9566.300595908477, 11064.643230399772, 10694.52518360229, 13450.041827437326, 14314.602943167938, 16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3383.3322208547997, 3383.3322208547997, 5466.310524417844, 5466.310524417844, 8327.908374825822, 8327.908374825822, 3574.9682095480275, 3574.9682095480275, 4922.916986281399, 4922.916986281399, 4783.150297954228, 4783.150297954228, 5532.321615199888, 5532.321615199888, 5347.262591801159, 5347.262591801159, 6725.020913718674, 6725.020913718674, 7157.301471583967, 7157.301471583967, 8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19653392437159017, "mean_inference_ms": 1.1661694631592898, "mean_action_processing_ms": 0.12732145600356673, "mean_env_wait_ms": 3.37516278001289, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 936000, "timesteps_this_iter": 0, "agent_timesteps_total": 1872000, "timers": {"sample_time_ms": 4897.658, "sample_throughput": 1633.434, "load_time_ms": 0.131, "load_throughput": 61008058.182, "learn_time_ms": 892.343, "learn_throughput": 8965.16, "update_time_ms": 1.479}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.762717290825002e-05, "cur_lr": 0.0005, "total_loss": 136328.94375, "policy_loss": 0.0027549273857260916, "vf_loss": 136328.978125, "vf_explained_var": 0.00015459060668945312, "kl": 0.024792726897304707, "entropy": 3.5774096965789797, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 936000, "num_agent_steps_sampled": 1872000, "num_steps_trained": 936000, "num_agent_steps_trained": 1872000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1170, "training_iteration": 117, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-30", "timestamp": 1718802870, "time_this_iter_s": 4.859064817428589, "time_total_s": 615.4002683162689, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a477790>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 615.4002683162689, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 54.357142857142854, "ram_util_percent": 36.07142857142857}}
{"episode_reward_max": 16273.29381250959, "episode_reward_min": 1400.0, "episode_reward_mean": 8935.907736890738, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 700.0}, "policy_reward_max": {"shared_policy": 8136.646906254806}, "policy_reward_mean": {"shared_policy": 4467.953868445369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16163.646464886668, 12308.269328445473, 6597.701226160309, 8873.056403866427, 9127.402648116222, 11718.841672887094, 6360.115431793294, 4548.755324309728, 4998.850463716626, 8988.182744664151, 12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [8081.823232443334, 8081.823232443334, 6154.134664222733, 6154.134664222733, 3298.8506130801543, 3298.8506130801543, 4436.5282019332135, 4436.5282019332135, 4563.701324058107, 4563.701324058107, 5859.420836443547, 5859.420836443547, 3180.057715896647, 3180.057715896647, 2274.377662154864, 2274.377662154864, 2499.425231858313, 2499.425231858313, 4494.091372332074, 4494.091372332074, 6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19655082371112978, "mean_inference_ms": 1.1661821658145781, "mean_action_processing_ms": 0.12732430985030457, "mean_env_wait_ms": 3.3752537902807513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 944000, "timesteps_this_iter": 0, "agent_timesteps_total": 1888000, "timers": {"sample_time_ms": 4899.214, "sample_throughput": 1632.915, "load_time_ms": 0.131, "load_throughput": 61230715.328, "learn_time_ms": 892.242, "learn_throughput": 8966.175, "update_time_ms": 1.458}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.6440759362375025e-05, "cur_lr": 0.0005, "total_loss": 241184.528125, "policy_loss": 0.0040581120919437556, "vf_loss": 241184.56875, "vf_explained_var": -0.0001605987548828125, "kl": 0.02790387645449629, "entropy": 4.207495880126953, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 944000, "num_agent_steps_sampled": 1888000, "num_steps_trained": 944000, "num_agent_steps_trained": 1888000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1180, "training_iteration": 118, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-35", "timestamp": 1718802875, "time_this_iter_s": 4.858394145965576, "time_total_s": 620.2586624622345, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a477040>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 620.2586624622345, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 62.19999999999999, "ram_util_percent": 36.06666666666667}}
{"episode_reward_max": 16273.29381250959, "episode_reward_min": 800.0, "episode_reward_mean": 8827.8671033416, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 400.0}, "policy_reward_max": {"shared_policy": 8136.646906254806}, "policy_reward_mean": {"shared_policy": 4413.9335516708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12365.418815056611, 6322.997579005954, 10442.42661633496, 8264.498358047222, 13532.429768768205, 11082.203161212656, 11927.25666806359, 3000.0, 1400.0, 3400.0, 12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606, 1800.0, 800.0, 7502.422298539059, 10488.388162058043, 9887.586663625403, 6171.350997539894, 10985.289682013386, 12306.88646605072, 8429.631876581272, 10509.202207524479], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6182.709407528304, 6182.709407528304, 3161.498789502977, 3161.498789502977, 5221.213308167469, 5221.213308167469, 4132.249179023613, 4132.249179023613, 6766.214884384086, 6766.214884384086, 5541.10158060633, 5541.10158060633, 5963.628334031797, 5963.628334031797, 1500.0, 1500.0, 700.0, 700.0, 1700.0, 1700.0, 6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803, 900.0, 900.0, 400.0, 400.0, 3751.2111492695294, 3751.2111492695294, 5244.1940810290125, 5244.1940810290125, 4943.7933318127025, 4943.7933318127025, 3085.675498769947, 3085.675498769947, 5492.644841006691, 5492.644841006691, 6153.443233025362, 6153.443233025362, 4214.815938290636, 4214.815938290636, 5254.601103762232, 5254.601103762232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19656725472894263, "mean_inference_ms": 1.1661668378720735, "mean_action_processing_ms": 0.12732456971421968, "mean_env_wait_ms": 3.3752658135813896, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 952000, "timesteps_this_iter": 0, "agent_timesteps_total": 1904000, "timers": {"sample_time_ms": 4888.303, "sample_throughput": 1636.56, "load_time_ms": 0.132, "load_throughput": 60404018.002, "learn_time_ms": 892.358, "learn_throughput": 8965.013, "update_time_ms": 1.469}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.466113904356255e-05, "cur_lr": 0.0005, "total_loss": 187564.28125, "policy_loss": 0.003120783816649464, "vf_loss": 187564.31875, "vf_explained_var": 4.678964614868164e-05, "kl": 0.02150965556633156, "entropy": 4.449172019958496, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 952000, "num_agent_steps_sampled": 1904000, "num_steps_trained": 952000, "num_agent_steps_trained": 1904000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1190, "training_iteration": 119, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-40", "timestamp": 1718802880, "time_this_iter_s": 4.906663417816162, "time_total_s": 625.1653258800507, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a51fa60>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 625.1653258800507, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 54.357142857142854, "ram_util_percent": 36.1}}
{"episode_reward_max": 16273.29381250959, "episode_reward_min": 800.0, "episode_reward_mean": 8876.810248285463, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 400.0}, "policy_reward_max": {"shared_policy": 8136.646906254806}, "policy_reward_mean": {"shared_policy": 4438.405124142731}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12351.79537867683, 12445.180716657178, 7443.549573413116, 7484.286042474696, 13158.337158684535, 3200.0, 10491.124969386652, 4977.6044263853255, 9469.759841897849, 7680.64321815051, 7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606, 1800.0, 800.0, 7502.422298539059, 10488.388162058043, 9887.586663625403, 6171.350997539894, 10985.289682013386, 12306.88646605072, 8429.631876581272, 10509.202207524479, 12463.310807711343, 7889.818153832581, 10633.164343202094, 13272.574365862343, 8066.1868756979675, 2400.0, 10388.979016527217, 12117.51189804182, 4800.0, 4600.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6175.897689338415, 6175.897689338415, 6222.590358328589, 6222.590358328589, 3721.774786706558, 3721.774786706558, 3742.143021237348, 3742.143021237348, 6579.168579342271, 6579.168579342271, 1600.0, 1600.0, 5245.562484693322, 5245.562484693322, 2488.8022131926627, 2488.8022131926627, 4734.879920948932, 4734.879920948932, 3840.321609075255, 3840.321609075255, 3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803, 900.0, 900.0, 400.0, 400.0, 3751.2111492695294, 3751.2111492695294, 5244.1940810290125, 5244.1940810290125, 4943.7933318127025, 4943.7933318127025, 3085.675498769947, 3085.675498769947, 5492.644841006691, 5492.644841006691, 6153.443233025362, 6153.443233025362, 4214.815938290636, 4214.815938290636, 5254.601103762232, 5254.601103762232, 6231.65540385567, 6231.65540385567, 3944.9090769162904, 3944.9090769162904, 5316.582171601051, 5316.582171601051, 6636.287182931192, 6636.287182931192, 4033.0934378489837, 4033.0934378489837, 1200.0, 1200.0, 5194.489508263606, 5194.489508263606, 6058.755949020911, 6058.755949020911, 2400.0, 2400.0, 2300.0, 2300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19658633725587676, "mean_inference_ms": 1.1661791278075804, "mean_action_processing_ms": 0.12732832891645557, "mean_env_wait_ms": 3.3754276132412224, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 960000, "timesteps_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"sample_time_ms": 4909.815, "sample_throughput": 1629.389, "load_time_ms": 0.132, "load_throughput": 60677092.224, "learn_time_ms": 893.964, "learn_throughput": 8948.906, "update_time_ms": 1.486}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00012699170856534381, "cur_lr": 0.0005, "total_loss": 226012.353125, "policy_loss": 0.0021704861454665547, "vf_loss": 226012.38125, "vf_explained_var": -0.00015766620635986327, "kl": 0.025532004983255963, "entropy": 3.8554853439331054, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 1920000, "num_steps_trained": 960000, "num_agent_steps_trained": 1920000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1200, "training_iteration": 120, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-45", "timestamp": 1718802885, "time_this_iter_s": 5.039287090301514, "time_total_s": 630.2046129703522, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9af0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 630.2046129703522, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 50.15, "ram_util_percent": 36.1}}
{"episode_reward_max": 18035.825212535798, "episode_reward_min": 800.0, "episode_reward_mean": 8888.595069009714, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 400.0}, "policy_reward_max": {"shared_policy": 9017.912606267895}, "policy_reward_mean": {"shared_policy": 4444.297534504857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7858.278803358098, 7641.241987867066, 10908.736642691212, 7407.677993512674, 9364.095595773426, 7936.260547904789, 9617.743524748206, 12596.851991115207, 11194.110099183305, 6921.442100139408, 12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606, 1800.0, 800.0, 7502.422298539059, 10488.388162058043, 9887.586663625403, 6171.350997539894, 10985.289682013386, 12306.88646605072, 8429.631876581272, 10509.202207524479, 12463.310807711343, 7889.818153832581, 10633.164343202094, 13272.574365862343, 8066.1868756979675, 2400.0, 10388.979016527217, 12117.51189804182, 4800.0, 4600.0, 10240.280711336749, 6957.061514587109, 5233.231711495348, 7127.132684188509, 7226.914847877655, 12268.144096581651, 8496.72444757024, 18035.825212535798, 6753.016425955082, 7542.4317460237235], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [3929.139401679049, 3929.139401679049, 3820.620993933533, 3820.620993933533, 5454.368321345604, 5454.368321345604, 3703.838996756337, 3703.838996756337, 4682.047797886716, 4682.047797886716, 3968.1302739523944, 3968.1302739523944, 4808.871762374105, 4808.871762374105, 6298.425995557596, 6298.425995557596, 5597.055049591656, 5597.055049591656, 3460.721050069704, 3460.721050069704, 6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803, 900.0, 900.0, 400.0, 400.0, 3751.2111492695294, 3751.2111492695294, 5244.1940810290125, 5244.1940810290125, 4943.7933318127025, 4943.7933318127025, 3085.675498769947, 3085.675498769947, 5492.644841006691, 5492.644841006691, 6153.443233025362, 6153.443233025362, 4214.815938290636, 4214.815938290636, 5254.601103762232, 5254.601103762232, 6231.65540385567, 6231.65540385567, 3944.9090769162904, 3944.9090769162904, 5316.582171601051, 5316.582171601051, 6636.287182931192, 6636.287182931192, 4033.0934378489837, 4033.0934378489837, 1200.0, 1200.0, 5194.489508263606, 5194.489508263606, 6058.755949020911, 6058.755949020911, 2400.0, 2400.0, 2300.0, 2300.0, 5120.140355668373, 5120.140355668373, 3478.5307572935544, 3478.5307572935544, 2616.615855747674, 2616.615855747674, 3563.5663420942547, 3563.5663420942547, 3613.4574239388276, 3613.4574239388276, 6134.072048290818, 6134.072048290818, 4248.36222378512, 4248.36222378512, 9017.912606267895, 9017.912606267895, 3376.508212977541, 3376.508212977541, 3771.2158730118617, 3771.2158730118617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19661281641871547, "mean_inference_ms": 1.166251213306193, "mean_action_processing_ms": 0.12733794002621077, "mean_env_wait_ms": 3.3758247525524308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 968000, "timesteps_this_iter": 0, "agent_timesteps_total": 1936000, "timers": {"sample_time_ms": 4943.514, "sample_throughput": 1618.282, "load_time_ms": 0.13, "load_throughput": 61612985.678, "learn_time_ms": 892.218, "learn_throughput": 8966.419, "update_time_ms": 1.487}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00019048756284801573, "cur_lr": 0.0005, "total_loss": 252707.634375, "policy_loss": 0.00327953945994377, "vf_loss": 252707.68125, "vf_explained_var": -6.322860717773437e-05, "kl": 0.02038749344704779, "entropy": 4.315781974792481, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 968000, "num_agent_steps_sampled": 1936000, "num_steps_trained": 968000, "num_agent_steps_trained": 1936000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1210, "training_iteration": 121, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-50", "timestamp": 1718802890, "time_this_iter_s": 5.146283864974976, "time_total_s": 635.3508968353271, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f9ee0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 635.3508968353271, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 57.57142857142857, "ram_util_percent": 36.07142857142857}}
{"episode_reward_max": 18035.825212535798, "episode_reward_min": 800.0, "episode_reward_mean": 8981.414812416806, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 400.0}, "policy_reward_max": {"shared_policy": 9017.912606267895}, "policy_reward_mean": {"shared_policy": 4490.707406208403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12480.325173913727, 10868.773471398355, 11537.504900225325, 16273.29381250959, 8900.427627493606, 3400.0, 13646.99710634907, 7469.300811094492, 15321.01040040527, 8195.690957737625, 10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606, 1800.0, 800.0, 7502.422298539059, 10488.388162058043, 9887.586663625403, 6171.350997539894, 10985.289682013386, 12306.88646605072, 8429.631876581272, 10509.202207524479, 12463.310807711343, 7889.818153832581, 10633.164343202094, 13272.574365862343, 8066.1868756979675, 2400.0, 10388.979016527217, 12117.51189804182, 4800.0, 4600.0, 10240.280711336749, 6957.061514587109, 5233.231711495348, 7127.132684188509, 7226.914847877655, 12268.144096581651, 8496.72444757024, 18035.825212535798, 6753.016425955082, 7542.4317460237235, 7939.498712943878, 7925.056702009733, 5537.500042268561, 12690.205358969728, 11034.428298054201, 14098.661053394724, 8065.912786295819, 11283.799484124182, 11350.285279370884, 10803.065909570942], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [6240.162586956869, 6240.162586956869, 5434.386735699177, 5434.386735699177, 5768.75245011267, 5768.75245011267, 8136.646906254806, 8136.646906254806, 4450.2138137467955, 4450.2138137467955, 1700.0, 1700.0, 6823.498553174521, 6823.498553174521, 3734.650405547246, 3734.650405547246, 7660.50520020263, 7660.50520020263, 4097.845478868812, 4097.845478868812, 5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803, 900.0, 900.0, 400.0, 400.0, 3751.2111492695294, 3751.2111492695294, 5244.1940810290125, 5244.1940810290125, 4943.7933318127025, 4943.7933318127025, 3085.675498769947, 3085.675498769947, 5492.644841006691, 5492.644841006691, 6153.443233025362, 6153.443233025362, 4214.815938290636, 4214.815938290636, 5254.601103762232, 5254.601103762232, 6231.65540385567, 6231.65540385567, 3944.9090769162904, 3944.9090769162904, 5316.582171601051, 5316.582171601051, 6636.287182931192, 6636.287182931192, 4033.0934378489837, 4033.0934378489837, 1200.0, 1200.0, 5194.489508263606, 5194.489508263606, 6058.755949020911, 6058.755949020911, 2400.0, 2400.0, 2300.0, 2300.0, 5120.140355668373, 5120.140355668373, 3478.5307572935544, 3478.5307572935544, 2616.615855747674, 2616.615855747674, 3563.5663420942547, 3563.5663420942547, 3613.4574239388276, 3613.4574239388276, 6134.072048290818, 6134.072048290818, 4248.36222378512, 4248.36222378512, 9017.912606267895, 9017.912606267895, 3376.508212977541, 3376.508212977541, 3771.2158730118617, 3771.2158730118617, 3969.749356471939, 3969.749356471939, 3962.5283510048666, 3962.5283510048666, 2768.7500211342804, 2768.7500211342804, 6345.102679484857, 6345.102679484857, 5517.21414902711, 5517.21414902711, 7049.330526697342, 7049.330526697342, 4032.9563931479097, 4032.9563931479097, 5641.899742062087, 5641.899742062087, 5675.142639685442, 5675.142639685442, 5401.532954785469, 5401.532954785469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19663840280160208, "mean_inference_ms": 1.1663144566310009, "mean_action_processing_ms": 0.12734643710829105, "mean_env_wait_ms": 3.376136244224726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 976000, "timesteps_this_iter": 0, "agent_timesteps_total": 1952000, "timers": {"sample_time_ms": 4934.76, "sample_throughput": 1621.153, "load_time_ms": 0.131, "load_throughput": 61286633.79, "learn_time_ms": 892.036, "learn_throughput": 8968.252, "update_time_ms": 1.493}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002857313442720236, "cur_lr": 0.0005, "total_loss": 284632.08125, "policy_loss": 0.0021223742851987026, "vf_loss": 284632.11875, "vf_explained_var": -0.0010903120040893556, "kl": 0.016722272895837793, "entropy": 4.7825898170471195, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 976000, "num_agent_steps_sampled": 1952000, "num_steps_trained": 976000, "num_agent_steps_trained": 1952000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1220, "training_iteration": 122, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-14-55", "timestamp": 1718802895, "time_this_iter_s": 4.842710018157959, "time_total_s": 640.1936068534851, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a5695e0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 640.1936068534851, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 53.74285714285714, "ram_util_percent": 35.9}}
{"episode_reward_max": 18035.825212535798, "episode_reward_min": 800.0, "episode_reward_mean": 8818.134561550321, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 400.0}, "policy_reward_max": {"shared_policy": 9017.912606267895}, "policy_reward_mean": {"shared_policy": 4409.067280775161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10869.773463326226, 4400.0, 6771.791640664185, 3400.0, 7368.974518703104, 7912.273727515843, 9200.014238246182, 7797.424963180041, 12803.328164086546, 6967.802002111001, 14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606, 1800.0, 800.0, 7502.422298539059, 10488.388162058043, 9887.586663625403, 6171.350997539894, 10985.289682013386, 12306.88646605072, 8429.631876581272, 10509.202207524479, 12463.310807711343, 7889.818153832581, 10633.164343202094, 13272.574365862343, 8066.1868756979675, 2400.0, 10388.979016527217, 12117.51189804182, 4800.0, 4600.0, 10240.280711336749, 6957.061514587109, 5233.231711495348, 7127.132684188509, 7226.914847877655, 12268.144096581651, 8496.72444757024, 18035.825212535798, 6753.016425955082, 7542.4317460237235, 7939.498712943878, 7925.056702009733, 5537.500042268561, 12690.205358969728, 11034.428298054201, 14098.661053394724, 8065.912786295819, 11283.799484124182, 11350.285279370884, 10803.065909570942, 8454.272183712103, 7840.058716418342, 9154.845370665975, 8780.332805511429, 9970.116476052466, 16336.217148707747, 6101.900918019215, 10250.444037070713, 7862.682939656168, 7014.4285786644305], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [5434.8867316631295, 5434.8867316631295, 2200.0, 2200.0, 3385.8958203320926, 3385.8958203320926, 1700.0, 1700.0, 3684.487259351552, 3684.487259351552, 3956.1368637579217, 3956.1368637579217, 4600.007119123093, 4600.007119123093, 3898.7124815900206, 3898.7124815900206, 6401.664082043269, 6401.664082043269, 3483.9010010555003, 3483.9010010555003, 7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803, 900.0, 900.0, 400.0, 400.0, 3751.2111492695294, 3751.2111492695294, 5244.1940810290125, 5244.1940810290125, 4943.7933318127025, 4943.7933318127025, 3085.675498769947, 3085.675498769947, 5492.644841006691, 5492.644841006691, 6153.443233025362, 6153.443233025362, 4214.815938290636, 4214.815938290636, 5254.601103762232, 5254.601103762232, 6231.65540385567, 6231.65540385567, 3944.9090769162904, 3944.9090769162904, 5316.582171601051, 5316.582171601051, 6636.287182931192, 6636.287182931192, 4033.0934378489837, 4033.0934378489837, 1200.0, 1200.0, 5194.489508263606, 5194.489508263606, 6058.755949020911, 6058.755949020911, 2400.0, 2400.0, 2300.0, 2300.0, 5120.140355668373, 5120.140355668373, 3478.5307572935544, 3478.5307572935544, 2616.615855747674, 2616.615855747674, 3563.5663420942547, 3563.5663420942547, 3613.4574239388276, 3613.4574239388276, 6134.072048290818, 6134.072048290818, 4248.36222378512, 4248.36222378512, 9017.912606267895, 9017.912606267895, 3376.508212977541, 3376.508212977541, 3771.2158730118617, 3771.2158730118617, 3969.749356471939, 3969.749356471939, 3962.5283510048666, 3962.5283510048666, 2768.7500211342804, 2768.7500211342804, 6345.102679484857, 6345.102679484857, 5517.21414902711, 5517.21414902711, 7049.330526697342, 7049.330526697342, 4032.9563931479097, 4032.9563931479097, 5641.899742062087, 5641.899742062087, 5675.142639685442, 5675.142639685442, 5401.532954785469, 5401.532954785469, 4227.136091856051, 4227.136091856051, 3920.029358209171, 3920.029358209171, 4577.422685332982, 4577.422685332982, 4390.166402755714, 4390.166402755714, 4985.058238026235, 4985.058238026235, 8168.108574353868, 8168.108574353868, 3050.9504590096076, 3050.9504590096076, 5125.222018535362, 5125.222018535362, 3931.341469828084, 3931.341469828084, 3507.2142893322152, 3507.2142893322152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966390672806269, "mean_inference_ms": 1.1663398817250734, "mean_action_processing_ms": 0.1273501649139228, "mean_env_wait_ms": 3.3762433148463935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 984000, "timesteps_this_iter": 0, "agent_timesteps_total": 1968000, "timers": {"sample_time_ms": 4910.44, "sample_throughput": 1629.182, "load_time_ms": 0.13, "load_throughput": 61500058.651, "learn_time_ms": 896.737, "learn_throughput": 8921.231, "update_time_ms": 1.465}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0002857313442720236, "cur_lr": 0.0005, "total_loss": 242664.61875, "policy_loss": 0.008620889730751457, "vf_loss": 242664.65625, "vf_explained_var": -4.5371055603027346e-05, "kl": 0.03587980568471395, "entropy": 4.4591827392578125, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 984000, "num_agent_steps_sampled": 1968000, "num_steps_trained": 984000, "num_agent_steps_trained": 1968000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1230, "training_iteration": 123, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-15-00", "timestamp": 1718802900, "time_this_iter_s": 4.8434367179870605, "time_total_s": 645.0370435714722, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a5691f0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 645.0370435714722, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 52.78571428571428, "ram_util_percent": 35.957142857142856}}
{"episode_reward_max": 18035.825212535798, "episode_reward_min": 800.0, "episode_reward_mean": 8996.883697611374, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 400.0}, "policy_reward_max": {"shared_policy": 9017.912606267895}, "policy_reward_mean": {"shared_policy": 4498.441848805687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14439.889479800298, 6569.343777208627, 6965.040258620622, 7047.3640268390445, 14763.689117091864, 11024.203220287065, 13425.11811284325, 7067.009422765434, 4993.1072613459655, 10170.363649466286, 14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606, 1800.0, 800.0, 7502.422298539059, 10488.388162058043, 9887.586663625403, 6171.350997539894, 10985.289682013386, 12306.88646605072, 8429.631876581272, 10509.202207524479, 12463.310807711343, 7889.818153832581, 10633.164343202094, 13272.574365862343, 8066.1868756979675, 2400.0, 10388.979016527217, 12117.51189804182, 4800.0, 4600.0, 10240.280711336749, 6957.061514587109, 5233.231711495348, 7127.132684188509, 7226.914847877655, 12268.144096581651, 8496.72444757024, 18035.825212535798, 6753.016425955082, 7542.4317460237235, 7939.498712943878, 7925.056702009733, 5537.500042268561, 12690.205358969728, 11034.428298054201, 14098.661053394724, 8065.912786295819, 11283.799484124182, 11350.285279370884, 10803.065909570942, 8454.272183712103, 7840.058716418342, 9154.845370665975, 8780.332805511429, 9970.116476052466, 16336.217148707747, 6101.900918019215, 10250.444037070713, 7862.682939656168, 7014.4285786644305, 5000.0, 7436.533377214604, 8954.484781092193, 4395.6907789690085, 5839.29499936508, 12284.493835098114, 11664.530316376378, 15653.763823461271, 11309.07244657696, 12828.431965784883], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7219.944739900158, 7219.944739900158, 3284.6718886043145, 3284.6718886043145, 3482.520129310311, 3482.520129310311, 3523.6820134195223, 3523.6820134195223, 7381.844558545941, 7381.844558545941, 5512.101610143534, 5512.101610143534, 6712.559056421618, 6712.559056421618, 3533.504711382717, 3533.504711382717, 2496.5536306729828, 2496.5536306729828, 5085.181824733139, 5085.181824733139, 7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803, 900.0, 900.0, 400.0, 400.0, 3751.2111492695294, 3751.2111492695294, 5244.1940810290125, 5244.1940810290125, 4943.7933318127025, 4943.7933318127025, 3085.675498769947, 3085.675498769947, 5492.644841006691, 5492.644841006691, 6153.443233025362, 6153.443233025362, 4214.815938290636, 4214.815938290636, 5254.601103762232, 5254.601103762232, 6231.65540385567, 6231.65540385567, 3944.9090769162904, 3944.9090769162904, 5316.582171601051, 5316.582171601051, 6636.287182931192, 6636.287182931192, 4033.0934378489837, 4033.0934378489837, 1200.0, 1200.0, 5194.489508263606, 5194.489508263606, 6058.755949020911, 6058.755949020911, 2400.0, 2400.0, 2300.0, 2300.0, 5120.140355668373, 5120.140355668373, 3478.5307572935544, 3478.5307572935544, 2616.615855747674, 2616.615855747674, 3563.5663420942547, 3563.5663420942547, 3613.4574239388276, 3613.4574239388276, 6134.072048290818, 6134.072048290818, 4248.36222378512, 4248.36222378512, 9017.912606267895, 9017.912606267895, 3376.508212977541, 3376.508212977541, 3771.2158730118617, 3771.2158730118617, 3969.749356471939, 3969.749356471939, 3962.5283510048666, 3962.5283510048666, 2768.7500211342804, 2768.7500211342804, 6345.102679484857, 6345.102679484857, 5517.21414902711, 5517.21414902711, 7049.330526697342, 7049.330526697342, 4032.9563931479097, 4032.9563931479097, 5641.899742062087, 5641.899742062087, 5675.142639685442, 5675.142639685442, 5401.532954785469, 5401.532954785469, 4227.136091856051, 4227.136091856051, 3920.029358209171, 3920.029358209171, 4577.422685332982, 4577.422685332982, 4390.166402755714, 4390.166402755714, 4985.058238026235, 4985.058238026235, 8168.108574353868, 8168.108574353868, 3050.9504590096076, 3050.9504590096076, 5125.222018535362, 5125.222018535362, 3931.341469828084, 3931.341469828084, 3507.2142893322152, 3507.2142893322152, 2500.0, 2500.0, 3718.266688607302, 3718.266688607302, 4477.2423905461, 4477.2423905461, 2197.8453894845043, 2197.8453894845043, 2919.64749968254, 2919.64749968254, 6142.246917549068, 6142.246917549068, 5832.26515818818, 5832.26515818818, 7826.881911730636, 7826.881911730636, 5654.536223288472, 5654.536223288472, 6414.215982892447, 6414.215982892447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1966358035307532, "mean_inference_ms": 1.1663583147868268, "mean_action_processing_ms": 0.1273527779470155, "mean_env_wait_ms": 3.376344083660513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 992000, "timesteps_this_iter": 0, "agent_timesteps_total": 1984000, "timers": {"sample_time_ms": 4911.589, "sample_throughput": 1628.801, "load_time_ms": 0.128, "load_throughput": 62706843.581, "learn_time_ms": 897.447, "learn_throughput": 8914.174, "update_time_ms": 1.469}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0004285970164080354, "cur_lr": 0.0005, "total_loss": 289976.55625, "policy_loss": 0.0013882831897589654, "vf_loss": 289976.6125, "vf_explained_var": -0.0005378484725952149, "kl": 0.01768971812069286, "entropy": 4.8927947044372555, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 992000, "num_agent_steps_sampled": 1984000, "num_steps_trained": 992000, "num_agent_steps_trained": 1984000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1240, "training_iteration": 124, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-15-04", "timestamp": 1718802904, "time_this_iter_s": 4.803686141967773, "time_total_s": 649.8407297134399, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a569d30>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 649.8407297134399, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 53.41428571428571, "ram_util_percent": 36.142857142857146}}
{"episode_reward_max": 18035.825212535798, "episode_reward_min": 800.0, "episode_reward_mean": 9087.087185566621, "episode_len_mean": 800.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"shared_policy": 400.0}, "policy_reward_max": {"shared_policy": 9017.912606267895}, "policy_reward_mean": {"shared_policy": 4543.5435927833105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14928.046388377752, 16100.564242683882, 6904.054172590157, 14097.198982235823, 13921.09426943121, 9731.904533011882, 13845.359021160613, 7359.669307912427, 8589.925459963342, 7642.1919599173925, 4000.0, 3600.0, 3400.0, 5000.0, 7392.259455076812, 6595.912682701386, 5200.0, 2200.0, 13861.268425383365, 9924.705758946267, 7772.654954366457, 2600.0, 2400.0, 9072.112859517478, 12538.316143976957, 11295.837403322814, 12323.461322805524, 7116.26351381823, 13324.23398532945, 7233.1302539606, 1800.0, 800.0, 7502.422298539059, 10488.388162058043, 9887.586663625403, 6171.350997539894, 10985.289682013386, 12306.88646605072, 8429.631876581272, 10509.202207524479, 12463.310807711343, 7889.818153832581, 10633.164343202094, 13272.574365862343, 8066.1868756979675, 2400.0, 10388.979016527217, 12117.51189804182, 4800.0, 4600.0, 10240.280711336749, 6957.061514587109, 5233.231711495348, 7127.132684188509, 7226.914847877655, 12268.144096581651, 8496.72444757024, 18035.825212535798, 6753.016425955082, 7542.4317460237235, 7939.498712943878, 7925.056702009733, 5537.500042268561, 12690.205358969728, 11034.428298054201, 14098.661053394724, 8065.912786295819, 11283.799484124182, 11350.285279370884, 10803.065909570942, 8454.272183712103, 7840.058716418342, 9154.845370665975, 8780.332805511429, 9970.116476052466, 16336.217148707747, 6101.900918019215, 10250.444037070713, 7862.682939656168, 7014.4285786644305, 5000.0, 7436.533377214604, 8954.484781092193, 4395.6907789690085, 5839.29499936508, 12284.493835098114, 11664.530316376378, 15653.763823461271, 11309.07244657696, 12828.431965784883, 7930.222867044009, 11846.534591528743, 15720.163669103888, 15023.739960430456, 3775.9223472318026, 8512.635623081856, 16249.990296070257, 12654.990557693527, 9171.277209608586, 4600.0], "episode_lengths": [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800], "policy_shared_policy_reward": [7464.023194188867, 7464.023194188867, 8050.282121341941, 8050.282121341941, 3452.0270862950783, 3452.0270862950783, 7048.599491117911, 7048.599491117911, 6960.547134715598, 6960.547134715598, 4865.9522665059485, 4865.9522665059485, 6922.679510580318, 6922.679510580318, 3679.8346539562135, 3679.8346539562135, 4294.962729981666, 4294.962729981666, 3821.0959799586963, 3821.0959799586963, 2000.0, 2000.0, 1800.0, 1800.0, 1700.0, 1700.0, 2500.0, 2500.0, 3696.129727538406, 3696.129727538406, 3297.956341350693, 3297.956341350693, 2600.0, 2600.0, 1100.0, 1100.0, 6930.634212691692, 6930.634212691692, 4962.35287947314, 4962.35287947314, 3886.3274771832284, 3886.3274771832284, 1300.0, 1300.0, 1200.0, 1200.0, 4536.0564297587425, 4536.0564297587425, 6269.158071988477, 6269.158071988477, 5647.91870166139, 5647.91870166139, 6161.730661402762, 6161.730661402762, 3558.131756909115, 3558.131756909115, 6662.11699266474, 6662.11699266474, 3616.5651269803, 3616.5651269803, 900.0, 900.0, 400.0, 400.0, 3751.2111492695294, 3751.2111492695294, 5244.1940810290125, 5244.1940810290125, 4943.7933318127025, 4943.7933318127025, 3085.675498769947, 3085.675498769947, 5492.644841006691, 5492.644841006691, 6153.443233025362, 6153.443233025362, 4214.815938290636, 4214.815938290636, 5254.601103762232, 5254.601103762232, 6231.65540385567, 6231.65540385567, 3944.9090769162904, 3944.9090769162904, 5316.582171601051, 5316.582171601051, 6636.287182931192, 6636.287182931192, 4033.0934378489837, 4033.0934378489837, 1200.0, 1200.0, 5194.489508263606, 5194.489508263606, 6058.755949020911, 6058.755949020911, 2400.0, 2400.0, 2300.0, 2300.0, 5120.140355668373, 5120.140355668373, 3478.5307572935544, 3478.5307572935544, 2616.615855747674, 2616.615855747674, 3563.5663420942547, 3563.5663420942547, 3613.4574239388276, 3613.4574239388276, 6134.072048290818, 6134.072048290818, 4248.36222378512, 4248.36222378512, 9017.912606267895, 9017.912606267895, 3376.508212977541, 3376.508212977541, 3771.2158730118617, 3771.2158730118617, 3969.749356471939, 3969.749356471939, 3962.5283510048666, 3962.5283510048666, 2768.7500211342804, 2768.7500211342804, 6345.102679484857, 6345.102679484857, 5517.21414902711, 5517.21414902711, 7049.330526697342, 7049.330526697342, 4032.9563931479097, 4032.9563931479097, 5641.899742062087, 5641.899742062087, 5675.142639685442, 5675.142639685442, 5401.532954785469, 5401.532954785469, 4227.136091856051, 4227.136091856051, 3920.029358209171, 3920.029358209171, 4577.422685332982, 4577.422685332982, 4390.166402755714, 4390.166402755714, 4985.058238026235, 4985.058238026235, 8168.108574353868, 8168.108574353868, 3050.9504590096076, 3050.9504590096076, 5125.222018535362, 5125.222018535362, 3931.341469828084, 3931.341469828084, 3507.2142893322152, 3507.2142893322152, 2500.0, 2500.0, 3718.266688607302, 3718.266688607302, 4477.2423905461, 4477.2423905461, 2197.8453894845043, 2197.8453894845043, 2919.64749968254, 2919.64749968254, 6142.246917549068, 6142.246917549068, 5832.26515818818, 5832.26515818818, 7826.881911730636, 7826.881911730636, 5654.536223288472, 5654.536223288472, 6414.215982892447, 6414.215982892447, 3965.1114335220045, 3965.1114335220045, 5923.267295764375, 5923.267295764375, 7860.081834551944, 7860.081834551944, 7511.869980215222, 7511.869980215222, 1887.9611736159013, 1887.9611736159013, 4256.317811540927, 4256.317811540927, 8124.995148035123, 8124.995148035123, 6327.495278846782, 6327.495278846782, 4585.638604804291, 4585.638604804291, 2300.0, 2300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19663120583585617, "mean_inference_ms": 1.1663565616091025, "mean_action_processing_ms": 0.12735277027845723, "mean_env_wait_ms": 3.3764240224228494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1000000, "timesteps_this_iter": 0, "agent_timesteps_total": 2000000, "timers": {"sample_time_ms": 4911.881, "sample_throughput": 1628.704, "load_time_ms": 0.128, "load_throughput": 62730289.774, "learn_time_ms": 898.864, "learn_throughput": 8900.123, "update_time_ms": 1.475}, "info": {"learner": {"shared_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0004285970164080354, "cur_lr": 0.0005, "total_loss": 346158.6, "policy_loss": 0.006997949241846868, "vf_loss": 346158.625, "vf_explained_var": -3.39508056640625e-05, "kl": 0.03257121443845655, "entropy": 4.534241962432861, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1000000, "num_agent_steps_sampled": 2000000, "num_steps_trained": 1000000, "num_agent_steps_trained": 2000000, "num_steps_trained_this_iter": 0}, "done": true, "episodes_total": 1250, "training_iteration": 125, "trial_id": "6b784_00000", "experiment_id": "9fbdd153c7f84aeaba2c5a1a8924c721", "date": "2024-06-19_22-15-09", "timestamp": 1718802909, "time_this_iter_s": 4.881359577178955, "time_total_s": 654.7220892906189, "pid": 1210450, "hostname": "DESKTOP-CUOU9RN", "node_ip": "172.26.35.186", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 320, "batch_mode": "complete_episodes", "gamma": 0.99, "lr": 0.0005, "train_batch_size": 3200, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "Centralized_Critic_Model", "custom_model_config": {"env": "gobigger", "env_args": {"frame_limit": 1600, "map_name": "st_t1p2"}, "mask_flag": false, "global_state_flag": false, "opp_action_in_cc": true, "fixed_batch_timesteps": 3200, "agent_level_batch_update": true, "force_coop": false, "local_mode": false, "share_policy": "group", "evaluation_interval": 50, "framework": "torch", "num_workers": 10, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "checkpoint_freq": 100, "checkpoint_end": true, "restore_path": {"model_path": "", "params_path": ""}, "stop_iters": 9999999, "stop_timesteps": 2000000, "stop_reward": 999999, "seed": 321, "local_dir": "", "model_arch_args": {"hidden_state_size": 256, "core_arch": "mlp", "fc_layer": 2, "out_dim_fc_0": 128, "out_dim_fc_1": 64, "encode_layer": "128-256"}, "algo_args": {"use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "batch_episode": 64, "num_sgd_iter": 5, "vf_loss_coeff": 1.0, "lr": 0.0005, "entropy_coeff": 0.01, "clip_param": 0.3, "vf_clip_param": 10.0, "batch_mode": "complete_episodes"}, "algorithm": "mappo", "space_obs": "Dict(obs:Box(-1000000.0, 1000000.0, (238,), float64))", "space_act": "Box(-1.0, 1.0, (2,), float64)", "num_agents": 2, "episode_limit": 1600, "policy_mapping_info": {"all_scenario": {"description": "mixed scenarios to t>2 (num_teams > 1)", "team_prefix": ["team0_"], "all_agents_one_policy": true, "one_agent_one_policy": true}}, "agent_name_ls": ["team0_0", "team0_1"]}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "gobigger_st_t1p2", "observation_space": null, "action_space": null, "env_config": {}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 50, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 321, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"shared_policy": ["<class 'ray.rllib.policy.policy_template.MAPPOTorchPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": "<function run_cc.<locals>.<lambda> at 0x7f336a1f90d0>", "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 3200, "shuffle_sequences": true, "num_sgd_iter": 5, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 654.7220892906189, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 54.285714285714285, "ram_util_percent": 36.1}}
